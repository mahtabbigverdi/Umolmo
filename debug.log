2025-07-15 13:20:18.406	g3084:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-15 13:20:18.667	g3084:0	train:54	INFO	Configuration:
2025-07-15 13:20:18.668	g3084:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=128, n_heads=2, n_kv_heads=None, head_dim=None, qkv_bias=False, clip_qkv=None, n_layers=1, mlp_ratio=4, mlp_hidden_size=None, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=10000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='default', layer_norm_with_affine=True, layer_norm_eps=None, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=True, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.1, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=None, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2-7B', tokenizer_dir=None), init_path=None, init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='openai', image_default_input_size=(336, 336), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1024, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=1, image_head_dim=64, image_mlp_dim=4096, image_mlp_activations='gelu', image_dropout_rate=0.0, image_num_pos=577, image_norm_eps=1e-05, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path=None, resize_mode='default', pad_value=0.0, normalize='openai'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-1,), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='resize', max_crops=1, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear'), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'chart_qa': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=20, inf_evaluators=[InfDatasetEvaluatorConfig(label='chart_qa', data=DataLoaderConfig(dataset='chart_qa', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='relaxed_correctness,scifi_relaxed_correctness,em', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=16, console_log_interval=5, include_image=False)], inf_eval_interval=20, eval_on_last_step=True, eval_on_load=False, save_folder='debug_run', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint=None, allow_resume=True, max_duration=1000, global_train_batch_size=8, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=None, beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=5, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=1000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-15 13:20:18.703	g3084:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-15 13:20:21.479	g3084:0	root:123	INFO	Padding tokenizer with 416 tokens
2025-07-15 13:20:24.574	g3084:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-15 13:20:25.048	g3084:0	train:191	INFO	Total number of parameters: 58,006,016
2025-07-15 13:20:25.049	g3084:0	train:192	INFO	Number of non-embedding parameters: 38,525,440
2025-07-15 13:20:25.050	g3084:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 234
2025-07-15 13:20:25.051	g3084:0	train:196	INFO	Model:
2025-07-15 13:20:25.051	g3084:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0): FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=128, out_features=128, bias=True)
          (ff_out): Linear(in_features=256, out_features=128, bias=True)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): LayerNorm()
          (ff_norm): LayerNorm()
          (att_proj): Linear(in_features=128, out_features=384, bias=True)
          (ff_proj): Linear(in_features=128, out_features=512, bias=True)
        )
      )
    )
    (ln_f): FSDPLayerNorm()
    (emb_drop): Dropout(p=0.1, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=128, out_features=152192, bias=True)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=1024, out_features=1024, bias=True)
        (wk): Linear(in_features=1024, out_features=1024, bias=True)
        (wv): Linear(in_features=1024, out_features=1024, bias=True)
        (wo): Linear(in_features=1024, out_features=1024, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1024, out_features=256, bias=False)
        (w2): Linear(in_features=256, out_features=128, bias=False)
        (w3): Linear(in_features=1024, out_features=256, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1024, bias=False)
      (pre_ln): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0): FSDPResidualAttentionBlock(
            (attention): ViTMultiHeadDotProductAttention(
              (wq): Linear(in_features=1024, out_features=1024, bias=True)
              (wk): Linear(in_features=1024, out_features=1024, bias=True)
              (wv): Linear(in_features=1024, out_features=1024, bias=True)
              (wo): Linear(in_features=1024, out_features=1024, bias=True)
              (residual_dropout): Dropout(p=0.0, inplace=False)
            )
            (feed_forward): ViTMLP(
              (w1): Linear(in_features=1024, out_features=4096, bias=True)
              (act): GELUActivation()
              (w2): Linear(in_features=4096, out_features=1024, bias=True)
            )
            (attention_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (ffn_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=700, out_features=128, bias=False)
  (vision_decoder_head): Linear(in_features=128, out_features=700, bias=False)
)
2025-07-15 13:20:25.062	g3084:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-15 13:20:25.062	g3084:0	olmo.data.data_loader:197	INFO	Loading train dataset chart_qa/train
2025-07-15 13:20:25.063	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_human.json
2025-07-15 13:20:25.133	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_augmented.json
2025-07-15 13:20:25.272	g3084:0	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-15 13:20:25.272	g3084:0	olmo.data.data_loader:219	INFO	chart_qa: 100.00
2025-07-15 13:20:25.274	g3084:0	olmo.models.molmo.molmo:119	INFO	Building collator, pad=to_max seq_len=2304 images=1 pooled_patches_idx=158
2025-07-15 13:20:25.275	g3084:0	olmo.data.data_loader:100	INFO	Loading eval dataset: chart_qa/validation
2025-07-15 13:20:25.275	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_human.json
2025-07-15 13:20:25.303	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_augmented.json
2025-07-15 13:20:25.368	g3084:0	olmo.models.molmo.molmo:119	INFO	Building collator, pad=to_max seq_len=1792 images=1 pooled_patches_idx=158
2025-07-15 13:20:25.841	g3084:0	train:332	INFO	Starting training...
2025-07-15 13:20:25.843	g3084:0	olmo.train.trainer:817	INFO	Pre-train system metrics
    System/Peak GPU Memory (MB)=370.5
2025-07-15 13:20:32.971	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:20:38.471	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:20:39.264	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:20:39.708	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:20:40.159	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:20:40.586	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:20:40.880	g3084:0	olmo.train.trainer:817	INFO	[step=5/1000]
    train/CrossEntropyLoss=11.92
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0318
    train/Accuracy=0.0
    throughput/total_tokens=92,160
    throughput/device/tokens_per_second=45,243
    throughput/device/batches_per_second=2.455
2025-07-15 13:20:41.015	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:20:41.465	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:20:41.899	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:20:42.349	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:20:42.791	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:20:43.087	g3084:0	olmo.train.trainer:817	INFO	[step=10/1000]
    train/CrossEntropyLoss=11.91
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0305
    train/Accuracy=0.0
    throughput/total_tokens=184,320
    throughput/device/tokens_per_second=43,244
    throughput/device/batches_per_second=2.346
    System/Peak GPU Memory (MB)=29,214
2025-07-15 13:20:43.244	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:20:43.680	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:20:44.113	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:20:44.571	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:20:45.121	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:20:45.414	g3084:0	olmo.train.trainer:817	INFO	[step=15/1000]
    train/CrossEntropyLoss=11.90
    train/ZLoss=0.0143
    train/ImageGenLoss=0.7157
    train/Accuracy=0.0
    throughput/total_tokens=276,480
    throughput/device/tokens_per_second=41,864
    throughput/device/batches_per_second=2.271
2025-07-15 13:20:45.558	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:20:45.996	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:20:46.417	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:20:46.855	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:20:47.309	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:20:47.605	g3084:0	olmo.train.trainer:817	INFO	[step=20/1000]
    train/CrossEntropyLoss=11.83
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=368,640
    throughput/device/tokens_per_second=41,920
    throughput/device/batches_per_second=2.274
    System/Peak GPU Memory (MB)=29,214
2025-07-15 13:20:47.606	g3084:0	olmo.train.trainer:863	INFO	Running evaluation for 'chart_qa'...
2025-07-15 13:20:48.138	g3084:0	olmo.util:177	CRITICAL	Uncaught AssertionError: 
Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/Umolmo/launch_scripts/train_multitask_model.py", line 396, in <module>
    run_trainer(cfg)
  File "/gscratch/krishna/mahtab/Umolmo/scripts/train.py", line 333, in run_trainer
    trainer.fit()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 1145, in fit
    eval_metrics = self.inference_eval()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 864, in inference_eval
    dataset_metrics = evaluator.run(
  File "/gscratch/krishna/mahtab/Umolmo/olmo/eval/inf_evaluator.py", line 194, in run
    for eval_step, batch in enumerate(tqdm(eval_it, total=total_steps, ncols=100, disable=not pbar)):
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/tqdm/std.py", line 1169, in __iter__
    for obj in iterable:
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 733, in __next__
    data = self._next_data()
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 789, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/gscratch/krishna/mahtab/Umolmo/olmo/data/dataset.py", line 52, in __getitem__
    return self.get(idx, 0)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/data/dataset.py", line 70, in get
    item = self.preprocessor(item, rng, **self.preprocessor_kwargs)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/model_preprocessor.py", line 398, in __call__
    batch = self.mm_preprocessor(
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/model_preprocessor.py", line 354, in __call__
    out = self.tokenize_and_interleave(messages, all_image_tokens, image_outputs, weight=weight)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/data/interleaved_text_preprocessor.py", line 262, in tokenize_and_interleave
    assert len(np.argwhere(target_tokens == self.tokenizer.image_gen_start_token_id)) == len(image_outputs)
AssertionError
2025-07-15 13:30:19.106	g3084:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-15 13:30:19.181	g3084:0	train:54	INFO	Configuration:
2025-07-15 13:30:19.182	g3084:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=128, n_heads=2, n_kv_heads=None, head_dim=None, qkv_bias=False, clip_qkv=None, n_layers=1, mlp_ratio=4, mlp_hidden_size=None, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=10000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='default', layer_norm_with_affine=True, layer_norm_eps=None, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=True, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.1, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=None, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2-7B', tokenizer_dir=None), init_path=None, init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='openai', image_default_input_size=(336, 336), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1024, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=1, image_head_dim=64, image_mlp_dim=4096, image_mlp_activations='gelu', image_dropout_rate=0.0, image_num_pos=577, image_norm_eps=1e-05, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path=None, resize_mode='default', pad_value=0.0, normalize='openai'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-1,), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='resize', max_crops=1, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear'), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'chart_qa': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=20, inf_evaluators=[InfDatasetEvaluatorConfig(label='chart_qa', data=DataLoaderConfig(dataset='chart_qa', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='relaxed_correctness,scifi_relaxed_correctness,em', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=16, console_log_interval=5, include_image=False)], inf_eval_interval=20, eval_on_last_step=True, eval_on_load=False, save_folder='debug_run', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint=None, allow_resume=True, max_duration=1000, global_train_batch_size=8, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=None, beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=5, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=1000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-15 13:30:19.213	g3084:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-15 13:30:21.833	g3084:0	root:123	INFO	Padding tokenizer with 416 tokens
2025-07-15 13:30:24.059	g3084:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-15 13:30:24.225	g3084:0	train:191	INFO	Total number of parameters: 58,006,016
2025-07-15 13:30:24.226	g3084:0	train:192	INFO	Number of non-embedding parameters: 38,525,440
2025-07-15 13:30:24.227	g3084:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 234
2025-07-15 13:30:24.227	g3084:0	train:196	INFO	Model:
2025-07-15 13:30:24.227	g3084:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0): FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=128, out_features=128, bias=True)
          (ff_out): Linear(in_features=256, out_features=128, bias=True)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): LayerNorm()
          (ff_norm): LayerNorm()
          (att_proj): Linear(in_features=128, out_features=384, bias=True)
          (ff_proj): Linear(in_features=128, out_features=512, bias=True)
        )
      )
    )
    (ln_f): FSDPLayerNorm()
    (emb_drop): Dropout(p=0.1, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=128, out_features=152192, bias=True)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=1024, out_features=1024, bias=True)
        (wk): Linear(in_features=1024, out_features=1024, bias=True)
        (wv): Linear(in_features=1024, out_features=1024, bias=True)
        (wo): Linear(in_features=1024, out_features=1024, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1024, out_features=256, bias=False)
        (w2): Linear(in_features=256, out_features=128, bias=False)
        (w3): Linear(in_features=1024, out_features=256, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1024, bias=False)
      (pre_ln): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0): FSDPResidualAttentionBlock(
            (attention): ViTMultiHeadDotProductAttention(
              (wq): Linear(in_features=1024, out_features=1024, bias=True)
              (wk): Linear(in_features=1024, out_features=1024, bias=True)
              (wv): Linear(in_features=1024, out_features=1024, bias=True)
              (wo): Linear(in_features=1024, out_features=1024, bias=True)
              (residual_dropout): Dropout(p=0.0, inplace=False)
            )
            (feed_forward): ViTMLP(
              (w1): Linear(in_features=1024, out_features=4096, bias=True)
              (act): GELUActivation()
              (w2): Linear(in_features=4096, out_features=1024, bias=True)
            )
            (attention_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (ffn_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=700, out_features=128, bias=False)
  (vision_decoder_head): Linear(in_features=128, out_features=700, bias=False)
)
2025-07-15 13:30:24.238	g3084:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-15 13:30:24.239	g3084:0	olmo.data.data_loader:197	INFO	Loading train dataset chart_qa/train
2025-07-15 13:30:24.239	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_human.json
2025-07-15 13:30:24.332	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_augmented.json
2025-07-15 13:30:24.489	g3084:0	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-15 13:30:24.489	g3084:0	olmo.data.data_loader:219	INFO	chart_qa: 100.00
2025-07-15 13:30:24.491	g3084:0	olmo.models.molmo.molmo:119	INFO	Building collator, pad=to_max seq_len=2304 images=1 pooled_patches_idx=158
2025-07-15 13:30:24.492	g3084:0	olmo.data.data_loader:100	INFO	Loading eval dataset: chart_qa/validation
2025-07-15 13:30:24.492	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_human.json
2025-07-15 13:30:24.518	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_augmented.json
2025-07-15 13:30:24.546	g3084:0	olmo.models.molmo.molmo:119	INFO	Building collator, pad=to_max seq_len=1792 images=1 pooled_patches_idx=158
2025-07-15 13:30:24.807	g3084:0	train:332	INFO	Starting training...
2025-07-15 13:30:24.808	g3084:0	olmo.train.trainer:817	INFO	Pre-train system metrics
    System/Peak GPU Memory (MB)=370.5
2025-07-15 13:30:29.332	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:30:33.936	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:30:34.583	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:30:35.016	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:30:35.447	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:30:35.872	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:30:36.166	g3084:0	olmo.train.trainer:817	INFO	[step=5/1000]
    train/CrossEntropyLoss=11.92
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0318
    train/Accuracy=0.0
    throughput/total_tokens=92,160
    throughput/device/tokens_per_second=46,173
    throughput/device/batches_per_second=2.505
2025-07-15 13:30:36.301	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:30:36.738	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:30:37.172	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:30:37.617	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:30:38.052	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:30:38.347	g3084:0	olmo.train.trainer:817	INFO	[step=10/1000]
    train/CrossEntropyLoss=11.91
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0305
    train/Accuracy=0.0
    throughput/total_tokens=184,320
    throughput/device/tokens_per_second=43,910
    throughput/device/batches_per_second=2.382
    System/Peak GPU Memory (MB)=29,214
2025-07-15 13:30:38.498	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:30:38.932	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:30:39.361	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:30:39.779	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:30:40.207	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:30:40.500	g3084:0	olmo.train.trainer:817	INFO	[step=15/1000]
    train/CrossEntropyLoss=11.90
    train/ZLoss=0.0143
    train/ImageGenLoss=0.7157
    train/Accuracy=0.0
    throughput/total_tokens=276,480
    throughput/device/tokens_per_second=43,507
    throughput/device/batches_per_second=2.360
2025-07-15 13:30:40.643	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:30:41.083	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:30:41.506	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:30:41.950	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:30:42.394	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:30:42.691	g3084:0	olmo.train.trainer:817	INFO	[step=20/1000]
    train/CrossEntropyLoss=11.84
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=368,640
    throughput/device/tokens_per_second=43,122
    throughput/device/batches_per_second=2.340
    System/Peak GPU Memory (MB)=29,214
2025-07-15 13:30:42.693	g3084:0	olmo.train.trainer:863	INFO	Running evaluation for 'chart_qa'...
2025-07-15 13:45:51.315	g3084:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-15 13:45:51.445	g3084:0	train:54	INFO	Configuration:
2025-07-15 13:45:51.446	g3084:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=128, n_heads=2, n_kv_heads=None, head_dim=None, qkv_bias=False, clip_qkv=None, n_layers=1, mlp_ratio=4, mlp_hidden_size=None, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=10000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='default', layer_norm_with_affine=True, layer_norm_eps=None, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=True, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.1, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=None, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2-7B', tokenizer_dir=None), init_path=None, init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='openai', image_default_input_size=(336, 336), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1024, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=1, image_head_dim=64, image_mlp_dim=4096, image_mlp_activations='gelu', image_dropout_rate=0.0, image_num_pos=577, image_norm_eps=1e-05, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path=None, resize_mode='default', pad_value=0.0, normalize='openai'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-1,), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='resize', max_crops=1, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear'), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'chart_qa': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=20, inf_evaluators=[InfDatasetEvaluatorConfig(label='chart_qa', data=DataLoaderConfig(dataset='chart_qa', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='relaxed_correctness,scifi_relaxed_correctness,em', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=16, console_log_interval=5, include_image=False)], inf_eval_interval=20, eval_on_last_step=True, eval_on_load=False, save_folder='debug_run', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint=None, allow_resume=True, max_duration=1000, global_train_batch_size=8, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=None, beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=5, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=1000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-15 13:45:51.476	g3084:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-15 13:45:54.094	g3084:0	root:123	INFO	Padding tokenizer with 416 tokens
2025-07-15 13:45:57.190	g3084:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-15 13:45:57.527	g3084:0	train:191	INFO	Total number of parameters: 58,006,016
2025-07-15 13:45:57.527	g3084:0	train:192	INFO	Number of non-embedding parameters: 38,525,440
2025-07-15 13:45:57.528	g3084:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 234
2025-07-15 13:45:57.529	g3084:0	train:196	INFO	Model:
2025-07-15 13:45:57.529	g3084:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0): FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=128, out_features=128, bias=True)
          (ff_out): Linear(in_features=256, out_features=128, bias=True)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): LayerNorm()
          (ff_norm): LayerNorm()
          (att_proj): Linear(in_features=128, out_features=384, bias=True)
          (ff_proj): Linear(in_features=128, out_features=512, bias=True)
        )
      )
    )
    (ln_f): FSDPLayerNorm()
    (emb_drop): Dropout(p=0.1, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=128, out_features=152192, bias=True)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=1024, out_features=1024, bias=True)
        (wk): Linear(in_features=1024, out_features=1024, bias=True)
        (wv): Linear(in_features=1024, out_features=1024, bias=True)
        (wo): Linear(in_features=1024, out_features=1024, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1024, out_features=256, bias=False)
        (w2): Linear(in_features=256, out_features=128, bias=False)
        (w3): Linear(in_features=1024, out_features=256, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1024, bias=False)
      (pre_ln): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0): FSDPResidualAttentionBlock(
            (attention): ViTMultiHeadDotProductAttention(
              (wq): Linear(in_features=1024, out_features=1024, bias=True)
              (wk): Linear(in_features=1024, out_features=1024, bias=True)
              (wv): Linear(in_features=1024, out_features=1024, bias=True)
              (wo): Linear(in_features=1024, out_features=1024, bias=True)
              (residual_dropout): Dropout(p=0.0, inplace=False)
            )
            (feed_forward): ViTMLP(
              (w1): Linear(in_features=1024, out_features=4096, bias=True)
              (act): GELUActivation()
              (w2): Linear(in_features=4096, out_features=1024, bias=True)
            )
            (attention_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (ffn_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=700, out_features=128, bias=False)
  (vision_decoder_head): Linear(in_features=128, out_features=700, bias=False)
)
2025-07-15 13:45:57.539	g3084:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-15 13:45:57.539	g3084:0	olmo.data.data_loader:197	INFO	Loading train dataset chart_qa/train
2025-07-15 13:45:57.540	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_human.json
2025-07-15 13:45:57.603	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_augmented.json
2025-07-15 13:45:57.746	g3084:0	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-15 13:45:57.747	g3084:0	olmo.data.data_loader:219	INFO	chart_qa: 100.00
2025-07-15 13:45:57.748	g3084:0	olmo.models.molmo.molmo:119	INFO	Building collator, pad=to_max seq_len=2304 images=1 pooled_patches_idx=158
2025-07-15 13:45:57.749	g3084:0	olmo.data.data_loader:100	INFO	Loading eval dataset: chart_qa/validation
2025-07-15 13:45:57.750	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_human.json
2025-07-15 13:45:57.776	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_augmented.json
2025-07-15 13:45:57.797	g3084:0	olmo.models.molmo.molmo:119	INFO	Building collator, pad=to_max seq_len=1792 images=1 pooled_patches_idx=158
2025-07-15 13:45:58.219	g3084:0	train:332	INFO	Starting training...
2025-07-15 13:45:58.221	g3084:0	olmo.train.trainer:817	INFO	Pre-train system metrics
    System/Peak GPU Memory (MB)=370.5
2025-07-15 13:46:04.101	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:46:09.241	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:46:10.083	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:46:10.493	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:46:10.897	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:46:11.294	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:46:11.577	g3084:0	olmo.train.trainer:817	INFO	[step=5/1000]
    train/CrossEntropyLoss=11.92
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0318
    train/Accuracy=0.0
    throughput/total_tokens=92,160
    throughput/device/tokens_per_second=48,902
    throughput/device/batches_per_second=2.653
2025-07-15 13:46:11.692	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:46:12.097	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:46:12.497	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:46:12.916	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:46:13.329	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:46:13.615	g3084:0	olmo.train.trainer:817	INFO	[step=10/1000]
    train/CrossEntropyLoss=11.91
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0305
    train/Accuracy=0.0
    throughput/total_tokens=184,320
    throughput/device/tokens_per_second=46,786
    throughput/device/batches_per_second=2.538
    System/Peak GPU Memory (MB)=29,214
2025-07-15 13:46:13.748	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:46:14.170	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:46:14.587	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:46:14.994	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:46:15.407	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:46:15.696	g3084:0	olmo.train.trainer:817	INFO	[step=15/1000]
    train/CrossEntropyLoss=11.90
    train/ZLoss=0.0143
    train/ImageGenLoss=0.7157
    train/Accuracy=0.0
    throughput/total_tokens=276,480
    throughput/device/tokens_per_second=45,862
    throughput/device/batches_per_second=2.488
2025-07-15 13:46:15.832	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:46:16.258	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:46:16.666	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:46:17.090	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:46:17.515	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:46:17.802	g3084:0	olmo.train.trainer:817	INFO	[step=20/1000]
    train/CrossEntropyLoss=11.83
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=368,640
    throughput/device/tokens_per_second=45,289
    throughput/device/batches_per_second=2.457
    System/Peak GPU Memory (MB)=29,214
2025-07-15 13:46:17.804	g3084:0	olmo.train.trainer:863	INFO	Running evaluation for 'chart_qa'...
2025-07-15 13:46:59.449	g3084:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-15 13:46:59.521	g3084:0	train:54	INFO	Configuration:
2025-07-15 13:46:59.522	g3084:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=128, n_heads=2, n_kv_heads=None, head_dim=None, qkv_bias=False, clip_qkv=None, n_layers=1, mlp_ratio=4, mlp_hidden_size=None, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=10000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='default', layer_norm_with_affine=True, layer_norm_eps=None, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=True, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.1, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=None, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2-7B', tokenizer_dir=None), init_path=None, init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='openai', image_default_input_size=(336, 336), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1024, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=1, image_head_dim=64, image_mlp_dim=4096, image_mlp_activations='gelu', image_dropout_rate=0.0, image_num_pos=577, image_norm_eps=1e-05, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path=None, resize_mode='default', pad_value=0.0, normalize='openai'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-1,), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='resize', max_crops=1, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear'), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'chart_qa': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=20, inf_evaluators=[InfDatasetEvaluatorConfig(label='chart_qa', data=DataLoaderConfig(dataset='chart_qa', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='relaxed_correctness,scifi_relaxed_correctness,em', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=16, console_log_interval=5, include_image=False)], inf_eval_interval=20, eval_on_last_step=True, eval_on_load=False, save_folder='debug_run', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint=None, allow_resume=True, max_duration=1000, global_train_batch_size=8, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=None, beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=5, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=1000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-15 13:46:59.552	g3084:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-15 13:47:01.810	g3084:0	root:123	INFO	Padding tokenizer with 416 tokens
2025-07-15 13:47:03.804	g3084:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-15 13:47:03.950	g3084:0	train:191	INFO	Total number of parameters: 58,006,016
2025-07-15 13:47:03.950	g3084:0	train:192	INFO	Number of non-embedding parameters: 38,525,440
2025-07-15 13:47:03.951	g3084:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 234
2025-07-15 13:47:03.952	g3084:0	train:196	INFO	Model:
2025-07-15 13:47:03.952	g3084:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0): FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=128, out_features=128, bias=True)
          (ff_out): Linear(in_features=256, out_features=128, bias=True)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): LayerNorm()
          (ff_norm): LayerNorm()
          (att_proj): Linear(in_features=128, out_features=384, bias=True)
          (ff_proj): Linear(in_features=128, out_features=512, bias=True)
        )
      )
    )
    (ln_f): FSDPLayerNorm()
    (emb_drop): Dropout(p=0.1, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=128, out_features=152192, bias=True)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=1024, out_features=1024, bias=True)
        (wk): Linear(in_features=1024, out_features=1024, bias=True)
        (wv): Linear(in_features=1024, out_features=1024, bias=True)
        (wo): Linear(in_features=1024, out_features=1024, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1024, out_features=256, bias=False)
        (w2): Linear(in_features=256, out_features=128, bias=False)
        (w3): Linear(in_features=1024, out_features=256, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1024, bias=False)
      (pre_ln): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0): FSDPResidualAttentionBlock(
            (attention): ViTMultiHeadDotProductAttention(
              (wq): Linear(in_features=1024, out_features=1024, bias=True)
              (wk): Linear(in_features=1024, out_features=1024, bias=True)
              (wv): Linear(in_features=1024, out_features=1024, bias=True)
              (wo): Linear(in_features=1024, out_features=1024, bias=True)
              (residual_dropout): Dropout(p=0.0, inplace=False)
            )
            (feed_forward): ViTMLP(
              (w1): Linear(in_features=1024, out_features=4096, bias=True)
              (act): GELUActivation()
              (w2): Linear(in_features=4096, out_features=1024, bias=True)
            )
            (attention_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (ffn_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=700, out_features=128, bias=False)
  (vision_decoder_head): Linear(in_features=128, out_features=700, bias=False)
)
2025-07-15 13:47:03.961	g3084:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-15 13:47:03.962	g3084:0	olmo.data.data_loader:197	INFO	Loading train dataset chart_qa/train
2025-07-15 13:47:03.962	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_human.json
2025-07-15 13:47:03.996	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_augmented.json
2025-07-15 13:47:04.094	g3084:0	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-15 13:47:04.094	g3084:0	olmo.data.data_loader:219	INFO	chart_qa: 100.00
2025-07-15 13:47:04.096	g3084:0	olmo.models.molmo.molmo:119	INFO	Building collator, pad=to_max seq_len=2304 images=1 pooled_patches_idx=158
2025-07-15 13:47:04.097	g3084:0	olmo.data.data_loader:100	INFO	Loading eval dataset: chart_qa/validation
2025-07-15 13:47:04.097	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_human.json
2025-07-15 13:47:04.103	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_augmented.json
2025-07-15 13:47:04.108	g3084:0	olmo.models.molmo.molmo:119	INFO	Building collator, pad=to_max seq_len=1792 images=1 pooled_patches_idx=158
2025-07-15 13:47:04.342	g3084:0	train:332	INFO	Starting training...
2025-07-15 13:47:04.343	g3084:0	olmo.train.trainer:817	INFO	Pre-train system metrics
    System/Peak GPU Memory (MB)=370.5
2025-07-15 13:47:15.354	g3084:0	olmo.util:177	CRITICAL	Uncaught BdbQuit: 
Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/Umolmo/launch_scripts/train_multitask_model.py", line 396, in <module>
    run_trainer(cfg)
  File "/gscratch/krishna/mahtab/Umolmo/scripts/train.py", line 333, in run_trainer
    trainer.fit()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 1020, in fit
    for batch in self.train_loader:
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 733, in __next__
    data = self._next_data()
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 789, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 33, in fetch
    data.append(next(self.dataset_iter))
  File "/gscratch/krishna/mahtab/Umolmo/olmo/data/iterable_dataset_mixture.py", line 122, in __iter__
    yield dataset.get(int(shuffled_order[count % len(dataset)]), epoch)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/data/dataset.py", line 70, in get
    item = self.preprocessor(item, rng, **self.preprocessor_kwargs)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/model_preprocessor.py", line 399, in __call__
    batch = self.mm_preprocessor(
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/model_preprocessor.py", line 354, in __call__
    out = self.tokenize_and_interleave(messages, all_image_tokens, image_outputs, weight=weight)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/data/interleaved_text_preprocessor.py", line 267, in tokenize_and_interleave
    new_mm_loss_masks = []
  File "/gscratch/krishna/mahtab/Umolmo/olmo/data/interleaved_text_preprocessor.py", line 267, in tokenize_and_interleave
    new_mm_loss_masks = []
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/bdb.py", line 90, in trace_dispatch
    return self.dispatch_line(frame)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/bdb.py", line 115, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit
2025-07-15 13:47:40.273	g3084:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-15 13:47:40.346	g3084:0	train:54	INFO	Configuration:
2025-07-15 13:47:40.346	g3084:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=128, n_heads=2, n_kv_heads=None, head_dim=None, qkv_bias=False, clip_qkv=None, n_layers=1, mlp_ratio=4, mlp_hidden_size=None, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=10000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='default', layer_norm_with_affine=True, layer_norm_eps=None, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=True, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.1, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=None, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2-7B', tokenizer_dir=None), init_path=None, init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='openai', image_default_input_size=(336, 336), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1024, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=1, image_head_dim=64, image_mlp_dim=4096, image_mlp_activations='gelu', image_dropout_rate=0.0, image_num_pos=577, image_norm_eps=1e-05, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path=None, resize_mode='default', pad_value=0.0, normalize='openai'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-1,), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='resize', max_crops=1, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear'), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'chart_qa': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=20, inf_evaluators=[InfDatasetEvaluatorConfig(label='chart_qa', data=DataLoaderConfig(dataset='chart_qa', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='relaxed_correctness,scifi_relaxed_correctness,em', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=16, console_log_interval=5, include_image=False)], inf_eval_interval=20, eval_on_last_step=True, eval_on_load=False, save_folder='debug_run', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint=None, allow_resume=True, max_duration=1000, global_train_batch_size=8, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=None, beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=5, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=1000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-15 13:47:40.377	g3084:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-15 13:47:42.913	g3084:0	root:123	INFO	Padding tokenizer with 416 tokens
2025-07-15 13:47:44.911	g3084:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-15 13:47:45.059	g3084:0	train:191	INFO	Total number of parameters: 58,006,016
2025-07-15 13:47:45.060	g3084:0	train:192	INFO	Number of non-embedding parameters: 38,525,440
2025-07-15 13:47:45.061	g3084:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 234
2025-07-15 13:47:45.061	g3084:0	train:196	INFO	Model:
2025-07-15 13:47:45.061	g3084:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0): FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=128, out_features=128, bias=True)
          (ff_out): Linear(in_features=256, out_features=128, bias=True)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): LayerNorm()
          (ff_norm): LayerNorm()
          (att_proj): Linear(in_features=128, out_features=384, bias=True)
          (ff_proj): Linear(in_features=128, out_features=512, bias=True)
        )
      )
    )
    (ln_f): FSDPLayerNorm()
    (emb_drop): Dropout(p=0.1, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=128, out_features=152192, bias=True)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=1024, out_features=1024, bias=True)
        (wk): Linear(in_features=1024, out_features=1024, bias=True)
        (wv): Linear(in_features=1024, out_features=1024, bias=True)
        (wo): Linear(in_features=1024, out_features=1024, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1024, out_features=256, bias=False)
        (w2): Linear(in_features=256, out_features=128, bias=False)
        (w3): Linear(in_features=1024, out_features=256, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1024, bias=False)
      (pre_ln): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0): FSDPResidualAttentionBlock(
            (attention): ViTMultiHeadDotProductAttention(
              (wq): Linear(in_features=1024, out_features=1024, bias=True)
              (wk): Linear(in_features=1024, out_features=1024, bias=True)
              (wv): Linear(in_features=1024, out_features=1024, bias=True)
              (wo): Linear(in_features=1024, out_features=1024, bias=True)
              (residual_dropout): Dropout(p=0.0, inplace=False)
            )
            (feed_forward): ViTMLP(
              (w1): Linear(in_features=1024, out_features=4096, bias=True)
              (act): GELUActivation()
              (w2): Linear(in_features=4096, out_features=1024, bias=True)
            )
            (attention_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (ffn_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=700, out_features=128, bias=False)
  (vision_decoder_head): Linear(in_features=128, out_features=700, bias=False)
)
2025-07-15 13:47:45.071	g3084:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-15 13:47:45.071	g3084:0	olmo.data.data_loader:197	INFO	Loading train dataset chart_qa/train
2025-07-15 13:47:45.072	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_human.json
2025-07-15 13:47:45.105	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_augmented.json
2025-07-15 13:47:45.204	g3084:0	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-15 13:47:45.205	g3084:0	olmo.data.data_loader:219	INFO	chart_qa: 100.00
2025-07-15 13:47:45.206	g3084:0	olmo.models.molmo.molmo:119	INFO	Building collator, pad=to_max seq_len=2304 images=1 pooled_patches_idx=158
2025-07-15 13:47:45.207	g3084:0	olmo.data.data_loader:100	INFO	Loading eval dataset: chart_qa/validation
2025-07-15 13:47:45.207	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_human.json
2025-07-15 13:47:45.213	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_augmented.json
2025-07-15 13:47:45.218	g3084:0	olmo.models.molmo.molmo:119	INFO	Building collator, pad=to_max seq_len=1792 images=1 pooled_patches_idx=158
2025-07-15 13:47:45.455	g3084:0	train:332	INFO	Starting training...
2025-07-15 13:47:45.456	g3084:0	olmo.train.trainer:817	INFO	Pre-train system metrics
    System/Peak GPU Memory (MB)=370.5
2025-07-15 13:47:49.428	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:47:53.881	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:47:54.473	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:47:54.895	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:47:55.312	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:47:55.725	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:47:56.014	g3084:0	olmo.train.trainer:817	INFO	[step=5/1000]
    train/CrossEntropyLoss=11.92
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0318
    train/Accuracy=0.0
    throughput/total_tokens=92,160
    throughput/device/tokens_per_second=47,401
    throughput/device/batches_per_second=2.572
2025-07-15 13:47:56.143	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:47:56.567	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:47:56.986	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:47:57.416	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:47:57.836	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:47:58.126	g3084:0	olmo.train.trainer:817	INFO	[step=10/1000]
    train/CrossEntropyLoss=11.91
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0305
    train/Accuracy=0.0
    throughput/total_tokens=184,320
    throughput/device/tokens_per_second=45,247
    throughput/device/batches_per_second=2.455
    System/Peak GPU Memory (MB)=29,214
2025-07-15 13:47:58.268	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:47:58.685	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:47:59.103	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:47:59.511	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:47:59.928	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:48:00.218	g3084:0	olmo.train.trainer:817	INFO	[step=15/1000]
    train/CrossEntropyLoss=11.90
    train/ZLoss=0.0143
    train/ImageGenLoss=0.7157
    train/Accuracy=0.0
    throughput/total_tokens=276,480
    throughput/device/tokens_per_second=44,805
    throughput/device/batches_per_second=2.431
2025-07-15 13:48:00.356	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:48:00.787	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:48:01.199	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:48:01.634	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:48:02.062	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:48:02.351	g3084:0	olmo.train.trainer:817	INFO	[step=20/1000]
    train/CrossEntropyLoss=11.84
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=368,640
    throughput/device/tokens_per_second=44,377
    throughput/device/batches_per_second=2.408
    System/Peak GPU Memory (MB)=29,214
2025-07-15 13:48:02.353	g3084:0	olmo.train.trainer:863	INFO	Running evaluation for 'chart_qa'...
2025-07-15 13:48:02.858	g3084:0	olmo.util:177	CRITICAL	Uncaught RuntimeError: Length mismatch
Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/Umolmo/launch_scripts/train_multitask_model.py", line 396, in <module>
    run_trainer(cfg)
  File "/gscratch/krishna/mahtab/Umolmo/scripts/train.py", line 333, in run_trainer
    trainer.fit()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 1145, in fit
    eval_metrics = self.inference_eval()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 864, in inference_eval
    dataset_metrics = evaluator.run(
  File "/gscratch/krishna/mahtab/Umolmo/olmo/eval/inf_evaluator.py", line 194, in run
    for eval_step, batch in enumerate(tqdm(eval_it, total=total_steps, ncols=100, disable=not pbar)):
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/tqdm/std.py", line 1169, in __iter__
    for obj in iterable:
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 733, in __next__
    data = self._next_data()
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 789, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 52, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 52, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/gscratch/krishna/mahtab/Umolmo/olmo/data/dataset.py", line 52, in __getitem__
    return self.get(idx, 0)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/data/dataset.py", line 70, in get
    item = self.preprocessor(item, rng, **self.preprocessor_kwargs)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/model_preprocessor.py", line 399, in __call__
    batch = self.mm_preprocessor(
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/model_preprocessor.py", line 354, in __call__
    out = self.tokenize_and_interleave(messages, all_image_tokens, image_outputs, weight=weight)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/data/interleaved_text_preprocessor.py", line 298, in tokenize_and_interleave
    raise RuntimeError("Length mismatch")
RuntimeError: Length mismatch
2025-07-15 13:49:38.137	g3084:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-15 13:49:38.209	g3084:0	train:54	INFO	Configuration:
2025-07-15 13:49:38.210	g3084:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=128, n_heads=2, n_kv_heads=None, head_dim=None, qkv_bias=False, clip_qkv=None, n_layers=1, mlp_ratio=4, mlp_hidden_size=None, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=10000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='default', layer_norm_with_affine=True, layer_norm_eps=None, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=True, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.1, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=None, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2-7B', tokenizer_dir=None), init_path=None, init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='openai', image_default_input_size=(336, 336), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1024, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=1, image_head_dim=64, image_mlp_dim=4096, image_mlp_activations='gelu', image_dropout_rate=0.0, image_num_pos=577, image_norm_eps=1e-05, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path=None, resize_mode='default', pad_value=0.0, normalize='openai'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-1,), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='resize', max_crops=1, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear'), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'chart_qa': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=20, inf_evaluators=[InfDatasetEvaluatorConfig(label='chart_qa', data=DataLoaderConfig(dataset='chart_qa', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='relaxed_correctness,scifi_relaxed_correctness,em', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=16, console_log_interval=5, include_image=False)], inf_eval_interval=20, eval_on_last_step=True, eval_on_load=False, save_folder='debug_run', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint=None, allow_resume=True, max_duration=1000, global_train_batch_size=8, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=None, beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=5, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=1000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-15 13:49:38.240	g3084:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-15 13:49:45.742	g3084:0	root:123	INFO	Padding tokenizer with 416 tokens
2025-07-15 13:49:47.770	g3084:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-15 13:49:47.916	g3084:0	train:191	INFO	Total number of parameters: 58,006,016
2025-07-15 13:49:47.917	g3084:0	train:192	INFO	Number of non-embedding parameters: 38,525,440
2025-07-15 13:49:47.918	g3084:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 234
2025-07-15 13:49:47.918	g3084:0	train:196	INFO	Model:
2025-07-15 13:49:47.918	g3084:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0): FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=128, out_features=128, bias=True)
          (ff_out): Linear(in_features=256, out_features=128, bias=True)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): LayerNorm()
          (ff_norm): LayerNorm()
          (att_proj): Linear(in_features=128, out_features=384, bias=True)
          (ff_proj): Linear(in_features=128, out_features=512, bias=True)
        )
      )
    )
    (ln_f): FSDPLayerNorm()
    (emb_drop): Dropout(p=0.1, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=128, out_features=152192, bias=True)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=1024, out_features=1024, bias=True)
        (wk): Linear(in_features=1024, out_features=1024, bias=True)
        (wv): Linear(in_features=1024, out_features=1024, bias=True)
        (wo): Linear(in_features=1024, out_features=1024, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1024, out_features=256, bias=False)
        (w2): Linear(in_features=256, out_features=128, bias=False)
        (w3): Linear(in_features=1024, out_features=256, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1024, bias=False)
      (pre_ln): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0): FSDPResidualAttentionBlock(
            (attention): ViTMultiHeadDotProductAttention(
              (wq): Linear(in_features=1024, out_features=1024, bias=True)
              (wk): Linear(in_features=1024, out_features=1024, bias=True)
              (wv): Linear(in_features=1024, out_features=1024, bias=True)
              (wo): Linear(in_features=1024, out_features=1024, bias=True)
              (residual_dropout): Dropout(p=0.0, inplace=False)
            )
            (feed_forward): ViTMLP(
              (w1): Linear(in_features=1024, out_features=4096, bias=True)
              (act): GELUActivation()
              (w2): Linear(in_features=4096, out_features=1024, bias=True)
            )
            (attention_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (ffn_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=700, out_features=128, bias=False)
  (vision_decoder_head): Linear(in_features=128, out_features=700, bias=False)
)
2025-07-15 13:49:47.928	g3084:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-15 13:49:47.929	g3084:0	olmo.data.data_loader:197	INFO	Loading train dataset chart_qa/train
2025-07-15 13:49:47.929	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_human.json
2025-07-15 13:49:47.986	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_augmented.json
2025-07-15 13:49:48.120	g3084:0	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-15 13:49:48.121	g3084:0	olmo.data.data_loader:219	INFO	chart_qa: 100.00
2025-07-15 13:49:48.123	g3084:0	olmo.models.molmo.molmo:119	INFO	Building collator, pad=to_max seq_len=2304 images=1 pooled_patches_idx=158
2025-07-15 13:49:48.123	g3084:0	olmo.data.data_loader:100	INFO	Loading eval dataset: chart_qa/validation
2025-07-15 13:49:48.124	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_human.json
2025-07-15 13:49:48.149	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_augmented.json
2025-07-15 13:49:48.172	g3084:0	olmo.models.molmo.molmo:119	INFO	Building collator, pad=to_max seq_len=1792 images=1 pooled_patches_idx=158
2025-07-15 13:49:48.409	g3084:0	train:332	INFO	Starting training...
2025-07-15 13:49:48.410	g3084:0	olmo.train.trainer:817	INFO	Pre-train system metrics
    System/Peak GPU Memory (MB)=370.5
2025-07-15 13:49:52.821	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:49:57.544	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:49:58.135	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:49:58.554	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:49:58.970	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:49:59.385	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:49:59.673	g3084:0	olmo.train.trainer:817	INFO	[step=5/1000]
    train/CrossEntropyLoss=11.92
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0318
    train/Accuracy=0.0
    throughput/total_tokens=92,160
    throughput/device/tokens_per_second=47,509
    throughput/device/batches_per_second=2.578
2025-07-15 13:49:59.800	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:50:00.226	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:50:00.646	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:50:01.080	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:50:01.503	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:50:01.791	g3084:0	olmo.train.trainer:817	INFO	[step=10/1000]
    train/CrossEntropyLoss=11.91
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0305
    train/Accuracy=0.0
    throughput/total_tokens=184,320
    throughput/device/tokens_per_second=45,210
    throughput/device/batches_per_second=2.453
    System/Peak GPU Memory (MB)=29,214
2025-07-15 13:50:01.935	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:50:02.357	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:50:02.772	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:50:03.178	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:50:03.596	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:50:03.885	g3084:0	olmo.train.trainer:817	INFO	[step=15/1000]
    train/CrossEntropyLoss=11.90
    train/ZLoss=0.0143
    train/ImageGenLoss=0.7157
    train/Accuracy=0.0
    throughput/total_tokens=276,480
    throughput/device/tokens_per_second=44,773
    throughput/device/batches_per_second=2.429
2025-07-15 13:50:04.024	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:50:04.453	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:50:04.864	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:50:05.290	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:50:05.718	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 13:50:06.007	g3084:0	olmo.train.trainer:817	INFO	[step=20/1000]
    train/CrossEntropyLoss=11.83
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=368,640
    throughput/device/tokens_per_second=44,413
    throughput/device/batches_per_second=2.410
    System/Peak GPU Memory (MB)=29,214
2025-07-15 13:50:06.009	g3084:0	olmo.train.trainer:863	INFO	Running evaluation for 'chart_qa'...
2025-07-15 13:50:07.081	g3084:0	olmo.util:177	CRITICAL	Uncaught AttributeError: 'NoneType' object has no attribute 'shape'
Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/Umolmo/launch_scripts/train_multitask_model.py", line 396, in <module>
    run_trainer(cfg)
  File "/gscratch/krishna/mahtab/Umolmo/scripts/train.py", line 333, in run_trainer
    trainer.fit()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 1145, in fit
    eval_metrics = self.inference_eval()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 864, in inference_eval
    dataset_metrics = evaluator.run(
  File "/gscratch/krishna/mahtab/Umolmo/olmo/eval/inf_evaluator.py", line 213, in run
    olmo_gen_output = model.generate(
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py", line 746, in generate
    token_ids, scores = beam_search.search(initial_preds, state, step)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/nn/beam_search.py", line 811, in search
    return self._search(start_predictions, start_state, new_step)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/nn/beam_search.py", line 841, in _search
    start_class_log_probabilities, state = step(start_predictions, start_state, 0)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/nn/beam_search.py", line 809, in new_step
    return old_step(last_predictions, state)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py", line 715, in step
    output = self(
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1857, in _call_impl
    return inner()
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1805, in inner
    result = forward_call(*args, **kwargs)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py", line 451, in forward
    if image_outputs.shape[1] > 0:
AttributeError: 'NoneType' object has no attribute 'shape'
2025-07-15 14:08:15.026	g3084:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-15 14:08:15.099	g3084:0	train:54	INFO	Configuration:
2025-07-15 14:08:15.099	g3084:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=128, n_heads=2, n_kv_heads=None, head_dim=None, qkv_bias=False, clip_qkv=None, n_layers=1, mlp_ratio=4, mlp_hidden_size=None, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=10000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='default', layer_norm_with_affine=True, layer_norm_eps=None, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=True, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.1, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=None, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2-7B', tokenizer_dir=None), init_path=None, init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='openai', image_default_input_size=(336, 336), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1024, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=1, image_head_dim=64, image_mlp_dim=4096, image_mlp_activations='gelu', image_dropout_rate=0.0, image_num_pos=577, image_norm_eps=1e-05, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path=None, resize_mode='default', pad_value=0.0, normalize='openai'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-1,), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='resize', max_crops=1, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear'), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'chart_qa': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=20, inf_evaluators=[InfDatasetEvaluatorConfig(label='chart_qa', data=DataLoaderConfig(dataset='chart_qa', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='relaxed_correctness,scifi_relaxed_correctness,em', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=16, console_log_interval=5, include_image=False)], inf_eval_interval=20, eval_on_last_step=True, eval_on_load=False, save_folder='debug_run', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint=None, allow_resume=True, max_duration=1000, global_train_batch_size=8, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=None, beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=5, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=1000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-15 14:08:15.130	g3084:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-15 14:08:17.601	g3084:0	root:123	INFO	Padding tokenizer with 416 tokens
2025-07-15 14:08:19.533	g3084:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-15 14:08:19.680	g3084:0	train:191	INFO	Total number of parameters: 58,006,016
2025-07-15 14:08:19.681	g3084:0	train:192	INFO	Number of non-embedding parameters: 38,525,440
2025-07-15 14:08:19.682	g3084:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 234
2025-07-15 14:08:19.682	g3084:0	train:196	INFO	Model:
2025-07-15 14:08:19.683	g3084:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0): FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=128, out_features=128, bias=True)
          (ff_out): Linear(in_features=256, out_features=128, bias=True)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): LayerNorm()
          (ff_norm): LayerNorm()
          (att_proj): Linear(in_features=128, out_features=384, bias=True)
          (ff_proj): Linear(in_features=128, out_features=512, bias=True)
        )
      )
    )
    (ln_f): FSDPLayerNorm()
    (emb_drop): Dropout(p=0.1, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=128, out_features=152192, bias=True)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=1024, out_features=1024, bias=True)
        (wk): Linear(in_features=1024, out_features=1024, bias=True)
        (wv): Linear(in_features=1024, out_features=1024, bias=True)
        (wo): Linear(in_features=1024, out_features=1024, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1024, out_features=256, bias=False)
        (w2): Linear(in_features=256, out_features=128, bias=False)
        (w3): Linear(in_features=1024, out_features=256, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1024, bias=False)
      (pre_ln): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0): FSDPResidualAttentionBlock(
            (attention): ViTMultiHeadDotProductAttention(
              (wq): Linear(in_features=1024, out_features=1024, bias=True)
              (wk): Linear(in_features=1024, out_features=1024, bias=True)
              (wv): Linear(in_features=1024, out_features=1024, bias=True)
              (wo): Linear(in_features=1024, out_features=1024, bias=True)
              (residual_dropout): Dropout(p=0.0, inplace=False)
            )
            (feed_forward): ViTMLP(
              (w1): Linear(in_features=1024, out_features=4096, bias=True)
              (act): GELUActivation()
              (w2): Linear(in_features=4096, out_features=1024, bias=True)
            )
            (attention_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (ffn_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=700, out_features=128, bias=False)
  (vision_decoder_head): Linear(in_features=128, out_features=700, bias=False)
)
2025-07-15 14:08:19.695	g3084:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-15 14:08:19.696	g3084:0	olmo.data.data_loader:197	INFO	Loading train dataset chart_qa/train
2025-07-15 14:08:19.696	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_human.json
2025-07-15 14:08:19.731	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_augmented.json
2025-07-15 14:08:19.830	g3084:0	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-15 14:08:19.831	g3084:0	olmo.data.data_loader:219	INFO	chart_qa: 100.00
2025-07-15 14:08:19.833	g3084:0	olmo.models.molmo.molmo:119	INFO	Building collator, pad=to_max seq_len=2304 images=1 pooled_patches_idx=158
2025-07-15 14:08:19.833	g3084:0	olmo.data.data_loader:100	INFO	Loading eval dataset: chart_qa/validation
2025-07-15 14:08:19.834	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_human.json
2025-07-15 14:08:19.840	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_augmented.json
2025-07-15 14:08:19.844	g3084:0	olmo.models.molmo.molmo:119	INFO	Building collator, pad=to_max seq_len=1792 images=1 pooled_patches_idx=158
2025-07-15 14:08:20.079	g3084:0	train:332	INFO	Starting training...
2025-07-15 14:08:20.081	g3084:0	olmo.train.trainer:817	INFO	Pre-train system metrics
    System/Peak GPU Memory (MB)=370.5
2025-07-15 14:08:23.649	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:08:27.939	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:08:28.535	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:08:28.954	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:08:29.370	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:08:29.781	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:08:30.068	g3084:0	olmo.train.trainer:817	INFO	[step=5/1000]
    train/CrossEntropyLoss=11.92
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0318
    train/Accuracy=0.0
    throughput/total_tokens=92,160
    throughput/device/tokens_per_second=47,676
    throughput/device/batches_per_second=2.587
2025-07-15 14:08:30.194	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:08:30.615	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:08:31.034	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:08:31.462	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:08:31.880	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:08:32.169	g3084:0	olmo.train.trainer:817	INFO	[step=10/1000]
    train/CrossEntropyLoss=11.91
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0305
    train/Accuracy=0.0
    throughput/total_tokens=184,320
    throughput/device/tokens_per_second=45,480
    throughput/device/batches_per_second=2.467
    System/Peak GPU Memory (MB)=29,214
2025-07-15 14:08:32.311	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:08:32.733	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:08:33.144	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:08:33.547	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:08:33.960	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:08:34.248	g3084:0	olmo.train.trainer:817	INFO	[step=15/1000]
    train/CrossEntropyLoss=11.90
    train/ZLoss=0.0143
    train/ImageGenLoss=0.7157
    train/Accuracy=0.0
    throughput/total_tokens=276,480
    throughput/device/tokens_per_second=45,064
    throughput/device/batches_per_second=2.445
2025-07-15 14:08:34.382	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:08:34.806	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:08:35.213	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:08:35.638	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:08:36.063	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:08:36.352	g3084:0	olmo.train.trainer:817	INFO	[step=20/1000]
    train/CrossEntropyLoss=11.83
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=368,640
    throughput/device/tokens_per_second=44,726
    throughput/device/batches_per_second=2.427
    System/Peak GPU Memory (MB)=29,214
2025-07-15 14:08:36.354	g3084:0	olmo.train.trainer:863	INFO	Running evaluation for 'chart_qa'...
2025-07-15 14:17:23.121	g3084:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-15 14:17:23.207	g3084:0	train:54	INFO	Configuration:
2025-07-15 14:17:23.208	g3084:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=128, n_heads=2, n_kv_heads=None, head_dim=None, qkv_bias=False, clip_qkv=None, n_layers=1, mlp_ratio=4, mlp_hidden_size=None, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=10000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='default', layer_norm_with_affine=True, layer_norm_eps=None, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=True, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.1, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=None, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2-7B', tokenizer_dir=None), init_path=None, init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='openai', image_default_input_size=(336, 336), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1024, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=1, image_head_dim=64, image_mlp_dim=4096, image_mlp_activations='gelu', image_dropout_rate=0.0, image_num_pos=577, image_norm_eps=1e-05, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path=None, resize_mode='default', pad_value=0.0, normalize='openai'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-1,), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='resize', max_crops=1, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear'), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'chart_qa': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=20, inf_evaluators=[InfDatasetEvaluatorConfig(label='chart_qa', data=DataLoaderConfig(dataset='chart_qa', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='relaxed_correctness,scifi_relaxed_correctness,em', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=16, console_log_interval=5, include_image=False)], inf_eval_interval=20, eval_on_last_step=True, eval_on_load=False, save_folder='debug_run', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint=None, allow_resume=True, max_duration=1000, global_train_batch_size=8, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=None, beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=5, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=1000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-15 14:17:23.240	g3084:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-15 14:17:25.623	g3084:0	root:123	INFO	Padding tokenizer with 416 tokens
2025-07-15 14:17:27.664	g3084:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-15 14:17:27.813	g3084:0	train:191	INFO	Total number of parameters: 58,006,016
2025-07-15 14:17:27.814	g3084:0	train:192	INFO	Number of non-embedding parameters: 38,525,440
2025-07-15 14:17:27.815	g3084:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 234
2025-07-15 14:17:27.815	g3084:0	train:196	INFO	Model:
2025-07-15 14:17:27.815	g3084:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0): FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=128, out_features=128, bias=True)
          (ff_out): Linear(in_features=256, out_features=128, bias=True)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): LayerNorm()
          (ff_norm): LayerNorm()
          (att_proj): Linear(in_features=128, out_features=384, bias=True)
          (ff_proj): Linear(in_features=128, out_features=512, bias=True)
        )
      )
    )
    (ln_f): FSDPLayerNorm()
    (emb_drop): Dropout(p=0.1, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=128, out_features=152192, bias=True)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=1024, out_features=1024, bias=True)
        (wk): Linear(in_features=1024, out_features=1024, bias=True)
        (wv): Linear(in_features=1024, out_features=1024, bias=True)
        (wo): Linear(in_features=1024, out_features=1024, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1024, out_features=256, bias=False)
        (w2): Linear(in_features=256, out_features=128, bias=False)
        (w3): Linear(in_features=1024, out_features=256, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1024, bias=False)
      (pre_ln): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0): FSDPResidualAttentionBlock(
            (attention): ViTMultiHeadDotProductAttention(
              (wq): Linear(in_features=1024, out_features=1024, bias=True)
              (wk): Linear(in_features=1024, out_features=1024, bias=True)
              (wv): Linear(in_features=1024, out_features=1024, bias=True)
              (wo): Linear(in_features=1024, out_features=1024, bias=True)
              (residual_dropout): Dropout(p=0.0, inplace=False)
            )
            (feed_forward): ViTMLP(
              (w1): Linear(in_features=1024, out_features=4096, bias=True)
              (act): GELUActivation()
              (w2): Linear(in_features=4096, out_features=1024, bias=True)
            )
            (attention_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (ffn_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=700, out_features=128, bias=False)
  (vision_decoder_head): Linear(in_features=128, out_features=700, bias=False)
)
2025-07-15 14:17:27.826	g3084:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-15 14:17:27.826	g3084:0	olmo.data.data_loader:197	INFO	Loading train dataset chart_qa/train
2025-07-15 14:17:27.827	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_human.json
2025-07-15 14:17:27.862	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_augmented.json
2025-07-15 14:17:27.961	g3084:0	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-15 14:17:27.962	g3084:0	olmo.data.data_loader:219	INFO	chart_qa: 100.00
2025-07-15 14:17:27.963	g3084:0	olmo.models.molmo.molmo:119	INFO	Building collator, pad=to_max seq_len=2304 images=1 pooled_patches_idx=158
2025-07-15 14:17:27.964	g3084:0	olmo.data.data_loader:100	INFO	Loading eval dataset: chart_qa/validation
2025-07-15 14:17:27.964	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_human.json
2025-07-15 14:17:27.970	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_augmented.json
2025-07-15 14:17:27.992	g3084:0	olmo.models.molmo.molmo:119	INFO	Building collator, pad=to_max seq_len=1792 images=1 pooled_patches_idx=158
2025-07-15 14:17:28.227	g3084:0	train:332	INFO	Starting training...
2025-07-15 14:17:28.228	g3084:0	olmo.train.trainer:817	INFO	Pre-train system metrics
    System/Peak GPU Memory (MB)=370.5
2025-07-15 14:17:32.439	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:17:36.753	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:17:37.355	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:17:37.776	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:17:38.197	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:17:38.608	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:17:38.896	g3084:0	olmo.train.trainer:817	INFO	[step=5/1000]
    train/CrossEntropyLoss=11.92
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0318
    train/Accuracy=0.0
    throughput/total_tokens=92,160
    throughput/device/tokens_per_second=47,421
    throughput/device/batches_per_second=2.573
2025-07-15 14:17:39.021	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:17:39.440	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:17:39.855	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:17:40.282	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:17:40.697	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:17:40.982	g3084:0	olmo.train.trainer:817	INFO	[step=10/1000]
    train/CrossEntropyLoss=11.91
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0305
    train/Accuracy=0.0
    throughput/total_tokens=184,320
    throughput/device/tokens_per_second=45,557
    throughput/device/batches_per_second=2.472
    System/Peak GPU Memory (MB)=29,214
2025-07-15 14:17:41.124	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:17:41.537	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:17:41.964	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:17:42.370	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:17:42.778	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:17:43.063	g3084:0	olmo.train.trainer:817	INFO	[step=15/1000]
    train/CrossEntropyLoss=11.90
    train/ZLoss=0.0143
    train/ImageGenLoss=0.7157
    train/Accuracy=0.0
    throughput/total_tokens=276,480
    throughput/device/tokens_per_second=45,093
    throughput/device/batches_per_second=2.446
2025-07-15 14:17:43.196	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:17:43.620	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:17:44.020	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:17:44.434	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:17:44.842	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:17:45.127	g3084:0	olmo.train.trainer:817	INFO	[step=20/1000]
    train/CrossEntropyLoss=11.83
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=368,640
    throughput/device/tokens_per_second=44,981
    throughput/device/batches_per_second=2.440
    System/Peak GPU Memory (MB)=29,214
2025-07-15 14:19:46.875	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 14:43:30.453	g3084:0	olmo.util:177	CRITICAL	Uncaught BdbQuit: 
Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/Umolmo/launch_scripts/train_multitask_model.py", line 396, in <module>
    run_trainer(cfg)
  File "/gscratch/krishna/mahtab/Umolmo/scripts/train.py", line 333, in run_trainer
    trainer.fit()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 1146, in fit
    eval_metrics = self.inference_eval()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 865, in inference_eval
    dataset_metrics = evaluator.run(
  File "/gscratch/krishna/mahtab/Umolmo/olmo/eval/inf_evaluator.py", line 213, in run
    olmo_gen_output = model.generate(
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py", line 631, in generate
    attention_mask = torch.cat(
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py", line 631, in generate
    attention_mask = torch.cat(
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/bdb.py", line 90, in trace_dispatch
    return self.dispatch_line(frame)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/bdb.py", line 115, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit
2025-07-15 14:45:38.412	g3084:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-15 14:45:38.493	g3084:0	train:54	INFO	Configuration:
2025-07-15 14:45:38.494	g3084:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=128, n_heads=2, n_kv_heads=None, head_dim=None, qkv_bias=False, clip_qkv=None, n_layers=1, mlp_ratio=4, mlp_hidden_size=None, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=10000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='default', layer_norm_with_affine=True, layer_norm_eps=None, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=True, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.1, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=None, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2-7B', tokenizer_dir=None), init_path=None, init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='openai', image_default_input_size=(336, 336), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1024, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=1, image_head_dim=64, image_mlp_dim=4096, image_mlp_activations='gelu', image_dropout_rate=0.0, image_num_pos=577, image_norm_eps=1e-05, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path=None, resize_mode='default', pad_value=0.0, normalize='openai'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-1,), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='resize', max_crops=1, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear'), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'chart_qa': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=20, inf_evaluators=[InfDatasetEvaluatorConfig(label='chart_qa', data=DataLoaderConfig(dataset='chart_qa', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='relaxed_correctness,scifi_relaxed_correctness,em', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=16, console_log_interval=5, include_image=False)], inf_eval_interval=20, eval_on_last_step=True, eval_on_load=False, save_folder='debug_run', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint=None, allow_resume=True, max_duration=1000, global_train_batch_size=8, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=None, beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=5, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=1000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-15 14:45:38.543	g3084:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-15 14:45:40.950	g3084:0	root:123	INFO	Padding tokenizer with 416 tokens
2025-07-15 14:45:43.108	g3084:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-15 14:45:43.261	g3084:0	train:191	INFO	Total number of parameters: 58,006,016
2025-07-15 14:45:43.262	g3084:0	train:192	INFO	Number of non-embedding parameters: 38,525,440
2025-07-15 14:45:43.263	g3084:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 234
2025-07-15 14:45:43.263	g3084:0	train:196	INFO	Model:
2025-07-15 14:45:43.263	g3084:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0): FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=128, out_features=128, bias=True)
          (ff_out): Linear(in_features=256, out_features=128, bias=True)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): LayerNorm()
          (ff_norm): LayerNorm()
          (att_proj): Linear(in_features=128, out_features=384, bias=True)
          (ff_proj): Linear(in_features=128, out_features=512, bias=True)
        )
      )
    )
    (ln_f): FSDPLayerNorm()
    (emb_drop): Dropout(p=0.1, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=128, out_features=152192, bias=True)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=1024, out_features=1024, bias=True)
        (wk): Linear(in_features=1024, out_features=1024, bias=True)
        (wv): Linear(in_features=1024, out_features=1024, bias=True)
        (wo): Linear(in_features=1024, out_features=1024, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1024, out_features=256, bias=False)
        (w2): Linear(in_features=256, out_features=128, bias=False)
        (w3): Linear(in_features=1024, out_features=256, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1024, bias=False)
      (pre_ln): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0): FSDPResidualAttentionBlock(
            (attention): ViTMultiHeadDotProductAttention(
              (wq): Linear(in_features=1024, out_features=1024, bias=True)
              (wk): Linear(in_features=1024, out_features=1024, bias=True)
              (wv): Linear(in_features=1024, out_features=1024, bias=True)
              (wo): Linear(in_features=1024, out_features=1024, bias=True)
              (residual_dropout): Dropout(p=0.0, inplace=False)
            )
            (feed_forward): ViTMLP(
              (w1): Linear(in_features=1024, out_features=4096, bias=True)
              (act): GELUActivation()
              (w2): Linear(in_features=4096, out_features=1024, bias=True)
            )
            (attention_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (ffn_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=700, out_features=128, bias=False)
  (vision_decoder_head): Linear(in_features=128, out_features=700, bias=False)
)
2025-07-15 14:45:43.274	g3084:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-15 14:45:43.275	g3084:0	olmo.data.data_loader:197	INFO	Loading train dataset chart_qa/train
2025-07-15 14:45:43.275	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_human.json
2025-07-15 14:45:43.345	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_augmented.json
2025-07-15 14:45:43.523	g3084:0	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-15 14:45:43.523	g3084:0	olmo.data.data_loader:219	INFO	chart_qa: 100.00
2025-07-15 14:45:43.525	g3084:0	olmo.models.molmo.molmo:119	INFO	Building collator, pad=to_max seq_len=2304 images=1 pooled_patches_idx=158
2025-07-15 14:45:43.526	g3084:0	olmo.data.data_loader:100	INFO	Loading eval dataset: chart_qa/validation
2025-07-15 14:45:43.526	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_human.json
2025-07-15 14:45:43.556	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_augmented.json
2025-07-15 14:45:43.587	g3084:0	olmo.models.molmo.molmo:119	INFO	Building collator, pad=to_max seq_len=1792 images=1 pooled_patches_idx=158
2025-07-15 14:45:43.825	g3084:0	train:332	INFO	Starting training...
2025-07-15 14:45:43.826	g3084:0	olmo.train.trainer:817	INFO	Pre-train system metrics
    System/Peak GPU Memory (MB)=370.5
2025-07-15 14:45:49.356	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:458: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:45:53.779	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:458: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:45:54.380	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:458: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:45:54.803	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:458: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:45:55.223	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:458: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:45:55.638	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:458: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:45:55.927	g3084:0	olmo.train.trainer:817	INFO	[step=5/1000]
    train/CrossEntropyLoss=11.92
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0318
    train/Accuracy=0.0
    throughput/total_tokens=92,160
    throughput/device/tokens_per_second=47,253
    throughput/device/batches_per_second=2.564
2025-07-15 14:45:56.057	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:458: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:45:56.485	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:458: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:45:56.908	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:458: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:45:57.355	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:458: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:45:57.777	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:458: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:45:58.068	g3084:0	olmo.train.trainer:817	INFO	[step=10/1000]
    train/CrossEntropyLoss=11.91
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0305
    train/Accuracy=0.0
    throughput/total_tokens=184,320
    throughput/device/tokens_per_second=44,823
    throughput/device/batches_per_second=2.432
    System/Peak GPU Memory (MB)=29,214
2025-07-15 14:45:58.214	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:458: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:45:58.640	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:458: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:45:59.060	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:458: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:45:59.469	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:458: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:45:59.887	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:458: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:46:00.190	g3084:0	olmo.train.trainer:817	INFO	[step=15/1000]
    train/CrossEntropyLoss=11.90
    train/ZLoss=0.0143
    train/ImageGenLoss=0.7157
    train/Accuracy=0.0
    throughput/total_tokens=276,480
    throughput/device/tokens_per_second=44,307
    throughput/device/batches_per_second=2.404
2025-07-15 14:46:00.330	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:458: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:46:00.798	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:458: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:46:01.211	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:458: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:46:01.654	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:458: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:46:02.083	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:458: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:46:02.372	g3084:0	olmo.train.trainer:817	INFO	[step=20/1000]
    train/CrossEntropyLoss=11.84
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=368,640
    throughput/device/tokens_per_second=43,746
    throughput/device/batches_per_second=2.373
    System/Peak GPU Memory (MB)=29,214
2025-07-15 14:48:34.625	g3084:0	olmo.util:177	CRITICAL	Uncaught BdbQuit: 
Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/Umolmo/launch_scripts/train_multitask_model.py", line 396, in <module>
    run_trainer(cfg)
  File "/gscratch/krishna/mahtab/Umolmo/scripts/train.py", line 333, in run_trainer
    trainer.fit()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 1146, in fit
    eval_metrics = self.inference_eval()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 862, in inference_eval
    for evaluator in self.inference_evaluators:
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 862, in inference_eval
    for evaluator in self.inference_evaluators:
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/bdb.py", line 90, in trace_dispatch
    return self.dispatch_line(frame)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/bdb.py", line 115, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit
2025-07-15 14:51:01.500	g3084:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-15 14:51:01.587	g3084:0	train:54	INFO	Configuration:
2025-07-15 14:51:01.587	g3084:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=128, n_heads=2, n_kv_heads=None, head_dim=None, qkv_bias=False, clip_qkv=None, n_layers=1, mlp_ratio=4, mlp_hidden_size=None, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=10000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='default', layer_norm_with_affine=True, layer_norm_eps=None, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=True, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.1, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=None, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2-7B', tokenizer_dir=None), init_path=None, init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='openai', image_default_input_size=(336, 336), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1024, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=1, image_head_dim=64, image_mlp_dim=4096, image_mlp_activations='gelu', image_dropout_rate=0.0, image_num_pos=577, image_norm_eps=1e-05, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path=None, resize_mode='default', pad_value=0.0, normalize='openai'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-1,), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='resize', max_crops=1, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear'), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'chart_qa': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=20, inf_evaluators=[InfDatasetEvaluatorConfig(label='chart_qa', data=DataLoaderConfig(dataset='chart_qa', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='relaxed_correctness,scifi_relaxed_correctness,em', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=16, console_log_interval=5, include_image=False)], inf_eval_interval=20, eval_on_last_step=True, eval_on_load=False, save_folder='debug_run', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint=None, allow_resume=True, max_duration=1000, global_train_batch_size=8, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=None, beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=5, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=1000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-15 14:51:01.619	g3084:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-15 14:51:03.937	g3084:0	root:123	INFO	Padding tokenizer with 416 tokens
2025-07-15 14:51:06.061	g3084:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-15 14:51:06.209	g3084:0	train:191	INFO	Total number of parameters: 58,006,016
2025-07-15 14:51:06.210	g3084:0	train:192	INFO	Number of non-embedding parameters: 38,525,440
2025-07-15 14:51:06.211	g3084:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 234
2025-07-15 14:51:06.211	g3084:0	train:196	INFO	Model:
2025-07-15 14:51:06.211	g3084:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0): FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=128, out_features=128, bias=True)
          (ff_out): Linear(in_features=256, out_features=128, bias=True)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): LayerNorm()
          (ff_norm): LayerNorm()
          (att_proj): Linear(in_features=128, out_features=384, bias=True)
          (ff_proj): Linear(in_features=128, out_features=512, bias=True)
        )
      )
    )
    (ln_f): FSDPLayerNorm()
    (emb_drop): Dropout(p=0.1, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=128, out_features=152192, bias=True)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=1024, out_features=1024, bias=True)
        (wk): Linear(in_features=1024, out_features=1024, bias=True)
        (wv): Linear(in_features=1024, out_features=1024, bias=True)
        (wo): Linear(in_features=1024, out_features=1024, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1024, out_features=256, bias=False)
        (w2): Linear(in_features=256, out_features=128, bias=False)
        (w3): Linear(in_features=1024, out_features=256, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1024, bias=False)
      (pre_ln): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0): FSDPResidualAttentionBlock(
            (attention): ViTMultiHeadDotProductAttention(
              (wq): Linear(in_features=1024, out_features=1024, bias=True)
              (wk): Linear(in_features=1024, out_features=1024, bias=True)
              (wv): Linear(in_features=1024, out_features=1024, bias=True)
              (wo): Linear(in_features=1024, out_features=1024, bias=True)
              (residual_dropout): Dropout(p=0.0, inplace=False)
            )
            (feed_forward): ViTMLP(
              (w1): Linear(in_features=1024, out_features=4096, bias=True)
              (act): GELUActivation()
              (w2): Linear(in_features=4096, out_features=1024, bias=True)
            )
            (attention_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (ffn_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=700, out_features=128, bias=False)
  (vision_decoder_head): Linear(in_features=128, out_features=700, bias=False)
)
2025-07-15 14:51:06.227	g3084:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-15 14:51:06.227	g3084:0	olmo.data.data_loader:197	INFO	Loading train dataset chart_qa/train
2025-07-15 14:51:06.228	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_human.json
2025-07-15 14:51:06.263	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_augmented.json
2025-07-15 14:51:06.412	g3084:0	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-15 14:51:06.412	g3084:0	olmo.data.data_loader:219	INFO	chart_qa: 100.00
2025-07-15 14:51:06.414	g3084:0	olmo.models.molmo.molmo:119	INFO	Building collator, pad=to_max seq_len=2304 images=1 pooled_patches_idx=158
2025-07-15 14:51:06.415	g3084:0	olmo.data.data_loader:100	INFO	Loading eval dataset: chart_qa/validation
2025-07-15 14:51:06.415	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_human.json
2025-07-15 14:51:06.443	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_augmented.json
2025-07-15 14:51:06.463	g3084:0	olmo.models.molmo.molmo:119	INFO	Building collator, pad=to_max seq_len=1792 images=1 pooled_patches_idx=158
2025-07-15 14:51:06.699	g3084:0	train:332	INFO	Starting training...
2025-07-15 14:51:06.700	g3084:0	olmo.train.trainer:817	INFO	Pre-train system metrics
    System/Peak GPU Memory (MB)=370.5
2025-07-15 14:51:10.974	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:458: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:51:15.302	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:458: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:51:15.926	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:458: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:51:16.356	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:458: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:51:16.782	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:458: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:51:17.208	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:458: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:51:17.500	g3084:0	olmo.train.trainer:817	INFO	[step=5/1000]
    train/CrossEntropyLoss=11.92
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0318
    train/Accuracy=0.0
    throughput/total_tokens=92,160
    throughput/device/tokens_per_second=46,425
    throughput/device/batches_per_second=2.519
2025-07-15 14:51:17.638	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:458: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:51:18.070	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:458: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:51:18.502	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:458: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:51:18.942	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:458: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:51:19.368	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:458: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:51:19.660	g3084:0	olmo.train.trainer:817	INFO	[step=10/1000]
    train/CrossEntropyLoss=11.91
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0305
    train/Accuracy=0.0
    throughput/total_tokens=184,320
    throughput/device/tokens_per_second=44,259
    throughput/device/batches_per_second=2.401
    System/Peak GPU Memory (MB)=29,214
2025-07-15 14:51:19.809	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:458: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:51:20.237	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:458: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:51:20.659	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:458: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:51:21.090	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:458: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:51:21.513	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:458: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:51:21.804	g3084:0	olmo.train.trainer:817	INFO	[step=15/1000]
    train/CrossEntropyLoss=11.90
    train/ZLoss=0.0143
    train/ImageGenLoss=0.7157
    train/Accuracy=0.0
    throughput/total_tokens=276,480
    throughput/device/tokens_per_second=43,795
    throughput/device/batches_per_second=2.376
2025-07-15 14:51:21.948	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:458: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:51:22.378	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:458: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:51:22.789	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:458: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:51:23.226	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:458: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:51:23.652	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:458: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 14:51:23.940	g3084:0	olmo.train.trainer:817	INFO	[step=20/1000]
    train/CrossEntropyLoss=11.84
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=368,640
    throughput/device/tokens_per_second=43,622
    throughput/device/batches_per_second=2.367
    System/Peak GPU Memory (MB)=29,214
2025-07-15 14:51:23.942	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 15:51:06.717	g3084:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-15 15:51:06.798	g3084:0	train:54	INFO	Configuration:
2025-07-15 15:51:06.799	g3084:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=128, n_heads=2, n_kv_heads=None, head_dim=None, qkv_bias=False, clip_qkv=None, n_layers=1, mlp_ratio=4, mlp_hidden_size=None, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=10000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='default', layer_norm_with_affine=True, layer_norm_eps=None, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=True, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.1, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=None, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2-7B', tokenizer_dir=None), init_path=None, init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='openai', image_default_input_size=(336, 336), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1024, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=1, image_head_dim=64, image_mlp_dim=4096, image_mlp_activations='gelu', image_dropout_rate=0.0, image_num_pos=577, image_norm_eps=1e-05, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path=None, resize_mode='default', pad_value=0.0, normalize='openai'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-1,), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='resize', max_crops=1, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear'), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'chart_qa': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=20, inf_evaluators=[InfDatasetEvaluatorConfig(label='chart_qa', data=DataLoaderConfig(dataset='chart_qa', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='relaxed_correctness,scifi_relaxed_correctness,em', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=16, console_log_interval=5, include_image=False)], inf_eval_interval=20, eval_on_last_step=True, eval_on_load=False, save_folder='debug_run', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint=None, allow_resume=True, max_duration=1000, global_train_batch_size=8, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=None, beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=5, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=1000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-15 15:51:06.830	g3084:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-15 15:51:09.113	g3084:0	root:123	INFO	Padding tokenizer with 416 tokens
2025-07-15 15:51:11.178	g3084:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-15 15:51:11.327	g3084:0	train:191	INFO	Total number of parameters: 58,006,016
2025-07-15 15:51:11.328	g3084:0	train:192	INFO	Number of non-embedding parameters: 38,525,440
2025-07-15 15:51:11.329	g3084:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 234
2025-07-15 15:51:11.329	g3084:0	train:196	INFO	Model:
2025-07-15 15:51:11.329	g3084:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0): FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=128, out_features=128, bias=True)
          (ff_out): Linear(in_features=256, out_features=128, bias=True)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): LayerNorm()
          (ff_norm): LayerNorm()
          (att_proj): Linear(in_features=128, out_features=384, bias=True)
          (ff_proj): Linear(in_features=128, out_features=512, bias=True)
        )
      )
    )
    (ln_f): FSDPLayerNorm()
    (emb_drop): Dropout(p=0.1, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=128, out_features=152192, bias=True)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=1024, out_features=1024, bias=True)
        (wk): Linear(in_features=1024, out_features=1024, bias=True)
        (wv): Linear(in_features=1024, out_features=1024, bias=True)
        (wo): Linear(in_features=1024, out_features=1024, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1024, out_features=256, bias=False)
        (w2): Linear(in_features=256, out_features=128, bias=False)
        (w3): Linear(in_features=1024, out_features=256, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1024, bias=False)
      (pre_ln): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0): FSDPResidualAttentionBlock(
            (attention): ViTMultiHeadDotProductAttention(
              (wq): Linear(in_features=1024, out_features=1024, bias=True)
              (wk): Linear(in_features=1024, out_features=1024, bias=True)
              (wv): Linear(in_features=1024, out_features=1024, bias=True)
              (wo): Linear(in_features=1024, out_features=1024, bias=True)
              (residual_dropout): Dropout(p=0.0, inplace=False)
            )
            (feed_forward): ViTMLP(
              (w1): Linear(in_features=1024, out_features=4096, bias=True)
              (act): GELUActivation()
              (w2): Linear(in_features=4096, out_features=1024, bias=True)
            )
            (attention_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (ffn_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=700, out_features=128, bias=False)
  (vision_decoder_head): Linear(in_features=128, out_features=700, bias=False)
)
2025-07-15 15:51:11.340	g3084:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-15 15:51:11.340	g3084:0	olmo.data.data_loader:197	INFO	Loading train dataset chart_qa/train
2025-07-15 15:51:11.341	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_human.json
2025-07-15 15:51:11.394	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_augmented.json
2025-07-15 15:51:11.524	g3084:0	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-15 15:51:11.525	g3084:0	olmo.data.data_loader:219	INFO	chart_qa: 100.00
2025-07-15 15:51:11.526	g3084:0	olmo.models.molmo.molmo:119	INFO	Building collator, pad=to_max seq_len=2304 images=1 pooled_patches_idx=158
2025-07-15 15:51:11.527	g3084:0	olmo.data.data_loader:100	INFO	Loading eval dataset: chart_qa/validation
2025-07-15 15:51:11.527	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_human.json
2025-07-15 15:51:11.551	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_augmented.json
2025-07-15 15:51:11.579	g3084:0	olmo.models.molmo.molmo:119	INFO	Building collator, pad=to_max seq_len=1792 images=1 pooled_patches_idx=158
2025-07-15 15:51:11.813	g3084:0	train:332	INFO	Starting training...
2025-07-15 15:51:11.814	g3084:0	olmo.train.trainer:817	INFO	Pre-train system metrics
    System/Peak GPU Memory (MB)=370.5
2025-07-15 15:51:16.417	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 15:51:20.664	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 15:51:21.260	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 15:51:21.679	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 15:51:22.093	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 15:51:22.514	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 15:51:22.803	g3084:0	olmo.train.trainer:817	INFO	[step=5/1000]
    train/CrossEntropyLoss=11.92
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0318
    train/Accuracy=0.0
    throughput/total_tokens=92,160
    throughput/device/tokens_per_second=47,363
    throughput/device/batches_per_second=2.570
2025-07-15 15:51:22.937	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 15:51:23.367	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 15:51:23.787	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 15:51:24.226	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 15:51:24.649	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 15:51:24.937	g3084:0	olmo.train.trainer:817	INFO	[step=10/1000]
    train/CrossEntropyLoss=11.91
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0305
    train/Accuracy=0.0
    throughput/total_tokens=184,320
    throughput/device/tokens_per_second=44,952
    throughput/device/batches_per_second=2.439
    System/Peak GPU Memory (MB)=29,214
2025-07-15 15:51:25.082	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 15:51:25.525	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 15:51:25.938	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 15:51:26.341	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 15:51:26.756	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 15:51:27.045	g3084:0	olmo.train.trainer:817	INFO	[step=15/1000]
    train/CrossEntropyLoss=11.90
    train/ZLoss=0.0143
    train/ImageGenLoss=0.7157
    train/Accuracy=0.0
    throughput/total_tokens=276,480
    throughput/device/tokens_per_second=44,499
    throughput/device/batches_per_second=2.414
2025-07-15 15:51:27.183	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 15:51:27.611	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 15:51:28.018	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 15:51:28.440	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 15:51:28.868	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 15:51:29.160	g3084:0	olmo.train.trainer:817	INFO	[step=20/1000]
    train/CrossEntropyLoss=11.84
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=368,640
    throughput/device/tokens_per_second=44,256
    throughput/device/batches_per_second=2.401
    System/Peak GPU Memory (MB)=29,214
2025-07-15 15:51:29.162	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 15:52:46.097	g3084:0	olmo.util:177	CRITICAL	Uncaught BdbQuit: 
Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/Umolmo/launch_scripts/train_multitask_model.py", line 396, in <module>
    run_trainer(cfg)
  File "/gscratch/krishna/mahtab/Umolmo/scripts/train.py", line 333, in run_trainer
    trainer.fit()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 1146, in fit
    eval_metrics = self.inference_eval()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 865, in inference_eval
    dataset_metrics = evaluator.run(
  File "/gscratch/krishna/mahtab/Umolmo/olmo/eval/inf_evaluator.py", line 213, in run
    olmo_gen_output = model.generate(
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py", line 749, in generate
    return OLMoGenerateOutput(
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py", line 749, in generate
    return OLMoGenerateOutput(
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/bdb.py", line 90, in trace_dispatch
    return self.dispatch_line(frame)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/bdb.py", line 115, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit
2025-07-15 15:59:59.227	g3084:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-15 15:59:59.329	g3084:0	train:54	INFO	Configuration:
2025-07-15 15:59:59.329	g3084:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=128, n_heads=2, n_kv_heads=None, head_dim=None, qkv_bias=False, clip_qkv=None, n_layers=1, mlp_ratio=4, mlp_hidden_size=None, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=10000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='default', layer_norm_with_affine=True, layer_norm_eps=None, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=True, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.1, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=None, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2-7B', tokenizer_dir=None), init_path=None, init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='openai', image_default_input_size=(336, 336), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1024, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=1, image_head_dim=64, image_mlp_dim=4096, image_mlp_activations='gelu', image_dropout_rate=0.0, image_num_pos=577, image_norm_eps=1e-05, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path=None, resize_mode='default', pad_value=0.0, normalize='openai'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-1,), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='resize', max_crops=1, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear'), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'chart_qa': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=20, inf_evaluators=[InfDatasetEvaluatorConfig(label='chart_qa', data=DataLoaderConfig(dataset='chart_qa', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='relaxed_correctness,scifi_relaxed_correctness,em', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=16, console_log_interval=5, include_image=False)], inf_eval_interval=20, eval_on_last_step=True, eval_on_load=False, save_folder='debug_run', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint=None, allow_resume=True, max_duration=1000, global_train_batch_size=8, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=None, beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=5, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=1000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-15 15:59:59.361	g3084:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-15 16:00:01.679	g3084:0	root:123	INFO	Padding tokenizer with 416 tokens
2025-07-15 16:00:03.815	g3084:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-15 16:00:03.965	g3084:0	train:191	INFO	Total number of parameters: 58,006,016
2025-07-15 16:00:03.966	g3084:0	train:192	INFO	Number of non-embedding parameters: 38,525,440
2025-07-15 16:00:03.967	g3084:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 234
2025-07-15 16:00:03.967	g3084:0	train:196	INFO	Model:
2025-07-15 16:00:03.967	g3084:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0): FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=128, out_features=128, bias=True)
          (ff_out): Linear(in_features=256, out_features=128, bias=True)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): LayerNorm()
          (ff_norm): LayerNorm()
          (att_proj): Linear(in_features=128, out_features=384, bias=True)
          (ff_proj): Linear(in_features=128, out_features=512, bias=True)
        )
      )
    )
    (ln_f): FSDPLayerNorm()
    (emb_drop): Dropout(p=0.1, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=128, out_features=152192, bias=True)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=1024, out_features=1024, bias=True)
        (wk): Linear(in_features=1024, out_features=1024, bias=True)
        (wv): Linear(in_features=1024, out_features=1024, bias=True)
        (wo): Linear(in_features=1024, out_features=1024, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1024, out_features=256, bias=False)
        (w2): Linear(in_features=256, out_features=128, bias=False)
        (w3): Linear(in_features=1024, out_features=256, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1024, bias=False)
      (pre_ln): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0): FSDPResidualAttentionBlock(
            (attention): ViTMultiHeadDotProductAttention(
              (wq): Linear(in_features=1024, out_features=1024, bias=True)
              (wk): Linear(in_features=1024, out_features=1024, bias=True)
              (wv): Linear(in_features=1024, out_features=1024, bias=True)
              (wo): Linear(in_features=1024, out_features=1024, bias=True)
              (residual_dropout): Dropout(p=0.0, inplace=False)
            )
            (feed_forward): ViTMLP(
              (w1): Linear(in_features=1024, out_features=4096, bias=True)
              (act): GELUActivation()
              (w2): Linear(in_features=4096, out_features=1024, bias=True)
            )
            (attention_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (ffn_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=700, out_features=128, bias=False)
  (vision_decoder_head): Linear(in_features=128, out_features=700, bias=False)
)
2025-07-15 16:00:03.978	g3084:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-15 16:00:03.979	g3084:0	olmo.data.data_loader:197	INFO	Loading train dataset chart_qa/train
2025-07-15 16:00:03.979	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_human.json
2025-07-15 16:00:04.057	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_augmented.json
2025-07-15 16:00:04.224	g3084:0	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-15 16:00:04.224	g3084:0	olmo.data.data_loader:219	INFO	chart_qa: 100.00
2025-07-15 16:00:04.226	g3084:0	olmo.models.molmo.molmo:119	INFO	Building collator, pad=to_max seq_len=2304 images=1 pooled_patches_idx=158
2025-07-15 16:00:04.227	g3084:0	olmo.data.data_loader:100	INFO	Loading eval dataset: chart_qa/validation
2025-07-15 16:00:04.227	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_human.json
2025-07-15 16:00:04.234	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_augmented.json
2025-07-15 16:00:04.257	g3084:0	olmo.models.molmo.molmo:119	INFO	Building collator, pad=to_max seq_len=1792 images=1 pooled_patches_idx=158
2025-07-15 16:00:04.498	g3084:0	train:332	INFO	Starting training...
2025-07-15 16:00:04.499	g3084:0	olmo.train.trainer:817	INFO	Pre-train system metrics
    System/Peak GPU Memory (MB)=370.5
2025-07-15 16:00:08.800	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 16:00:13.030	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 16:00:13.620	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 16:00:14.046	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 16:00:14.465	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 16:00:14.876	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 16:00:15.165	g3084:0	olmo.train.trainer:817	INFO	[step=5/1000]
    train/CrossEntropyLoss=11.92
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0318
    train/Accuracy=0.0
    throughput/total_tokens=92,160
    throughput/device/tokens_per_second=47,313
    throughput/device/batches_per_second=2.567
2025-07-15 16:00:15.295	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 16:00:15.722	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 16:00:16.146	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 16:00:16.582	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 16:00:17.010	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 16:00:17.299	g3084:0	olmo.train.trainer:817	INFO	[step=10/1000]
    train/CrossEntropyLoss=11.91
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0305
    train/Accuracy=0.0
    throughput/total_tokens=184,320
    throughput/device/tokens_per_second=44,933
    throughput/device/batches_per_second=2.438
    System/Peak GPU Memory (MB)=29,214
2025-07-15 16:00:17.445	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 16:00:17.871	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 16:00:18.290	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 16:00:18.717	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 16:00:19.137	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 16:00:19.427	g3084:0	olmo.train.trainer:817	INFO	[step=15/1000]
    train/CrossEntropyLoss=11.90
    train/ZLoss=0.0143
    train/ImageGenLoss=0.7157
    train/Accuracy=0.0
    throughput/total_tokens=276,480
    throughput/device/tokens_per_second=44,338
    throughput/device/batches_per_second=2.406
2025-07-15 16:00:19.566	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 16:00:19.997	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 16:00:20.408	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 16:00:20.836	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 16:00:21.264	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 16:00:21.554	g3084:0	olmo.train.trainer:817	INFO	[step=20/1000]
    train/CrossEntropyLoss=11.83
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=368,640
    throughput/device/tokens_per_second=44,070
    throughput/device/batches_per_second=2.391
    System/Peak GPU Memory (MB)=29,214
2025-07-15 16:00:21.555	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 16:42:46.258	g3084:0	olmo.util:177	CRITICAL	Uncaught BdbQuit: 
Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/Umolmo/launch_scripts/train_multitask_model.py", line 396, in <module>
    run_trainer(cfg)
  File "/gscratch/krishna/mahtab/Umolmo/scripts/train.py", line 333, in run_trainer
    trainer.fit()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 1146, in fit
    eval_metrics = self.inference_eval()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 865, in inference_eval
    dataset_metrics = evaluator.run(
  File "/gscratch/krishna/mahtab/Umolmo/olmo/eval/inf_evaluator.py", line 213, in run
    olmo_gen_output = model.generate(
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py", line 748, in generate
    token_ids, scores = beam_search.search(initial_preds, state, step)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/nn/beam_search.py", line 801, in search
    step_signature = signature(step)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/inspect.py", line 3254, in signature
    return Signature.from_callable(obj, follow_wrapped=follow_wrapped,
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/inspect.py", line 3254, in signature
    return Signature.from_callable(obj, follow_wrapped=follow_wrapped,
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/bdb.py", line 90, in trace_dispatch
    return self.dispatch_line(frame)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/bdb.py", line 115, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit
2025-07-15 16:54:03.814	g3084:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-15 16:54:03.936	g3084:0	train:54	INFO	Configuration:
2025-07-15 16:54:03.936	g3084:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=128, n_heads=2, n_kv_heads=None, head_dim=None, qkv_bias=False, clip_qkv=None, n_layers=1, mlp_ratio=4, mlp_hidden_size=None, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=10000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='default', layer_norm_with_affine=True, layer_norm_eps=None, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=True, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.1, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=None, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2-7B', tokenizer_dir=None), init_path=None, init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='openai', image_default_input_size=(336, 336), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1024, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=1, image_head_dim=64, image_mlp_dim=4096, image_mlp_activations='gelu', image_dropout_rate=0.0, image_num_pos=577, image_norm_eps=1e-05, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path=None, resize_mode='default', pad_value=0.0, normalize='openai'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-1,), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='resize', max_crops=1, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear'), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'chart_qa': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=20, inf_evaluators=[InfDatasetEvaluatorConfig(label='chart_qa', data=DataLoaderConfig(dataset='chart_qa', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='relaxed_correctness,scifi_relaxed_correctness,em', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=16, console_log_interval=5, include_image=False)], inf_eval_interval=20, eval_on_last_step=True, eval_on_load=False, save_folder='debug_run', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint=None, allow_resume=True, max_duration=1000, global_train_batch_size=8, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=None, beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=5, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=1000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-15 16:54:03.968	g3084:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-15 16:54:06.188	g3084:0	root:123	INFO	Padding tokenizer with 416 tokens
2025-07-15 16:54:08.293	g3084:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-15 16:54:08.471	g3084:0	train:191	INFO	Total number of parameters: 58,006,016
2025-07-15 16:54:08.472	g3084:0	train:192	INFO	Number of non-embedding parameters: 38,525,440
2025-07-15 16:54:08.473	g3084:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 234
2025-07-15 16:54:08.473	g3084:0	train:196	INFO	Model:
2025-07-15 16:54:08.473	g3084:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0): FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=128, out_features=128, bias=True)
          (ff_out): Linear(in_features=256, out_features=128, bias=True)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): LayerNorm()
          (ff_norm): LayerNorm()
          (att_proj): Linear(in_features=128, out_features=384, bias=True)
          (ff_proj): Linear(in_features=128, out_features=512, bias=True)
        )
      )
    )
    (ln_f): FSDPLayerNorm()
    (emb_drop): Dropout(p=0.1, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=128, out_features=152192, bias=True)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=1024, out_features=1024, bias=True)
        (wk): Linear(in_features=1024, out_features=1024, bias=True)
        (wv): Linear(in_features=1024, out_features=1024, bias=True)
        (wo): Linear(in_features=1024, out_features=1024, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1024, out_features=256, bias=False)
        (w2): Linear(in_features=256, out_features=128, bias=False)
        (w3): Linear(in_features=1024, out_features=256, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1024, bias=False)
      (pre_ln): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0): FSDPResidualAttentionBlock(
            (attention): ViTMultiHeadDotProductAttention(
              (wq): Linear(in_features=1024, out_features=1024, bias=True)
              (wk): Linear(in_features=1024, out_features=1024, bias=True)
              (wv): Linear(in_features=1024, out_features=1024, bias=True)
              (wo): Linear(in_features=1024, out_features=1024, bias=True)
              (residual_dropout): Dropout(p=0.0, inplace=False)
            )
            (feed_forward): ViTMLP(
              (w1): Linear(in_features=1024, out_features=4096, bias=True)
              (act): GELUActivation()
              (w2): Linear(in_features=4096, out_features=1024, bias=True)
            )
            (attention_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (ffn_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=700, out_features=128, bias=False)
  (vision_decoder_head): Linear(in_features=128, out_features=700, bias=False)
)
2025-07-15 16:54:08.484	g3084:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-15 16:54:08.484	g3084:0	olmo.data.data_loader:197	INFO	Loading train dataset chart_qa/train
2025-07-15 16:54:08.485	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_human.json
2025-07-15 16:54:08.539	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_augmented.json
2025-07-15 16:54:08.677	g3084:0	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-15 16:54:08.677	g3084:0	olmo.data.data_loader:219	INFO	chart_qa: 100.00
2025-07-15 16:54:08.679	g3084:0	olmo.models.molmo.molmo:119	INFO	Building collator, pad=to_max seq_len=2304 images=1 pooled_patches_idx=158
2025-07-15 16:54:08.680	g3084:0	olmo.data.data_loader:100	INFO	Loading eval dataset: chart_qa/validation
2025-07-15 16:54:08.680	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_human.json
2025-07-15 16:54:08.701	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_augmented.json
2025-07-15 16:54:08.724	g3084:0	olmo.models.molmo.molmo:119	INFO	Building collator, pad=to_max seq_len=1792 images=1 pooled_patches_idx=158
2025-07-15 16:54:08.959	g3084:0	train:332	INFO	Starting training...
2025-07-15 16:54:08.960	g3084:0	olmo.train.trainer:817	INFO	Pre-train system metrics
    System/Peak GPU Memory (MB)=370.5
2025-07-15 16:54:13.912	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 16:54:18.116	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 16:54:18.704	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 16:54:19.120	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 16:54:19.541	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 16:54:19.957	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 16:54:20.247	g3084:0	olmo.train.trainer:817	INFO	[step=5/1000]
    train/CrossEntropyLoss=11.92
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0318
    train/Accuracy=0.0
    throughput/total_tokens=92,160
    throughput/device/tokens_per_second=47,353
    throughput/device/batches_per_second=2.569
2025-07-15 16:54:20.376	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 16:54:20.801	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 16:54:21.239	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 16:54:21.668	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 16:54:22.088	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 16:54:22.375	g3084:0	olmo.train.trainer:817	INFO	[step=10/1000]
    train/CrossEntropyLoss=11.91
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0305
    train/Accuracy=0.0
    throughput/total_tokens=184,320
    throughput/device/tokens_per_second=45,012
    throughput/device/batches_per_second=2.442
    System/Peak GPU Memory (MB)=29,214
2025-07-15 16:54:22.530	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 16:54:22.946	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 16:54:23.356	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 16:54:23.840	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 16:54:24.262	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 16:54:24.551	g3084:0	olmo.train.trainer:817	INFO	[step=15/1000]
    train/CrossEntropyLoss=11.90
    train/ZLoss=0.0143
    train/ImageGenLoss=0.7157
    train/Accuracy=0.0
    throughput/total_tokens=276,480
    throughput/device/tokens_per_second=44,029
    throughput/device/batches_per_second=2.389
2025-07-15 16:54:24.713	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 16:54:25.138	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 16:54:25.543	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 16:54:25.980	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 16:54:26.406	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 16:54:26.693	g3084:0	olmo.train.trainer:817	INFO	[step=20/1000]
    train/CrossEntropyLoss=11.83
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=368,640
    throughput/device/tokens_per_second=43,760
    throughput/device/batches_per_second=2.374
    System/Peak GPU Memory (MB)=29,214
2025-07-15 16:54:26.695	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 16:57:07.864	g3084:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-15 16:57:07.935	g3084:0	train:54	INFO	Configuration:
2025-07-15 16:57:07.935	g3084:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=128, n_heads=2, n_kv_heads=None, head_dim=None, qkv_bias=False, clip_qkv=None, n_layers=1, mlp_ratio=4, mlp_hidden_size=None, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=10000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='default', layer_norm_with_affine=True, layer_norm_eps=None, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=True, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.1, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=None, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2-7B', tokenizer_dir=None), init_path=None, init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='openai', image_default_input_size=(336, 336), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1024, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=1, image_head_dim=64, image_mlp_dim=4096, image_mlp_activations='gelu', image_dropout_rate=0.0, image_num_pos=577, image_norm_eps=1e-05, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path=None, resize_mode='default', pad_value=0.0, normalize='openai'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-1,), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='resize', max_crops=1, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear'), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'chart_qa': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=20, inf_evaluators=[InfDatasetEvaluatorConfig(label='chart_qa', data=DataLoaderConfig(dataset='chart_qa', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='relaxed_correctness,scifi_relaxed_correctness,em', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=16, console_log_interval=5, include_image=False)], inf_eval_interval=20, eval_on_last_step=True, eval_on_load=False, save_folder='debug_run', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint=None, allow_resume=True, max_duration=1000, global_train_batch_size=8, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=None, beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=5, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=1000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-15 16:57:07.965	g3084:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-15 16:57:09.990	g3084:0	root:123	INFO	Padding tokenizer with 416 tokens
2025-07-15 16:57:11.868	g3084:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-15 16:57:12.010	g3084:0	train:191	INFO	Total number of parameters: 58,006,016
2025-07-15 16:57:12.011	g3084:0	train:192	INFO	Number of non-embedding parameters: 38,525,440
2025-07-15 16:57:12.012	g3084:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 234
2025-07-15 16:57:12.012	g3084:0	train:196	INFO	Model:
2025-07-15 16:57:12.012	g3084:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0): FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=128, out_features=128, bias=True)
          (ff_out): Linear(in_features=256, out_features=128, bias=True)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): LayerNorm()
          (ff_norm): LayerNorm()
          (att_proj): Linear(in_features=128, out_features=384, bias=True)
          (ff_proj): Linear(in_features=128, out_features=512, bias=True)
        )
      )
    )
    (ln_f): FSDPLayerNorm()
    (emb_drop): Dropout(p=0.1, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=128, out_features=152192, bias=True)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=1024, out_features=1024, bias=True)
        (wk): Linear(in_features=1024, out_features=1024, bias=True)
        (wv): Linear(in_features=1024, out_features=1024, bias=True)
        (wo): Linear(in_features=1024, out_features=1024, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1024, out_features=256, bias=False)
        (w2): Linear(in_features=256, out_features=128, bias=False)
        (w3): Linear(in_features=1024, out_features=256, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1024, bias=False)
      (pre_ln): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0): FSDPResidualAttentionBlock(
            (attention): ViTMultiHeadDotProductAttention(
              (wq): Linear(in_features=1024, out_features=1024, bias=True)
              (wk): Linear(in_features=1024, out_features=1024, bias=True)
              (wv): Linear(in_features=1024, out_features=1024, bias=True)
              (wo): Linear(in_features=1024, out_features=1024, bias=True)
              (residual_dropout): Dropout(p=0.0, inplace=False)
            )
            (feed_forward): ViTMLP(
              (w1): Linear(in_features=1024, out_features=4096, bias=True)
              (act): GELUActivation()
              (w2): Linear(in_features=4096, out_features=1024, bias=True)
            )
            (attention_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (ffn_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=700, out_features=128, bias=False)
  (vision_decoder_head): Linear(in_features=128, out_features=700, bias=False)
)
2025-07-15 16:57:12.022	g3084:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-15 16:57:12.022	g3084:0	olmo.data.data_loader:197	INFO	Loading train dataset chart_qa/train
2025-07-15 16:57:12.023	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_human.json
2025-07-15 16:57:12.056	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_augmented.json
2025-07-15 16:57:12.155	g3084:0	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-15 16:57:12.156	g3084:0	olmo.data.data_loader:219	INFO	chart_qa: 100.00
2025-07-15 16:57:12.157	g3084:0	olmo.models.molmo.molmo:119	INFO	Building collator, pad=to_max seq_len=2304 images=1 pooled_patches_idx=158
2025-07-15 16:57:12.158	g3084:0	olmo.data.data_loader:100	INFO	Loading eval dataset: chart_qa/validation
2025-07-15 16:57:12.158	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_human.json
2025-07-15 16:57:12.164	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_augmented.json
2025-07-15 16:57:12.168	g3084:0	olmo.models.molmo.molmo:119	INFO	Building collator, pad=to_max seq_len=1792 images=1 pooled_patches_idx=158
2025-07-15 16:57:12.395	g3084:0	train:332	INFO	Starting training...
2025-07-15 16:57:12.396	g3084:0	olmo.train.trainer:817	INFO	Pre-train system metrics
    System/Peak GPU Memory (MB)=370.5
2025-07-15 16:57:15.671	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 16:57:19.702	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 16:57:20.249	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 16:57:20.640	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 16:57:21.030	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 16:57:21.415	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 16:57:21.696	g3084:0	olmo.train.trainer:817	INFO	[step=5/1000]
    train/CrossEntropyLoss=11.92
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0318
    train/Accuracy=0.0
    throughput/total_tokens=92,160
    throughput/device/tokens_per_second=50,482
    throughput/device/batches_per_second=2.739
2025-07-15 16:57:21.807	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 16:57:22.211	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 16:57:22.618	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 16:57:23.026	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 16:57:23.427	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 16:57:23.706	g3084:0	olmo.train.trainer:817	INFO	[step=10/1000]
    train/CrossEntropyLoss=11.91
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0305
    train/Accuracy=0.0
    throughput/total_tokens=184,320
    throughput/device/tokens_per_second=47,807
    throughput/device/batches_per_second=2.594
    System/Peak GPU Memory (MB)=29,214
2025-07-15 16:57:23.832	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 16:57:24.234	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 16:57:24.624	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 16:57:25.007	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 16:57:25.403	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 16:57:25.683	g3084:0	olmo.train.trainer:817	INFO	[step=15/1000]
    train/CrossEntropyLoss=11.90
    train/ZLoss=0.0143
    train/ImageGenLoss=0.7157
    train/Accuracy=0.0
    throughput/total_tokens=276,480
    throughput/device/tokens_per_second=47,369
    throughput/device/batches_per_second=2.570
2025-07-15 16:57:25.806	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 16:57:26.233	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 16:57:26.621	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 16:57:27.028	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 16:57:27.431	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 16:57:27.712	g3084:0	olmo.train.trainer:817	INFO	[step=20/1000]
    train/CrossEntropyLoss=11.84
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=368,640
    throughput/device/tokens_per_second=46,844
    throughput/device/batches_per_second=2.541
    System/Peak GPU Memory (MB)=29,214
2025-07-15 16:57:27.713	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 17:08:56.775	g3084:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-15 17:08:56.848	g3084:0	train:54	INFO	Configuration:
2025-07-15 17:08:56.848	g3084:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=128, n_heads=2, n_kv_heads=None, head_dim=None, qkv_bias=False, clip_qkv=None, n_layers=1, mlp_ratio=4, mlp_hidden_size=None, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=10000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='default', layer_norm_with_affine=True, layer_norm_eps=None, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=True, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.1, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=None, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2-7B', tokenizer_dir=None), init_path=None, init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='openai', image_default_input_size=(336, 336), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1024, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=1, image_head_dim=64, image_mlp_dim=4096, image_mlp_activations='gelu', image_dropout_rate=0.0, image_num_pos=577, image_norm_eps=1e-05, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path=None, resize_mode='default', pad_value=0.0, normalize='openai'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-1,), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='resize', max_crops=1, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear'), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'chart_qa': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=20, inf_evaluators=[InfDatasetEvaluatorConfig(label='chart_qa', data=DataLoaderConfig(dataset='chart_qa', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='relaxed_correctness,scifi_relaxed_correctness,em', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=16, console_log_interval=5, include_image=False)], inf_eval_interval=20, eval_on_last_step=True, eval_on_load=False, save_folder='debug_run', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint=None, allow_resume=True, max_duration=1000, global_train_batch_size=8, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=None, beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=5, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=1000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-15 17:08:56.879	g3084:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-15 17:08:59.045	g3084:0	root:123	INFO	Padding tokenizer with 416 tokens
2025-07-15 17:09:01.037	g3084:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-15 17:09:01.186	g3084:0	train:191	INFO	Total number of parameters: 58,006,016
2025-07-15 17:09:01.187	g3084:0	train:192	INFO	Number of non-embedding parameters: 38,525,440
2025-07-15 17:09:01.188	g3084:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 234
2025-07-15 17:09:01.188	g3084:0	train:196	INFO	Model:
2025-07-15 17:09:01.188	g3084:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0): FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=128, out_features=128, bias=True)
          (ff_out): Linear(in_features=256, out_features=128, bias=True)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): LayerNorm()
          (ff_norm): LayerNorm()
          (att_proj): Linear(in_features=128, out_features=384, bias=True)
          (ff_proj): Linear(in_features=128, out_features=512, bias=True)
        )
      )
    )
    (ln_f): FSDPLayerNorm()
    (emb_drop): Dropout(p=0.1, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=128, out_features=152192, bias=True)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=1024, out_features=1024, bias=True)
        (wk): Linear(in_features=1024, out_features=1024, bias=True)
        (wv): Linear(in_features=1024, out_features=1024, bias=True)
        (wo): Linear(in_features=1024, out_features=1024, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1024, out_features=256, bias=False)
        (w2): Linear(in_features=256, out_features=128, bias=False)
        (w3): Linear(in_features=1024, out_features=256, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1024, bias=False)
      (pre_ln): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0): FSDPResidualAttentionBlock(
            (attention): ViTMultiHeadDotProductAttention(
              (wq): Linear(in_features=1024, out_features=1024, bias=True)
              (wk): Linear(in_features=1024, out_features=1024, bias=True)
              (wv): Linear(in_features=1024, out_features=1024, bias=True)
              (wo): Linear(in_features=1024, out_features=1024, bias=True)
              (residual_dropout): Dropout(p=0.0, inplace=False)
            )
            (feed_forward): ViTMLP(
              (w1): Linear(in_features=1024, out_features=4096, bias=True)
              (act): GELUActivation()
              (w2): Linear(in_features=4096, out_features=1024, bias=True)
            )
            (attention_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (ffn_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=700, out_features=128, bias=False)
  (vision_decoder_head): Linear(in_features=128, out_features=700, bias=False)
)
2025-07-15 17:09:01.198	g3084:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-15 17:09:01.199	g3084:0	olmo.data.data_loader:197	INFO	Loading train dataset chart_qa/train
2025-07-15 17:09:01.199	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_human.json
2025-07-15 17:09:01.234	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_augmented.json
2025-07-15 17:09:01.336	g3084:0	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-15 17:09:01.337	g3084:0	olmo.data.data_loader:219	INFO	chart_qa: 100.00
2025-07-15 17:09:01.338	g3084:0	olmo.models.molmo.molmo:119	INFO	Building collator, pad=to_max seq_len=2304 images=1 pooled_patches_idx=158
2025-07-15 17:09:01.339	g3084:0	olmo.data.data_loader:100	INFO	Loading eval dataset: chart_qa/validation
2025-07-15 17:09:01.339	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_human.json
2025-07-15 17:09:01.346	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_augmented.json
2025-07-15 17:09:01.350	g3084:0	olmo.models.molmo.molmo:119	INFO	Building collator, pad=to_max seq_len=1792 images=1 pooled_patches_idx=158
2025-07-15 17:09:01.593	g3084:0	train:332	INFO	Starting training...
2025-07-15 17:09:01.594	g3084:0	olmo.train.trainer:817	INFO	Pre-train system metrics
    System/Peak GPU Memory (MB)=370.5
2025-07-15 17:09:05.164	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:09:09.303	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:09:09.888	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:09:10.308	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:09:10.723	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:09:11.132	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:09:11.419	g3084:0	olmo.train.trainer:817	INFO	[step=5/1000]
    train/CrossEntropyLoss=11.92
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0318
    train/Accuracy=0.0
    throughput/total_tokens=92,160
    throughput/device/tokens_per_second=47,728
    throughput/device/batches_per_second=2.589
2025-07-15 17:09:11.546	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:09:11.968	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:09:12.379	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:09:12.801	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:09:13.209	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:09:13.494	g3084:0	olmo.train.trainer:817	INFO	[step=10/1000]
    train/CrossEntropyLoss=11.91
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0305
    train/Accuracy=0.0
    throughput/total_tokens=184,320
    throughput/device/tokens_per_second=45,839
    throughput/device/batches_per_second=2.487
    System/Peak GPU Memory (MB)=29,214
2025-07-15 17:09:13.632	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:09:14.046	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:09:14.456	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:09:14.856	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:09:15.271	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:09:15.560	g3084:0	olmo.train.trainer:817	INFO	[step=15/1000]
    train/CrossEntropyLoss=11.90
    train/ZLoss=0.0143
    train/ImageGenLoss=0.7157
    train/Accuracy=0.0
    throughput/total_tokens=276,480
    throughput/device/tokens_per_second=45,390
    throughput/device/batches_per_second=2.463
2025-07-15 17:09:15.693	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:09:16.118	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:09:16.526	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:09:16.953	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:09:17.375	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:09:17.661	g3084:0	olmo.train.trainer:817	INFO	[step=20/1000]
    train/CrossEntropyLoss=11.83
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=368,640
    throughput/device/tokens_per_second=44,979
    throughput/device/batches_per_second=2.440
    System/Peak GPU Memory (MB)=29,214
2025-07-15 17:09:17.663	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 17:29:45.690	g3084:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-15 17:29:45.761	g3084:0	train:54	INFO	Configuration:
2025-07-15 17:29:45.761	g3084:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=128, n_heads=2, n_kv_heads=None, head_dim=None, qkv_bias=False, clip_qkv=None, n_layers=1, mlp_ratio=4, mlp_hidden_size=None, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=10000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='default', layer_norm_with_affine=True, layer_norm_eps=None, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=True, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.1, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=None, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2-7B', tokenizer_dir=None), init_path=None, init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='openai', image_default_input_size=(336, 336), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1024, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=1, image_head_dim=64, image_mlp_dim=4096, image_mlp_activations='gelu', image_dropout_rate=0.0, image_num_pos=577, image_norm_eps=1e-05, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path=None, resize_mode='default', pad_value=0.0, normalize='openai'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-1,), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='resize', max_crops=1, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear'), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'chart_qa': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=20, inf_evaluators=[InfDatasetEvaluatorConfig(label='chart_qa', data=DataLoaderConfig(dataset='chart_qa', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='relaxed_correctness,scifi_relaxed_correctness,em', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=16, console_log_interval=5, include_image=False)], inf_eval_interval=20, eval_on_last_step=True, eval_on_load=False, save_folder='debug_run', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint=None, allow_resume=True, max_duration=1000, global_train_batch_size=8, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=None, beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=5, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=1000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-15 17:29:45.791	g3084:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-15 17:29:52.950	g3084:0	root:123	INFO	Padding tokenizer with 416 tokens
2025-07-15 17:29:54.893	g3084:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-15 17:29:55.041	g3084:0	train:191	INFO	Total number of parameters: 58,006,016
2025-07-15 17:29:55.041	g3084:0	train:192	INFO	Number of non-embedding parameters: 38,525,440
2025-07-15 17:29:55.042	g3084:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 234
2025-07-15 17:29:55.043	g3084:0	train:196	INFO	Model:
2025-07-15 17:29:55.043	g3084:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0): FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=128, out_features=128, bias=True)
          (ff_out): Linear(in_features=256, out_features=128, bias=True)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): LayerNorm()
          (ff_norm): LayerNorm()
          (att_proj): Linear(in_features=128, out_features=384, bias=True)
          (ff_proj): Linear(in_features=128, out_features=512, bias=True)
        )
      )
    )
    (ln_f): FSDPLayerNorm()
    (emb_drop): Dropout(p=0.1, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=128, out_features=152192, bias=True)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=1024, out_features=1024, bias=True)
        (wk): Linear(in_features=1024, out_features=1024, bias=True)
        (wv): Linear(in_features=1024, out_features=1024, bias=True)
        (wo): Linear(in_features=1024, out_features=1024, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1024, out_features=256, bias=False)
        (w2): Linear(in_features=256, out_features=128, bias=False)
        (w3): Linear(in_features=1024, out_features=256, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1024, bias=False)
      (pre_ln): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0): FSDPResidualAttentionBlock(
            (attention): ViTMultiHeadDotProductAttention(
              (wq): Linear(in_features=1024, out_features=1024, bias=True)
              (wk): Linear(in_features=1024, out_features=1024, bias=True)
              (wv): Linear(in_features=1024, out_features=1024, bias=True)
              (wo): Linear(in_features=1024, out_features=1024, bias=True)
              (residual_dropout): Dropout(p=0.0, inplace=False)
            )
            (feed_forward): ViTMLP(
              (w1): Linear(in_features=1024, out_features=4096, bias=True)
              (act): GELUActivation()
              (w2): Linear(in_features=4096, out_features=1024, bias=True)
            )
            (attention_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (ffn_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=700, out_features=128, bias=False)
  (vision_decoder_head): Linear(in_features=128, out_features=700, bias=False)
)
2025-07-15 17:29:55.052	g3084:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-15 17:29:55.053	g3084:0	olmo.data.data_loader:197	INFO	Loading train dataset chart_qa/train
2025-07-15 17:29:55.053	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_human.json
2025-07-15 17:29:55.088	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_augmented.json
2025-07-15 17:29:55.188	g3084:0	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-15 17:29:55.189	g3084:0	olmo.data.data_loader:219	INFO	chart_qa: 100.00
2025-07-15 17:29:55.191	g3084:0	olmo.models.molmo.molmo:119	INFO	Building collator, pad=to_max seq_len=2304 images=1 pooled_patches_idx=158
2025-07-15 17:29:55.191	g3084:0	olmo.data.data_loader:100	INFO	Loading eval dataset: chart_qa/validation
2025-07-15 17:29:55.192	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_human.json
2025-07-15 17:29:55.198	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_augmented.json
2025-07-15 17:29:55.202	g3084:0	olmo.models.molmo.molmo:119	INFO	Building collator, pad=to_max seq_len=1792 images=1 pooled_patches_idx=158
2025-07-15 17:29:55.437	g3084:0	train:332	INFO	Starting training...
2025-07-15 17:29:55.438	g3084:0	olmo.train.trainer:817	INFO	Pre-train system metrics
    System/Peak GPU Memory (MB)=370.5
2025-07-15 17:29:58.798	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:30:02.948	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:30:03.520	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:30:03.924	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:30:04.369	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:30:04.769	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:30:05.052	g3084:0	olmo.train.trainer:817	INFO	[step=5/1000]
    train/CrossEntropyLoss=11.92
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0318
    train/Accuracy=0.0
    throughput/total_tokens=92,160
    throughput/device/tokens_per_second=47,721
    throughput/device/batches_per_second=2.589
2025-07-15 17:30:05.170	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:30:05.580	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:30:05.990	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:30:06.417	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:30:06.832	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:30:07.120	g3084:0	olmo.train.trainer:817	INFO	[step=10/1000]
    train/CrossEntropyLoss=11.91
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0305
    train/Accuracy=0.0
    throughput/total_tokens=184,320
    throughput/device/tokens_per_second=45,924
    throughput/device/batches_per_second=2.492
    System/Peak GPU Memory (MB)=29,214
2025-07-15 17:30:07.257	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:30:07.670	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:30:08.084	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:30:08.484	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:30:08.893	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:30:09.180	g3084:0	olmo.train.trainer:817	INFO	[step=15/1000]
    train/CrossEntropyLoss=11.90
    train/ZLoss=0.0143
    train/ImageGenLoss=0.7157
    train/Accuracy=0.0
    throughput/total_tokens=276,480
    throughput/device/tokens_per_second=45,484
    throughput/device/batches_per_second=2.468
2025-07-15 17:30:09.311	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:30:09.731	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:30:10.130	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:30:10.548	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:30:10.964	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:30:11.249	g3084:0	olmo.train.trainer:817	INFO	[step=20/1000]
    train/CrossEntropyLoss=11.84
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=368,640
    throughput/device/tokens_per_second=45,235
    throughput/device/batches_per_second=2.454
    System/Peak GPU Memory (MB)=29,214
2025-07-15 17:30:11.251	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 17:30:11.800	g3084:0	olmo.util:177	CRITICAL	Uncaught NotImplementedError: 
Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/Umolmo/launch_scripts/train_multitask_model.py", line 396, in <module>
    run_trainer(cfg)
  File "/gscratch/krishna/mahtab/Umolmo/scripts/train.py", line 333, in run_trainer
    trainer.fit()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 1146, in fit
    eval_metrics = self.inference_eval()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 865, in inference_eval
    dataset_metrics = evaluator.run(
  File "/gscratch/krishna/mahtab/Umolmo/olmo/eval/inf_evaluator.py", line 213, in run
    olmo_gen_output = model.generate(
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/model.py", line 140, in generate
    raise NotImplementedError()
NotImplementedError
2025-07-15 17:34:07.999	g3084:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-15 17:34:08.069	g3084:0	train:54	INFO	Configuration:
2025-07-15 17:34:08.070	g3084:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=128, n_heads=2, n_kv_heads=None, head_dim=None, qkv_bias=False, clip_qkv=None, n_layers=1, mlp_ratio=4, mlp_hidden_size=None, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=10000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='default', layer_norm_with_affine=True, layer_norm_eps=None, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=True, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.1, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=None, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2-7B', tokenizer_dir=None), init_path=None, init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='openai', image_default_input_size=(336, 336), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1024, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=1, image_head_dim=64, image_mlp_dim=4096, image_mlp_activations='gelu', image_dropout_rate=0.0, image_num_pos=577, image_norm_eps=1e-05, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path=None, resize_mode='default', pad_value=0.0, normalize='openai'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-1,), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='resize', max_crops=1, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear'), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'chart_qa': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=20, inf_evaluators=[InfDatasetEvaluatorConfig(label='chart_qa', data=DataLoaderConfig(dataset='chart_qa', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='relaxed_correctness,scifi_relaxed_correctness,em', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=16, console_log_interval=5, include_image=False)], inf_eval_interval=20, eval_on_last_step=True, eval_on_load=False, save_folder='debug_run', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint=None, allow_resume=True, max_duration=1000, global_train_batch_size=8, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=None, beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=5, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=1000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-15 17:34:08.099	g3084:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-15 17:34:10.146	g3084:0	root:123	INFO	Padding tokenizer with 416 tokens
2025-07-15 17:34:12.019	g3084:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-15 17:34:12.161	g3084:0	train:191	INFO	Total number of parameters: 58,006,016
2025-07-15 17:34:12.162	g3084:0	train:192	INFO	Number of non-embedding parameters: 38,525,440
2025-07-15 17:34:12.163	g3084:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 234
2025-07-15 17:34:12.163	g3084:0	train:196	INFO	Model:
2025-07-15 17:34:12.163	g3084:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0): FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=128, out_features=128, bias=True)
          (ff_out): Linear(in_features=256, out_features=128, bias=True)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): LayerNorm()
          (ff_norm): LayerNorm()
          (att_proj): Linear(in_features=128, out_features=384, bias=True)
          (ff_proj): Linear(in_features=128, out_features=512, bias=True)
        )
      )
    )
    (ln_f): FSDPLayerNorm()
    (emb_drop): Dropout(p=0.1, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=128, out_features=152192, bias=True)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=1024, out_features=1024, bias=True)
        (wk): Linear(in_features=1024, out_features=1024, bias=True)
        (wv): Linear(in_features=1024, out_features=1024, bias=True)
        (wo): Linear(in_features=1024, out_features=1024, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1024, out_features=256, bias=False)
        (w2): Linear(in_features=256, out_features=128, bias=False)
        (w3): Linear(in_features=1024, out_features=256, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1024, bias=False)
      (pre_ln): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0): FSDPResidualAttentionBlock(
            (attention): ViTMultiHeadDotProductAttention(
              (wq): Linear(in_features=1024, out_features=1024, bias=True)
              (wk): Linear(in_features=1024, out_features=1024, bias=True)
              (wv): Linear(in_features=1024, out_features=1024, bias=True)
              (wo): Linear(in_features=1024, out_features=1024, bias=True)
              (residual_dropout): Dropout(p=0.0, inplace=False)
            )
            (feed_forward): ViTMLP(
              (w1): Linear(in_features=1024, out_features=4096, bias=True)
              (act): GELUActivation()
              (w2): Linear(in_features=4096, out_features=1024, bias=True)
            )
            (attention_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (ffn_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=700, out_features=128, bias=False)
  (vision_decoder_head): Linear(in_features=128, out_features=700, bias=False)
)
2025-07-15 17:34:12.173	g3084:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-15 17:34:12.173	g3084:0	olmo.data.data_loader:197	INFO	Loading train dataset chart_qa/train
2025-07-15 17:34:12.174	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_human.json
2025-07-15 17:34:12.207	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_augmented.json
2025-07-15 17:34:12.305	g3084:0	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-15 17:34:12.306	g3084:0	olmo.data.data_loader:219	INFO	chart_qa: 100.00
2025-07-15 17:34:12.307	g3084:0	olmo.models.molmo.molmo:119	INFO	Building collator, pad=to_max seq_len=2304 images=1 pooled_patches_idx=158
2025-07-15 17:34:12.308	g3084:0	olmo.data.data_loader:100	INFO	Loading eval dataset: chart_qa/validation
2025-07-15 17:34:12.308	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_human.json
2025-07-15 17:34:12.314	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_augmented.json
2025-07-15 17:34:12.318	g3084:0	olmo.models.molmo.molmo:119	INFO	Building collator, pad=to_max seq_len=1792 images=1 pooled_patches_idx=158
2025-07-15 17:34:12.549	g3084:0	train:332	INFO	Starting training...
2025-07-15 17:34:12.551	g3084:0	olmo.train.trainer:817	INFO	Pre-train system metrics
    System/Peak GPU Memory (MB)=370.5
2025-07-15 17:34:15.839	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:34:19.993	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:34:20.586	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:34:21.008	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:34:21.427	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:34:21.838	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:34:22.128	g3084:0	olmo.train.trainer:817	INFO	[step=5/1000]
    train/CrossEntropyLoss=11.92
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0318
    train/Accuracy=0.0
    throughput/total_tokens=92,160
    throughput/device/tokens_per_second=47,386
    throughput/device/batches_per_second=2.571
2025-07-15 17:34:22.258	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:34:22.692	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:34:23.117	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:34:23.552	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:34:23.978	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:34:24.269	g3084:0	olmo.train.trainer:817	INFO	[step=10/1000]
    train/CrossEntropyLoss=11.91
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0305
    train/Accuracy=0.0
    throughput/total_tokens=184,320
    throughput/device/tokens_per_second=44,885
    throughput/device/batches_per_second=2.435
    System/Peak GPU Memory (MB)=29,214
2025-07-15 17:34:24.413	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:34:24.836	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:34:25.249	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:34:25.655	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:34:26.068	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:34:26.354	g3084:0	olmo.train.trainer:817	INFO	[step=15/1000]
    train/CrossEntropyLoss=11.90
    train/ZLoss=0.0143
    train/ImageGenLoss=0.7157
    train/Accuracy=0.0
    throughput/total_tokens=276,480
    throughput/device/tokens_per_second=44,630
    throughput/device/batches_per_second=2.421
2025-07-15 17:34:26.485	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:34:26.908	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:34:27.313	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:34:27.734	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:34:28.156	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:34:28.442	g3084:0	olmo.train.trainer:817	INFO	[step=20/1000]
    train/CrossEntropyLoss=11.84
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=368,640
    throughput/device/tokens_per_second=44,502
    throughput/device/batches_per_second=2.414
    System/Peak GPU Memory (MB)=29,214
2025-07-15 17:34:28.444	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 17:34:29.001	g3084:0	olmo.util:177	CRITICAL	Uncaught NotImplementedError: 
Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/Umolmo/launch_scripts/train_multitask_model.py", line 396, in <module>
    run_trainer(cfg)
  File "/gscratch/krishna/mahtab/Umolmo/scripts/train.py", line 333, in run_trainer
    trainer.fit()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 1146, in fit
    eval_metrics = self.inference_eval()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 865, in inference_eval
    dataset_metrics = evaluator.run(
  File "/gscratch/krishna/mahtab/Umolmo/olmo/eval/inf_evaluator.py", line 213, in run
    olmo_gen_output = model.generate(
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/model.py", line 140, in generate
    raise NotImplementedError()
NotImplementedError
2025-07-15 17:38:15.013	g3084:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-15 17:38:15.089	g3084:0	train:54	INFO	Configuration:
2025-07-15 17:38:15.090	g3084:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=128, n_heads=2, n_kv_heads=None, head_dim=None, qkv_bias=False, clip_qkv=None, n_layers=1, mlp_ratio=4, mlp_hidden_size=None, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=10000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='default', layer_norm_with_affine=True, layer_norm_eps=None, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=True, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.1, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=None, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2-7B', tokenizer_dir=None), init_path=None, init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='openai', image_default_input_size=(336, 336), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1024, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=1, image_head_dim=64, image_mlp_dim=4096, image_mlp_activations='gelu', image_dropout_rate=0.0, image_num_pos=577, image_norm_eps=1e-05, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path=None, resize_mode='default', pad_value=0.0, normalize='openai'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-1,), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='resize', max_crops=1, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear'), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'chart_qa': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=20, inf_evaluators=[InfDatasetEvaluatorConfig(label='chart_qa', data=DataLoaderConfig(dataset='chart_qa', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='relaxed_correctness,scifi_relaxed_correctness,em', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=16, console_log_interval=5, include_image=False)], inf_eval_interval=20, eval_on_last_step=True, eval_on_load=False, save_folder='debug_run', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint=None, allow_resume=True, max_duration=1000, global_train_batch_size=8, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=None, beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=5, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=1000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-15 17:38:15.121	g3084:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-15 17:38:17.276	g3084:0	root:123	INFO	Padding tokenizer with 416 tokens
2025-07-15 17:38:19.207	g3084:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-15 17:38:19.355	g3084:0	train:191	INFO	Total number of parameters: 58,006,016
2025-07-15 17:38:19.356	g3084:0	train:192	INFO	Number of non-embedding parameters: 38,525,440
2025-07-15 17:38:19.356	g3084:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 234
2025-07-15 17:38:19.357	g3084:0	train:196	INFO	Model:
2025-07-15 17:38:19.357	g3084:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0): FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=128, out_features=128, bias=True)
          (ff_out): Linear(in_features=256, out_features=128, bias=True)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): LayerNorm()
          (ff_norm): LayerNorm()
          (att_proj): Linear(in_features=128, out_features=384, bias=True)
          (ff_proj): Linear(in_features=128, out_features=512, bias=True)
        )
      )
    )
    (ln_f): FSDPLayerNorm()
    (emb_drop): Dropout(p=0.1, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=128, out_features=152192, bias=True)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=1024, out_features=1024, bias=True)
        (wk): Linear(in_features=1024, out_features=1024, bias=True)
        (wv): Linear(in_features=1024, out_features=1024, bias=True)
        (wo): Linear(in_features=1024, out_features=1024, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1024, out_features=256, bias=False)
        (w2): Linear(in_features=256, out_features=128, bias=False)
        (w3): Linear(in_features=1024, out_features=256, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1024, bias=False)
      (pre_ln): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0): FSDPResidualAttentionBlock(
            (attention): ViTMultiHeadDotProductAttention(
              (wq): Linear(in_features=1024, out_features=1024, bias=True)
              (wk): Linear(in_features=1024, out_features=1024, bias=True)
              (wv): Linear(in_features=1024, out_features=1024, bias=True)
              (wo): Linear(in_features=1024, out_features=1024, bias=True)
              (residual_dropout): Dropout(p=0.0, inplace=False)
            )
            (feed_forward): ViTMLP(
              (w1): Linear(in_features=1024, out_features=4096, bias=True)
              (act): GELUActivation()
              (w2): Linear(in_features=4096, out_features=1024, bias=True)
            )
            (attention_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (ffn_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=700, out_features=128, bias=False)
  (vision_decoder_head): Linear(in_features=128, out_features=700, bias=False)
)
2025-07-15 17:38:19.367	g3084:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-15 17:38:19.367	g3084:0	olmo.data.data_loader:197	INFO	Loading train dataset chart_qa/train
2025-07-15 17:38:19.367	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_human.json
2025-07-15 17:38:19.401	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_augmented.json
2025-07-15 17:38:19.501	g3084:0	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-15 17:38:19.502	g3084:0	olmo.data.data_loader:219	INFO	chart_qa: 100.00
2025-07-15 17:38:19.503	g3084:0	olmo.models.molmo.molmo:119	INFO	Building collator, pad=to_max seq_len=2304 images=1 pooled_patches_idx=158
2025-07-15 17:38:19.504	g3084:0	olmo.data.data_loader:100	INFO	Loading eval dataset: chart_qa/validation
2025-07-15 17:38:19.504	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_human.json
2025-07-15 17:38:19.510	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_augmented.json
2025-07-15 17:38:19.515	g3084:0	olmo.models.molmo.molmo:119	INFO	Building collator, pad=to_max seq_len=1792 images=1 pooled_patches_idx=158
2025-07-15 17:38:19.747	g3084:0	train:332	INFO	Starting training...
2025-07-15 17:38:19.748	g3084:0	olmo.train.trainer:817	INFO	Pre-train system metrics
    System/Peak GPU Memory (MB)=370.5
2025-07-15 17:38:23.099	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:38:27.224	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:38:27.806	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:38:28.221	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:38:28.633	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:38:29.051	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:38:29.338	g3084:0	olmo.train.trainer:817	INFO	[step=5/1000]
    train/CrossEntropyLoss=11.92
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0318
    train/Accuracy=0.0
    throughput/total_tokens=92,160
    throughput/device/tokens_per_second=47,699
    throughput/device/batches_per_second=2.588
2025-07-15 17:38:29.462	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:38:29.901	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:38:30.324	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:38:30.747	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:38:31.162	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:38:31.446	g3084:0	olmo.train.trainer:817	INFO	[step=10/1000]
    train/CrossEntropyLoss=11.91
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0305
    train/Accuracy=0.0
    throughput/total_tokens=184,320
    throughput/device/tokens_per_second=45,416
    throughput/device/batches_per_second=2.464
    System/Peak GPU Memory (MB)=29,214
2025-07-15 17:38:31.583	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:38:31.990	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:38:32.393	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:38:32.787	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:38:33.191	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:38:33.475	g3084:0	olmo.train.trainer:817	INFO	[step=15/1000]
    train/CrossEntropyLoss=11.90
    train/ZLoss=0.0143
    train/ImageGenLoss=0.7157
    train/Accuracy=0.0
    throughput/total_tokens=276,480
    throughput/device/tokens_per_second=45,412
    throughput/device/batches_per_second=2.464
2025-07-15 17:38:33.609	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:38:34.024	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:38:34.426	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:38:34.841	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:38:35.257	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:38:35.542	g3084:0	olmo.train.trainer:817	INFO	[step=20/1000]
    train/CrossEntropyLoss=11.83
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=368,640
    throughput/device/tokens_per_second=45,195
    throughput/device/batches_per_second=2.452
    System/Peak GPU Memory (MB)=29,214
2025-07-15 17:38:35.544	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 17:38:36.087	g3084:0	olmo.util:177	CRITICAL	Uncaught NotImplementedError: 
Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/Umolmo/launch_scripts/train_multitask_model.py", line 396, in <module>
    run_trainer(cfg)
  File "/gscratch/krishna/mahtab/Umolmo/scripts/train.py", line 333, in run_trainer
    trainer.fit()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 1146, in fit
    eval_metrics = self.inference_eval()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 865, in inference_eval
    dataset_metrics = evaluator.run(
  File "/gscratch/krishna/mahtab/Umolmo/olmo/eval/inf_evaluator.py", line 213, in run
    olmo_gen_output = model.generate(
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/model.py", line 151, in generate
    raise NotImplementedError()
NotImplementedError
2025-07-15 17:39:14.159	g3084:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-15 17:39:14.231	g3084:0	train:54	INFO	Configuration:
2025-07-15 17:39:14.231	g3084:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=128, n_heads=2, n_kv_heads=None, head_dim=None, qkv_bias=False, clip_qkv=None, n_layers=1, mlp_ratio=4, mlp_hidden_size=None, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=10000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='default', layer_norm_with_affine=True, layer_norm_eps=None, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=True, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.1, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=None, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2-7B', tokenizer_dir=None), init_path=None, init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='openai', image_default_input_size=(336, 336), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1024, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=1, image_head_dim=64, image_mlp_dim=4096, image_mlp_activations='gelu', image_dropout_rate=0.0, image_num_pos=577, image_norm_eps=1e-05, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path=None, resize_mode='default', pad_value=0.0, normalize='openai'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-1,), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='resize', max_crops=1, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear'), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'chart_qa': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=20, inf_evaluators=[InfDatasetEvaluatorConfig(label='chart_qa', data=DataLoaderConfig(dataset='chart_qa', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='relaxed_correctness,scifi_relaxed_correctness,em', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=16, console_log_interval=5, include_image=False)], inf_eval_interval=20, eval_on_last_step=True, eval_on_load=False, save_folder='debug_run', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint=None, allow_resume=True, max_duration=1000, global_train_batch_size=8, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=None, beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=5, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=1000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-15 17:39:14.261	g3084:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-15 17:39:16.359	g3084:0	root:123	INFO	Padding tokenizer with 416 tokens
2025-07-15 17:39:18.291	g3084:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-15 17:39:18.436	g3084:0	train:191	INFO	Total number of parameters: 58,006,016
2025-07-15 17:39:18.437	g3084:0	train:192	INFO	Number of non-embedding parameters: 38,525,440
2025-07-15 17:39:18.438	g3084:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 234
2025-07-15 17:39:18.438	g3084:0	train:196	INFO	Model:
2025-07-15 17:39:18.438	g3084:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0): FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=128, out_features=128, bias=True)
          (ff_out): Linear(in_features=256, out_features=128, bias=True)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): LayerNorm()
          (ff_norm): LayerNorm()
          (att_proj): Linear(in_features=128, out_features=384, bias=True)
          (ff_proj): Linear(in_features=128, out_features=512, bias=True)
        )
      )
    )
    (ln_f): FSDPLayerNorm()
    (emb_drop): Dropout(p=0.1, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=128, out_features=152192, bias=True)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=1024, out_features=1024, bias=True)
        (wk): Linear(in_features=1024, out_features=1024, bias=True)
        (wv): Linear(in_features=1024, out_features=1024, bias=True)
        (wo): Linear(in_features=1024, out_features=1024, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1024, out_features=256, bias=False)
        (w2): Linear(in_features=256, out_features=128, bias=False)
        (w3): Linear(in_features=1024, out_features=256, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1024, bias=False)
      (pre_ln): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0): FSDPResidualAttentionBlock(
            (attention): ViTMultiHeadDotProductAttention(
              (wq): Linear(in_features=1024, out_features=1024, bias=True)
              (wk): Linear(in_features=1024, out_features=1024, bias=True)
              (wv): Linear(in_features=1024, out_features=1024, bias=True)
              (wo): Linear(in_features=1024, out_features=1024, bias=True)
              (residual_dropout): Dropout(p=0.0, inplace=False)
            )
            (feed_forward): ViTMLP(
              (w1): Linear(in_features=1024, out_features=4096, bias=True)
              (act): GELUActivation()
              (w2): Linear(in_features=4096, out_features=1024, bias=True)
            )
            (attention_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (ffn_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=700, out_features=128, bias=False)
  (vision_decoder_head): Linear(in_features=128, out_features=700, bias=False)
)
2025-07-15 17:39:18.448	g3084:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-15 17:39:18.448	g3084:0	olmo.data.data_loader:197	INFO	Loading train dataset chart_qa/train
2025-07-15 17:39:18.449	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_human.json
2025-07-15 17:39:18.483	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_augmented.json
2025-07-15 17:39:18.583	g3084:0	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-15 17:39:18.584	g3084:0	olmo.data.data_loader:219	INFO	chart_qa: 100.00
2025-07-15 17:39:18.585	g3084:0	olmo.models.molmo.molmo:119	INFO	Building collator, pad=to_max seq_len=2304 images=1 pooled_patches_idx=158
2025-07-15 17:39:18.586	g3084:0	olmo.data.data_loader:100	INFO	Loading eval dataset: chart_qa/validation
2025-07-15 17:39:18.587	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_human.json
2025-07-15 17:39:18.592	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_augmented.json
2025-07-15 17:39:18.597	g3084:0	olmo.models.molmo.molmo:119	INFO	Building collator, pad=to_max seq_len=1792 images=1 pooled_patches_idx=158
2025-07-15 17:39:18.826	g3084:0	train:332	INFO	Starting training...
2025-07-15 17:39:18.828	g3084:0	olmo.train.trainer:817	INFO	Pre-train system metrics
    System/Peak GPU Memory (MB)=370.5
2025-07-15 17:39:22.188	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:39:26.417	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:39:27.007	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:39:27.426	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:39:27.844	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:39:28.257	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:39:28.544	g3084:0	olmo.train.trainer:817	INFO	[step=5/1000]
    train/CrossEntropyLoss=11.92
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0318
    train/Accuracy=0.0
    throughput/total_tokens=92,160
    throughput/device/tokens_per_second=47,527
    throughput/device/batches_per_second=2.579
2025-07-15 17:39:28.680	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:39:29.103	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:39:29.522	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:39:29.972	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:39:30.392	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:39:30.681	g3084:0	olmo.train.trainer:817	INFO	[step=10/1000]
    train/CrossEntropyLoss=11.91
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0305
    train/Accuracy=0.0
    throughput/total_tokens=184,320
    throughput/device/tokens_per_second=44,992
    throughput/device/batches_per_second=2.441
    System/Peak GPU Memory (MB)=29,214
2025-07-15 17:39:30.825	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:39:31.237	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:39:31.643	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:39:32.039	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:39:32.447	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:39:32.731	g3084:0	olmo.train.trainer:817	INFO	[step=15/1000]
    train/CrossEntropyLoss=11.90
    train/ZLoss=0.0143
    train/ImageGenLoss=0.7157
    train/Accuracy=0.0
    throughput/total_tokens=276,480
    throughput/device/tokens_per_second=44,970
    throughput/device/batches_per_second=2.440
2025-07-15 17:39:32.862	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:39:33.283	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:39:33.685	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:39:34.103	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:39:34.522	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:39:34.809	g3084:0	olmo.train.trainer:817	INFO	[step=20/1000]
    train/CrossEntropyLoss=11.83
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=368,640
    throughput/device/tokens_per_second=44,808
    throughput/device/batches_per_second=2.431
    System/Peak GPU Memory (MB)=29,214
2025-07-15 17:39:34.811	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 17:39:35.361	g3084:0	olmo.util:177	CRITICAL	Uncaught NotImplementedError: 
Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/Umolmo/launch_scripts/train_multitask_model.py", line 396, in <module>
    run_trainer(cfg)
  File "/gscratch/krishna/mahtab/Umolmo/scripts/train.py", line 333, in run_trainer
    trainer.fit()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 1146, in fit
    eval_metrics = self.inference_eval()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 865, in inference_eval
    dataset_metrics = evaluator.run(
  File "/gscratch/krishna/mahtab/Umolmo/olmo/eval/inf_evaluator.py", line 213, in run
    olmo_gen_output = model.generate(
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/model.py", line 132, in generate
    raise NotImplementedError()
NotImplementedError
2025-07-15 17:40:37.143	g3084:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-15 17:40:37.214	g3084:0	train:54	INFO	Configuration:
2025-07-15 17:40:37.214	g3084:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=128, n_heads=2, n_kv_heads=None, head_dim=None, qkv_bias=False, clip_qkv=None, n_layers=1, mlp_ratio=4, mlp_hidden_size=None, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=10000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='default', layer_norm_with_affine=True, layer_norm_eps=None, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=True, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.1, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=None, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2-7B', tokenizer_dir=None), init_path=None, init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='openai', image_default_input_size=(336, 336), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1024, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=1, image_head_dim=64, image_mlp_dim=4096, image_mlp_activations='gelu', image_dropout_rate=0.0, image_num_pos=577, image_norm_eps=1e-05, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path=None, resize_mode='default', pad_value=0.0, normalize='openai'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-1,), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='resize', max_crops=1, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear'), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'chart_qa': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=20, inf_evaluators=[InfDatasetEvaluatorConfig(label='chart_qa', data=DataLoaderConfig(dataset='chart_qa', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='relaxed_correctness,scifi_relaxed_correctness,em', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=16, console_log_interval=5, include_image=False)], inf_eval_interval=20, eval_on_last_step=True, eval_on_load=False, save_folder='debug_run', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint=None, allow_resume=True, max_duration=1000, global_train_batch_size=8, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=None, beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=5, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=1000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-15 17:40:37.247	g3084:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-15 17:40:39.498	g3084:0	root:123	INFO	Padding tokenizer with 416 tokens
2025-07-15 17:40:41.396	g3084:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-15 17:40:41.541	g3084:0	train:191	INFO	Total number of parameters: 58,006,016
2025-07-15 17:40:41.542	g3084:0	train:192	INFO	Number of non-embedding parameters: 38,525,440
2025-07-15 17:40:41.543	g3084:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 234
2025-07-15 17:40:41.543	g3084:0	train:196	INFO	Model:
2025-07-15 17:40:41.543	g3084:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0): FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=128, out_features=128, bias=True)
          (ff_out): Linear(in_features=256, out_features=128, bias=True)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): LayerNorm()
          (ff_norm): LayerNorm()
          (att_proj): Linear(in_features=128, out_features=384, bias=True)
          (ff_proj): Linear(in_features=128, out_features=512, bias=True)
        )
      )
    )
    (ln_f): FSDPLayerNorm()
    (emb_drop): Dropout(p=0.1, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=128, out_features=152192, bias=True)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=1024, out_features=1024, bias=True)
        (wk): Linear(in_features=1024, out_features=1024, bias=True)
        (wv): Linear(in_features=1024, out_features=1024, bias=True)
        (wo): Linear(in_features=1024, out_features=1024, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1024, out_features=256, bias=False)
        (w2): Linear(in_features=256, out_features=128, bias=False)
        (w3): Linear(in_features=1024, out_features=256, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1024, bias=False)
      (pre_ln): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0): FSDPResidualAttentionBlock(
            (attention): ViTMultiHeadDotProductAttention(
              (wq): Linear(in_features=1024, out_features=1024, bias=True)
              (wk): Linear(in_features=1024, out_features=1024, bias=True)
              (wv): Linear(in_features=1024, out_features=1024, bias=True)
              (wo): Linear(in_features=1024, out_features=1024, bias=True)
              (residual_dropout): Dropout(p=0.0, inplace=False)
            )
            (feed_forward): ViTMLP(
              (w1): Linear(in_features=1024, out_features=4096, bias=True)
              (act): GELUActivation()
              (w2): Linear(in_features=4096, out_features=1024, bias=True)
            )
            (attention_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (ffn_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=700, out_features=128, bias=False)
  (vision_decoder_head): Linear(in_features=128, out_features=700, bias=False)
)
2025-07-15 17:40:41.552	g3084:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-15 17:40:41.553	g3084:0	olmo.data.data_loader:197	INFO	Loading train dataset chart_qa/train
2025-07-15 17:40:41.553	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_human.json
2025-07-15 17:40:41.587	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_augmented.json
2025-07-15 17:40:41.688	g3084:0	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-15 17:40:41.689	g3084:0	olmo.data.data_loader:219	INFO	chart_qa: 100.00
2025-07-15 17:40:41.691	g3084:0	olmo.models.molmo.molmo:119	INFO	Building collator, pad=to_max seq_len=2304 images=1 pooled_patches_idx=158
2025-07-15 17:40:41.691	g3084:0	olmo.data.data_loader:100	INFO	Loading eval dataset: chart_qa/validation
2025-07-15 17:40:41.692	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_human.json
2025-07-15 17:40:41.697	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_augmented.json
2025-07-15 17:40:41.702	g3084:0	olmo.models.molmo.molmo:119	INFO	Building collator, pad=to_max seq_len=1792 images=1 pooled_patches_idx=158
2025-07-15 17:40:41.937	g3084:0	train:332	INFO	Starting training...
2025-07-15 17:40:41.939	g3084:0	olmo.train.trainer:817	INFO	Pre-train system metrics
    System/Peak GPU Memory (MB)=370.5
2025-07-15 17:40:45.449	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:40:49.513	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:40:50.070	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:40:50.472	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:40:50.867	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:40:51.271	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:40:51.554	g3084:0	olmo.train.trainer:817	INFO	[step=5/1000]
    train/CrossEntropyLoss=11.92
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0318
    train/Accuracy=0.0
    throughput/total_tokens=92,160
    throughput/device/tokens_per_second=49,243
    throughput/device/batches_per_second=2.672
2025-07-15 17:40:51.672	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:40:52.079	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:40:52.488	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:40:52.913	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:40:53.321	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:40:53.606	g3084:0	olmo.train.trainer:817	INFO	[step=10/1000]
    train/CrossEntropyLoss=11.91
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0305
    train/Accuracy=0.0
    throughput/total_tokens=184,320
    throughput/device/tokens_per_second=46,745
    throughput/device/batches_per_second=2.536
    System/Peak GPU Memory (MB)=29,214
2025-07-15 17:40:53.738	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:40:54.144	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:40:54.546	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:40:54.940	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:40:55.344	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:40:55.628	g3084:0	olmo.train.trainer:817	INFO	[step=15/1000]
    train/CrossEntropyLoss=11.90
    train/ZLoss=0.0143
    train/ImageGenLoss=0.7157
    train/Accuracy=0.0
    throughput/total_tokens=276,480
    throughput/device/tokens_per_second=46,317
    throughput/device/batches_per_second=2.513
2025-07-15 17:40:55.755	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:40:56.169	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:40:56.564	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:40:56.977	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:40:57.389	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:459: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 17:40:57.674	g3084:0	olmo.train.trainer:817	INFO	[step=20/1000]
    train/CrossEntropyLoss=11.83
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=368,640
    throughput/device/tokens_per_second=45,978
    throughput/device/batches_per_second=2.495
    System/Peak GPU Memory (MB)=29,214
2025-07-15 17:40:57.676	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 17:54:01.576	g3084:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-15 17:54:01.697	g3084:0	train:54	INFO	Configuration:
2025-07-15 17:54:01.697	g3084:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=128, n_heads=2, n_kv_heads=None, head_dim=None, qkv_bias=False, clip_qkv=None, n_layers=1, mlp_ratio=4, mlp_hidden_size=None, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=10000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='default', layer_norm_with_affine=True, layer_norm_eps=None, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=True, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.1, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=None, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2-7B', tokenizer_dir=None), init_path=None, init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='openai', image_default_input_size=(336, 336), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1024, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=1, image_head_dim=64, image_mlp_dim=4096, image_mlp_activations='gelu', image_dropout_rate=0.0, image_num_pos=577, image_norm_eps=1e-05, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path=None, resize_mode='default', pad_value=0.0, normalize='openai'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-1,), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='resize', max_crops=1, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear'), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'chart_qa': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=20, inf_evaluators=[InfDatasetEvaluatorConfig(label='chart_qa', data=DataLoaderConfig(dataset='chart_qa', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='relaxed_correctness,scifi_relaxed_correctness,em', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=16, console_log_interval=5, include_image=False)], inf_eval_interval=20, eval_on_last_step=True, eval_on_load=False, save_folder='debug_run', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint=None, allow_resume=True, max_duration=1000, global_train_batch_size=8, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=None, beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=5, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=1000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-15 17:54:01.730	g3084:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-15 17:54:04.030	g3084:0	root:123	INFO	Padding tokenizer with 416 tokens
2025-07-15 17:58:12.796	g3084:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-15 17:58:12.883	g3084:0	train:54	INFO	Configuration:
2025-07-15 17:58:12.883	g3084:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=128, n_heads=2, n_kv_heads=None, head_dim=None, qkv_bias=False, clip_qkv=None, n_layers=1, mlp_ratio=4, mlp_hidden_size=None, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=10000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='default', layer_norm_with_affine=True, layer_norm_eps=None, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=True, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.1, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=None, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2-7B', tokenizer_dir=None), init_path=None, init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='openai', image_default_input_size=(336, 336), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1024, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=1, image_head_dim=64, image_mlp_dim=4096, image_mlp_activations='gelu', image_dropout_rate=0.0, image_num_pos=577, image_norm_eps=1e-05, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path=None, resize_mode='default', pad_value=0.0, normalize='openai'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-1,), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='resize', max_crops=1, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear'), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'chart_qa': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=20, inf_evaluators=[InfDatasetEvaluatorConfig(label='chart_qa', data=DataLoaderConfig(dataset='chart_qa', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='relaxed_correctness,scifi_relaxed_correctness,em', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=16, console_log_interval=5, include_image=False)], inf_eval_interval=20, eval_on_last_step=True, eval_on_load=False, save_folder='debug_run', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint=None, allow_resume=True, max_duration=1000, global_train_batch_size=8, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=None, beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=5, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=1000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-15 17:58:12.915	g3084:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-15 17:58:15.019	g3084:0	root:123	INFO	Padding tokenizer with 416 tokens
2025-07-15 17:58:28.264	g3084:0	olmo.util:177	CRITICAL	Uncaught BdbQuit: 
Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/Umolmo/launch_scripts/train_multitask_model.py", line 396, in <module>
    run_trainer(cfg)
  File "/gscratch/krishna/mahtab/Umolmo/scripts/train.py", line 104, in run_trainer
    olmo_model = model_cfg.build_model()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py", line 130, in build_model
    return Molmo(self, device)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py", line 184, in __init__
    self.image_gen_start_token_id = tokenizer.image_gen_start_token_id
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/bdb.py", line 94, in trace_dispatch
    return self.dispatch_return(frame, arg)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/bdb.py", line 156, in dispatch_return
    if self.quitting: raise BdbQuit
bdb.BdbQuit
2025-07-15 17:59:40.692	g3084:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-15 17:59:40.763	g3084:0	train:54	INFO	Configuration:
2025-07-15 17:59:40.763	g3084:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=128, n_heads=2, n_kv_heads=None, head_dim=None, qkv_bias=False, clip_qkv=None, n_layers=1, mlp_ratio=4, mlp_hidden_size=None, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=10000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='default', layer_norm_with_affine=True, layer_norm_eps=None, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=True, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.1, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=None, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2-7B', tokenizer_dir=None), init_path=None, init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='openai', image_default_input_size=(336, 336), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1024, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=1, image_head_dim=64, image_mlp_dim=4096, image_mlp_activations='gelu', image_dropout_rate=0.0, image_num_pos=577, image_norm_eps=1e-05, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path=None, resize_mode='default', pad_value=0.0, normalize='openai'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-1,), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='resize', max_crops=1, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear'), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'chart_qa': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=20, inf_evaluators=[InfDatasetEvaluatorConfig(label='chart_qa', data=DataLoaderConfig(dataset='chart_qa', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='relaxed_correctness,scifi_relaxed_correctness,em', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=16, console_log_interval=5, include_image=False)], inf_eval_interval=20, eval_on_last_step=True, eval_on_load=False, save_folder='debug_run', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint=None, allow_resume=True, max_duration=1000, global_train_batch_size=8, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=None, beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=5, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=1000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-15 17:59:40.803	g3084:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-15 17:59:42.952	g3084:0	root:123	INFO	Padding tokenizer with 416 tokens
2025-07-15 17:59:58.524	g3084:0	olmo.util:177	CRITICAL	Uncaught BdbQuit: 
Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/Umolmo/launch_scripts/train_multitask_model.py", line 396, in <module>
    run_trainer(cfg)
  File "/gscratch/krishna/mahtab/Umolmo/scripts/train.py", line 104, in run_trainer
    olmo_model = model_cfg.build_model()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py", line 130, in build_model
    return Molmo(self, device)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py", line 186, in __init__
    self._image_end_token_id = self.special_ids[tokenizer.IM_END_TOKEN]
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py", line 186, in __init__
    self._image_end_token_id = self.special_ids[tokenizer.IM_END_TOKEN]
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/bdb.py", line 90, in trace_dispatch
    return self.dispatch_line(frame)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/bdb.py", line 115, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit
2025-07-15 18:10:54.454	g3084:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-15 18:10:54.597	g3084:0	train:54	INFO	Configuration:
2025-07-15 18:10:54.597	g3084:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=128, n_heads=2, n_kv_heads=None, head_dim=None, qkv_bias=False, clip_qkv=None, n_layers=1, mlp_ratio=4, mlp_hidden_size=None, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=10000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='default', layer_norm_with_affine=True, layer_norm_eps=None, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=True, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.1, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=None, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2-7B', tokenizer_dir=None), init_path=None, init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='openai', image_default_input_size=(336, 336), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1024, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=1, image_head_dim=64, image_mlp_dim=4096, image_mlp_activations='gelu', image_dropout_rate=0.0, image_num_pos=577, image_norm_eps=1e-05, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path=None, resize_mode='default', pad_value=0.0, normalize='openai'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-1,), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='resize', max_crops=1, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear', per_image_output_tokens=64), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'chart_qa': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=20, inf_evaluators=[InfDatasetEvaluatorConfig(label='chart_qa', data=DataLoaderConfig(dataset='chart_qa', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='relaxed_correctness,scifi_relaxed_correctness,em', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=16, console_log_interval=5, include_image=False)], inf_eval_interval=20, eval_on_last_step=True, eval_on_load=False, save_folder='debug_run', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint=None, allow_resume=True, max_duration=1000, global_train_batch_size=8, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=None, beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=5, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=1000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-15 18:10:54.630	g3084:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-15 18:10:56.772	g3084:0	root:123	INFO	Padding tokenizer with 416 tokens
2025-07-15 18:10:59.536	g3084:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-15 18:10:59.985	g3084:0	train:191	INFO	Total number of parameters: 58,006,016
2025-07-15 18:10:59.986	g3084:0	train:192	INFO	Number of non-embedding parameters: 38,525,440
2025-07-15 18:10:59.987	g3084:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 234
2025-07-15 18:10:59.987	g3084:0	train:196	INFO	Model:
2025-07-15 18:10:59.988	g3084:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0): FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=128, out_features=128, bias=True)
          (ff_out): Linear(in_features=256, out_features=128, bias=True)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): LayerNorm()
          (ff_norm): LayerNorm()
          (att_proj): Linear(in_features=128, out_features=384, bias=True)
          (ff_proj): Linear(in_features=128, out_features=512, bias=True)
        )
      )
    )
    (ln_f): FSDPLayerNorm()
    (emb_drop): Dropout(p=0.1, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=128, out_features=152192, bias=True)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=1024, out_features=1024, bias=True)
        (wk): Linear(in_features=1024, out_features=1024, bias=True)
        (wv): Linear(in_features=1024, out_features=1024, bias=True)
        (wo): Linear(in_features=1024, out_features=1024, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1024, out_features=256, bias=False)
        (w2): Linear(in_features=256, out_features=128, bias=False)
        (w3): Linear(in_features=1024, out_features=256, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1024, bias=False)
      (pre_ln): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0): FSDPResidualAttentionBlock(
            (attention): ViTMultiHeadDotProductAttention(
              (wq): Linear(in_features=1024, out_features=1024, bias=True)
              (wk): Linear(in_features=1024, out_features=1024, bias=True)
              (wv): Linear(in_features=1024, out_features=1024, bias=True)
              (wo): Linear(in_features=1024, out_features=1024, bias=True)
              (residual_dropout): Dropout(p=0.0, inplace=False)
            )
            (feed_forward): ViTMLP(
              (w1): Linear(in_features=1024, out_features=4096, bias=True)
              (act): GELUActivation()
              (w2): Linear(in_features=4096, out_features=1024, bias=True)
            )
            (attention_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (ffn_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=700, out_features=128, bias=False)
  (vision_decoder_head): Linear(in_features=128, out_features=700, bias=False)
)
2025-07-15 18:11:00.011	g3084:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-15 18:11:00.012	g3084:0	olmo.data.data_loader:197	INFO	Loading train dataset chart_qa/train
2025-07-15 18:11:00.012	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_human.json
2025-07-15 18:11:00.074	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_augmented.json
2025-07-15 18:11:00.247	g3084:0	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-15 18:11:00.247	g3084:0	olmo.data.data_loader:219	INFO	chart_qa: 100.00
2025-07-15 18:11:00.272	g3084:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=2304 images=1 pooled_patches_idx=158
2025-07-15 18:11:00.272	g3084:0	olmo.data.data_loader:100	INFO	Loading eval dataset: chart_qa/validation
2025-07-15 18:11:00.273	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_human.json
2025-07-15 18:11:00.290	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_augmented.json
2025-07-15 18:11:00.308	g3084:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=1792 images=1 pooled_patches_idx=158
2025-07-15 18:11:00.799	g3084:0	train:332	INFO	Starting training...
2025-07-15 18:11:00.800	g3084:0	olmo.train.trainer:817	INFO	Pre-train system metrics
    System/Peak GPU Memory (MB)=370.5
2025-07-15 18:11:09.888	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:11:15.618	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:11:16.479	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:11:16.903	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:11:17.336	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:11:17.752	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:11:18.041	g3084:0	olmo.train.trainer:817	INFO	[step=5/1000]
    train/CrossEntropyLoss=11.92
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0318
    train/Accuracy=0.0
    throughput/total_tokens=92,160
    throughput/device/tokens_per_second=46,801
    throughput/device/batches_per_second=2.539
2025-07-15 18:11:18.178	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:11:18.629	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:11:19.052	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:11:19.487	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:11:19.919	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:11:20.207	g3084:0	olmo.train.trainer:817	INFO	[step=10/1000]
    train/CrossEntropyLoss=11.91
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0305
    train/Accuracy=0.0
    throughput/total_tokens=184,320
    throughput/device/tokens_per_second=44,351
    throughput/device/batches_per_second=2.406
    System/Peak GPU Memory (MB)=29,214
2025-07-15 18:11:20.350	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:11:20.771	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:11:21.280	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:11:21.686	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:11:22.120	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:11:22.409	g3084:0	olmo.train.trainer:817	INFO	[step=15/1000]
    train/CrossEntropyLoss=11.90
    train/ZLoss=0.0143
    train/ImageGenLoss=0.7157
    train/Accuracy=0.0
    throughput/total_tokens=276,480
    throughput/device/tokens_per_second=43,420
    throughput/device/batches_per_second=2.356
2025-07-15 18:11:22.555	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:11:22.983	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:11:23.450	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:11:23.922	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:11:24.354	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:11:24.645	g3084:0	olmo.train.trainer:817	INFO	[step=20/1000]
    train/CrossEntropyLoss=11.84
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=368,640
    throughput/device/tokens_per_second=42,821
    throughput/device/batches_per_second=2.323
    System/Peak GPU Memory (MB)=29,214
2025-07-15 18:11:24.646	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 18:12:40.222	g3084:0	olmo.util:177	CRITICAL	Uncaught BdbQuit: 
Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/Umolmo/launch_scripts/train_multitask_model.py", line 396, in <module>
    run_trainer(cfg)
  File "/gscratch/krishna/mahtab/Umolmo/scripts/train.py", line 333, in run_trainer
    trainer.fit()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 1146, in fit
    eval_metrics = self.inference_eval()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 865, in inference_eval
    dataset_metrics = evaluator.run(
  File "/gscratch/krishna/mahtab/Umolmo/olmo/eval/inf_evaluator.py", line 213, in run
    olmo_gen_output = model.generate(
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py", line 669, in generate
    generated = torch.cat((generated, next_token), dim=1)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py", line 669, in generate
    generated = torch.cat((generated, next_token), dim=1)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/bdb.py", line 90, in trace_dispatch
    return self.dispatch_line(frame)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/bdb.py", line 115, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit
2025-07-15 18:14:03.719	g3084:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-15 18:14:03.805	g3084:0	train:54	INFO	Configuration:
2025-07-15 18:14:03.806	g3084:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=128, n_heads=2, n_kv_heads=None, head_dim=None, qkv_bias=False, clip_qkv=None, n_layers=1, mlp_ratio=4, mlp_hidden_size=None, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=10000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='default', layer_norm_with_affine=True, layer_norm_eps=None, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=True, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.1, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=None, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2-7B', tokenizer_dir=None), init_path=None, init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='openai', image_default_input_size=(336, 336), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1024, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=1, image_head_dim=64, image_mlp_dim=4096, image_mlp_activations='gelu', image_dropout_rate=0.0, image_num_pos=577, image_norm_eps=1e-05, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path=None, resize_mode='default', pad_value=0.0, normalize='openai'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-1,), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='resize', max_crops=1, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear', per_image_output_tokens=64), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'chart_qa': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=20, inf_evaluators=[InfDatasetEvaluatorConfig(label='chart_qa', data=DataLoaderConfig(dataset='chart_qa', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='relaxed_correctness,scifi_relaxed_correctness,em', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=16, console_log_interval=5, include_image=False)], inf_eval_interval=20, eval_on_last_step=True, eval_on_load=False, save_folder='debug_run', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint=None, allow_resume=True, max_duration=1000, global_train_batch_size=8, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=None, beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=5, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=1000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-15 18:14:03.860	g3084:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-15 18:14:06.264	g3084:0	root:123	INFO	Padding tokenizer with 416 tokens
2025-07-15 18:14:08.391	g3084:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-15 18:14:08.546	g3084:0	train:191	INFO	Total number of parameters: 58,006,016
2025-07-15 18:14:08.547	g3084:0	train:192	INFO	Number of non-embedding parameters: 38,525,440
2025-07-15 18:14:08.548	g3084:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 234
2025-07-15 18:14:08.548	g3084:0	train:196	INFO	Model:
2025-07-15 18:14:08.549	g3084:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0): FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=128, out_features=128, bias=True)
          (ff_out): Linear(in_features=256, out_features=128, bias=True)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): LayerNorm()
          (ff_norm): LayerNorm()
          (att_proj): Linear(in_features=128, out_features=384, bias=True)
          (ff_proj): Linear(in_features=128, out_features=512, bias=True)
        )
      )
    )
    (ln_f): FSDPLayerNorm()
    (emb_drop): Dropout(p=0.1, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=128, out_features=152192, bias=True)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=1024, out_features=1024, bias=True)
        (wk): Linear(in_features=1024, out_features=1024, bias=True)
        (wv): Linear(in_features=1024, out_features=1024, bias=True)
        (wo): Linear(in_features=1024, out_features=1024, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1024, out_features=256, bias=False)
        (w2): Linear(in_features=256, out_features=128, bias=False)
        (w3): Linear(in_features=1024, out_features=256, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1024, bias=False)
      (pre_ln): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0): FSDPResidualAttentionBlock(
            (attention): ViTMultiHeadDotProductAttention(
              (wq): Linear(in_features=1024, out_features=1024, bias=True)
              (wk): Linear(in_features=1024, out_features=1024, bias=True)
              (wv): Linear(in_features=1024, out_features=1024, bias=True)
              (wo): Linear(in_features=1024, out_features=1024, bias=True)
              (residual_dropout): Dropout(p=0.0, inplace=False)
            )
            (feed_forward): ViTMLP(
              (w1): Linear(in_features=1024, out_features=4096, bias=True)
              (act): GELUActivation()
              (w2): Linear(in_features=4096, out_features=1024, bias=True)
            )
            (attention_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (ffn_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=700, out_features=128, bias=False)
  (vision_decoder_head): Linear(in_features=128, out_features=700, bias=False)
)
2025-07-15 18:14:08.578	g3084:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-15 18:14:08.579	g3084:0	olmo.data.data_loader:197	INFO	Loading train dataset chart_qa/train
2025-07-15 18:14:08.579	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_human.json
2025-07-15 18:14:08.645	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_augmented.json
2025-07-15 18:14:08.780	g3084:0	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-15 18:14:08.781	g3084:0	olmo.data.data_loader:219	INFO	chart_qa: 100.00
2025-07-15 18:14:08.782	g3084:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=2304 images=1 pooled_patches_idx=158
2025-07-15 18:14:08.783	g3084:0	olmo.data.data_loader:100	INFO	Loading eval dataset: chart_qa/validation
2025-07-15 18:14:08.784	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_human.json
2025-07-15 18:14:08.815	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_augmented.json
2025-07-15 18:14:08.834	g3084:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=1792 images=1 pooled_patches_idx=158
2025-07-15 18:14:09.077	g3084:0	train:332	INFO	Starting training...
2025-07-15 18:14:09.079	g3084:0	olmo.train.trainer:817	INFO	Pre-train system metrics
    System/Peak GPU Memory (MB)=370.5
2025-07-15 18:14:13.192	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:14:17.732	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:14:18.355	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:14:18.794	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:14:19.217	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:14:19.639	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:14:19.932	g3084:0	olmo.train.trainer:817	INFO	[step=5/1000]
    train/CrossEntropyLoss=11.92
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0318
    train/Accuracy=0.0
    throughput/total_tokens=92,160
    throughput/device/tokens_per_second=46,331
    throughput/device/batches_per_second=2.514
2025-07-15 18:14:20.064	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:14:20.495	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:14:20.924	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:14:21.363	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:14:21.799	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:14:22.090	g3084:0	olmo.train.trainer:817	INFO	[step=10/1000]
    train/CrossEntropyLoss=11.91
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0305
    train/Accuracy=0.0
    throughput/total_tokens=184,320
    throughput/device/tokens_per_second=44,247
    throughput/device/batches_per_second=2.401
    System/Peak GPU Memory (MB)=29,214
2025-07-15 18:14:22.239	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:14:22.732	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:14:23.155	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:14:23.574	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:14:24.000	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:14:24.292	g3084:0	olmo.train.trainer:817	INFO	[step=15/1000]
    train/CrossEntropyLoss=11.90
    train/ZLoss=0.0143
    train/ImageGenLoss=0.7157
    train/Accuracy=0.0
    throughput/total_tokens=276,480
    throughput/device/tokens_per_second=43,355
    throughput/device/batches_per_second=2.352
2025-07-15 18:14:24.435	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:14:24.874	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:14:25.295	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:14:25.730	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:14:26.169	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:14:26.463	g3084:0	olmo.train.trainer:817	INFO	[step=20/1000]
    train/CrossEntropyLoss=11.84
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=368,640
    throughput/device/tokens_per_second=43,119
    throughput/device/batches_per_second=2.339
    System/Peak GPU Memory (MB)=29,214
2025-07-15 18:14:26.465	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 18:18:05.828	g3084:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-15 18:18:05.901	g3084:0	train:54	INFO	Configuration:
2025-07-15 18:18:05.901	g3084:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=128, n_heads=2, n_kv_heads=None, head_dim=None, qkv_bias=False, clip_qkv=None, n_layers=1, mlp_ratio=4, mlp_hidden_size=None, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=10000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='default', layer_norm_with_affine=True, layer_norm_eps=None, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=True, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.1, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=None, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2-7B', tokenizer_dir=None), init_path=None, init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='openai', image_default_input_size=(336, 336), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1024, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=1, image_head_dim=64, image_mlp_dim=4096, image_mlp_activations='gelu', image_dropout_rate=0.0, image_num_pos=577, image_norm_eps=1e-05, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path=None, resize_mode='default', pad_value=0.0, normalize='openai'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-1,), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='resize', max_crops=1, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear', per_image_output_tokens=64), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'chart_qa': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=20, inf_evaluators=[InfDatasetEvaluatorConfig(label='chart_qa', data=DataLoaderConfig(dataset='chart_qa', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='relaxed_correctness,scifi_relaxed_correctness,em', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=16, console_log_interval=5, include_image=False)], inf_eval_interval=20, eval_on_last_step=True, eval_on_load=False, save_folder='debug_run', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint=None, allow_resume=True, max_duration=1000, global_train_batch_size=8, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=None, beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=5, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=1000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-15 18:18:05.944	g3084:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-15 18:18:08.259	g3084:0	root:123	INFO	Padding tokenizer with 416 tokens
2025-07-15 18:18:10.261	g3084:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-15 18:18:10.413	g3084:0	train:191	INFO	Total number of parameters: 58,006,016
2025-07-15 18:18:10.414	g3084:0	train:192	INFO	Number of non-embedding parameters: 38,525,440
2025-07-15 18:18:10.414	g3084:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 234
2025-07-15 18:18:10.415	g3084:0	train:196	INFO	Model:
2025-07-15 18:18:10.415	g3084:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0): FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=128, out_features=128, bias=True)
          (ff_out): Linear(in_features=256, out_features=128, bias=True)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): LayerNorm()
          (ff_norm): LayerNorm()
          (att_proj): Linear(in_features=128, out_features=384, bias=True)
          (ff_proj): Linear(in_features=128, out_features=512, bias=True)
        )
      )
    )
    (ln_f): FSDPLayerNorm()
    (emb_drop): Dropout(p=0.1, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=128, out_features=152192, bias=True)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=1024, out_features=1024, bias=True)
        (wk): Linear(in_features=1024, out_features=1024, bias=True)
        (wv): Linear(in_features=1024, out_features=1024, bias=True)
        (wo): Linear(in_features=1024, out_features=1024, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1024, out_features=256, bias=False)
        (w2): Linear(in_features=256, out_features=128, bias=False)
        (w3): Linear(in_features=1024, out_features=256, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1024, bias=False)
      (pre_ln): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0): FSDPResidualAttentionBlock(
            (attention): ViTMultiHeadDotProductAttention(
              (wq): Linear(in_features=1024, out_features=1024, bias=True)
              (wk): Linear(in_features=1024, out_features=1024, bias=True)
              (wv): Linear(in_features=1024, out_features=1024, bias=True)
              (wo): Linear(in_features=1024, out_features=1024, bias=True)
              (residual_dropout): Dropout(p=0.0, inplace=False)
            )
            (feed_forward): ViTMLP(
              (w1): Linear(in_features=1024, out_features=4096, bias=True)
              (act): GELUActivation()
              (w2): Linear(in_features=4096, out_features=1024, bias=True)
            )
            (attention_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (ffn_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=700, out_features=128, bias=False)
  (vision_decoder_head): Linear(in_features=128, out_features=700, bias=False)
)
2025-07-15 18:18:10.444	g3084:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-15 18:18:10.445	g3084:0	olmo.data.data_loader:197	INFO	Loading train dataset chart_qa/train
2025-07-15 18:18:10.445	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_human.json
2025-07-15 18:18:10.481	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_augmented.json
2025-07-15 18:18:10.582	g3084:0	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-15 18:18:10.582	g3084:0	olmo.data.data_loader:219	INFO	chart_qa: 100.00
2025-07-15 18:18:10.584	g3084:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=2304 images=1 pooled_patches_idx=158
2025-07-15 18:18:10.585	g3084:0	olmo.data.data_loader:100	INFO	Loading eval dataset: chart_qa/validation
2025-07-15 18:18:10.585	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_human.json
2025-07-15 18:18:10.591	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_augmented.json
2025-07-15 18:18:10.596	g3084:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=1792 images=1 pooled_patches_idx=158
2025-07-15 18:18:10.833	g3084:0	train:332	INFO	Starting training...
2025-07-15 18:18:10.835	g3084:0	olmo.train.trainer:817	INFO	Pre-train system metrics
    System/Peak GPU Memory (MB)=370.5
2025-07-15 18:18:14.399	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:18:18.613	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:18:19.196	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:18:19.615	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:18:20.030	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:18:20.441	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:18:20.727	g3084:0	olmo.train.trainer:817	INFO	[step=5/1000]
    train/CrossEntropyLoss=11.92
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0318
    train/Accuracy=0.0
    throughput/total_tokens=92,160
    throughput/device/tokens_per_second=47,701
    throughput/device/batches_per_second=2.588
2025-07-15 18:18:20.853	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:18:21.277	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:18:21.700	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:18:22.135	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:18:22.569	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:18:22.860	g3084:0	olmo.train.trainer:817	INFO	[step=10/1000]
    train/CrossEntropyLoss=11.91
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0305
    train/Accuracy=0.0
    throughput/total_tokens=184,320
    throughput/device/tokens_per_second=45,107
    throughput/device/batches_per_second=2.447
    System/Peak GPU Memory (MB)=29,214
2025-07-15 18:18:23.005	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:18:23.431	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:18:23.849	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:18:24.258	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:18:24.676	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:18:24.967	g3084:0	olmo.train.trainer:817	INFO	[step=15/1000]
    train/CrossEntropyLoss=11.90
    train/ZLoss=0.0143
    train/ImageGenLoss=0.7157
    train/Accuracy=0.0
    throughput/total_tokens=276,480
    throughput/device/tokens_per_second=44,604
    throughput/device/batches_per_second=2.420
2025-07-15 18:18:25.103	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:18:25.530	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:18:25.936	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:18:26.359	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:18:26.784	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:18:27.074	g3084:0	olmo.train.trainer:817	INFO	[step=20/1000]
    train/CrossEntropyLoss=11.84
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=368,640
    throughput/device/tokens_per_second=44,379
    throughput/device/batches_per_second=2.408
    System/Peak GPU Memory (MB)=29,214
2025-07-15 18:18:27.075	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 18:23:33.786	g3084:0	olmo.util:177	CRITICAL	Uncaught BdbQuit: 
Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/Umolmo/launch_scripts/train_multitask_model.py", line 396, in <module>
    run_trainer(cfg)
  File "/gscratch/krishna/mahtab/Umolmo/scripts/train.py", line 333, in run_trainer
    trainer.fit()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 1146, in fit
    eval_metrics = self.inference_eval()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 865, in inference_eval
    dataset_metrics = evaluator.run(
  File "/gscratch/krishna/mahtab/Umolmo/olmo/eval/inf_evaluator.py", line 213, in run
    olmo_gen_output = model.generate(
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py", line 631, in generate
    import pdb; pdb.set_trace()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py", line 631, in generate
    import pdb; pdb.set_trace()
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/bdb.py", line 90, in trace_dispatch
    return self.dispatch_line(frame)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/bdb.py", line 115, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit
2025-07-15 18:23:49.550	g3084:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-15 18:23:49.624	g3084:0	train:54	INFO	Configuration:
2025-07-15 18:23:49.624	g3084:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=128, n_heads=2, n_kv_heads=None, head_dim=None, qkv_bias=False, clip_qkv=None, n_layers=1, mlp_ratio=4, mlp_hidden_size=None, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=10000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='default', layer_norm_with_affine=True, layer_norm_eps=None, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=True, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.1, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=None, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2-7B', tokenizer_dir=None), init_path=None, init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='openai', image_default_input_size=(336, 336), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1024, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=1, image_head_dim=64, image_mlp_dim=4096, image_mlp_activations='gelu', image_dropout_rate=0.0, image_num_pos=577, image_norm_eps=1e-05, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path=None, resize_mode='default', pad_value=0.0, normalize='openai'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-1,), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='resize', max_crops=1, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear', per_image_output_tokens=64), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'chart_qa': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=20, inf_evaluators=[InfDatasetEvaluatorConfig(label='chart_qa', data=DataLoaderConfig(dataset='chart_qa', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='relaxed_correctness,scifi_relaxed_correctness,em', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=16, console_log_interval=5, include_image=False)], inf_eval_interval=20, eval_on_last_step=True, eval_on_load=False, save_folder='debug_run', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint=None, allow_resume=True, max_duration=1000, global_train_batch_size=8, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=None, beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=5, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=1000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-15 18:23:49.677	g3084:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-15 18:23:52.127	g3084:0	root:123	INFO	Padding tokenizer with 416 tokens
2025-07-15 18:23:54.199	g3084:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-15 18:23:54.358	g3084:0	train:191	INFO	Total number of parameters: 58,006,016
2025-07-15 18:23:54.359	g3084:0	train:192	INFO	Number of non-embedding parameters: 38,525,440
2025-07-15 18:23:54.360	g3084:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 234
2025-07-15 18:23:54.360	g3084:0	train:196	INFO	Model:
2025-07-15 18:23:54.360	g3084:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0): FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=128, out_features=128, bias=True)
          (ff_out): Linear(in_features=256, out_features=128, bias=True)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): LayerNorm()
          (ff_norm): LayerNorm()
          (att_proj): Linear(in_features=128, out_features=384, bias=True)
          (ff_proj): Linear(in_features=128, out_features=512, bias=True)
        )
      )
    )
    (ln_f): FSDPLayerNorm()
    (emb_drop): Dropout(p=0.1, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=128, out_features=152192, bias=True)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=1024, out_features=1024, bias=True)
        (wk): Linear(in_features=1024, out_features=1024, bias=True)
        (wv): Linear(in_features=1024, out_features=1024, bias=True)
        (wo): Linear(in_features=1024, out_features=1024, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1024, out_features=256, bias=False)
        (w2): Linear(in_features=256, out_features=128, bias=False)
        (w3): Linear(in_features=1024, out_features=256, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1024, bias=False)
      (pre_ln): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0): FSDPResidualAttentionBlock(
            (attention): ViTMultiHeadDotProductAttention(
              (wq): Linear(in_features=1024, out_features=1024, bias=True)
              (wk): Linear(in_features=1024, out_features=1024, bias=True)
              (wv): Linear(in_features=1024, out_features=1024, bias=True)
              (wo): Linear(in_features=1024, out_features=1024, bias=True)
              (residual_dropout): Dropout(p=0.0, inplace=False)
            )
            (feed_forward): ViTMLP(
              (w1): Linear(in_features=1024, out_features=4096, bias=True)
              (act): GELUActivation()
              (w2): Linear(in_features=4096, out_features=1024, bias=True)
            )
            (attention_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (ffn_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=700, out_features=128, bias=False)
  (vision_decoder_head): Linear(in_features=128, out_features=700, bias=False)
)
2025-07-15 18:23:54.386	g3084:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-15 18:23:54.387	g3084:0	olmo.data.data_loader:197	INFO	Loading train dataset chart_qa/train
2025-07-15 18:23:54.387	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_human.json
2025-07-15 18:23:54.424	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_augmented.json
2025-07-15 18:23:54.528	g3084:0	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-15 18:23:54.529	g3084:0	olmo.data.data_loader:219	INFO	chart_qa: 100.00
2025-07-15 18:23:54.530	g3084:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=2304 images=1 pooled_patches_idx=158
2025-07-15 18:23:54.531	g3084:0	olmo.data.data_loader:100	INFO	Loading eval dataset: chart_qa/validation
2025-07-15 18:23:54.531	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_human.json
2025-07-15 18:23:54.538	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_augmented.json
2025-07-15 18:23:54.543	g3084:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=1792 images=1 pooled_patches_idx=158
2025-07-15 18:23:54.793	g3084:0	train:332	INFO	Starting training...
2025-07-15 18:23:54.794	g3084:0	olmo.train.trainer:817	INFO	Pre-train system metrics
    System/Peak GPU Memory (MB)=370.5
2025-07-15 18:23:58.479	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:24:02.987	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:24:03.650	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:24:04.082	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:24:04.507	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:24:04.936	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:24:05.228	g3084:0	olmo.train.trainer:817	INFO	[step=5/1000]
    train/CrossEntropyLoss=11.92
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0318
    train/Accuracy=0.0
    throughput/total_tokens=92,160
    throughput/device/tokens_per_second=46,318
    throughput/device/batches_per_second=2.513
2025-07-15 18:24:05.364	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:24:05.799	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:24:06.225	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:24:06.665	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:24:07.099	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:24:07.391	g3084:0	olmo.train.trainer:817	INFO	[step=10/1000]
    train/CrossEntropyLoss=11.91
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0305
    train/Accuracy=0.0
    throughput/total_tokens=184,320
    throughput/device/tokens_per_second=44,189
    throughput/device/batches_per_second=2.397
    System/Peak GPU Memory (MB)=29,214
2025-07-15 18:24:07.540	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:24:07.967	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:24:08.392	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:24:08.810	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:24:09.240	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:24:09.532	g3084:0	olmo.train.trainer:817	INFO	[step=15/1000]
    train/CrossEntropyLoss=11.90
    train/ZLoss=0.0143
    train/ImageGenLoss=0.7157
    train/Accuracy=0.0
    throughput/total_tokens=276,480
    throughput/device/tokens_per_second=43,771
    throughput/device/batches_per_second=2.375
2025-07-15 18:24:09.679	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:24:10.117	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:24:10.534	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:24:10.966	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:24:11.398	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:24:11.689	g3084:0	olmo.train.trainer:817	INFO	[step=20/1000]
    train/CrossEntropyLoss=11.84
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=368,640
    throughput/device/tokens_per_second=43,490
    throughput/device/batches_per_second=2.359
    System/Peak GPU Memory (MB)=29,214
2025-07-15 18:24:11.691	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 18:26:02.567	g3084:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-15 18:26:02.647	g3084:0	train:54	INFO	Configuration:
2025-07-15 18:26:02.648	g3084:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=128, n_heads=2, n_kv_heads=None, head_dim=None, qkv_bias=False, clip_qkv=None, n_layers=1, mlp_ratio=4, mlp_hidden_size=None, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=10000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='default', layer_norm_with_affine=True, layer_norm_eps=None, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=True, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.1, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=None, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2-7B', tokenizer_dir=None), init_path=None, init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='openai', image_default_input_size=(336, 336), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1024, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=1, image_head_dim=64, image_mlp_dim=4096, image_mlp_activations='gelu', image_dropout_rate=0.0, image_num_pos=577, image_norm_eps=1e-05, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path=None, resize_mode='default', pad_value=0.0, normalize='openai'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-1,), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='resize', max_crops=1, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear', per_image_output_tokens=64), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'chart_qa': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=20, inf_evaluators=[InfDatasetEvaluatorConfig(label='chart_qa', data=DataLoaderConfig(dataset='chart_qa', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='relaxed_correctness,scifi_relaxed_correctness,em', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=16, console_log_interval=5, include_image=False)], inf_eval_interval=20, eval_on_last_step=True, eval_on_load=False, save_folder='debug_run', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint=None, allow_resume=True, max_duration=1000, global_train_batch_size=8, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=None, beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=5, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=1000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-15 18:26:02.702	g3084:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-15 18:26:06.647	g3084:0	root:123	INFO	Padding tokenizer with 416 tokens
2025-07-15 18:26:08.680	g3084:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-15 18:26:08.837	g3084:0	train:191	INFO	Total number of parameters: 58,006,016
2025-07-15 18:26:08.837	g3084:0	train:192	INFO	Number of non-embedding parameters: 38,525,440
2025-07-15 18:26:08.838	g3084:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 234
2025-07-15 18:26:08.839	g3084:0	train:196	INFO	Model:
2025-07-15 18:26:08.839	g3084:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0): FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=128, out_features=128, bias=True)
          (ff_out): Linear(in_features=256, out_features=128, bias=True)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): LayerNorm()
          (ff_norm): LayerNorm()
          (att_proj): Linear(in_features=128, out_features=384, bias=True)
          (ff_proj): Linear(in_features=128, out_features=512, bias=True)
        )
      )
    )
    (ln_f): FSDPLayerNorm()
    (emb_drop): Dropout(p=0.1, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=128, out_features=152192, bias=True)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=1024, out_features=1024, bias=True)
        (wk): Linear(in_features=1024, out_features=1024, bias=True)
        (wv): Linear(in_features=1024, out_features=1024, bias=True)
        (wo): Linear(in_features=1024, out_features=1024, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1024, out_features=256, bias=False)
        (w2): Linear(in_features=256, out_features=128, bias=False)
        (w3): Linear(in_features=1024, out_features=256, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1024, bias=False)
      (pre_ln): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0): FSDPResidualAttentionBlock(
            (attention): ViTMultiHeadDotProductAttention(
              (wq): Linear(in_features=1024, out_features=1024, bias=True)
              (wk): Linear(in_features=1024, out_features=1024, bias=True)
              (wv): Linear(in_features=1024, out_features=1024, bias=True)
              (wo): Linear(in_features=1024, out_features=1024, bias=True)
              (residual_dropout): Dropout(p=0.0, inplace=False)
            )
            (feed_forward): ViTMLP(
              (w1): Linear(in_features=1024, out_features=4096, bias=True)
              (act): GELUActivation()
              (w2): Linear(in_features=4096, out_features=1024, bias=True)
            )
            (attention_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (ffn_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=700, out_features=128, bias=False)
  (vision_decoder_head): Linear(in_features=128, out_features=700, bias=False)
)
2025-07-15 18:26:08.863	g3084:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-15 18:26:08.864	g3084:0	olmo.data.data_loader:197	INFO	Loading train dataset chart_qa/train
2025-07-15 18:26:08.864	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_human.json
2025-07-15 18:26:08.901	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_augmented.json
2025-07-15 18:26:09.005	g3084:0	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-15 18:26:09.005	g3084:0	olmo.data.data_loader:219	INFO	chart_qa: 100.00
2025-07-15 18:26:09.007	g3084:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=2304 images=1 pooled_patches_idx=158
2025-07-15 18:26:09.008	g3084:0	olmo.data.data_loader:100	INFO	Loading eval dataset: chart_qa/validation
2025-07-15 18:26:09.008	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_human.json
2025-07-15 18:26:09.015	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_augmented.json
2025-07-15 18:26:09.020	g3084:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=1792 images=1 pooled_patches_idx=158
2025-07-15 18:26:09.268	g3084:0	train:332	INFO	Starting training...
2025-07-15 18:26:09.269	g3084:0	olmo.train.trainer:817	INFO	Pre-train system metrics
    System/Peak GPU Memory (MB)=370.5
2025-07-15 18:26:12.909	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:26:17.321	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:26:17.949	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:26:18.379	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:26:18.809	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:26:19.236	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:26:19.528	g3084:0	olmo.train.trainer:817	INFO	[step=5/1000]
    train/CrossEntropyLoss=11.92
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0318
    train/Accuracy=0.0
    throughput/total_tokens=92,160
    throughput/device/tokens_per_second=46,289
    throughput/device/batches_per_second=2.511
2025-07-15 18:26:19.660	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:26:20.094	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:26:20.522	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:26:20.964	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:26:21.394	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:26:21.687	g3084:0	olmo.train.trainer:817	INFO	[step=10/1000]
    train/CrossEntropyLoss=11.91
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0305
    train/Accuracy=0.0
    throughput/total_tokens=184,320
    throughput/device/tokens_per_second=44,223
    throughput/device/batches_per_second=2.399
    System/Peak GPU Memory (MB)=29,214
2025-07-15 18:26:21.837	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:26:22.270	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:26:22.692	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:26:23.103	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:26:23.526	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:26:23.817	g3084:0	olmo.train.trainer:817	INFO	[step=15/1000]
    train/CrossEntropyLoss=11.90
    train/ZLoss=0.0143
    train/ImageGenLoss=0.7157
    train/Accuracy=0.0
    throughput/total_tokens=276,480
    throughput/device/tokens_per_second=43,872
    throughput/device/batches_per_second=2.380
2025-07-15 18:26:23.958	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:26:24.394	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:26:24.812	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:26:25.249	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:26:25.683	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:26:25.974	g3084:0	olmo.train.trainer:817	INFO	[step=20/1000]
    train/CrossEntropyLoss=11.83
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=368,640
    throughput/device/tokens_per_second=43,568
    throughput/device/batches_per_second=2.364
    System/Peak GPU Memory (MB)=29,214
2025-07-15 18:26:25.976	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 18:28:52.737	g3084:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-15 18:28:52.810	g3084:0	train:54	INFO	Configuration:
2025-07-15 18:28:52.810	g3084:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=128, n_heads=2, n_kv_heads=None, head_dim=None, qkv_bias=False, clip_qkv=None, n_layers=1, mlp_ratio=4, mlp_hidden_size=None, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=10000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='default', layer_norm_with_affine=True, layer_norm_eps=None, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=True, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.1, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=None, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2-7B', tokenizer_dir=None), init_path=None, init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='openai', image_default_input_size=(336, 336), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1024, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=1, image_head_dim=64, image_mlp_dim=4096, image_mlp_activations='gelu', image_dropout_rate=0.0, image_num_pos=577, image_norm_eps=1e-05, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path=None, resize_mode='default', pad_value=0.0, normalize='openai'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-1,), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='resize', max_crops=1, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear', per_image_output_tokens=64), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'chart_qa': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=20, inf_evaluators=[InfDatasetEvaluatorConfig(label='chart_qa', data=DataLoaderConfig(dataset='chart_qa', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='relaxed_correctness,scifi_relaxed_correctness,em', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=16, console_log_interval=5, include_image=False)], inf_eval_interval=20, eval_on_last_step=True, eval_on_load=False, save_folder='debug_run', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint=None, allow_resume=True, max_duration=1000, global_train_batch_size=8, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=None, beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=5, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=1000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-15 18:28:52.841	g3084:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-15 18:28:55.116	g3084:0	root:123	INFO	Padding tokenizer with 416 tokens
2025-07-15 18:28:57.099	g3084:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-15 18:28:57.251	g3084:0	train:191	INFO	Total number of parameters: 58,006,016
2025-07-15 18:28:57.251	g3084:0	train:192	INFO	Number of non-embedding parameters: 38,525,440
2025-07-15 18:28:57.252	g3084:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 234
2025-07-15 18:28:57.253	g3084:0	train:196	INFO	Model:
2025-07-15 18:28:57.253	g3084:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0): FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=128, out_features=128, bias=True)
          (ff_out): Linear(in_features=256, out_features=128, bias=True)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): LayerNorm()
          (ff_norm): LayerNorm()
          (att_proj): Linear(in_features=128, out_features=384, bias=True)
          (ff_proj): Linear(in_features=128, out_features=512, bias=True)
        )
      )
    )
    (ln_f): FSDPLayerNorm()
    (emb_drop): Dropout(p=0.1, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=128, out_features=152192, bias=True)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=1024, out_features=1024, bias=True)
        (wk): Linear(in_features=1024, out_features=1024, bias=True)
        (wv): Linear(in_features=1024, out_features=1024, bias=True)
        (wo): Linear(in_features=1024, out_features=1024, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1024, out_features=256, bias=False)
        (w2): Linear(in_features=256, out_features=128, bias=False)
        (w3): Linear(in_features=1024, out_features=256, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1024, bias=False)
      (pre_ln): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0): FSDPResidualAttentionBlock(
            (attention): ViTMultiHeadDotProductAttention(
              (wq): Linear(in_features=1024, out_features=1024, bias=True)
              (wk): Linear(in_features=1024, out_features=1024, bias=True)
              (wv): Linear(in_features=1024, out_features=1024, bias=True)
              (wo): Linear(in_features=1024, out_features=1024, bias=True)
              (residual_dropout): Dropout(p=0.0, inplace=False)
            )
            (feed_forward): ViTMLP(
              (w1): Linear(in_features=1024, out_features=4096, bias=True)
              (act): GELUActivation()
              (w2): Linear(in_features=4096, out_features=1024, bias=True)
            )
            (attention_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (ffn_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=700, out_features=128, bias=False)
  (vision_decoder_head): Linear(in_features=128, out_features=700, bias=False)
)
2025-07-15 18:28:57.263	g3084:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-15 18:28:57.263	g3084:0	olmo.data.data_loader:197	INFO	Loading train dataset chart_qa/train
2025-07-15 18:28:57.264	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_human.json
2025-07-15 18:28:57.300	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_augmented.json
2025-07-15 18:28:57.404	g3084:0	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-15 18:28:57.405	g3084:0	olmo.data.data_loader:219	INFO	chart_qa: 100.00
2025-07-15 18:28:57.407	g3084:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=2304 images=1 pooled_patches_idx=158
2025-07-15 18:28:57.407	g3084:0	olmo.data.data_loader:100	INFO	Loading eval dataset: chart_qa/validation
2025-07-15 18:28:57.408	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_human.json
2025-07-15 18:28:57.414	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_augmented.json
2025-07-15 18:28:57.420	g3084:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=1792 images=1 pooled_patches_idx=158
2025-07-15 18:28:57.660	g3084:0	train:332	INFO	Starting training...
2025-07-15 18:28:57.661	g3084:0	olmo.train.trainer:817	INFO	Pre-train system metrics
    System/Peak GPU Memory (MB)=370.5
2025-07-15 18:29:01.219	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:29:05.762	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:29:06.355	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:29:06.775	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:29:07.196	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:29:07.609	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:29:07.899	g3084:0	olmo.train.trainer:817	INFO	[step=5/1000]
    train/CrossEntropyLoss=11.92
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0318
    train/Accuracy=0.0
    throughput/total_tokens=92,160
    throughput/device/tokens_per_second=47,358
    throughput/device/batches_per_second=2.569
2025-07-15 18:29:08.034	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:29:08.459	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:29:08.888	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:29:09.324	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:29:09.747	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:29:10.037	g3084:0	olmo.train.trainer:817	INFO	[step=10/1000]
    train/CrossEntropyLoss=11.91
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0305
    train/Accuracy=0.0
    throughput/total_tokens=184,320
    throughput/device/tokens_per_second=44,897
    throughput/device/batches_per_second=2.436
    System/Peak GPU Memory (MB)=29,214
2025-07-15 18:29:10.183	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:29:10.605	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:29:11.023	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:29:11.429	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:29:11.853	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:29:12.143	g3084:0	olmo.train.trainer:817	INFO	[step=15/1000]
    train/CrossEntropyLoss=11.90
    train/ZLoss=0.0143
    train/ImageGenLoss=0.7157
    train/Accuracy=0.0
    throughput/total_tokens=276,480
    throughput/device/tokens_per_second=44,484
    throughput/device/batches_per_second=2.413
2025-07-15 18:29:12.281	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:29:12.710	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:29:13.121	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:29:13.552	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:29:13.982	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:29:14.272	g3084:0	olmo.train.trainer:817	INFO	[step=20/1000]
    train/CrossEntropyLoss=11.84
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=368,640
    throughput/device/tokens_per_second=44,162
    throughput/device/batches_per_second=2.396
    System/Peak GPU Memory (MB)=29,214
2025-07-15 18:29:14.274	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 18:30:51.745	g3084:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-15 18:30:51.818	g3084:0	train:54	INFO	Configuration:
2025-07-15 18:30:51.819	g3084:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=128, n_heads=2, n_kv_heads=None, head_dim=None, qkv_bias=False, clip_qkv=None, n_layers=1, mlp_ratio=4, mlp_hidden_size=None, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=10000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='default', layer_norm_with_affine=True, layer_norm_eps=None, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=True, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.1, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=None, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2-7B', tokenizer_dir=None), init_path=None, init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='openai', image_default_input_size=(336, 336), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1024, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=1, image_head_dim=64, image_mlp_dim=4096, image_mlp_activations='gelu', image_dropout_rate=0.0, image_num_pos=577, image_norm_eps=1e-05, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path=None, resize_mode='default', pad_value=0.0, normalize='openai'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-1,), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='resize', max_crops=1, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear', per_image_output_tokens=64), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'chart_qa': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=20, inf_evaluators=[InfDatasetEvaluatorConfig(label='chart_qa', data=DataLoaderConfig(dataset='chart_qa', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='relaxed_correctness,scifi_relaxed_correctness,em', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=16, console_log_interval=5, include_image=False)], inf_eval_interval=20, eval_on_last_step=True, eval_on_load=False, save_folder='debug_run', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint=None, allow_resume=True, max_duration=1000, global_train_batch_size=8, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=None, beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=5, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=1000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-15 18:30:51.850	g3084:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-15 18:30:54.245	g3084:0	root:123	INFO	Padding tokenizer with 416 tokens
2025-07-15 18:30:56.272	g3084:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-15 18:30:56.426	g3084:0	train:191	INFO	Total number of parameters: 58,006,016
2025-07-15 18:30:56.427	g3084:0	train:192	INFO	Number of non-embedding parameters: 38,525,440
2025-07-15 18:30:56.428	g3084:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 234
2025-07-15 18:30:56.428	g3084:0	train:196	INFO	Model:
2025-07-15 18:30:56.428	g3084:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0): FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=128, out_features=128, bias=True)
          (ff_out): Linear(in_features=256, out_features=128, bias=True)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): LayerNorm()
          (ff_norm): LayerNorm()
          (att_proj): Linear(in_features=128, out_features=384, bias=True)
          (ff_proj): Linear(in_features=128, out_features=512, bias=True)
        )
      )
    )
    (ln_f): FSDPLayerNorm()
    (emb_drop): Dropout(p=0.1, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=128, out_features=152192, bias=True)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=1024, out_features=1024, bias=True)
        (wk): Linear(in_features=1024, out_features=1024, bias=True)
        (wv): Linear(in_features=1024, out_features=1024, bias=True)
        (wo): Linear(in_features=1024, out_features=1024, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1024, out_features=256, bias=False)
        (w2): Linear(in_features=256, out_features=128, bias=False)
        (w3): Linear(in_features=1024, out_features=256, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1024, bias=False)
      (pre_ln): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0): FSDPResidualAttentionBlock(
            (attention): ViTMultiHeadDotProductAttention(
              (wq): Linear(in_features=1024, out_features=1024, bias=True)
              (wk): Linear(in_features=1024, out_features=1024, bias=True)
              (wv): Linear(in_features=1024, out_features=1024, bias=True)
              (wo): Linear(in_features=1024, out_features=1024, bias=True)
              (residual_dropout): Dropout(p=0.0, inplace=False)
            )
            (feed_forward): ViTMLP(
              (w1): Linear(in_features=1024, out_features=4096, bias=True)
              (act): GELUActivation()
              (w2): Linear(in_features=4096, out_features=1024, bias=True)
            )
            (attention_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (ffn_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=700, out_features=128, bias=False)
  (vision_decoder_head): Linear(in_features=128, out_features=700, bias=False)
)
2025-07-15 18:30:56.438	g3084:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-15 18:30:56.439	g3084:0	olmo.data.data_loader:197	INFO	Loading train dataset chart_qa/train
2025-07-15 18:30:56.439	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_human.json
2025-07-15 18:30:56.475	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_augmented.json
2025-07-15 18:30:56.575	g3084:0	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-15 18:30:56.576	g3084:0	olmo.data.data_loader:219	INFO	chart_qa: 100.00
2025-07-15 18:30:56.578	g3084:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=2304 images=1 pooled_patches_idx=158
2025-07-15 18:30:56.579	g3084:0	olmo.data.data_loader:100	INFO	Loading eval dataset: chart_qa/validation
2025-07-15 18:30:56.579	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_human.json
2025-07-15 18:30:56.585	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_augmented.json
2025-07-15 18:30:56.590	g3084:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=1792 images=1 pooled_patches_idx=158
2025-07-15 18:30:56.836	g3084:0	train:332	INFO	Starting training...
2025-07-15 18:30:56.838	g3084:0	olmo.train.trainer:817	INFO	Pre-train system metrics
    System/Peak GPU Memory (MB)=370.5
2025-07-15 18:31:00.436	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:31:04.943	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:31:05.568	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:31:05.996	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:31:06.423	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:31:06.846	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:31:07.139	g3084:0	olmo.train.trainer:817	INFO	[step=5/1000]
    train/CrossEntropyLoss=11.92
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0318
    train/Accuracy=0.0
    throughput/total_tokens=92,160
    throughput/device/tokens_per_second=46,517
    throughput/device/batches_per_second=2.524
2025-07-15 18:31:07.273	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:31:07.707	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:31:08.136	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:31:08.581	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:31:09.012	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:31:09.304	g3084:0	olmo.train.trainer:817	INFO	[step=10/1000]
    train/CrossEntropyLoss=11.91
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0305
    train/Accuracy=0.0
    throughput/total_tokens=184,320
    throughput/device/tokens_per_second=44,235
    throughput/device/batches_per_second=2.400
    System/Peak GPU Memory (MB)=29,214
2025-07-15 18:31:09.452	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:31:09.885	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:31:10.308	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:31:10.720	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:31:11.144	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:31:11.435	g3084:0	olmo.train.trainer:817	INFO	[step=15/1000]
    train/CrossEntropyLoss=11.90
    train/ZLoss=0.0143
    train/ImageGenLoss=0.7157
    train/Accuracy=0.0
    throughput/total_tokens=276,480
    throughput/device/tokens_per_second=43,879
    throughput/device/batches_per_second=2.381
2025-07-15 18:31:11.576	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:31:12.013	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:31:12.430	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:31:12.866	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:31:13.307	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:31:13.601	g3084:0	olmo.train.trainer:817	INFO	[step=20/1000]
    train/CrossEntropyLoss=11.83
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=368,640
    throughput/device/tokens_per_second=43,524
    throughput/device/batches_per_second=2.361
    System/Peak GPU Memory (MB)=29,214
2025-07-15 18:31:13.602	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 18:31:14.922	g3084:0	olmo.util:177	CRITICAL	Uncaught NameError: name 'generated_states' is not defined
Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/Umolmo/launch_scripts/train_multitask_model.py", line 396, in <module>
    run_trainer(cfg)
  File "/gscratch/krishna/mahtab/Umolmo/scripts/train.py", line 333, in run_trainer
    trainer.fit()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 1146, in fit
    eval_metrics = self.inference_eval()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 865, in inference_eval
    dataset_metrics = evaluator.run(
  File "/gscratch/krishna/mahtab/Umolmo/olmo/eval/inf_evaluator.py", line 213, in run
    olmo_gen_output = model.generate(
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py", line 631, in generate
    if generated_states.sum() > 0:
NameError: name 'generated_states' is not defined. Did you mean: 'generation_states'?
2025-07-15 18:31:57.761	g3084:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-15 18:31:57.833	g3084:0	train:54	INFO	Configuration:
2025-07-15 18:31:57.833	g3084:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=128, n_heads=2, n_kv_heads=None, head_dim=None, qkv_bias=False, clip_qkv=None, n_layers=1, mlp_ratio=4, mlp_hidden_size=None, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=10000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='default', layer_norm_with_affine=True, layer_norm_eps=None, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=True, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.1, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=None, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2-7B', tokenizer_dir=None), init_path=None, init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='openai', image_default_input_size=(336, 336), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1024, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=1, image_head_dim=64, image_mlp_dim=4096, image_mlp_activations='gelu', image_dropout_rate=0.0, image_num_pos=577, image_norm_eps=1e-05, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path=None, resize_mode='default', pad_value=0.0, normalize='openai'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-1,), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='resize', max_crops=1, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear', per_image_output_tokens=64), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'chart_qa': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=20, inf_evaluators=[InfDatasetEvaluatorConfig(label='chart_qa', data=DataLoaderConfig(dataset='chart_qa', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='relaxed_correctness,scifi_relaxed_correctness,em', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=16, console_log_interval=5, include_image=False)], inf_eval_interval=20, eval_on_last_step=True, eval_on_load=False, save_folder='debug_run', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint=None, allow_resume=True, max_duration=1000, global_train_batch_size=8, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=None, beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=5, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=1000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-15 18:31:57.864	g3084:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-15 18:32:01.759	g3084:0	root:123	INFO	Padding tokenizer with 416 tokens
2025-07-15 18:32:03.907	g3084:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-15 18:32:04.049	g3084:0	train:191	INFO	Total number of parameters: 58,006,016
2025-07-15 18:32:04.050	g3084:0	train:192	INFO	Number of non-embedding parameters: 38,525,440
2025-07-15 18:32:04.051	g3084:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 234
2025-07-15 18:32:04.051	g3084:0	train:196	INFO	Model:
2025-07-15 18:32:04.051	g3084:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0): FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=128, out_features=128, bias=True)
          (ff_out): Linear(in_features=256, out_features=128, bias=True)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): LayerNorm()
          (ff_norm): LayerNorm()
          (att_proj): Linear(in_features=128, out_features=384, bias=True)
          (ff_proj): Linear(in_features=128, out_features=512, bias=True)
        )
      )
    )
    (ln_f): FSDPLayerNorm()
    (emb_drop): Dropout(p=0.1, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=128, out_features=152192, bias=True)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=1024, out_features=1024, bias=True)
        (wk): Linear(in_features=1024, out_features=1024, bias=True)
        (wv): Linear(in_features=1024, out_features=1024, bias=True)
        (wo): Linear(in_features=1024, out_features=1024, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1024, out_features=256, bias=False)
        (w2): Linear(in_features=256, out_features=128, bias=False)
        (w3): Linear(in_features=1024, out_features=256, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1024, bias=False)
      (pre_ln): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0): FSDPResidualAttentionBlock(
            (attention): ViTMultiHeadDotProductAttention(
              (wq): Linear(in_features=1024, out_features=1024, bias=True)
              (wk): Linear(in_features=1024, out_features=1024, bias=True)
              (wv): Linear(in_features=1024, out_features=1024, bias=True)
              (wo): Linear(in_features=1024, out_features=1024, bias=True)
              (residual_dropout): Dropout(p=0.0, inplace=False)
            )
            (feed_forward): ViTMLP(
              (w1): Linear(in_features=1024, out_features=4096, bias=True)
              (act): GELUActivation()
              (w2): Linear(in_features=4096, out_features=1024, bias=True)
            )
            (attention_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (ffn_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=700, out_features=128, bias=False)
  (vision_decoder_head): Linear(in_features=128, out_features=700, bias=False)
)
2025-07-15 18:32:04.061	g3084:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-15 18:32:04.062	g3084:0	olmo.data.data_loader:197	INFO	Loading train dataset chart_qa/train
2025-07-15 18:32:04.062	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_human.json
2025-07-15 18:32:04.095	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_augmented.json
2025-07-15 18:32:04.195	g3084:0	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-15 18:32:04.195	g3084:0	olmo.data.data_loader:219	INFO	chart_qa: 100.00
2025-07-15 18:32:04.197	g3084:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=2304 images=1 pooled_patches_idx=158
2025-07-15 18:32:04.198	g3084:0	olmo.data.data_loader:100	INFO	Loading eval dataset: chart_qa/validation
2025-07-15 18:32:04.198	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_human.json
2025-07-15 18:32:04.204	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_augmented.json
2025-07-15 18:32:04.208	g3084:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=1792 images=1 pooled_patches_idx=158
2025-07-15 18:32:04.437	g3084:0	train:332	INFO	Starting training...
2025-07-15 18:32:04.438	g3084:0	olmo.train.trainer:817	INFO	Pre-train system metrics
    System/Peak GPU Memory (MB)=370.5
2025-07-15 18:32:07.754	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:32:11.905	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:32:12.489	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:32:12.906	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:32:13.317	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:32:13.723	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:32:14.007	g3084:0	olmo.train.trainer:817	INFO	[step=5/1000]
    train/CrossEntropyLoss=11.92
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0318
    train/Accuracy=0.0
    throughput/total_tokens=92,160
    throughput/device/tokens_per_second=48,142
    throughput/device/batches_per_second=2.612
2025-07-15 18:32:14.133	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:32:14.550	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:32:14.962	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:32:15.388	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:32:15.804	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:32:16.088	g3084:0	olmo.train.trainer:817	INFO	[step=10/1000]
    train/CrossEntropyLoss=11.91
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0305
    train/Accuracy=0.0
    throughput/total_tokens=184,320
    throughput/device/tokens_per_second=45,926
    throughput/device/batches_per_second=2.492
    System/Peak GPU Memory (MB)=29,214
2025-07-15 18:32:16.226	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:32:16.645	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:32:17.050	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:32:17.450	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:32:17.859	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:32:18.145	g3084:0	olmo.train.trainer:817	INFO	[step=15/1000]
    train/CrossEntropyLoss=11.90
    train/ZLoss=0.0143
    train/ImageGenLoss=0.7157
    train/Accuracy=0.0
    throughput/total_tokens=276,480
    throughput/device/tokens_per_second=45,517
    throughput/device/batches_per_second=2.469
2025-07-15 18:32:18.276	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:32:18.695	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:32:19.096	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:32:19.517	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:32:19.937	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:32:20.229	g3084:0	olmo.train.trainer:817	INFO	[step=20/1000]
    train/CrossEntropyLoss=11.83
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=368,640
    throughput/device/tokens_per_second=45,171
    throughput/device/batches_per_second=2.451
    System/Peak GPU Memory (MB)=29,214
2025-07-15 18:32:20.231	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 18:32:22.233	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 18:32:22.547	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 18:32:22.548	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 2.3 seconds
2025-07-15 18:32:22.725	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:32:23.194	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:32:23.665	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:32:24.095	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:32:24.518	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:32:24.811	g3084:0	olmo.train.trainer:817	INFO	[step=25/1000]
    train/CrossEntropyLoss=11.86
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=460,800
    throughput/device/tokens_per_second=43,918
    throughput/device/batches_per_second=2.383
2025-07-15 18:32:24.969	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:32:25.426	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:32:25.942	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:32:26.424	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:32:26.872	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:32:27.165	g3084:0	olmo.train.trainer:817	INFO	[step=30/1000]
    train/CrossEntropyLoss=11.83
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=552,960
    throughput/device/tokens_per_second=41,401
    throughput/device/batches_per_second=2.246
    System/Peak GPU Memory (MB)=29,215
2025-07-15 18:32:27.336	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:32:27.761	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:32:28.205	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:32:28.630	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:32:29.094	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:32:29.388	g3084:0	olmo.train.trainer:817	INFO	[step=35/1000]
    train/CrossEntropyLoss=11.81
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=645,120
    throughput/device/tokens_per_second=41,417
    throughput/device/batches_per_second=2.247
2025-07-15 18:32:29.535	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:32:30.004	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:32:30.440	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:32:30.932	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:32:31.446	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:32:31.738	g3084:0	olmo.train.trainer:817	INFO	[step=40/1000]
    train/CrossEntropyLoss=11.83
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=737,280
    throughput/device/tokens_per_second=40,844
    throughput/device/batches_per_second=2.216
    System/Peak GPU Memory (MB)=29,215
2025-07-15 18:32:31.740	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 18:32:32.293	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 18:32:32.308	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 18:32:32.309	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 0.6 seconds
2025-07-15 18:32:32.506	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:32:32.945	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:32:33.405	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:32:33.917	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:32:34.373	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:32:34.664	g3084:0	olmo.train.trainer:817	INFO	[step=45/1000]
    train/CrossEntropyLoss=11.75
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=829,440
    throughput/device/tokens_per_second=42,446
    throughput/device/batches_per_second=2.303
2025-07-15 18:32:34.830	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:32:35.290	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:32:35.743	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:32:36.185	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:32:36.616	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:32:36.908	g3084:0	olmo.train.trainer:817	INFO	[step=50/1000]
    train/CrossEntropyLoss=11.68
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=921,600
    throughput/device/tokens_per_second=41,758
    throughput/device/batches_per_second=2.266
    System/Peak GPU Memory (MB)=29,215
2025-07-15 18:32:37.105	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:32:37.514	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:32:37.948	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:32:38.516	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:32:39.003	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:32:39.297	g3084:0	olmo.train.trainer:817	INFO	[step=55/1000]
    train/CrossEntropyLoss=11.67
    train/ZLoss=0.0143
    train/ImageGenLoss=1.999
    train/Accuracy=0.0
    throughput/total_tokens=1,013,760
    throughput/device/tokens_per_second=40,638
    throughput/device/batches_per_second=2.205
2025-07-15 18:32:39.453	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:32:39.889	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:32:40.377	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:32:40.807	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:32:41.253	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:32:41.546	g3084:0	olmo.train.trainer:817	INFO	[step=60/1000]
    train/CrossEntropyLoss=11.72
    train/ZLoss=0.0143
    train/ImageGenLoss=2.000
    train/Accuracy=0.0
    throughput/total_tokens=1,105,920
    throughput/device/tokens_per_second=40,725
    throughput/device/batches_per_second=2.209
    System/Peak GPU Memory (MB)=29,215
2025-07-15 18:32:41.547	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 18:32:42.132	g3084:0	olmo.util:177	CRITICAL	Uncaught AttributeError: 'FSDPMolmo' object has no attribute 'per_image_output_tokens'
Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/Umolmo/launch_scripts/train_multitask_model.py", line 396, in <module>
    run_trainer(cfg)
  File "/gscratch/krishna/mahtab/Umolmo/scripts/train.py", line 333, in run_trainer
    trainer.fit()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 1146, in fit
    eval_metrics = self.inference_eval()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 865, in inference_eval
    dataset_metrics = evaluator.run(
  File "/gscratch/krishna/mahtab/Umolmo/olmo/eval/inf_evaluator.py", line 213, in run
    olmo_gen_output = model.generate(
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py", line 698, in generate
    if generated[i].shape[0] - last_generation_start_idx[i] == self.per_image_output_tokens + 1:
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1940, in __getattr__
    raise AttributeError(
AttributeError: 'FSDPMolmo' object has no attribute 'per_image_output_tokens'. Did you mean: '_image_output_token_id'?
2025-07-15 18:33:48.183	g3084:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-15 18:33:48.258	g3084:0	train:54	INFO	Configuration:
2025-07-15 18:33:48.259	g3084:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=128, n_heads=2, n_kv_heads=None, head_dim=None, qkv_bias=False, clip_qkv=None, n_layers=1, mlp_ratio=4, mlp_hidden_size=None, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=10000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='default', layer_norm_with_affine=True, layer_norm_eps=None, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=True, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.1, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=None, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2-7B', tokenizer_dir=None), init_path=None, init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='openai', image_default_input_size=(336, 336), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1024, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=1, image_head_dim=64, image_mlp_dim=4096, image_mlp_activations='gelu', image_dropout_rate=0.0, image_num_pos=577, image_norm_eps=1e-05, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path=None, resize_mode='default', pad_value=0.0, normalize='openai'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-1,), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='resize', max_crops=1, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear', per_image_output_tokens=64), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'chart_qa': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=20, inf_evaluators=[InfDatasetEvaluatorConfig(label='chart_qa', data=DataLoaderConfig(dataset='chart_qa', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='relaxed_correctness,scifi_relaxed_correctness,em', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=16, console_log_interval=5, include_image=False)], inf_eval_interval=20, eval_on_last_step=True, eval_on_load=False, save_folder='debug_run', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint=None, allow_resume=True, max_duration=1000, global_train_batch_size=8, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=None, beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=5, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=1000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-15 18:33:48.290	g3084:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-15 18:33:50.831	g3084:0	root:123	INFO	Padding tokenizer with 416 tokens
2025-07-15 18:33:52.850	g3084:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-15 18:33:53.005	g3084:0	train:191	INFO	Total number of parameters: 58,006,016
2025-07-15 18:33:53.006	g3084:0	train:192	INFO	Number of non-embedding parameters: 38,525,440
2025-07-15 18:33:53.007	g3084:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 234
2025-07-15 18:33:53.007	g3084:0	train:196	INFO	Model:
2025-07-15 18:33:53.007	g3084:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0): FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=128, out_features=128, bias=True)
          (ff_out): Linear(in_features=256, out_features=128, bias=True)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): LayerNorm()
          (ff_norm): LayerNorm()
          (att_proj): Linear(in_features=128, out_features=384, bias=True)
          (ff_proj): Linear(in_features=128, out_features=512, bias=True)
        )
      )
    )
    (ln_f): FSDPLayerNorm()
    (emb_drop): Dropout(p=0.1, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=128, out_features=152192, bias=True)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=1024, out_features=1024, bias=True)
        (wk): Linear(in_features=1024, out_features=1024, bias=True)
        (wv): Linear(in_features=1024, out_features=1024, bias=True)
        (wo): Linear(in_features=1024, out_features=1024, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1024, out_features=256, bias=False)
        (w2): Linear(in_features=256, out_features=128, bias=False)
        (w3): Linear(in_features=1024, out_features=256, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1024, bias=False)
      (pre_ln): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0): FSDPResidualAttentionBlock(
            (attention): ViTMultiHeadDotProductAttention(
              (wq): Linear(in_features=1024, out_features=1024, bias=True)
              (wk): Linear(in_features=1024, out_features=1024, bias=True)
              (wv): Linear(in_features=1024, out_features=1024, bias=True)
              (wo): Linear(in_features=1024, out_features=1024, bias=True)
              (residual_dropout): Dropout(p=0.0, inplace=False)
            )
            (feed_forward): ViTMLP(
              (w1): Linear(in_features=1024, out_features=4096, bias=True)
              (act): GELUActivation()
              (w2): Linear(in_features=4096, out_features=1024, bias=True)
            )
            (attention_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (ffn_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=700, out_features=128, bias=False)
  (vision_decoder_head): Linear(in_features=128, out_features=700, bias=False)
)
2025-07-15 18:33:53.017	g3084:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-15 18:33:53.018	g3084:0	olmo.data.data_loader:197	INFO	Loading train dataset chart_qa/train
2025-07-15 18:33:53.018	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_human.json
2025-07-15 18:33:53.053	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_augmented.json
2025-07-15 18:33:53.153	g3084:0	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-15 18:33:53.154	g3084:0	olmo.data.data_loader:219	INFO	chart_qa: 100.00
2025-07-15 18:33:53.156	g3084:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=2304 images=1 pooled_patches_idx=158
2025-07-15 18:33:53.156	g3084:0	olmo.data.data_loader:100	INFO	Loading eval dataset: chart_qa/validation
2025-07-15 18:33:53.157	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_human.json
2025-07-15 18:33:53.163	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_augmented.json
2025-07-15 18:33:53.168	g3084:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=1792 images=1 pooled_patches_idx=158
2025-07-15 18:33:53.413	g3084:0	train:332	INFO	Starting training...
2025-07-15 18:33:53.414	g3084:0	olmo.train.trainer:817	INFO	Pre-train system metrics
    System/Peak GPU Memory (MB)=370.5
2025-07-15 18:33:56.990	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:34:01.464	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:34:02.096	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:34:02.531	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:34:02.960	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:34:03.385	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:34:03.681	g3084:0	olmo.train.trainer:817	INFO	[step=5/1000]
    train/CrossEntropyLoss=11.92
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0318
    train/Accuracy=0.0
    throughput/total_tokens=92,160
    throughput/device/tokens_per_second=46,115
    throughput/device/batches_per_second=2.502
2025-07-15 18:34:03.815	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:34:04.248	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:34:04.674	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:34:05.116	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:34:05.547	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:34:05.839	g3084:0	olmo.train.trainer:817	INFO	[step=10/1000]
    train/CrossEntropyLoss=11.91
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0305
    train/Accuracy=0.0
    throughput/total_tokens=184,320
    throughput/device/tokens_per_second=44,161
    throughput/device/batches_per_second=2.396
    System/Peak GPU Memory (MB)=29,214
2025-07-15 18:34:05.988	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:34:06.417	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:34:06.842	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:34:07.259	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:34:07.682	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:34:07.973	g3084:0	olmo.train.trainer:817	INFO	[step=15/1000]
    train/CrossEntropyLoss=11.90
    train/ZLoss=0.0143
    train/ImageGenLoss=0.7157
    train/Accuracy=0.0
    throughput/total_tokens=276,480
    throughput/device/tokens_per_second=43,801
    throughput/device/batches_per_second=2.376
2025-07-15 18:34:08.113	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:34:08.547	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:34:08.963	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:34:09.393	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:34:09.824	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:34:10.116	g3084:0	olmo.train.trainer:817	INFO	[step=20/1000]
    train/CrossEntropyLoss=11.83
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=368,640
    throughput/device/tokens_per_second=43,593
    throughput/device/batches_per_second=2.365
    System/Peak GPU Memory (MB)=29,214
2025-07-15 18:34:10.118	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 18:34:11.717	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 18:34:11.734	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 18:34:11.735	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 1.6 seconds
2025-07-15 18:34:11.906	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:34:12.321	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:34:12.753	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:34:13.183	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:34:13.605	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:34:13.898	g3084:0	olmo.train.trainer:817	INFO	[step=25/1000]
    train/CrossEntropyLoss=11.86
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=460,800
    throughput/device/tokens_per_second=45,953
    throughput/device/batches_per_second=2.493
2025-07-15 18:34:14.045	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:34:14.480	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:34:14.928	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:34:15.372	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:34:15.811	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:34:16.104	g3084:0	olmo.train.trainer:817	INFO	[step=30/1000]
    train/CrossEntropyLoss=11.83
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=552,960
    throughput/device/tokens_per_second=43,776
    throughput/device/batches_per_second=2.375
    System/Peak GPU Memory (MB)=29,215
2025-07-15 18:34:16.247	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:34:16.673	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:34:17.103	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:34:17.529	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:34:17.964	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:34:18.255	g3084:0	olmo.train.trainer:817	INFO	[step=35/1000]
    train/CrossEntropyLoss=11.81
    train/ZLoss=0.0143
    train/ImageGenLoss=2.000
    train/Accuracy=0.0
    throughput/total_tokens=645,120
    throughput/device/tokens_per_second=43,458
    throughput/device/batches_per_second=2.358
2025-07-15 18:34:18.399	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:34:18.829	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:34:19.261	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:34:19.693	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:34:20.127	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:34:20.419	g3084:0	olmo.train.trainer:817	INFO	[step=40/1000]
    train/CrossEntropyLoss=11.83
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=737,280
    throughput/device/tokens_per_second=43,241
    throughput/device/batches_per_second=2.346
    System/Peak GPU Memory (MB)=29,215
2025-07-15 18:34:20.420	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 18:34:20.962	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 18:34:20.977	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 18:34:20.978	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 0.6 seconds
2025-07-15 18:34:21.127	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:34:21.558	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:34:22.006	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:34:22.449	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:34:22.881	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:34:23.173	g3084:0	olmo.train.trainer:817	INFO	[step=45/1000]
    train/CrossEntropyLoss=11.75
    train/ZLoss=0.0143
    train/ImageGenLoss=2.000
    train/Accuracy=0.0
    throughput/total_tokens=829,440
    throughput/device/tokens_per_second=44,766
    throughput/device/batches_per_second=2.429
2025-07-15 18:34:23.330	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:34:23.762	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:34:24.190	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:34:24.634	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:34:25.069	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:34:25.362	g3084:0	olmo.train.trainer:817	INFO	[step=50/1000]
    train/CrossEntropyLoss=11.68
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=921,600
    throughput/device/tokens_per_second=43,392
    throughput/device/batches_per_second=2.354
    System/Peak GPU Memory (MB)=29,215
2025-07-15 18:34:25.512	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:34:25.931	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:34:26.368	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:34:26.821	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:34:27.251	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:34:27.544	g3084:0	olmo.train.trainer:817	INFO	[step=55/1000]
    train/CrossEntropyLoss=11.67
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=1,013,760
    throughput/device/tokens_per_second=43,003
    throughput/device/batches_per_second=2.333
2025-07-15 18:34:27.691	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:34:28.125	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:34:28.564	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:34:28.979	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:34:29.399	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:34:29.693	g3084:0	olmo.train.trainer:817	INFO	[step=60/1000]
    train/CrossEntropyLoss=11.72
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=1,105,920
    throughput/device/tokens_per_second=42,972
    throughput/device/batches_per_second=2.331
    System/Peak GPU Memory (MB)=29,215
2025-07-15 18:34:29.695	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 18:47:48.240	g3084:0	olmo.util:177	CRITICAL	Uncaught BdbQuit: 
Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/Umolmo/launch_scripts/train_multitask_model.py", line 396, in <module>
    run_trainer(cfg)
  File "/gscratch/krishna/mahtab/Umolmo/scripts/train.py", line 333, in run_trainer
    trainer.fit()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 1146, in fit
    eval_metrics = self.inference_eval()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 865, in inference_eval
    dataset_metrics = evaluator.run(
  File "/gscratch/krishna/mahtab/Umolmo/olmo/eval/inf_evaluator.py", line 213, in run
    olmo_gen_output = model.generate(
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py", line 633, in generate
    input_embeddings = []
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py", line 633, in generate
    input_embeddings = []
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/bdb.py", line 90, in trace_dispatch
    return self.dispatch_line(frame)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/bdb.py", line 115, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit
2025-07-15 18:50:39.905	g3084:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-15 18:50:39.979	g3084:0	train:54	INFO	Configuration:
2025-07-15 18:50:39.980	g3084:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=128, n_heads=2, n_kv_heads=None, head_dim=None, qkv_bias=False, clip_qkv=None, n_layers=1, mlp_ratio=4, mlp_hidden_size=None, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=10000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='default', layer_norm_with_affine=True, layer_norm_eps=None, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=True, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.1, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=None, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2-7B', tokenizer_dir=None), init_path=None, init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='openai', image_default_input_size=(336, 336), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1024, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=1, image_head_dim=64, image_mlp_dim=4096, image_mlp_activations='gelu', image_dropout_rate=0.0, image_num_pos=577, image_norm_eps=1e-05, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path=None, resize_mode='default', pad_value=0.0, normalize='openai'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-1,), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='resize', max_crops=1, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear', per_image_output_tokens=64), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'chart_qa': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=20, inf_evaluators=[InfDatasetEvaluatorConfig(label='chart_qa', data=DataLoaderConfig(dataset='chart_qa', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='relaxed_correctness,scifi_relaxed_correctness,em', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=16, console_log_interval=5, include_image=False)], inf_eval_interval=20, eval_on_last_step=True, eval_on_load=False, save_folder='debug_run', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint=None, allow_resume=True, max_duration=1000, global_train_batch_size=8, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=None, beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=5, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=1000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-15 18:50:40.015	g3084:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-15 18:50:42.410	g3084:0	root:123	INFO	Padding tokenizer with 416 tokens
2025-07-15 18:50:44.538	g3084:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-15 18:50:44.690	g3084:0	train:191	INFO	Total number of parameters: 58,006,016
2025-07-15 18:50:44.691	g3084:0	train:192	INFO	Number of non-embedding parameters: 38,525,440
2025-07-15 18:50:44.692	g3084:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 234
2025-07-15 18:50:44.692	g3084:0	train:196	INFO	Model:
2025-07-15 18:50:44.693	g3084:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0): FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=128, out_features=128, bias=True)
          (ff_out): Linear(in_features=256, out_features=128, bias=True)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): LayerNorm()
          (ff_norm): LayerNorm()
          (att_proj): Linear(in_features=128, out_features=384, bias=True)
          (ff_proj): Linear(in_features=128, out_features=512, bias=True)
        )
      )
    )
    (ln_f): FSDPLayerNorm()
    (emb_drop): Dropout(p=0.1, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=128, out_features=152192, bias=True)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=1024, out_features=1024, bias=True)
        (wk): Linear(in_features=1024, out_features=1024, bias=True)
        (wv): Linear(in_features=1024, out_features=1024, bias=True)
        (wo): Linear(in_features=1024, out_features=1024, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1024, out_features=256, bias=False)
        (w2): Linear(in_features=256, out_features=128, bias=False)
        (w3): Linear(in_features=1024, out_features=256, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1024, bias=False)
      (pre_ln): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0): FSDPResidualAttentionBlock(
            (attention): ViTMultiHeadDotProductAttention(
              (wq): Linear(in_features=1024, out_features=1024, bias=True)
              (wk): Linear(in_features=1024, out_features=1024, bias=True)
              (wv): Linear(in_features=1024, out_features=1024, bias=True)
              (wo): Linear(in_features=1024, out_features=1024, bias=True)
              (residual_dropout): Dropout(p=0.0, inplace=False)
            )
            (feed_forward): ViTMLP(
              (w1): Linear(in_features=1024, out_features=4096, bias=True)
              (act): GELUActivation()
              (w2): Linear(in_features=4096, out_features=1024, bias=True)
            )
            (attention_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (ffn_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=700, out_features=128, bias=False)
  (vision_decoder_head): Linear(in_features=128, out_features=700, bias=False)
)
2025-07-15 18:50:44.703	g3084:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-15 18:50:44.703	g3084:0	olmo.data.data_loader:197	INFO	Loading train dataset chart_qa/train
2025-07-15 18:50:44.704	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_human.json
2025-07-15 18:50:44.739	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_augmented.json
2025-07-15 18:50:44.839	g3084:0	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-15 18:50:44.840	g3084:0	olmo.data.data_loader:219	INFO	chart_qa: 100.00
2025-07-15 18:50:44.841	g3084:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=2304 images=1 pooled_patches_idx=158
2025-07-15 18:50:44.842	g3084:0	olmo.data.data_loader:100	INFO	Loading eval dataset: chart_qa/validation
2025-07-15 18:50:44.843	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_human.json
2025-07-15 18:50:44.849	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_augmented.json
2025-07-15 18:50:44.874	g3084:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=1792 images=1 pooled_patches_idx=158
2025-07-15 18:50:45.112	g3084:0	train:332	INFO	Starting training...
2025-07-15 18:50:45.114	g3084:0	olmo.train.trainer:817	INFO	Pre-train system metrics
    System/Peak GPU Memory (MB)=370.5
2025-07-15 18:50:48.640	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:50:53.081	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:50:53.718	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:50:54.150	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:50:54.578	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:50:55.001	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:50:55.293	g3084:0	olmo.train.trainer:817	INFO	[step=5/1000]
    train/CrossEntropyLoss=11.92
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0318
    train/Accuracy=0.0
    throughput/total_tokens=92,160
    throughput/device/tokens_per_second=46,404
    throughput/device/batches_per_second=2.518
2025-07-15 18:50:55.429	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:50:55.864	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:50:56.293	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:50:56.735	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:50:57.165	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:50:57.456	g3084:0	olmo.train.trainer:817	INFO	[step=10/1000]
    train/CrossEntropyLoss=11.91
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0305
    train/Accuracy=0.0
    throughput/total_tokens=184,320
    throughput/device/tokens_per_second=44,219
    throughput/device/batches_per_second=2.399
    System/Peak GPU Memory (MB)=29,214
2025-07-15 18:50:57.606	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:50:58.039	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:50:58.464	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:50:58.876	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:50:59.300	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:50:59.591	g3084:0	olmo.train.trainer:817	INFO	[step=15/1000]
    train/CrossEntropyLoss=11.90
    train/ZLoss=0.0143
    train/ImageGenLoss=0.7157
    train/Accuracy=0.0
    throughput/total_tokens=276,480
    throughput/device/tokens_per_second=43,836
    throughput/device/batches_per_second=2.378
2025-07-15 18:50:59.732	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:51:00.168	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:51:00.585	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:51:01.015	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:51:01.450	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:51:01.748	g3084:0	olmo.train.trainer:817	INFO	[step=20/1000]
    train/CrossEntropyLoss=11.83
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=368,640
    throughput/device/tokens_per_second=43,540
    throughput/device/batches_per_second=2.362
    System/Peak GPU Memory (MB)=29,214
2025-07-15 18:51:01.750	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 18:51:07.317	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 18:51:07.334	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 18:51:07.335	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 5.6 seconds
2025-07-15 18:51:07.531	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:51:07.948	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:51:08.380	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:51:08.808	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:51:09.229	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:51:09.521	g3084:0	olmo.train.trainer:817	INFO	[step=25/1000]
    train/CrossEntropyLoss=11.86
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=460,800
    throughput/device/tokens_per_second=46,013
    throughput/device/batches_per_second=2.496
2025-07-15 18:51:09.667	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:51:10.101	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:51:10.546	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:51:10.984	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:51:11.421	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:51:11.713	g3084:0	olmo.train.trainer:817	INFO	[step=30/1000]
    train/CrossEntropyLoss=11.83
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=552,960
    throughput/device/tokens_per_second=43,943
    throughput/device/batches_per_second=2.384
    System/Peak GPU Memory (MB)=29,215
2025-07-15 18:51:11.856	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:51:12.279	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:51:12.705	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:51:13.127	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:51:13.556	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:51:13.848	g3084:0	olmo.train.trainer:817	INFO	[step=35/1000]
    train/CrossEntropyLoss=11.81
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=645,120
    throughput/device/tokens_per_second=43,680
    throughput/device/batches_per_second=2.370
2025-07-15 18:51:13.989	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:51:14.418	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:51:14.847	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:51:15.301	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:51:15.732	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:51:16.023	g3084:0	olmo.train.trainer:817	INFO	[step=40/1000]
    train/CrossEntropyLoss=11.83
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=737,280
    throughput/device/tokens_per_second=43,344
    throughput/device/batches_per_second=2.352
    System/Peak GPU Memory (MB)=29,215
2025-07-15 18:51:16.025	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 18:51:20.280	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 18:51:20.295	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 18:51:20.296	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 4.3 seconds
2025-07-15 18:51:20.478	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:51:20.907	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:51:21.355	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:51:21.782	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:51:22.208	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:51:22.499	g3084:0	olmo.train.trainer:817	INFO	[step=45/1000]
    train/CrossEntropyLoss=11.75
    train/ZLoss=0.0143
    train/ImageGenLoss=2.000
    train/Accuracy=0.0
    throughput/total_tokens=829,440
    throughput/device/tokens_per_second=45,317
    throughput/device/batches_per_second=2.459
2025-07-15 18:51:22.729	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:51:23.154	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:51:23.577	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:51:24.019	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:51:24.446	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:51:24.737	g3084:0	olmo.train.trainer:817	INFO	[step=50/1000]
    train/CrossEntropyLoss=11.68
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=921,600
    throughput/device/tokens_per_second=43,154
    throughput/device/batches_per_second=2.341
    System/Peak GPU Memory (MB)=29,215
2025-07-15 18:51:24.882	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:51:25.290	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:51:25.721	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:51:26.172	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:51:26.594	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:51:26.884	g3084:0	olmo.train.trainer:817	INFO	[step=55/1000]
    train/CrossEntropyLoss=11.67
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=1,013,760
    throughput/device/tokens_per_second=43,077
    throughput/device/batches_per_second=2.337
2025-07-15 18:51:27.031	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:51:27.457	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:51:27.889	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:51:28.295	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:51:28.729	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:51:29.021	g3084:0	olmo.train.trainer:817	INFO	[step=60/1000]
    train/CrossEntropyLoss=11.72
    train/ZLoss=0.0143
    train/ImageGenLoss=2.000
    train/Accuracy=0.0
    throughput/total_tokens=1,105,920
    throughput/device/tokens_per_second=43,090
    throughput/device/batches_per_second=2.338
    System/Peak GPU Memory (MB)=29,215
2025-07-15 18:51:29.022	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 18:51:58.857	g3084:0	olmo.util:177	CRITICAL	Uncaught RuntimeError: stack expects each tensor to be equal size, but got [1, 1, 128] at entry 0 and [1, 128] at entry 1
Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/Umolmo/launch_scripts/train_multitask_model.py", line 396, in <module>
    run_trainer(cfg)
  File "/gscratch/krishna/mahtab/Umolmo/scripts/train.py", line 333, in run_trainer
    trainer.fit()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 1146, in fit
    eval_metrics = self.inference_eval()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 865, in inference_eval
    dataset_metrics = evaluator.run(
  File "/gscratch/krishna/mahtab/Umolmo/olmo/eval/inf_evaluator.py", line 213, in run
    olmo_gen_output = model.generate(
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py", line 651, in generate
    input_embeddings = torch.stack(input_embeddings, dim=0)
RuntimeError: stack expects each tensor to be equal size, but got [1, 1, 128] at entry 0 and [1, 128] at entry 1
2025-07-15 18:52:44.279	g3084:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-15 18:52:44.356	g3084:0	train:54	INFO	Configuration:
2025-07-15 18:52:44.356	g3084:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=128, n_heads=2, n_kv_heads=None, head_dim=None, qkv_bias=False, clip_qkv=None, n_layers=1, mlp_ratio=4, mlp_hidden_size=None, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=10000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='default', layer_norm_with_affine=True, layer_norm_eps=None, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=True, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.1, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=None, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2-7B', tokenizer_dir=None), init_path=None, init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='openai', image_default_input_size=(336, 336), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1024, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=1, image_head_dim=64, image_mlp_dim=4096, image_mlp_activations='gelu', image_dropout_rate=0.0, image_num_pos=577, image_norm_eps=1e-05, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path=None, resize_mode='default', pad_value=0.0, normalize='openai'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-1,), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='resize', max_crops=1, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear', per_image_output_tokens=64), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'chart_qa': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=20, inf_evaluators=[InfDatasetEvaluatorConfig(label='chart_qa', data=DataLoaderConfig(dataset='chart_qa', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='relaxed_correctness,scifi_relaxed_correctness,em', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=16, console_log_interval=5, include_image=False)], inf_eval_interval=20, eval_on_last_step=True, eval_on_load=False, save_folder='debug_run', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint=None, allow_resume=True, max_duration=1000, global_train_batch_size=8, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=None, beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=5, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=1000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-15 18:52:44.387	g3084:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-15 18:52:46.629	g3084:0	root:123	INFO	Padding tokenizer with 416 tokens
2025-07-15 18:52:48.629	g3084:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-15 18:52:48.781	g3084:0	train:191	INFO	Total number of parameters: 58,006,016
2025-07-15 18:52:48.782	g3084:0	train:192	INFO	Number of non-embedding parameters: 38,525,440
2025-07-15 18:52:48.783	g3084:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 234
2025-07-15 18:52:48.783	g3084:0	train:196	INFO	Model:
2025-07-15 18:52:48.783	g3084:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0): FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=128, out_features=128, bias=True)
          (ff_out): Linear(in_features=256, out_features=128, bias=True)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): LayerNorm()
          (ff_norm): LayerNorm()
          (att_proj): Linear(in_features=128, out_features=384, bias=True)
          (ff_proj): Linear(in_features=128, out_features=512, bias=True)
        )
      )
    )
    (ln_f): FSDPLayerNorm()
    (emb_drop): Dropout(p=0.1, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=128, out_features=152192, bias=True)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=1024, out_features=1024, bias=True)
        (wk): Linear(in_features=1024, out_features=1024, bias=True)
        (wv): Linear(in_features=1024, out_features=1024, bias=True)
        (wo): Linear(in_features=1024, out_features=1024, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1024, out_features=256, bias=False)
        (w2): Linear(in_features=256, out_features=128, bias=False)
        (w3): Linear(in_features=1024, out_features=256, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1024, bias=False)
      (pre_ln): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0): FSDPResidualAttentionBlock(
            (attention): ViTMultiHeadDotProductAttention(
              (wq): Linear(in_features=1024, out_features=1024, bias=True)
              (wk): Linear(in_features=1024, out_features=1024, bias=True)
              (wv): Linear(in_features=1024, out_features=1024, bias=True)
              (wo): Linear(in_features=1024, out_features=1024, bias=True)
              (residual_dropout): Dropout(p=0.0, inplace=False)
            )
            (feed_forward): ViTMLP(
              (w1): Linear(in_features=1024, out_features=4096, bias=True)
              (act): GELUActivation()
              (w2): Linear(in_features=4096, out_features=1024, bias=True)
            )
            (attention_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (ffn_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=700, out_features=128, bias=False)
  (vision_decoder_head): Linear(in_features=128, out_features=700, bias=False)
)
2025-07-15 18:52:48.793	g3084:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-15 18:52:48.794	g3084:0	olmo.data.data_loader:197	INFO	Loading train dataset chart_qa/train
2025-07-15 18:52:48.794	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_human.json
2025-07-15 18:52:48.830	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_augmented.json
2025-07-15 18:52:48.932	g3084:0	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-15 18:52:48.933	g3084:0	olmo.data.data_loader:219	INFO	chart_qa: 100.00
2025-07-15 18:52:48.934	g3084:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=2304 images=1 pooled_patches_idx=158
2025-07-15 18:52:48.935	g3084:0	olmo.data.data_loader:100	INFO	Loading eval dataset: chart_qa/validation
2025-07-15 18:52:48.935	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_human.json
2025-07-15 18:52:48.942	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_augmented.json
2025-07-15 18:52:48.947	g3084:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=1792 images=1 pooled_patches_idx=158
2025-07-15 18:52:49.188	g3084:0	train:332	INFO	Starting training...
2025-07-15 18:52:49.190	g3084:0	olmo.train.trainer:817	INFO	Pre-train system metrics
    System/Peak GPU Memory (MB)=370.5
2025-07-15 18:52:52.928	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:52:57.363	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:52:57.978	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:52:58.402	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:52:58.824	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:52:59.243	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:52:59.534	g3084:0	olmo.train.trainer:817	INFO	[step=5/1000]
    train/CrossEntropyLoss=11.92
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0318
    train/Accuracy=0.0
    throughput/total_tokens=92,160
    throughput/device/tokens_per_second=46,958
    throughput/device/batches_per_second=2.548
2025-07-15 18:52:59.670	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:53:00.100	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:53:00.523	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:53:00.964	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:53:01.398	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:53:01.690	g3084:0	olmo.train.trainer:817	INFO	[step=10/1000]
    train/CrossEntropyLoss=11.91
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0305
    train/Accuracy=0.0
    throughput/total_tokens=184,320
    throughput/device/tokens_per_second=44,522
    throughput/device/batches_per_second=2.416
    System/Peak GPU Memory (MB)=29,214
2025-07-15 18:53:01.843	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:53:02.275	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:53:02.716	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:53:03.132	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:53:03.555	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:53:03.846	g3084:0	olmo.train.trainer:817	INFO	[step=15/1000]
    train/CrossEntropyLoss=11.90
    train/ZLoss=0.0143
    train/ImageGenLoss=0.7157
    train/Accuracy=0.0
    throughput/total_tokens=276,480
    throughput/device/tokens_per_second=43,871
    throughput/device/batches_per_second=2.380
2025-07-15 18:53:04.007	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:53:04.441	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:53:04.858	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:53:05.289	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:53:05.744	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:53:06.036	g3084:0	olmo.train.trainer:817	INFO	[step=20/1000]
    train/CrossEntropyLoss=11.84
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=368,640
    throughput/device/tokens_per_second=43,389
    throughput/device/batches_per_second=2.354
    System/Peak GPU Memory (MB)=29,214
2025-07-15 18:53:06.037	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 18:53:11.352	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 18:53:11.369	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 18:53:11.369	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 5.3 seconds
2025-07-15 18:53:11.551	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:53:11.968	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:53:12.395	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:53:12.825	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:53:13.243	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:53:13.532	g3084:0	olmo.train.trainer:817	INFO	[step=25/1000]
    train/CrossEntropyLoss=11.86
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=460,800
    throughput/device/tokens_per_second=46,211
    throughput/device/batches_per_second=2.507
2025-07-15 18:53:13.683	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:53:14.113	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:53:14.556	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:53:14.995	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:53:15.431	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:53:15.723	g3084:0	olmo.train.trainer:817	INFO	[step=30/1000]
    train/CrossEntropyLoss=11.83
    train/ZLoss=0.0143
    train/ImageGenLoss=2.000
    train/Accuracy=0.0
    throughput/total_tokens=552,960
    throughput/device/tokens_per_second=44,051
    throughput/device/batches_per_second=2.390
    System/Peak GPU Memory (MB)=29,215
2025-07-15 18:53:15.868	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:53:16.291	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:53:16.719	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:53:17.142	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:53:17.572	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:53:17.864	g3084:0	olmo.train.trainer:817	INFO	[step=35/1000]
    train/CrossEntropyLoss=11.81
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=645,120
    throughput/device/tokens_per_second=43,704
    throughput/device/batches_per_second=2.371
2025-07-15 18:53:18.007	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:53:18.438	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:53:18.871	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:53:19.304	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:53:19.738	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:53:20.031	g3084:0	olmo.train.trainer:817	INFO	[step=40/1000]
    train/CrossEntropyLoss=11.83
    train/ZLoss=0.0143
    train/ImageGenLoss=2.000
    train/Accuracy=0.0
    throughput/total_tokens=737,280
    throughput/device/tokens_per_second=43,409
    throughput/device/batches_per_second=2.355
    System/Peak GPU Memory (MB)=29,215
2025-07-15 18:53:20.032	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 18:53:24.420	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 18:53:24.436	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 18:53:24.436	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 4.4 seconds
2025-07-15 18:53:24.638	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:53:25.073	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:53:25.524	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:53:25.960	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:53:26.391	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:53:26.683	g3084:0	olmo.train.trainer:817	INFO	[step=45/1000]
    train/CrossEntropyLoss=11.75
    train/ZLoss=0.0143
    train/ImageGenLoss=2.000
    train/Accuracy=0.0
    throughput/total_tokens=829,440
    throughput/device/tokens_per_second=44,764
    throughput/device/batches_per_second=2.429
2025-07-15 18:53:26.840	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:53:27.267	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:53:27.695	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:53:28.134	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:53:28.566	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:53:28.862	g3084:0	olmo.train.trainer:817	INFO	[step=50/1000]
    train/CrossEntropyLoss=11.68
    train/ZLoss=0.0143
    train/ImageGenLoss=1.999
    train/Accuracy=0.0
    throughput/total_tokens=921,600
    throughput/device/tokens_per_second=43,507
    throughput/device/batches_per_second=2.360
    System/Peak GPU Memory (MB)=29,215
2025-07-15 18:53:29.018	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:53:29.434	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:53:29.878	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:53:30.332	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:53:30.768	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:53:31.063	g3084:0	olmo.train.trainer:817	INFO	[step=55/1000]
    train/CrossEntropyLoss=11.67
    train/ZLoss=0.0143
    train/ImageGenLoss=2.000
    train/Accuracy=0.0
    throughput/total_tokens=1,013,760
    throughput/device/tokens_per_second=42,941
    throughput/device/batches_per_second=2.330
2025-07-15 18:53:31.251	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:53:31.685	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:53:32.122	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:53:32.534	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:53:32.949	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:53:33.241	g3084:0	olmo.train.trainer:817	INFO	[step=60/1000]
    train/CrossEntropyLoss=11.72
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=1,105,920
    throughput/device/tokens_per_second=42,783
    throughput/device/batches_per_second=2.321
    System/Peak GPU Memory (MB)=29,215
2025-07-15 18:53:33.243	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 18:54:45.915	g3084:0	olmo.util:177	CRITICAL	Uncaught BdbQuit: 
Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/Umolmo/launch_scripts/train_multitask_model.py", line 396, in <module>
    run_trainer(cfg)
  File "/gscratch/krishna/mahtab/Umolmo/scripts/train.py", line 333, in run_trainer
    trainer.fit()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 1146, in fit
    eval_metrics = self.inference_eval()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 865, in inference_eval
    dataset_metrics = evaluator.run(
  File "/gscratch/krishna/mahtab/Umolmo/olmo/eval/inf_evaluator.py", line 213, in run
    olmo_gen_output = model.generate(
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py", line 639, in generate
    for i in range(batch_size):
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py", line 639, in generate
    for i in range(batch_size):
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/bdb.py", line 90, in trace_dispatch
    return self.dispatch_line(frame)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/bdb.py", line 115, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit
2025-07-15 18:55:37.673	g3084:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-15 18:55:37.746	g3084:0	train:54	INFO	Configuration:
2025-07-15 18:55:37.747	g3084:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=128, n_heads=2, n_kv_heads=None, head_dim=None, qkv_bias=False, clip_qkv=None, n_layers=1, mlp_ratio=4, mlp_hidden_size=None, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=10000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='default', layer_norm_with_affine=True, layer_norm_eps=None, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=True, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.1, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=None, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2-7B', tokenizer_dir=None), init_path=None, init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='openai', image_default_input_size=(336, 336), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1024, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=1, image_head_dim=64, image_mlp_dim=4096, image_mlp_activations='gelu', image_dropout_rate=0.0, image_num_pos=577, image_norm_eps=1e-05, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path=None, resize_mode='default', pad_value=0.0, normalize='openai'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-1,), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='resize', max_crops=1, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear', per_image_output_tokens=64), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'chart_qa': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=20, inf_evaluators=[InfDatasetEvaluatorConfig(label='chart_qa', data=DataLoaderConfig(dataset='chart_qa', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='relaxed_correctness,scifi_relaxed_correctness,em', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=16, console_log_interval=5, include_image=False)], inf_eval_interval=20, eval_on_last_step=True, eval_on_load=False, save_folder='debug_run', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint=None, allow_resume=True, max_duration=1000, global_train_batch_size=8, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=None, beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=5, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=1000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-15 18:55:37.778	g3084:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-15 18:55:45.217	g3084:0	root:123	INFO	Padding tokenizer with 416 tokens
2025-07-15 18:55:47.274	g3084:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-15 18:55:47.432	g3084:0	train:191	INFO	Total number of parameters: 58,006,016
2025-07-15 18:55:47.433	g3084:0	train:192	INFO	Number of non-embedding parameters: 38,525,440
2025-07-15 18:55:47.434	g3084:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 234
2025-07-15 18:55:47.434	g3084:0	train:196	INFO	Model:
2025-07-15 18:55:47.434	g3084:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0): FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=128, out_features=128, bias=True)
          (ff_out): Linear(in_features=256, out_features=128, bias=True)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): LayerNorm()
          (ff_norm): LayerNorm()
          (att_proj): Linear(in_features=128, out_features=384, bias=True)
          (ff_proj): Linear(in_features=128, out_features=512, bias=True)
        )
      )
    )
    (ln_f): FSDPLayerNorm()
    (emb_drop): Dropout(p=0.1, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=128, out_features=152192, bias=True)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=1024, out_features=1024, bias=True)
        (wk): Linear(in_features=1024, out_features=1024, bias=True)
        (wv): Linear(in_features=1024, out_features=1024, bias=True)
        (wo): Linear(in_features=1024, out_features=1024, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1024, out_features=256, bias=False)
        (w2): Linear(in_features=256, out_features=128, bias=False)
        (w3): Linear(in_features=1024, out_features=256, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1024, bias=False)
      (pre_ln): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0): FSDPResidualAttentionBlock(
            (attention): ViTMultiHeadDotProductAttention(
              (wq): Linear(in_features=1024, out_features=1024, bias=True)
              (wk): Linear(in_features=1024, out_features=1024, bias=True)
              (wv): Linear(in_features=1024, out_features=1024, bias=True)
              (wo): Linear(in_features=1024, out_features=1024, bias=True)
              (residual_dropout): Dropout(p=0.0, inplace=False)
            )
            (feed_forward): ViTMLP(
              (w1): Linear(in_features=1024, out_features=4096, bias=True)
              (act): GELUActivation()
              (w2): Linear(in_features=4096, out_features=1024, bias=True)
            )
            (attention_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (ffn_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=700, out_features=128, bias=False)
  (vision_decoder_head): Linear(in_features=128, out_features=700, bias=False)
)
2025-07-15 18:55:47.444	g3084:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-15 18:55:47.445	g3084:0	olmo.data.data_loader:197	INFO	Loading train dataset chart_qa/train
2025-07-15 18:55:47.446	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_human.json
2025-07-15 18:55:47.482	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_augmented.json
2025-07-15 18:55:47.585	g3084:0	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-15 18:55:47.585	g3084:0	olmo.data.data_loader:219	INFO	chart_qa: 100.00
2025-07-15 18:55:47.587	g3084:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=2304 images=1 pooled_patches_idx=158
2025-07-15 18:55:47.588	g3084:0	olmo.data.data_loader:100	INFO	Loading eval dataset: chart_qa/validation
2025-07-15 18:55:47.588	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_human.json
2025-07-15 18:55:47.595	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_augmented.json
2025-07-15 18:55:47.600	g3084:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=1792 images=1 pooled_patches_idx=158
2025-07-15 18:55:47.852	g3084:0	train:332	INFO	Starting training...
2025-07-15 18:55:47.853	g3084:0	olmo.train.trainer:817	INFO	Pre-train system metrics
    System/Peak GPU Memory (MB)=370.5
2025-07-15 18:55:51.491	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:55:55.942	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:55:56.575	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:55:57.004	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:55:57.441	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:55:57.863	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:55:58.155	g3084:0	olmo.train.trainer:817	INFO	[step=5/1000]
    train/CrossEntropyLoss=11.92
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0318
    train/Accuracy=0.0
    throughput/total_tokens=92,160
    throughput/device/tokens_per_second=46,249
    throughput/device/batches_per_second=2.509
2025-07-15 18:55:58.289	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:55:58.724	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:55:59.154	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:55:59.595	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:56:00.024	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:56:00.316	g3084:0	olmo.train.trainer:817	INFO	[step=10/1000]
    train/CrossEntropyLoss=11.91
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0305
    train/Accuracy=0.0
    throughput/total_tokens=184,320
    throughput/device/tokens_per_second=44,181
    throughput/device/batches_per_second=2.397
    System/Peak GPU Memory (MB)=29,214
2025-07-15 18:56:00.466	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:56:00.897	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:56:01.322	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:56:01.743	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:56:02.187	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:56:02.481	g3084:0	olmo.train.trainer:817	INFO	[step=15/1000]
    train/CrossEntropyLoss=11.90
    train/ZLoss=0.0143
    train/ImageGenLoss=0.7157
    train/Accuracy=0.0
    throughput/total_tokens=276,480
    throughput/device/tokens_per_second=43,586
    throughput/device/batches_per_second=2.365
2025-07-15 18:56:02.634	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:56:03.087	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:56:03.562	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:56:03.999	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:56:04.467	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:56:04.761	g3084:0	olmo.train.trainer:817	INFO	[step=20/1000]
    train/CrossEntropyLoss=11.83
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=368,640
    throughput/device/tokens_per_second=42,710
    throughput/device/batches_per_second=2.317
    System/Peak GPU Memory (MB)=29,214
2025-07-15 18:56:04.763	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 18:56:10.240	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 18:56:10.257	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 18:56:10.257	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 5.5 seconds
2025-07-15 18:56:10.441	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:56:10.857	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:56:11.289	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:56:11.725	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:56:12.149	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:56:12.441	g3084:0	olmo.train.trainer:817	INFO	[step=25/1000]
    train/CrossEntropyLoss=11.86
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=460,800
    throughput/device/tokens_per_second=45,769
    throughput/device/batches_per_second=2.483
2025-07-15 18:56:12.589	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:56:13.025	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:56:13.472	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:56:13.913	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:56:14.351	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:56:14.643	g3084:0	olmo.train.trainer:817	INFO	[step=30/1000]
    train/CrossEntropyLoss=11.83
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=552,960
    throughput/device/tokens_per_second=43,732
    throughput/device/batches_per_second=2.373
    System/Peak GPU Memory (MB)=29,215
2025-07-15 18:56:14.787	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:56:15.257	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:56:15.686	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:56:16.112	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:56:16.544	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:56:16.837	g3084:0	olmo.train.trainer:817	INFO	[step=35/1000]
    train/CrossEntropyLoss=11.81
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=645,120
    throughput/device/tokens_per_second=43,141
    throughput/device/batches_per_second=2.341
2025-07-15 18:56:16.981	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:56:17.411	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:56:17.845	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:56:18.279	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:56:18.714	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:56:19.006	g3084:0	olmo.train.trainer:817	INFO	[step=40/1000]
    train/CrossEntropyLoss=11.83
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=737,280
    throughput/device/tokens_per_second=42,977
    throughput/device/batches_per_second=2.332
    System/Peak GPU Memory (MB)=29,215
2025-07-15 18:56:19.008	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 18:56:23.434	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 18:56:23.450	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 18:56:23.450	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 4.4 seconds
2025-07-15 18:56:23.643	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:56:24.075	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:56:24.522	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:56:24.958	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:56:25.393	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:56:25.685	g3084:0	olmo.train.trainer:817	INFO	[step=45/1000]
    train/CrossEntropyLoss=11.75
    train/ZLoss=0.0143
    train/ImageGenLoss=2.000
    train/Accuracy=0.0
    throughput/total_tokens=829,440
    throughput/device/tokens_per_second=44,860
    throughput/device/batches_per_second=2.434
2025-07-15 18:56:25.842	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:56:26.271	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:56:26.699	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:56:27.144	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:56:27.575	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:56:27.867	g3084:0	olmo.train.trainer:817	INFO	[step=50/1000]
    train/CrossEntropyLoss=11.68
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=921,600
    throughput/device/tokens_per_second=43,510
    throughput/device/batches_per_second=2.361
    System/Peak GPU Memory (MB)=29,215
2025-07-15 18:56:28.015	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:56:28.425	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:56:28.868	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:56:29.321	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:56:29.758	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:56:30.051	g3084:0	olmo.train.trainer:817	INFO	[step=55/1000]
    train/CrossEntropyLoss=11.67
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=1,013,760
    throughput/device/tokens_per_second=43,059
    throughput/device/batches_per_second=2.336
2025-07-15 18:56:30.210	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:56:30.646	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:56:31.081	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:56:31.491	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:56:31.911	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:56:32.203	g3084:0	olmo.train.trainer:817	INFO	[step=60/1000]
    train/CrossEntropyLoss=11.72
    train/ZLoss=0.0143
    train/ImageGenLoss=1.999
    train/Accuracy=0.0
    throughput/total_tokens=1,105,920
    throughput/device/tokens_per_second=43,002
    throughput/device/batches_per_second=2.333
    System/Peak GPU Memory (MB)=29,215
2025-07-15 18:56:32.205	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 18:57:42.109	g3084:0	olmo.util:177	CRITICAL	Uncaught BdbQuit: 
Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/Umolmo/launch_scripts/train_multitask_model.py", line 396, in <module>
    run_trainer(cfg)
  File "/gscratch/krishna/mahtab/Umolmo/scripts/train.py", line 333, in run_trainer
    trainer.fit()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 1146, in fit
    eval_metrics = self.inference_eval()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 865, in inference_eval
    dataset_metrics = evaluator.run(
  File "/gscratch/krishna/mahtab/Umolmo/olmo/eval/inf_evaluator.py", line 213, in run
    olmo_gen_output = model.generate(
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py", line 653, in generate
    input_token = None
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py", line 653, in generate
    input_token = None
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/bdb.py", line 90, in trace_dispatch
    return self.dispatch_line(frame)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/bdb.py", line 115, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit
2025-07-15 18:58:01.067	g3084:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-15 18:58:01.141	g3084:0	train:54	INFO	Configuration:
2025-07-15 18:58:01.141	g3084:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=128, n_heads=2, n_kv_heads=None, head_dim=None, qkv_bias=False, clip_qkv=None, n_layers=1, mlp_ratio=4, mlp_hidden_size=None, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=10000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='default', layer_norm_with_affine=True, layer_norm_eps=None, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=True, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.1, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=None, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2-7B', tokenizer_dir=None), init_path=None, init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='openai', image_default_input_size=(336, 336), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1024, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=1, image_head_dim=64, image_mlp_dim=4096, image_mlp_activations='gelu', image_dropout_rate=0.0, image_num_pos=577, image_norm_eps=1e-05, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path=None, resize_mode='default', pad_value=0.0, normalize='openai'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-1,), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='resize', max_crops=1, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear', per_image_output_tokens=64), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'chart_qa': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=20, inf_evaluators=[InfDatasetEvaluatorConfig(label='chart_qa', data=DataLoaderConfig(dataset='chart_qa', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='relaxed_correctness,scifi_relaxed_correctness,em', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=16, console_log_interval=5, include_image=False)], inf_eval_interval=20, eval_on_last_step=True, eval_on_load=False, save_folder='debug_run', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint=None, allow_resume=True, max_duration=1000, global_train_batch_size=8, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=None, beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=5, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=1000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-15 18:58:01.173	g3084:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-15 18:58:03.735	g3084:0	root:123	INFO	Padding tokenizer with 416 tokens
2025-07-15 18:58:05.713	g3084:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-15 18:58:05.861	g3084:0	train:191	INFO	Total number of parameters: 58,006,016
2025-07-15 18:58:05.862	g3084:0	train:192	INFO	Number of non-embedding parameters: 38,525,440
2025-07-15 18:58:05.863	g3084:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 234
2025-07-15 18:58:05.863	g3084:0	train:196	INFO	Model:
2025-07-15 18:58:05.863	g3084:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0): FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=128, out_features=128, bias=True)
          (ff_out): Linear(in_features=256, out_features=128, bias=True)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): LayerNorm()
          (ff_norm): LayerNorm()
          (att_proj): Linear(in_features=128, out_features=384, bias=True)
          (ff_proj): Linear(in_features=128, out_features=512, bias=True)
        )
      )
    )
    (ln_f): FSDPLayerNorm()
    (emb_drop): Dropout(p=0.1, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=128, out_features=152192, bias=True)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=1024, out_features=1024, bias=True)
        (wk): Linear(in_features=1024, out_features=1024, bias=True)
        (wv): Linear(in_features=1024, out_features=1024, bias=True)
        (wo): Linear(in_features=1024, out_features=1024, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1024, out_features=256, bias=False)
        (w2): Linear(in_features=256, out_features=128, bias=False)
        (w3): Linear(in_features=1024, out_features=256, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1024, bias=False)
      (pre_ln): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0): FSDPResidualAttentionBlock(
            (attention): ViTMultiHeadDotProductAttention(
              (wq): Linear(in_features=1024, out_features=1024, bias=True)
              (wk): Linear(in_features=1024, out_features=1024, bias=True)
              (wv): Linear(in_features=1024, out_features=1024, bias=True)
              (wo): Linear(in_features=1024, out_features=1024, bias=True)
              (residual_dropout): Dropout(p=0.0, inplace=False)
            )
            (feed_forward): ViTMLP(
              (w1): Linear(in_features=1024, out_features=4096, bias=True)
              (act): GELUActivation()
              (w2): Linear(in_features=4096, out_features=1024, bias=True)
            )
            (attention_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (ffn_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=700, out_features=128, bias=False)
  (vision_decoder_head): Linear(in_features=128, out_features=700, bias=False)
)
2025-07-15 18:58:05.873	g3084:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-15 18:58:05.874	g3084:0	olmo.data.data_loader:197	INFO	Loading train dataset chart_qa/train
2025-07-15 18:58:05.874	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_human.json
2025-07-15 18:58:05.907	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_augmented.json
2025-07-15 18:58:06.007	g3084:0	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-15 18:58:06.008	g3084:0	olmo.data.data_loader:219	INFO	chart_qa: 100.00
2025-07-15 18:58:06.009	g3084:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=2304 images=1 pooled_patches_idx=158
2025-07-15 18:58:06.010	g3084:0	olmo.data.data_loader:100	INFO	Loading eval dataset: chart_qa/validation
2025-07-15 18:58:06.011	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_human.json
2025-07-15 18:58:06.017	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_augmented.json
2025-07-15 18:58:06.021	g3084:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=1792 images=1 pooled_patches_idx=158
2025-07-15 18:58:06.260	g3084:0	train:332	INFO	Starting training...
2025-07-15 18:58:06.262	g3084:0	olmo.train.trainer:817	INFO	Pre-train system metrics
    System/Peak GPU Memory (MB)=370.5
2025-07-15 18:58:09.802	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:58:13.974	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:58:14.549	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:58:14.962	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:58:15.368	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:58:15.772	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:58:16.056	g3084:0	olmo.train.trainer:817	INFO	[step=5/1000]
    train/CrossEntropyLoss=11.92
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0318
    train/Accuracy=0.0
    throughput/total_tokens=92,160
    throughput/device/tokens_per_second=48,489
    throughput/device/batches_per_second=2.631
2025-07-15 18:58:16.176	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:58:16.589	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:58:16.997	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:58:17.418	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:58:17.828	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:58:18.112	g3084:0	olmo.train.trainer:817	INFO	[step=10/1000]
    train/CrossEntropyLoss=11.91
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0305
    train/Accuracy=0.0
    throughput/total_tokens=184,320
    throughput/device/tokens_per_second=46,384
    throughput/device/batches_per_second=2.517
    System/Peak GPU Memory (MB)=29,214
2025-07-15 18:58:18.249	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:58:18.652	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:58:19.063	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:58:19.463	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:58:19.872	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:58:20.155	g3084:0	olmo.train.trainer:817	INFO	[step=15/1000]
    train/CrossEntropyLoss=11.90
    train/ZLoss=0.0143
    train/ImageGenLoss=0.7157
    train/Accuracy=0.0
    throughput/total_tokens=276,480
    throughput/device/tokens_per_second=45,919
    throughput/device/batches_per_second=2.491
2025-07-15 18:58:20.282	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:58:20.695	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:58:21.094	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:58:21.510	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:58:21.927	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:58:22.212	g3084:0	olmo.train.trainer:817	INFO	[step=20/1000]
    train/CrossEntropyLoss=11.84
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=368,640
    throughput/device/tokens_per_second=45,621
    throughput/device/batches_per_second=2.475
    System/Peak GPU Memory (MB)=29,214
2025-07-15 18:58:22.214	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 18:58:27.099	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 18:58:27.115	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 18:58:27.116	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 4.9 seconds
2025-07-15 18:58:27.275	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:58:27.673	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:58:28.080	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:58:28.488	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:58:28.896	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:58:29.182	g3084:0	olmo.train.trainer:817	INFO	[step=25/1000]
    train/CrossEntropyLoss=11.86
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=460,800
    throughput/device/tokens_per_second=48,045
    throughput/device/batches_per_second=2.607
2025-07-15 18:58:29.329	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:58:29.762	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:58:30.206	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:58:30.624	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:58:31.039	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:58:31.324	g3084:0	olmo.train.trainer:817	INFO	[step=30/1000]
    train/CrossEntropyLoss=11.83
    train/ZLoss=0.0143
    train/ImageGenLoss=2.000
    train/Accuracy=0.0
    throughput/total_tokens=552,960
    throughput/device/tokens_per_second=45,398
    throughput/device/batches_per_second=2.463
    System/Peak GPU Memory (MB)=29,215
2025-07-15 18:58:31.454	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:58:31.868	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:58:32.284	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:58:32.689	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:58:33.099	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:58:33.384	g3084:0	olmo.train.trainer:817	INFO	[step=35/1000]
    train/CrossEntropyLoss=11.81
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=645,120
    throughput/device/tokens_per_second=45,170
    throughput/device/batches_per_second=2.451
2025-07-15 18:58:33.516	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:58:33.926	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:58:34.338	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:58:34.749	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:58:35.166	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:58:35.452	g3084:0	olmo.train.trainer:817	INFO	[step=40/1000]
    train/CrossEntropyLoss=11.83
    train/ZLoss=0.0143
    train/ImageGenLoss=2.000
    train/Accuracy=0.0
    throughput/total_tokens=737,280
    throughput/device/tokens_per_second=45,023
    throughput/device/batches_per_second=2.443
    System/Peak GPU Memory (MB)=29,215
2025-07-15 18:58:35.455	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 18:58:39.374	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 18:58:39.389	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 18:58:39.389	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.9 seconds
2025-07-15 18:58:39.543	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:58:39.955	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:58:40.387	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:58:40.805	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:58:41.223	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:58:41.509	g3084:0	olmo.train.trainer:817	INFO	[step=45/1000]
    train/CrossEntropyLoss=11.75
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=829,440
    throughput/device/tokens_per_second=46,593
    throughput/device/batches_per_second=2.528
2025-07-15 18:58:41.657	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:58:42.080	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:58:42.496	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:58:42.929	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:58:43.381	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:58:43.665	g3084:0	olmo.train.trainer:817	INFO	[step=50/1000]
    train/CrossEntropyLoss=11.68
    train/ZLoss=0.0143
    train/ImageGenLoss=2.000
    train/Accuracy=0.0
    throughput/total_tokens=921,600
    throughput/device/tokens_per_second=44,586
    throughput/device/batches_per_second=2.419
    System/Peak GPU Memory (MB)=29,215
2025-07-15 18:58:43.803	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:58:44.194	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:58:44.608	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:58:45.041	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:58:45.447	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:58:45.732	g3084:0	olmo.train.trainer:817	INFO	[step=55/1000]
    train/CrossEntropyLoss=11.67
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=1,013,760
    throughput/device/tokens_per_second=44,583
    throughput/device/batches_per_second=2.419
2025-07-15 18:58:45.869	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:58:46.284	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:58:46.700	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:58:47.093	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:58:47.489	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 18:58:47.773	g3084:0	olmo.train.trainer:817	INFO	[step=60/1000]
    train/CrossEntropyLoss=11.72
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=1,105,920
    throughput/device/tokens_per_second=44,726
    throughput/device/batches_per_second=2.427
    System/Peak GPU Memory (MB)=29,215
2025-07-15 18:58:47.775	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:02:30.253	g3084:0	olmo.util:177	CRITICAL	Uncaught BdbQuit: 
Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/Umolmo/launch_scripts/train_multitask_model.py", line 396, in <module>
    run_trainer(cfg)
  File "/gscratch/krishna/mahtab/Umolmo/scripts/train.py", line 333, in run_trainer
    trainer.fit()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 1146, in fit
    eval_metrics = self.inference_eval()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 865, in inference_eval
    dataset_metrics = evaluator.run(
  File "/gscratch/krishna/mahtab/Umolmo/olmo/eval/inf_evaluator.py", line 213, in run
    olmo_gen_output = model.generate(
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py", line 652, in generate
    input_token = None
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py", line 652, in generate
    input_token = None
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/bdb.py", line 90, in trace_dispatch
    return self.dispatch_line(frame)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/bdb.py", line 115, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit
2025-07-15 19:02:53.966	g3084:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-15 19:02:54.040	g3084:0	train:54	INFO	Configuration:
2025-07-15 19:02:54.040	g3084:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=128, n_heads=2, n_kv_heads=None, head_dim=None, qkv_bias=False, clip_qkv=None, n_layers=1, mlp_ratio=4, mlp_hidden_size=None, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=10000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='default', layer_norm_with_affine=True, layer_norm_eps=None, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=True, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.1, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=None, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2-7B', tokenizer_dir=None), init_path=None, init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='openai', image_default_input_size=(336, 336), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1024, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=1, image_head_dim=64, image_mlp_dim=4096, image_mlp_activations='gelu', image_dropout_rate=0.0, image_num_pos=577, image_norm_eps=1e-05, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path=None, resize_mode='default', pad_value=0.0, normalize='openai'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-1,), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='resize', max_crops=1, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear', per_image_output_tokens=64), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'chart_qa': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=20, inf_evaluators=[InfDatasetEvaluatorConfig(label='chart_qa', data=DataLoaderConfig(dataset='chart_qa', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='relaxed_correctness,scifi_relaxed_correctness,em', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=16, console_log_interval=5, include_image=False)], inf_eval_interval=20, eval_on_last_step=True, eval_on_load=False, save_folder='debug_run', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint=None, allow_resume=True, max_duration=1000, global_train_batch_size=8, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=None, beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=5, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=1000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-15 19:02:54.072	g3084:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-15 19:02:56.475	g3084:0	root:123	INFO	Padding tokenizer with 416 tokens
2025-07-15 19:02:58.506	g3084:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-15 19:02:58.660	g3084:0	train:191	INFO	Total number of parameters: 58,006,016
2025-07-15 19:02:58.660	g3084:0	train:192	INFO	Number of non-embedding parameters: 38,525,440
2025-07-15 19:02:58.661	g3084:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 234
2025-07-15 19:02:58.662	g3084:0	train:196	INFO	Model:
2025-07-15 19:02:58.662	g3084:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0): FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=128, out_features=128, bias=True)
          (ff_out): Linear(in_features=256, out_features=128, bias=True)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): LayerNorm()
          (ff_norm): LayerNorm()
          (att_proj): Linear(in_features=128, out_features=384, bias=True)
          (ff_proj): Linear(in_features=128, out_features=512, bias=True)
        )
      )
    )
    (ln_f): FSDPLayerNorm()
    (emb_drop): Dropout(p=0.1, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=128, out_features=152192, bias=True)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=1024, out_features=1024, bias=True)
        (wk): Linear(in_features=1024, out_features=1024, bias=True)
        (wv): Linear(in_features=1024, out_features=1024, bias=True)
        (wo): Linear(in_features=1024, out_features=1024, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1024, out_features=256, bias=False)
        (w2): Linear(in_features=256, out_features=128, bias=False)
        (w3): Linear(in_features=1024, out_features=256, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1024, bias=False)
      (pre_ln): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0): FSDPResidualAttentionBlock(
            (attention): ViTMultiHeadDotProductAttention(
              (wq): Linear(in_features=1024, out_features=1024, bias=True)
              (wk): Linear(in_features=1024, out_features=1024, bias=True)
              (wv): Linear(in_features=1024, out_features=1024, bias=True)
              (wo): Linear(in_features=1024, out_features=1024, bias=True)
              (residual_dropout): Dropout(p=0.0, inplace=False)
            )
            (feed_forward): ViTMLP(
              (w1): Linear(in_features=1024, out_features=4096, bias=True)
              (act): GELUActivation()
              (w2): Linear(in_features=4096, out_features=1024, bias=True)
            )
            (attention_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (ffn_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=700, out_features=128, bias=False)
  (vision_decoder_head): Linear(in_features=128, out_features=700, bias=False)
)
2025-07-15 19:02:58.672	g3084:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-15 19:02:58.673	g3084:0	olmo.data.data_loader:197	INFO	Loading train dataset chart_qa/train
2025-07-15 19:02:58.673	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_human.json
2025-07-15 19:02:58.708	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_augmented.json
2025-07-15 19:02:58.808	g3084:0	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-15 19:02:58.808	g3084:0	olmo.data.data_loader:219	INFO	chart_qa: 100.00
2025-07-15 19:02:58.810	g3084:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=2304 images=1 pooled_patches_idx=158
2025-07-15 19:02:58.811	g3084:0	olmo.data.data_loader:100	INFO	Loading eval dataset: chart_qa/validation
2025-07-15 19:02:58.811	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_human.json
2025-07-15 19:02:58.818	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_augmented.json
2025-07-15 19:02:58.823	g3084:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=1792 images=1 pooled_patches_idx=158
2025-07-15 19:02:59.066	g3084:0	train:332	INFO	Starting training...
2025-07-15 19:02:59.067	g3084:0	olmo.train.trainer:817	INFO	Pre-train system metrics
    System/Peak GPU Memory (MB)=370.5
2025-07-15 19:03:02.817	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:03:07.348	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:03:07.990	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:03:08.421	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:03:08.845	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:03:09.268	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:03:09.559	g3084:0	olmo.train.trainer:817	INFO	[step=5/1000]
    train/CrossEntropyLoss=11.92
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0318
    train/Accuracy=0.0
    throughput/total_tokens=92,160
    throughput/device/tokens_per_second=46,551
    throughput/device/batches_per_second=2.526
2025-07-15 19:03:09.693	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:03:10.126	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:03:10.555	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:03:10.993	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:03:11.421	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:03:11.713	g3084:0	olmo.train.trainer:817	INFO	[step=10/1000]
    train/CrossEntropyLoss=11.91
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0305
    train/Accuracy=0.0
    throughput/total_tokens=184,320
    throughput/device/tokens_per_second=44,385
    throughput/device/batches_per_second=2.408
    System/Peak GPU Memory (MB)=29,214
2025-07-15 19:03:11.862	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:03:12.289	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:03:12.712	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:03:13.125	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:03:13.548	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:03:13.839	g3084:0	olmo.train.trainer:817	INFO	[step=15/1000]
    train/CrossEntropyLoss=11.90
    train/ZLoss=0.0143
    train/ImageGenLoss=0.7157
    train/Accuracy=0.0
    throughput/total_tokens=276,480
    throughput/device/tokens_per_second=44,005
    throughput/device/batches_per_second=2.387
2025-07-15 19:03:13.980	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:03:14.415	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:03:14.832	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:03:15.269	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:03:15.704	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:03:15.996	g3084:0	olmo.train.trainer:817	INFO	[step=20/1000]
    train/CrossEntropyLoss=11.83
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=368,640
    throughput/device/tokens_per_second=43,667
    throughput/device/batches_per_second=2.369
    System/Peak GPU Memory (MB)=29,214
2025-07-15 19:03:15.997	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:06:00.042	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:06:00.059	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:06:00.060	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 164.1 seconds
2025-07-15 19:06:00.237	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:06:00.651	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:06:01.082	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:06:01.517	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:06:01.949	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:06:02.243	g3084:0	olmo.train.trainer:817	INFO	[step=25/1000]
    train/CrossEntropyLoss=11.86
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=460,800
    throughput/device/tokens_per_second=45,645
    throughput/device/batches_per_second=2.476
2025-07-15 19:06:02.430	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:06:02.892	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:06:03.351	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:06:03.800	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:06:04.250	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:06:04.543	g3084:0	olmo.train.trainer:817	INFO	[step=30/1000]
    train/CrossEntropyLoss=11.83
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=552,960
    throughput/device/tokens_per_second=42,685
    throughput/device/batches_per_second=2.316
    System/Peak GPU Memory (MB)=29,233
2025-07-15 19:06:04.687	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:06:05.111	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:06:05.539	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:06:05.962	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:06:06.392	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:06:06.684	g3084:0	olmo.train.trainer:817	INFO	[step=35/1000]
    train/CrossEntropyLoss=11.81
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=645,120
    throughput/device/tokens_per_second=42,801
    throughput/device/batches_per_second=2.322
2025-07-15 19:06:06.826	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:06:07.255	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:06:07.686	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:06:08.117	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:06:08.550	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:06:08.841	g3084:0	olmo.train.trainer:817	INFO	[step=40/1000]
    train/CrossEntropyLoss=11.83
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=737,280
    throughput/device/tokens_per_second=42,781
    throughput/device/batches_per_second=2.321
    System/Peak GPU Memory (MB)=29,233
2025-07-15 19:06:08.843	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:06:50.118	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:06:50.134	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:06:50.134	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 41.3 seconds
2025-07-15 19:06:50.312	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:06:50.738	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:06:51.187	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:06:51.615	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:06:52.041	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:06:52.330	g3084:0	olmo.train.trainer:817	INFO	[step=45/1000]
    train/CrossEntropyLoss=11.75
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=829,440
    throughput/device/tokens_per_second=45,360
    throughput/device/batches_per_second=2.461
2025-07-15 19:06:52.485	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:06:52.908	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:06:53.331	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:06:53.766	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:06:54.198	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:06:54.489	g3084:0	olmo.train.trainer:817	INFO	[step=50/1000]
    train/CrossEntropyLoss=11.68
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=921,600
    throughput/device/tokens_per_second=43,993
    throughput/device/batches_per_second=2.387
    System/Peak GPU Memory (MB)=29,233
2025-07-15 19:06:54.635	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:06:55.041	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:06:55.471	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:06:55.916	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:06:56.341	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:06:56.632	g3084:0	olmo.train.trainer:817	INFO	[step=55/1000]
    train/CrossEntropyLoss=11.67
    train/ZLoss=0.0143
    train/ImageGenLoss=2.000
    train/Accuracy=0.0
    throughput/total_tokens=1,013,760
    throughput/device/tokens_per_second=43,653
    throughput/device/batches_per_second=2.368
2025-07-15 19:06:56.778	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:06:57.212	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:06:57.648	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:06:58.061	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:06:58.481	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:06:58.774	g3084:0	olmo.train.trainer:817	INFO	[step=60/1000]
    train/CrossEntropyLoss=11.72
    train/ZLoss=0.0143
    train/ImageGenLoss=2.000
    train/Accuracy=0.0
    throughput/total_tokens=1,105,920
    throughput/device/tokens_per_second=43,498
    throughput/device/batches_per_second=2.360
    System/Peak GPU Memory (MB)=29,233
2025-07-15 19:06:58.776	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:06:59.373	g3084:0	olmo.util:177	CRITICAL	Uncaught TypeError: argument of type 'NoneType' is not iterable
Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/Umolmo/launch_scripts/train_multitask_model.py", line 396, in <module>
    run_trainer(cfg)
  File "/gscratch/krishna/mahtab/Umolmo/scripts/train.py", line 333, in run_trainer
    trainer.fit()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 1146, in fit
    eval_metrics = self.inference_eval()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 865, in inference_eval
    dataset_metrics = evaluator.run(
  File "/gscratch/krishna/mahtab/Umolmo/olmo/eval/inf_evaluator.py", line 213, in run
    olmo_gen_output = model.generate(
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py", line 675, in generate
    output = self(
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1857, in _call_impl
    return inner()
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1805, in inner
    result = forward_call(*args, **kwargs)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py", line 455, in forward
    if self._image_output_token_id in input_ids and is_training:
TypeError: argument of type 'NoneType' is not iterable
2025-07-15 19:08:21.345	g3084:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-15 19:08:21.419	g3084:0	train:54	INFO	Configuration:
2025-07-15 19:08:21.420	g3084:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=128, n_heads=2, n_kv_heads=None, head_dim=None, qkv_bias=False, clip_qkv=None, n_layers=1, mlp_ratio=4, mlp_hidden_size=None, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=10000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='default', layer_norm_with_affine=True, layer_norm_eps=None, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=True, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.1, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=None, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2-7B', tokenizer_dir=None), init_path=None, init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='openai', image_default_input_size=(336, 336), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1024, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=1, image_head_dim=64, image_mlp_dim=4096, image_mlp_activations='gelu', image_dropout_rate=0.0, image_num_pos=577, image_norm_eps=1e-05, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path=None, resize_mode='default', pad_value=0.0, normalize='openai'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-1,), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='resize', max_crops=1, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear', per_image_output_tokens=64), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'chart_qa': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=20, inf_evaluators=[InfDatasetEvaluatorConfig(label='chart_qa', data=DataLoaderConfig(dataset='chart_qa', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='relaxed_correctness,scifi_relaxed_correctness,em', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=16, console_log_interval=5, include_image=False)], inf_eval_interval=20, eval_on_last_step=True, eval_on_load=False, save_folder='debug_run', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint=None, allow_resume=True, max_duration=1000, global_train_batch_size=8, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=None, beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=5, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=1000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-15 19:08:21.452	g3084:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-15 19:08:23.907	g3084:0	root:123	INFO	Padding tokenizer with 416 tokens
2025-07-15 19:08:25.980	g3084:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-15 19:08:26.136	g3084:0	train:191	INFO	Total number of parameters: 58,006,016
2025-07-15 19:08:26.137	g3084:0	train:192	INFO	Number of non-embedding parameters: 38,525,440
2025-07-15 19:08:26.138	g3084:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 234
2025-07-15 19:08:26.138	g3084:0	train:196	INFO	Model:
2025-07-15 19:08:26.139	g3084:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0): FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=128, out_features=128, bias=True)
          (ff_out): Linear(in_features=256, out_features=128, bias=True)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): LayerNorm()
          (ff_norm): LayerNorm()
          (att_proj): Linear(in_features=128, out_features=384, bias=True)
          (ff_proj): Linear(in_features=128, out_features=512, bias=True)
        )
      )
    )
    (ln_f): FSDPLayerNorm()
    (emb_drop): Dropout(p=0.1, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=128, out_features=152192, bias=True)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=1024, out_features=1024, bias=True)
        (wk): Linear(in_features=1024, out_features=1024, bias=True)
        (wv): Linear(in_features=1024, out_features=1024, bias=True)
        (wo): Linear(in_features=1024, out_features=1024, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1024, out_features=256, bias=False)
        (w2): Linear(in_features=256, out_features=128, bias=False)
        (w3): Linear(in_features=1024, out_features=256, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1024, bias=False)
      (pre_ln): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0): FSDPResidualAttentionBlock(
            (attention): ViTMultiHeadDotProductAttention(
              (wq): Linear(in_features=1024, out_features=1024, bias=True)
              (wk): Linear(in_features=1024, out_features=1024, bias=True)
              (wv): Linear(in_features=1024, out_features=1024, bias=True)
              (wo): Linear(in_features=1024, out_features=1024, bias=True)
              (residual_dropout): Dropout(p=0.0, inplace=False)
            )
            (feed_forward): ViTMLP(
              (w1): Linear(in_features=1024, out_features=4096, bias=True)
              (act): GELUActivation()
              (w2): Linear(in_features=4096, out_features=1024, bias=True)
            )
            (attention_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (ffn_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=700, out_features=128, bias=False)
  (vision_decoder_head): Linear(in_features=128, out_features=700, bias=False)
)
2025-07-15 19:08:26.149	g3084:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-15 19:08:26.149	g3084:0	olmo.data.data_loader:197	INFO	Loading train dataset chart_qa/train
2025-07-15 19:08:26.150	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_human.json
2025-07-15 19:08:26.185	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_augmented.json
2025-07-15 19:08:26.287	g3084:0	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-15 19:08:26.288	g3084:0	olmo.data.data_loader:219	INFO	chart_qa: 100.00
2025-07-15 19:08:26.290	g3084:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=2304 images=1 pooled_patches_idx=158
2025-07-15 19:08:26.291	g3084:0	olmo.data.data_loader:100	INFO	Loading eval dataset: chart_qa/validation
2025-07-15 19:08:26.291	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_human.json
2025-07-15 19:08:26.297	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_augmented.json
2025-07-15 19:08:26.302	g3084:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=1792 images=1 pooled_patches_idx=158
2025-07-15 19:08:26.546	g3084:0	train:332	INFO	Starting training...
2025-07-15 19:08:26.548	g3084:0	olmo.train.trainer:817	INFO	Pre-train system metrics
    System/Peak GPU Memory (MB)=370.5
2025-07-15 19:08:30.199	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:08:34.701	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:08:35.323	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:08:35.755	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:08:36.183	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:08:36.608	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:08:36.901	g3084:0	olmo.train.trainer:817	INFO	[step=5/1000]
    train/CrossEntropyLoss=11.92
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0318
    train/Accuracy=0.0
    throughput/total_tokens=92,160
    throughput/device/tokens_per_second=46,321
    throughput/device/batches_per_second=2.513
2025-07-15 19:08:37.036	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:08:37.472	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:08:37.907	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:08:38.349	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:08:38.788	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:08:39.081	g3084:0	olmo.train.trainer:817	INFO	[step=10/1000]
    train/CrossEntropyLoss=11.91
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0305
    train/Accuracy=0.0
    throughput/total_tokens=184,320
    throughput/device/tokens_per_second=43,986
    throughput/device/batches_per_second=2.386
    System/Peak GPU Memory (MB)=29,214
2025-07-15 19:08:39.231	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:08:39.662	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:08:40.090	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:08:40.503	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:08:40.934	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:08:41.226	g3084:0	olmo.train.trainer:817	INFO	[step=15/1000]
    train/CrossEntropyLoss=11.90
    train/ZLoss=0.0143
    train/ImageGenLoss=0.7157
    train/Accuracy=0.0
    throughput/total_tokens=276,480
    throughput/device/tokens_per_second=43,612
    throughput/device/batches_per_second=2.366
2025-07-15 19:08:41.367	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:08:41.806	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:08:42.229	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:08:42.672	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:08:43.115	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:08:43.411	g3084:0	olmo.train.trainer:817	INFO	[step=20/1000]
    train/CrossEntropyLoss=11.84
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=368,640
    throughput/device/tokens_per_second=43,227
    throughput/device/batches_per_second=2.345
    System/Peak GPU Memory (MB)=29,214
2025-07-15 19:08:43.413	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:08:51.657	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:08:51.674	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:08:51.675	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 8.3 seconds
2025-07-15 19:08:51.861	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:08:52.275	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:08:52.704	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:08:53.132	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:08:53.556	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:08:53.848	g3084:0	olmo.train.trainer:817	INFO	[step=25/1000]
    train/CrossEntropyLoss=11.86
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=460,800
    throughput/device/tokens_per_second=46,083
    throughput/device/batches_per_second=2.500
2025-07-15 19:08:53.993	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:08:54.429	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:08:54.874	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:08:55.311	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:08:55.749	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:08:56.042	g3084:0	olmo.train.trainer:817	INFO	[step=30/1000]
    train/CrossEntropyLoss=11.83
    train/ZLoss=0.0143
    train/ImageGenLoss=2.000
    train/Accuracy=0.0
    throughput/total_tokens=552,960
    throughput/device/tokens_per_second=43,945
    throughput/device/batches_per_second=2.384
    System/Peak GPU Memory (MB)=29,233
2025-07-15 19:08:56.187	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:08:56.615	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:08:57.045	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:08:57.471	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:08:57.902	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:08:58.194	g3084:0	olmo.train.trainer:817	INFO	[step=35/1000]
    train/CrossEntropyLoss=11.81
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=645,120
    throughput/device/tokens_per_second=43,566
    throughput/device/batches_per_second=2.364
2025-07-15 19:08:58.338	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:08:58.767	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:08:59.201	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:08:59.636	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:09:00.075	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:09:00.368	g3084:0	olmo.train.trainer:817	INFO	[step=40/1000]
    train/CrossEntropyLoss=11.83
    train/ZLoss=0.0143
    train/ImageGenLoss=2.000
    train/Accuracy=0.0
    throughput/total_tokens=737,280
    throughput/device/tokens_per_second=43,270
    throughput/device/batches_per_second=2.348
    System/Peak GPU Memory (MB)=29,233
2025-07-15 19:09:00.369	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:09:08.358	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:09:08.374	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:09:08.375	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 8.0 seconds
2025-07-15 19:09:08.568	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:09:09.004	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:09:09.462	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:09:09.897	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:09:10.335	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:09:10.629	g3084:0	olmo.train.trainer:817	INFO	[step=45/1000]
    train/CrossEntropyLoss=11.75
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=829,440
    throughput/device/tokens_per_second=44,430
    throughput/device/batches_per_second=2.411
2025-07-15 19:09:10.790	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:09:11.223	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:09:11.653	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:09:12.097	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:09:12.532	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:09:12.825	g3084:0	olmo.train.trainer:817	INFO	[step=50/1000]
    train/CrossEntropyLoss=11.68
    train/ZLoss=0.0143
    train/ImageGenLoss=2.000
    train/Accuracy=0.0
    throughput/total_tokens=921,600
    throughput/device/tokens_per_second=43,164
    throughput/device/batches_per_second=2.342
    System/Peak GPU Memory (MB)=29,233
2025-07-15 19:09:12.975	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:09:13.385	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:09:13.823	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:09:14.287	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:09:14.717	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:09:15.010	g3084:0	olmo.train.trainer:817	INFO	[step=55/1000]
    train/CrossEntropyLoss=11.67
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=1,013,760
    throughput/device/tokens_per_second=42,831
    throughput/device/batches_per_second=2.324
2025-07-15 19:09:15.163	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:09:15.597	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:09:16.037	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:09:16.451	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:09:16.869	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:09:17.162	g3084:0	olmo.train.trainer:817	INFO	[step=60/1000]
    train/CrossEntropyLoss=11.72
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=1,105,920
    throughput/device/tokens_per_second=42,829
    throughput/device/batches_per_second=2.324
    System/Peak GPU Memory (MB)=29,233
2025-07-15 19:09:17.164	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:09:17.769	g3084:0	olmo.util:177	CRITICAL	Uncaught ValueError: not enough values to unpack (expected 3, got 2)
Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/Umolmo/launch_scripts/train_multitask_model.py", line 396, in <module>
    run_trainer(cfg)
  File "/gscratch/krishna/mahtab/Umolmo/scripts/train.py", line 333, in run_trainer
    trainer.fit()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 1146, in fit
    eval_metrics = self.inference_eval()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 865, in inference_eval
    dataset_metrics = evaluator.run(
  File "/gscratch/krishna/mahtab/Umolmo/olmo/eval/inf_evaluator.py", line 213, in run
    olmo_gen_output = model.generate(
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py", line 675, in generate
    output = self(
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1857, in _call_impl
    return inner()
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1805, in inner
    result = forward_call(*args, **kwargs)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py", line 530, in forward
    x, cache = block(
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1749, in _wrapped_call_impl
    return self._compiled_call_impl(*args, **kwargs)  # type: ignore[misc]
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py", line 655, in _fn
    return fn(*args, **kwargs)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1857, in _call_impl
    return inner()
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1805, in inner
    result = forward_call(*args, **kwargs)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/distributed/algorithms/_checkpoint/checkpoint_wrapper.py", line 171, in forward
    return self.checkpoint_fn(  # type: ignore[misc]
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/_compile.py", line 51, in inner
    return disable_fn(*args, **kwargs)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py", line 838, in _fn
    return fn(*args, **kwargs)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/utils/checkpoint.py", line 495, in checkpoint
    ret = function(*args, **kwargs)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/nn/llm.py", line 1676, in forward
    att, cache = self.attention(
  File "/gscratch/krishna/mahtab/Umolmo/olmo/nn/llm.py", line 1349, in attention
    B, T, C = q.size()  # batch size, sequence length, d_model
ValueError: not enough values to unpack (expected 3, got 2)
2025-07-15 19:11:06.831	g3084:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-15 19:11:06.905	g3084:0	train:54	INFO	Configuration:
2025-07-15 19:11:06.906	g3084:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=128, n_heads=2, n_kv_heads=None, head_dim=None, qkv_bias=False, clip_qkv=None, n_layers=1, mlp_ratio=4, mlp_hidden_size=None, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=10000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='default', layer_norm_with_affine=True, layer_norm_eps=None, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=True, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.1, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=None, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2-7B', tokenizer_dir=None), init_path=None, init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='openai', image_default_input_size=(336, 336), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1024, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=1, image_head_dim=64, image_mlp_dim=4096, image_mlp_activations='gelu', image_dropout_rate=0.0, image_num_pos=577, image_norm_eps=1e-05, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path=None, resize_mode='default', pad_value=0.0, normalize='openai'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-1,), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='resize', max_crops=1, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear', per_image_output_tokens=64), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'chart_qa': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=20, inf_evaluators=[InfDatasetEvaluatorConfig(label='chart_qa', data=DataLoaderConfig(dataset='chart_qa', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='relaxed_correctness,scifi_relaxed_correctness,em', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=16, console_log_interval=5, include_image=False)], inf_eval_interval=20, eval_on_last_step=True, eval_on_load=False, save_folder='debug_run', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint=None, allow_resume=True, max_duration=1000, global_train_batch_size=8, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=None, beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=5, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=1000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-15 19:11:06.937	g3084:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-15 19:11:09.315	g3084:0	root:123	INFO	Padding tokenizer with 416 tokens
2025-07-15 19:11:11.360	g3084:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-15 19:11:11.514	g3084:0	train:191	INFO	Total number of parameters: 58,006,016
2025-07-15 19:11:11.515	g3084:0	train:192	INFO	Number of non-embedding parameters: 38,525,440
2025-07-15 19:11:11.516	g3084:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 234
2025-07-15 19:11:11.516	g3084:0	train:196	INFO	Model:
2025-07-15 19:11:11.517	g3084:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0): FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=128, out_features=128, bias=True)
          (ff_out): Linear(in_features=256, out_features=128, bias=True)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): LayerNorm()
          (ff_norm): LayerNorm()
          (att_proj): Linear(in_features=128, out_features=384, bias=True)
          (ff_proj): Linear(in_features=128, out_features=512, bias=True)
        )
      )
    )
    (ln_f): FSDPLayerNorm()
    (emb_drop): Dropout(p=0.1, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=128, out_features=152192, bias=True)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=1024, out_features=1024, bias=True)
        (wk): Linear(in_features=1024, out_features=1024, bias=True)
        (wv): Linear(in_features=1024, out_features=1024, bias=True)
        (wo): Linear(in_features=1024, out_features=1024, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1024, out_features=256, bias=False)
        (w2): Linear(in_features=256, out_features=128, bias=False)
        (w3): Linear(in_features=1024, out_features=256, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1024, bias=False)
      (pre_ln): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0): FSDPResidualAttentionBlock(
            (attention): ViTMultiHeadDotProductAttention(
              (wq): Linear(in_features=1024, out_features=1024, bias=True)
              (wk): Linear(in_features=1024, out_features=1024, bias=True)
              (wv): Linear(in_features=1024, out_features=1024, bias=True)
              (wo): Linear(in_features=1024, out_features=1024, bias=True)
              (residual_dropout): Dropout(p=0.0, inplace=False)
            )
            (feed_forward): ViTMLP(
              (w1): Linear(in_features=1024, out_features=4096, bias=True)
              (act): GELUActivation()
              (w2): Linear(in_features=4096, out_features=1024, bias=True)
            )
            (attention_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (ffn_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=700, out_features=128, bias=False)
  (vision_decoder_head): Linear(in_features=128, out_features=700, bias=False)
)
2025-07-15 19:11:11.527	g3084:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-15 19:11:11.527	g3084:0	olmo.data.data_loader:197	INFO	Loading train dataset chart_qa/train
2025-07-15 19:11:11.528	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_human.json
2025-07-15 19:11:11.564	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_augmented.json
2025-07-15 19:11:11.666	g3084:0	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-15 19:11:11.667	g3084:0	olmo.data.data_loader:219	INFO	chart_qa: 100.00
2025-07-15 19:11:11.668	g3084:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=2304 images=1 pooled_patches_idx=158
2025-07-15 19:11:11.669	g3084:0	olmo.data.data_loader:100	INFO	Loading eval dataset: chart_qa/validation
2025-07-15 19:11:11.670	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_human.json
2025-07-15 19:11:11.676	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_augmented.json
2025-07-15 19:11:11.681	g3084:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=1792 images=1 pooled_patches_idx=158
2025-07-15 19:11:11.927	g3084:0	train:332	INFO	Starting training...
2025-07-15 19:11:11.928	g3084:0	olmo.train.trainer:817	INFO	Pre-train system metrics
    System/Peak GPU Memory (MB)=370.5
2025-07-15 19:11:15.484	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:11:19.981	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:11:20.616	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:11:21.048	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:11:21.473	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:11:21.893	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:11:22.183	g3084:0	olmo.train.trainer:817	INFO	[step=5/1000]
    train/CrossEntropyLoss=11.92
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0318
    train/Accuracy=0.0
    throughput/total_tokens=92,160
    throughput/device/tokens_per_second=46,633
    throughput/device/batches_per_second=2.530
2025-07-15 19:11:22.315	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:11:22.774	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:11:23.201	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:11:23.636	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:11:24.063	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:11:24.355	g3084:0	olmo.train.trainer:817	INFO	[step=10/1000]
    train/CrossEntropyLoss=11.91
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0305
    train/Accuracy=0.0
    throughput/total_tokens=184,320
    throughput/device/tokens_per_second=44,213
    throughput/device/batches_per_second=2.399
    System/Peak GPU Memory (MB)=29,214
2025-07-15 19:11:24.501	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:11:24.924	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:11:25.348	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:11:25.757	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:11:26.173	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:11:26.462	g3084:0	olmo.train.trainer:817	INFO	[step=15/1000]
    train/CrossEntropyLoss=11.90
    train/ZLoss=0.0143
    train/ImageGenLoss=0.7157
    train/Accuracy=0.0
    throughput/total_tokens=276,480
    throughput/device/tokens_per_second=44,038
    throughput/device/batches_per_second=2.389
2025-07-15 19:11:26.599	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:11:27.028	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:11:27.437	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:11:27.862	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:11:28.290	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:11:28.579	g3084:0	olmo.train.trainer:817	INFO	[step=20/1000]
    train/CrossEntropyLoss=11.83
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=368,640
    throughput/device/tokens_per_second=43,904
    throughput/device/batches_per_second=2.382
    System/Peak GPU Memory (MB)=29,214
2025-07-15 19:11:28.581	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:16:15.325	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:16:15.342	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:16:15.343	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 286.8 seconds
2025-07-15 19:16:15.525	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:16:15.938	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:16:16.367	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:16:16.794	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:16:17.218	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:16:17.510	g3084:0	olmo.train.trainer:817	INFO	[step=25/1000]
    train/CrossEntropyLoss=11.86
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=460,800
    throughput/device/tokens_per_second=46,097
    throughput/device/batches_per_second=2.501
2025-07-15 19:16:17.661	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:16:18.094	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:16:18.541	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:16:18.975	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:16:19.410	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:16:19.704	g3084:0	olmo.train.trainer:817	INFO	[step=30/1000]
    train/CrossEntropyLoss=11.83
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=552,960
    throughput/device/tokens_per_second=43,967
    throughput/device/batches_per_second=2.385
    System/Peak GPU Memory (MB)=29,233
2025-07-15 19:16:19.854	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:16:20.278	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:16:20.706	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:16:21.130	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:16:21.565	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:16:21.859	g3084:0	olmo.train.trainer:817	INFO	[step=35/1000]
    train/CrossEntropyLoss=11.81
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=645,120
    throughput/device/tokens_per_second=43,557
    throughput/device/batches_per_second=2.363
2025-07-15 19:16:22.009	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:16:22.442	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:16:22.878	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:16:23.313	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:16:23.752	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:16:24.046	g3084:0	olmo.train.trainer:817	INFO	[step=40/1000]
    train/CrossEntropyLoss=11.83
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=737,280
    throughput/device/tokens_per_second=43,194
    throughput/device/batches_per_second=2.343
    System/Peak GPU Memory (MB)=29,233
2025-07-15 19:16:24.048	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:16:32.720	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:16:32.735	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:16:32.736	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 8.7 seconds
2025-07-15 19:16:32.921	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:16:33.352	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:16:33.804	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:16:34.239	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:16:34.671	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:16:34.963	g3084:0	olmo.train.trainer:817	INFO	[step=45/1000]
    train/CrossEntropyLoss=11.75
    train/ZLoss=0.0143
    train/ImageGenLoss=2.000
    train/Accuracy=0.0
    throughput/total_tokens=829,440
    throughput/device/tokens_per_second=44,853
    throughput/device/batches_per_second=2.433
2025-07-15 19:16:35.123	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:16:35.553	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:16:35.984	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:16:36.428	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:16:36.861	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:16:37.153	g3084:0	olmo.train.trainer:817	INFO	[step=50/1000]
    train/CrossEntropyLoss=11.68
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=921,600
    throughput/device/tokens_per_second=43,425
    throughput/device/batches_per_second=2.356
    System/Peak GPU Memory (MB)=29,233
2025-07-15 19:16:37.303	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:16:37.714	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:16:38.149	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:16:38.600	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:16:39.029	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:16:39.321	g3084:0	olmo.train.trainer:817	INFO	[step=55/1000]
    train/CrossEntropyLoss=11.67
    train/ZLoss=0.0143
    train/ImageGenLoss=2.000
    train/Accuracy=0.0
    throughput/total_tokens=1,013,760
    throughput/device/tokens_per_second=43,115
    throughput/device/batches_per_second=2.339
2025-07-15 19:16:39.469	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:16:39.904	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:16:40.343	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:16:40.761	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:16:41.177	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:16:41.469	g3084:0	olmo.train.trainer:817	INFO	[step=60/1000]
    train/CrossEntropyLoss=11.72
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=1,105,920
    throughput/device/tokens_per_second=43,063
    throughput/device/batches_per_second=2.336
    System/Peak GPU Memory (MB)=29,233
2025-07-15 19:16:41.471	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:21:32.628	g3084:0	olmo.util:177	CRITICAL	Uncaught BdbQuit: 
Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/Umolmo/launch_scripts/train_multitask_model.py", line 396, in <module>
    run_trainer(cfg)
  File "/gscratch/krishna/mahtab/Umolmo/scripts/train.py", line 333, in run_trainer
    trainer.fit()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 1146, in fit
    eval_metrics = self.inference_eval()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 865, in inference_eval
    dataset_metrics = evaluator.run(
  File "/gscratch/krishna/mahtab/Umolmo/olmo/eval/inf_evaluator.py", line 213, in run
    olmo_gen_output = model.generate(
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py", line 720, in generate
    return OLMoGenerateOutput(
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py", line 720, in generate
    return OLMoGenerateOutput(
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/bdb.py", line 90, in trace_dispatch
    return self.dispatch_line(frame)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/bdb.py", line 115, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit
2025-07-15 19:21:53.200	g3084:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-15 19:21:53.273	g3084:0	train:54	INFO	Configuration:
2025-07-15 19:21:53.274	g3084:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=128, n_heads=2, n_kv_heads=None, head_dim=None, qkv_bias=False, clip_qkv=None, n_layers=1, mlp_ratio=4, mlp_hidden_size=None, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=10000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='default', layer_norm_with_affine=True, layer_norm_eps=None, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=True, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.1, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=None, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2-7B', tokenizer_dir=None), init_path=None, init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='openai', image_default_input_size=(336, 336), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1024, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=1, image_head_dim=64, image_mlp_dim=4096, image_mlp_activations='gelu', image_dropout_rate=0.0, image_num_pos=577, image_norm_eps=1e-05, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path=None, resize_mode='default', pad_value=0.0, normalize='openai'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-1,), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='resize', max_crops=1, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear', per_image_output_tokens=64), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'chart_qa': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=20, inf_evaluators=[InfDatasetEvaluatorConfig(label='chart_qa', data=DataLoaderConfig(dataset='chart_qa', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='relaxed_correctness,scifi_relaxed_correctness,em', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=16, console_log_interval=5, include_image=False)], inf_eval_interval=20, eval_on_last_step=True, eval_on_load=False, save_folder='debug_run', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint=None, allow_resume=True, max_duration=1000, global_train_batch_size=8, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=None, beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=5, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=1000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-15 19:21:53.304	g3084:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-15 19:21:55.654	g3084:0	root:123	INFO	Padding tokenizer with 416 tokens
2025-07-15 19:21:57.661	g3084:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-15 19:21:57.817	g3084:0	train:191	INFO	Total number of parameters: 58,006,016
2025-07-15 19:21:57.818	g3084:0	train:192	INFO	Number of non-embedding parameters: 38,525,440
2025-07-15 19:21:57.819	g3084:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 234
2025-07-15 19:21:57.819	g3084:0	train:196	INFO	Model:
2025-07-15 19:21:57.820	g3084:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0): FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=128, out_features=128, bias=True)
          (ff_out): Linear(in_features=256, out_features=128, bias=True)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): LayerNorm()
          (ff_norm): LayerNorm()
          (att_proj): Linear(in_features=128, out_features=384, bias=True)
          (ff_proj): Linear(in_features=128, out_features=512, bias=True)
        )
      )
    )
    (ln_f): FSDPLayerNorm()
    (emb_drop): Dropout(p=0.1, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=128, out_features=152192, bias=True)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=1024, out_features=1024, bias=True)
        (wk): Linear(in_features=1024, out_features=1024, bias=True)
        (wv): Linear(in_features=1024, out_features=1024, bias=True)
        (wo): Linear(in_features=1024, out_features=1024, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1024, out_features=256, bias=False)
        (w2): Linear(in_features=256, out_features=128, bias=False)
        (w3): Linear(in_features=1024, out_features=256, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1024, bias=False)
      (pre_ln): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0): FSDPResidualAttentionBlock(
            (attention): ViTMultiHeadDotProductAttention(
              (wq): Linear(in_features=1024, out_features=1024, bias=True)
              (wk): Linear(in_features=1024, out_features=1024, bias=True)
              (wv): Linear(in_features=1024, out_features=1024, bias=True)
              (wo): Linear(in_features=1024, out_features=1024, bias=True)
              (residual_dropout): Dropout(p=0.0, inplace=False)
            )
            (feed_forward): ViTMLP(
              (w1): Linear(in_features=1024, out_features=4096, bias=True)
              (act): GELUActivation()
              (w2): Linear(in_features=4096, out_features=1024, bias=True)
            )
            (attention_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (ffn_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=700, out_features=128, bias=False)
  (vision_decoder_head): Linear(in_features=128, out_features=700, bias=False)
)
2025-07-15 19:21:57.832	g3084:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-15 19:21:57.833	g3084:0	olmo.data.data_loader:197	INFO	Loading train dataset chart_qa/train
2025-07-15 19:21:57.833	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_human.json
2025-07-15 19:21:57.870	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_augmented.json
2025-07-15 19:21:57.972	g3084:0	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-15 19:21:57.972	g3084:0	olmo.data.data_loader:219	INFO	chart_qa: 100.00
2025-07-15 19:21:57.974	g3084:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=2304 images=1 pooled_patches_idx=158
2025-07-15 19:21:57.975	g3084:0	olmo.data.data_loader:100	INFO	Loading eval dataset: chart_qa/validation
2025-07-15 19:21:57.975	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_human.json
2025-07-15 19:21:57.981	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_augmented.json
2025-07-15 19:21:57.986	g3084:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=1792 images=1 pooled_patches_idx=158
2025-07-15 19:21:58.228	g3084:0	train:332	INFO	Starting training...
2025-07-15 19:21:58.229	g3084:0	olmo.train.trainer:817	INFO	Pre-train system metrics
    System/Peak GPU Memory (MB)=370.5
2025-07-15 19:22:01.840	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:06.259	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:06.875	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:07.303	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:07.727	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:08.148	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:08.439	g3084:0	olmo.train.trainer:817	INFO	[step=5/1000]
    train/CrossEntropyLoss=11.92
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0318
    train/Accuracy=0.0
    throughput/total_tokens=92,160
    throughput/device/tokens_per_second=46,705
    throughput/device/batches_per_second=2.534
2025-07-15 19:22:08.570	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:09.004	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:09.432	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:09.878	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:10.309	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:10.601	g3084:0	olmo.train.trainer:817	INFO	[step=10/1000]
    train/CrossEntropyLoss=11.91
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0305
    train/Accuracy=0.0
    throughput/total_tokens=184,320
    throughput/device/tokens_per_second=44,353
    throughput/device/batches_per_second=2.406
    System/Peak GPU Memory (MB)=29,214
2025-07-15 19:22:10.750	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:11.181	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:11.606	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:12.019	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:12.448	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:12.739	g3084:0	olmo.train.trainer:817	INFO	[step=15/1000]
    train/CrossEntropyLoss=11.90
    train/ZLoss=0.0143
    train/ImageGenLoss=0.7157
    train/Accuracy=0.0
    throughput/total_tokens=276,480
    throughput/device/tokens_per_second=43,901
    throughput/device/batches_per_second=2.382
2025-07-15 19:22:12.880	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:13.315	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:13.730	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:14.162	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:14.593	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:14.884	g3084:0	olmo.train.trainer:817	INFO	[step=20/1000]
    train/CrossEntropyLoss=11.83
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=368,640
    throughput/device/tokens_per_second=43,650
    throughput/device/batches_per_second=2.368
    System/Peak GPU Memory (MB)=29,214
2025-07-15 19:22:14.886	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:22:20.100	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:22:20.116	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:22:20.117	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 5.2 seconds
2025-07-15 19:22:20.296	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:20.708	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:21.136	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:21.561	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:21.981	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:22.274	g3084:0	olmo.train.trainer:817	INFO	[step=25/1000]
    train/CrossEntropyLoss=11.86
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=460,800
    throughput/device/tokens_per_second=46,301
    throughput/device/batches_per_second=2.512
2025-07-15 19:22:22.419	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:22.849	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:23.292	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:23.730	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:24.163	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:24.455	g3084:0	olmo.train.trainer:817	INFO	[step=30/1000]
    train/CrossEntropyLoss=11.83
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=552,960
    throughput/device/tokens_per_second=44,183
    throughput/device/batches_per_second=2.397
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:22:24.597	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:25.020	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:25.446	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:25.868	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:26.297	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:26.588	g3084:0	olmo.train.trainer:817	INFO	[step=35/1000]
    train/CrossEntropyLoss=11.81
    train/ZLoss=0.0143
    train/ImageGenLoss=2.000
    train/Accuracy=0.0
    throughput/total_tokens=645,120
    throughput/device/tokens_per_second=43,852
    throughput/device/batches_per_second=2.379
2025-07-15 19:22:26.729	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:27.156	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:27.585	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:28.014	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:28.444	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:28.737	g3084:0	olmo.train.trainer:817	INFO	[step=40/1000]
    train/CrossEntropyLoss=11.83
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=737,280
    throughput/device/tokens_per_second=43,611
    throughput/device/batches_per_second=2.366
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:22:28.738	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:22:32.960	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:22:32.975	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:22:32.976	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 4.2 seconds
2025-07-15 19:22:33.150	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:33.579	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:34.024	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:34.459	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:34.889	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:35.180	g3084:0	olmo.train.trainer:817	INFO	[step=45/1000]
    train/CrossEntropyLoss=11.75
    train/ZLoss=0.0143
    train/ImageGenLoss=2.000
    train/Accuracy=0.0
    throughput/total_tokens=829,440
    throughput/device/tokens_per_second=45,126
    throughput/device/batches_per_second=2.448
2025-07-15 19:22:35.336	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:35.762	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:36.185	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:36.627	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:37.055	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:37.349	g3084:0	olmo.train.trainer:817	INFO	[step=50/1000]
    train/CrossEntropyLoss=11.68
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=921,600
    throughput/device/tokens_per_second=43,773
    throughput/device/batches_per_second=2.375
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:22:37.501	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:37.911	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:38.343	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:38.800	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:39.225	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:39.517	g3084:0	olmo.train.trainer:817	INFO	[step=55/1000]
    train/CrossEntropyLoss=11.67
    train/ZLoss=0.0143
    train/ImageGenLoss=2.000
    train/Accuracy=0.0
    throughput/total_tokens=1,013,760
    throughput/device/tokens_per_second=43,338
    throughput/device/batches_per_second=2.351
2025-07-15 19:22:39.665	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:40.096	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:40.531	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:40.946	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:41.358	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:41.649	g3084:0	olmo.train.trainer:817	INFO	[step=60/1000]
    train/CrossEntropyLoss=11.72
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=1,105,920
    throughput/device/tokens_per_second=43,316
    throughput/device/batches_per_second=2.350
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:22:41.650	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:22:45.656	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:22:45.672	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:22:45.672	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 4.0 seconds
2025-07-15 19:22:45.897	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:46.383	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:46.842	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:47.291	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:47.729	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:48.020	g3084:0	olmo.train.trainer:817	INFO	[step=65/1000]
    train/CrossEntropyLoss=11.66
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=1,198,080
    throughput/device/tokens_per_second=43,148
    throughput/device/batches_per_second=2.341
2025-07-15 19:22:48.169	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:48.663	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:49.136	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:49.545	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:50.025	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:50.316	g3084:0	olmo.train.trainer:817	INFO	[step=70/1000]
    train/CrossEntropyLoss=11.65
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=1,290,240
    throughput/device/tokens_per_second=41,593
    throughput/device/batches_per_second=2.257
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:22:50.493	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:50.962	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:51.414	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:51.877	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:52.334	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:52.627	g3084:0	olmo.train.trainer:817	INFO	[step=75/1000]
    train/CrossEntropyLoss=11.57
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=1,382,400
    throughput/device/tokens_per_second=41,007
    throughput/device/batches_per_second=2.225
2025-07-15 19:22:52.826	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:53.277	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:53.690	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:54.144	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:54.580	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:54.872	g3084:0	olmo.train.trainer:817	INFO	[step=80/1000]
    train/CrossEntropyLoss=11.63
    train/ZLoss=0.0143
    train/ImageGenLoss=1.998
    train/Accuracy=0.0139
    throughput/total_tokens=1,474,560
    throughput/device/tokens_per_second=41,019
    throughput/device/batches_per_second=2.225
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:22:54.874	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:22:58.489	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:22:58.505	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:22:58.505	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.6 seconds
2025-07-15 19:22:58.683	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:59.194	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:22:59.633	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:23:00.099	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:23:00.531	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:23:00.821	g3084:0	olmo.train.trainer:817	INFO	[step=85/1000]
    train/CrossEntropyLoss=11.54
    train/ZLoss=0.0143
    train/ImageGenLoss=2.000
    train/Accuracy=0.0290
    throughput/total_tokens=1,566,720
    throughput/device/tokens_per_second=42,841
    throughput/device/batches_per_second=2.324
2025-07-15 19:23:00.985	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:23:01.466	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:23:01.917	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:23:02.389	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:23:02.873	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:23:03.167	g3084:0	olmo.train.trainer:817	INFO	[step=90/1000]
    train/CrossEntropyLoss=11.57
    train/ZLoss=0.0143
    train/ImageGenLoss=2.000
    train/Accuracy=0.0312
    throughput/total_tokens=1,658,880
    throughput/device/tokens_per_second=40,988
    throughput/device/batches_per_second=2.224
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:23:03.371	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:23:03.828	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:23:04.352	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:23:04.813	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:23:05.244	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:23:05.537	g3084:0	olmo.train.trainer:817	INFO	[step=95/1000]
    train/CrossEntropyLoss=11.53
    train/ZLoss=0.0143
    train/ImageGenLoss=2.000
    train/Accuracy=0.0441
    throughput/total_tokens=1,751,040
    throughput/device/tokens_per_second=40,264
    throughput/device/batches_per_second=2.184
2025-07-15 19:23:05.691	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:23:06.139	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:23:06.603	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:23:07.043	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:23:07.480	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:23:07.772	g3084:0	olmo.train.trainer:817	INFO	[step=100/1000]
    train/CrossEntropyLoss=11.51
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0411
    throughput/total_tokens=1,843,200
    throughput/device/tokens_per_second=40,503
    throughput/device/batches_per_second=2.197
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:23:07.774	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:23:11.606	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:23:11.621	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:23:11.621	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.8 seconds
2025-07-15 19:23:11.803	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:23:12.225	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:23:12.645	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:23:13.114	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:23:13.570	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:23:13.861	g3084:0	olmo.train.trainer:817	INFO	[step=105/1000]
    train/CrossEntropyLoss=11.49
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.1077
    throughput/total_tokens=1,935,360
    throughput/device/tokens_per_second=44,504
    throughput/device/batches_per_second=2.414
2025-07-15 19:23:14.082	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:23:14.548	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:23:15.057	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:23:15.490	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:23:15.945	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:23:16.237	g3084:0	olmo.train.trainer:817	INFO	[step=110/1000]
    train/CrossEntropyLoss=11.49
    train/ZLoss=0.0143
    train/ImageGenLoss=2.000
    train/Accuracy=0.1311
    throughput/total_tokens=2,027,520
    throughput/device/tokens_per_second=41,450
    throughput/device/batches_per_second=2.249
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:23:16.397	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:23:16.836	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:23:17.317	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:23:17.780	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:23:18.359	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:23:18.650	g3084:0	olmo.train.trainer:817	INFO	[step=115/1000]
    train/CrossEntropyLoss=11.42
    train/ZLoss=0.0143
    train/ImageGenLoss=2.000
    train/Accuracy=0.1690
    throughput/total_tokens=2,119,680
    throughput/device/tokens_per_second=40,301
    throughput/device/batches_per_second=2.186
2025-07-15 19:23:18.956	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:23:19.562	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:23:20.122	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:23:20.695	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:23:21.230	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:23:21.523	g3084:0	olmo.train.trainer:817	INFO	[step=120/1000]
    train/CrossEntropyLoss=11.47
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0735
    throughput/total_tokens=2,211,840
    throughput/device/tokens_per_second=37,878
    throughput/device/batches_per_second=2.055
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:23:21.524	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:23:25.437	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:23:25.452	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:23:25.453	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.9 seconds
2025-07-15 19:23:25.759	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:23:26.902	g3084:0	olmo.util:177	CRITICAL	Uncaught RuntimeError: Encountered `nan` values in tensor
Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/Umolmo/launch_scripts/train_multitask_model.py", line 396, in <module>
    run_trainer(cfg)
  File "/gscratch/krishna/mahtab/Umolmo/scripts/train.py", line 333, in run_trainer
    trainer.fit()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 1045, in fit
    metrics = self.train_step(batch, compute_metrics=should_log_this_step)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 709, in train_step
    loss = self.train_batch(batch, True)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 661, in train_batch
    self._train_metrics.update(micro_batch, model_out, ce_loss, z_loss, image_gen_loss)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/eval/loss_evaluator.py", line 70, in update
    self.eval_metrics["ImageGenLoss"].update(genloss/gen_total_weight, gen_total_weight)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torchmetrics/metric.py", line 559, in wrapped_func
    raise err
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torchmetrics/metric.py", line 549, in wrapped_func
    update(*args, **kwargs)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torchmetrics/aggregation.py", line 576, in update
    value, weight = self._cast_and_nan_check_input(value, weight)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torchmetrics/aggregation.py", line 95, in _cast_and_nan_check_input
    raise RuntimeError("Encountered `nan` values in tensor")
RuntimeError: Encountered `nan` values in tensor
2025-07-15 19:26:20.921	g3084:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-15 19:26:20.994	g3084:0	train:54	INFO	Configuration:
2025-07-15 19:26:20.995	g3084:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=128, n_heads=2, n_kv_heads=None, head_dim=None, qkv_bias=False, clip_qkv=None, n_layers=1, mlp_ratio=4, mlp_hidden_size=None, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=10000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='default', layer_norm_with_affine=True, layer_norm_eps=None, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=True, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.1, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=None, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2-7B', tokenizer_dir=None), init_path=None, init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='openai', image_default_input_size=(336, 336), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1024, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=1, image_head_dim=64, image_mlp_dim=4096, image_mlp_activations='gelu', image_dropout_rate=0.0, image_num_pos=577, image_norm_eps=1e-05, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path=None, resize_mode='default', pad_value=0.0, normalize='openai'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-1,), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='resize', max_crops=1, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear', per_image_output_tokens=64), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'chart_qa': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=20, inf_evaluators=[InfDatasetEvaluatorConfig(label='chart_qa', data=DataLoaderConfig(dataset='chart_qa', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='relaxed_correctness,scifi_relaxed_correctness,em', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=16, console_log_interval=5, include_image=False)], inf_eval_interval=20, eval_on_last_step=True, eval_on_load=False, save_folder='debug_run', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint=None, allow_resume=True, max_duration=1000, global_train_batch_size=8, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=None, beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=5, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=1000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-15 19:26:21.026	g3084:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-15 19:26:23.462	g3084:0	root:123	INFO	Padding tokenizer with 416 tokens
2025-07-15 19:26:25.465	g3084:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-15 19:26:25.620	g3084:0	train:191	INFO	Total number of parameters: 58,006,016
2025-07-15 19:26:25.621	g3084:0	train:192	INFO	Number of non-embedding parameters: 38,525,440
2025-07-15 19:26:25.622	g3084:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 234
2025-07-15 19:26:25.622	g3084:0	train:196	INFO	Model:
2025-07-15 19:26:25.622	g3084:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0): FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=128, out_features=128, bias=True)
          (ff_out): Linear(in_features=256, out_features=128, bias=True)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): LayerNorm()
          (ff_norm): LayerNorm()
          (att_proj): Linear(in_features=128, out_features=384, bias=True)
          (ff_proj): Linear(in_features=128, out_features=512, bias=True)
        )
      )
    )
    (ln_f): FSDPLayerNorm()
    (emb_drop): Dropout(p=0.1, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=128, out_features=152192, bias=True)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=1024, out_features=1024, bias=True)
        (wk): Linear(in_features=1024, out_features=1024, bias=True)
        (wv): Linear(in_features=1024, out_features=1024, bias=True)
        (wo): Linear(in_features=1024, out_features=1024, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1024, out_features=256, bias=False)
        (w2): Linear(in_features=256, out_features=128, bias=False)
        (w3): Linear(in_features=1024, out_features=256, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1024, bias=False)
      (pre_ln): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0): FSDPResidualAttentionBlock(
            (attention): ViTMultiHeadDotProductAttention(
              (wq): Linear(in_features=1024, out_features=1024, bias=True)
              (wk): Linear(in_features=1024, out_features=1024, bias=True)
              (wv): Linear(in_features=1024, out_features=1024, bias=True)
              (wo): Linear(in_features=1024, out_features=1024, bias=True)
              (residual_dropout): Dropout(p=0.0, inplace=False)
            )
            (feed_forward): ViTMLP(
              (w1): Linear(in_features=1024, out_features=4096, bias=True)
              (act): GELUActivation()
              (w2): Linear(in_features=4096, out_features=1024, bias=True)
            )
            (attention_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (ffn_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=700, out_features=128, bias=False)
  (vision_decoder_head): Linear(in_features=128, out_features=700, bias=False)
)
2025-07-15 19:26:25.632	g3084:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-15 19:26:25.633	g3084:0	olmo.data.data_loader:197	INFO	Loading train dataset chart_qa/train
2025-07-15 19:26:25.633	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_human.json
2025-07-15 19:26:25.669	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_augmented.json
2025-07-15 19:26:25.771	g3084:0	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-15 19:26:25.771	g3084:0	olmo.data.data_loader:219	INFO	chart_qa: 100.00
2025-07-15 19:26:25.773	g3084:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=2304 images=1 pooled_patches_idx=158
2025-07-15 19:26:25.774	g3084:0	olmo.data.data_loader:100	INFO	Loading eval dataset: chart_qa/validation
2025-07-15 19:26:25.774	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_human.json
2025-07-15 19:26:25.780	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_augmented.json
2025-07-15 19:26:25.785	g3084:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=1792 images=1 pooled_patches_idx=158
2025-07-15 19:26:26.036	g3084:0	train:332	INFO	Starting training...
2025-07-15 19:26:26.038	g3084:0	olmo.train.trainer:817	INFO	Pre-train system metrics
    System/Peak GPU Memory (MB)=370.5
2025-07-15 19:26:29.560	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:26:33.896	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:26:34.499	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:26:34.921	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:26:35.340	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:26:35.755	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:26:36.044	g3084:0	olmo.train.trainer:817	INFO	[step=5/1000]
    train/CrossEntropyLoss=11.92
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0318
    train/Accuracy=0.0
    throughput/total_tokens=92,160
    throughput/device/tokens_per_second=47,293
    throughput/device/batches_per_second=2.566
2025-07-15 19:26:36.173	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:26:36.600	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:26:37.022	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:26:37.458	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:26:37.882	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:26:38.171	g3084:0	olmo.train.trainer:817	INFO	[step=10/1000]
    train/CrossEntropyLoss=11.91
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0305
    train/Accuracy=0.0
    throughput/total_tokens=184,320
    throughput/device/tokens_per_second=45,008
    throughput/device/batches_per_second=2.442
    System/Peak GPU Memory (MB)=29,214
2025-07-15 19:26:38.317	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:26:38.746	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:26:39.167	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:26:39.580	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:26:40.001	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:26:40.292	g3084:0	olmo.train.trainer:817	INFO	[step=15/1000]
    train/CrossEntropyLoss=11.90
    train/ZLoss=0.0143
    train/ImageGenLoss=0.7157
    train/Accuracy=0.0
    throughput/total_tokens=276,480
    throughput/device/tokens_per_second=44,439
    throughput/device/batches_per_second=2.411
2025-07-15 19:26:40.432	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:26:40.863	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:26:41.276	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:26:41.704	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:26:42.143	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:26:42.435	g3084:0	olmo.train.trainer:817	INFO	[step=20/1000]
    train/CrossEntropyLoss=11.84
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=368,640
    throughput/device/tokens_per_second=44,057
    throughput/device/batches_per_second=2.390
    System/Peak GPU Memory (MB)=29,214
2025-07-15 19:26:42.436	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:26:47.650	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:26:47.666	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:26:47.667	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 5.2 seconds
2025-07-15 19:26:47.838	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:26:48.247	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:26:48.670	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:26:49.088	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:26:49.504	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:26:49.794	g3084:0	olmo.train.trainer:817	INFO	[step=25/1000]
    train/CrossEntropyLoss=11.86
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=460,800
    throughput/device/tokens_per_second=46,831
    throughput/device/batches_per_second=2.541
2025-07-15 19:26:49.939	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:26:50.365	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:26:50.806	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:26:51.237	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:26:51.665	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:26:51.957	g3084:0	olmo.train.trainer:817	INFO	[step=30/1000]
    train/CrossEntropyLoss=11.83
    train/ZLoss=0.0143
    train/ImageGenLoss=2.000
    train/Accuracy=0.0
    throughput/total_tokens=552,960
    throughput/device/tokens_per_second=44,618
    throughput/device/batches_per_second=2.421
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:26:52.096	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:26:52.517	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:26:52.940	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:26:53.364	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:26:53.788	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:26:54.079	g3084:0	olmo.train.trainer:817	INFO	[step=35/1000]
    train/CrossEntropyLoss=11.81
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=645,120
    throughput/device/tokens_per_second=44,214
    throughput/device/batches_per_second=2.399
2025-07-15 19:26:54.218	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:26:54.644	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:26:55.071	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:26:55.499	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:26:55.931	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:26:56.222	g3084:0	olmo.train.trainer:817	INFO	[step=40/1000]
    train/CrossEntropyLoss=11.83
    train/ZLoss=0.0143
    train/ImageGenLoss=2.000
    train/Accuracy=0.0
    throughput/total_tokens=737,280
    throughput/device/tokens_per_second=43,905
    throughput/device/batches_per_second=2.382
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:26:56.224	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:27:00.407	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:27:00.423	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:27:00.423	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 4.2 seconds
2025-07-15 19:27:00.601	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:01.031	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:01.484	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:01.921	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:02.369	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:02.663	g3084:0	olmo.train.trainer:817	INFO	[step=45/1000]
    train/CrossEntropyLoss=11.75
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=829,440
    throughput/device/tokens_per_second=44,419
    throughput/device/batches_per_second=2.410
2025-07-15 19:27:02.824	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:03.256	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:03.691	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:04.133	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:04.565	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:04.856	g3084:0	olmo.train.trainer:817	INFO	[step=50/1000]
    train/CrossEntropyLoss=11.68
    train/ZLoss=0.0143
    train/ImageGenLoss=2.000
    train/Accuracy=0.0
    throughput/total_tokens=921,600
    throughput/device/tokens_per_second=43,188
    throughput/device/batches_per_second=2.343
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:27:05.003	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:05.411	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:05.847	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:06.294	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:06.719	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:07.012	g3084:0	olmo.train.trainer:817	INFO	[step=55/1000]
    train/CrossEntropyLoss=11.67
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=1,013,760
    throughput/device/tokens_per_second=43,039
    throughput/device/batches_per_second=2.335
2025-07-15 19:27:07.157	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:07.585	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:08.023	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:08.440	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:08.857	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:09.151	g3084:0	olmo.train.trainer:817	INFO	[step=60/1000]
    train/CrossEntropyLoss=11.72
    train/ZLoss=0.0143
    train/ImageGenLoss=2.000
    train/Accuracy=0.0
    throughput/total_tokens=1,105,920
    throughput/device/tokens_per_second=43,052
    throughput/device/batches_per_second=2.336
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:27:09.153	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:27:13.047	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:27:13.063	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:27:13.064	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.9 seconds
2025-07-15 19:27:13.233	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:13.657	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:14.092	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:14.523	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:14.957	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:15.248	g3084:0	olmo.train.trainer:817	INFO	[step=65/1000]
    train/CrossEntropyLoss=11.66
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=1,198,080
    throughput/device/tokens_per_second=45,434
    throughput/device/batches_per_second=2.465
2025-07-15 19:27:15.380	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:15.811	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:16.240	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:16.647	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:17.074	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:17.365	g3084:0	olmo.train.trainer:817	INFO	[step=70/1000]
    train/CrossEntropyLoss=11.65
    train/ZLoss=0.0143
    train/ImageGenLoss=2.000
    train/Accuracy=0.0
    throughput/total_tokens=1,290,240
    throughput/device/tokens_per_second=44,473
    throughput/device/batches_per_second=2.413
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:27:17.514	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:17.940	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:18.360	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:18.804	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:19.234	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:19.525	g3084:0	olmo.train.trainer:817	INFO	[step=75/1000]
    train/CrossEntropyLoss=11.57
    train/ZLoss=0.0143
    train/ImageGenLoss=2.000
    train/Accuracy=0.0
    throughput/total_tokens=1,382,400
    throughput/device/tokens_per_second=43,849
    throughput/device/batches_per_second=2.379
2025-07-15 19:27:19.657	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:20.078	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:20.489	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:20.924	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:21.351	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:21.645	g3084:0	olmo.train.trainer:817	INFO	[step=80/1000]
    train/CrossEntropyLoss=11.63
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0139
    throughput/total_tokens=1,474,560
    throughput/device/tokens_per_second=43,759
    throughput/device/batches_per_second=2.374
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:27:21.646	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:27:25.351	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:27:25.367	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:27:25.368	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.7 seconds
2025-07-15 19:27:25.532	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:25.960	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:26.396	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:26.855	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:27.288	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:27.579	g3084:0	olmo.train.trainer:817	INFO	[step=85/1000]
    train/CrossEntropyLoss=11.54
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0290
    throughput/total_tokens=1,566,720
    throughput/device/tokens_per_second=44,744
    throughput/device/batches_per_second=2.428
2025-07-15 19:27:27.714	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:28.159	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:28.582	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:29.023	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:29.467	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:29.762	g3084:0	olmo.train.trainer:817	INFO	[step=90/1000]
    train/CrossEntropyLoss=11.57
    train/ZLoss=0.0143
    train/ImageGenLoss=2.000
    train/Accuracy=0.0312
    throughput/total_tokens=1,658,880
    throughput/device/tokens_per_second=43,449
    throughput/device/batches_per_second=2.357
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:27:29.911	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:30.352	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:30.789	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:31.213	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:31.638	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:31.928	g3084:0	olmo.train.trainer:817	INFO	[step=95/1000]
    train/CrossEntropyLoss=11.53
    train/ZLoss=0.0143
    train/ImageGenLoss=1.999
    train/Accuracy=0.0441
    throughput/total_tokens=1,751,040
    throughput/device/tokens_per_second=43,139
    throughput/device/batches_per_second=2.340
2025-07-15 19:27:32.064	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:32.497	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:32.918	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:33.350	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:33.786	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:34.079	g3084:0	olmo.train.trainer:817	INFO	[step=100/1000]
    train/CrossEntropyLoss=11.51
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0411
    throughput/total_tokens=1,843,200
    throughput/device/tokens_per_second=43,068
    throughput/device/batches_per_second=2.337
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:27:34.081	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:27:37.983	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:27:37.999	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:27:38.000	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.9 seconds
2025-07-15 19:27:38.153	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:38.579	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:39.005	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:39.454	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:39.876	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:40.167	g3084:0	olmo.train.trainer:817	INFO	[step=105/1000]
    train/CrossEntropyLoss=11.49
    train/ZLoss=0.0143
    train/ImageGenLoss=2.000
    train/Accuracy=0.1077
    throughput/total_tokens=1,935,360
    throughput/device/tokens_per_second=45,474
    throughput/device/batches_per_second=2.467
2025-07-15 19:27:40.307	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:40.746	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:41.194	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:41.625	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:42.061	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:42.355	g3084:0	olmo.train.trainer:817	INFO	[step=110/1000]
    train/CrossEntropyLoss=11.49
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.1475
    throughput/total_tokens=2,027,520
    throughput/device/tokens_per_second=43,738
    throughput/device/batches_per_second=2.373
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:27:42.499	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:42.931	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:43.363	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:43.801	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:44.236	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:44.526	g3084:0	olmo.train.trainer:817	INFO	[step=115/1000]
    train/CrossEntropyLoss=11.42
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.1690
    throughput/total_tokens=2,119,680
    throughput/device/tokens_per_second=43,295
    throughput/device/batches_per_second=2.349
2025-07-15 19:27:44.679	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:45.112	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:45.538	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:45.974	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:46.393	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:27:46.685	g3084:0	olmo.train.trainer:817	INFO	[step=120/1000]
    train/CrossEntropyLoss=11.47
    train/ZLoss=0.0143
    train/ImageGenLoss=2.000
    train/Accuracy=0.0735
    throughput/total_tokens=2,211,840
    throughput/device/tokens_per_second=43,146
    throughput/device/batches_per_second=2.341
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:27:46.686	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:27:50.642	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:27:50.658	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:27:50.659	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 4.0 seconds
2025-07-15 19:27:50.831	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:31:26.567	g3084:0	olmo.util:177	CRITICAL	Uncaught BdbQuit: 
Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/Umolmo/launch_scripts/train_multitask_model.py", line 396, in <module>
    run_trainer(cfg)
  File "/gscratch/krishna/mahtab/Umolmo/scripts/train.py", line 333, in run_trainer
    trainer.fit()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 1045, in fit
    metrics = self.train_step(batch, compute_metrics=should_log_this_step)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 709, in train_step
    loss = self.train_batch(batch, True)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 661, in train_batch
    self._train_metrics.update(micro_batch, model_out, ce_loss, z_loss, image_gen_loss)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/eval/loss_evaluator.py", line 74, in update
    self.eval_metrics["ZLoss"].update(zloss/total_weight, total_weight)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/eval/loss_evaluator.py", line 74, in update
    self.eval_metrics["ZLoss"].update(zloss/total_weight, total_weight)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/bdb.py", line 90, in trace_dispatch
    return self.dispatch_line(frame)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/bdb.py", line 115, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit
2025-07-15 19:31:48.519	g3084:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-15 19:31:48.591	g3084:0	train:54	INFO	Configuration:
2025-07-15 19:31:48.592	g3084:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=128, n_heads=2, n_kv_heads=None, head_dim=None, qkv_bias=False, clip_qkv=None, n_layers=1, mlp_ratio=4, mlp_hidden_size=None, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=10000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='default', layer_norm_with_affine=True, layer_norm_eps=None, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=True, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.1, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=None, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2-7B', tokenizer_dir=None), init_path=None, init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='openai', image_default_input_size=(336, 336), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1024, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=1, image_head_dim=64, image_mlp_dim=4096, image_mlp_activations='gelu', image_dropout_rate=0.0, image_num_pos=577, image_norm_eps=1e-05, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path=None, resize_mode='default', pad_value=0.0, normalize='openai'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-1,), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='resize', max_crops=1, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear', per_image_output_tokens=64), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'chart_qa': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=20, inf_evaluators=[InfDatasetEvaluatorConfig(label='chart_qa', data=DataLoaderConfig(dataset='chart_qa', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='relaxed_correctness,scifi_relaxed_correctness,em', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=16, console_log_interval=5, include_image=False)], inf_eval_interval=20, eval_on_last_step=True, eval_on_load=False, save_folder='debug_run', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint=None, allow_resume=True, max_duration=1000, global_train_batch_size=8, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=None, beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=5, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=1000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-15 19:31:48.640	g3084:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-15 19:31:50.977	g3084:0	root:123	INFO	Padding tokenizer with 416 tokens
2025-07-15 19:31:52.994	g3084:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-15 19:31:53.139	g3084:0	train:191	INFO	Total number of parameters: 58,006,016
2025-07-15 19:31:53.140	g3084:0	train:192	INFO	Number of non-embedding parameters: 38,525,440
2025-07-15 19:31:53.141	g3084:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 234
2025-07-15 19:31:53.141	g3084:0	train:196	INFO	Model:
2025-07-15 19:31:53.141	g3084:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0): FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=128, out_features=128, bias=True)
          (ff_out): Linear(in_features=256, out_features=128, bias=True)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): LayerNorm()
          (ff_norm): LayerNorm()
          (att_proj): Linear(in_features=128, out_features=384, bias=True)
          (ff_proj): Linear(in_features=128, out_features=512, bias=True)
        )
      )
    )
    (ln_f): FSDPLayerNorm()
    (emb_drop): Dropout(p=0.1, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=128, out_features=152192, bias=True)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=1024, out_features=1024, bias=True)
        (wk): Linear(in_features=1024, out_features=1024, bias=True)
        (wv): Linear(in_features=1024, out_features=1024, bias=True)
        (wo): Linear(in_features=1024, out_features=1024, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1024, out_features=256, bias=False)
        (w2): Linear(in_features=256, out_features=128, bias=False)
        (w3): Linear(in_features=1024, out_features=256, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1024, bias=False)
      (pre_ln): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0): FSDPResidualAttentionBlock(
            (attention): ViTMultiHeadDotProductAttention(
              (wq): Linear(in_features=1024, out_features=1024, bias=True)
              (wk): Linear(in_features=1024, out_features=1024, bias=True)
              (wv): Linear(in_features=1024, out_features=1024, bias=True)
              (wo): Linear(in_features=1024, out_features=1024, bias=True)
              (residual_dropout): Dropout(p=0.0, inplace=False)
            )
            (feed_forward): ViTMLP(
              (w1): Linear(in_features=1024, out_features=4096, bias=True)
              (act): GELUActivation()
              (w2): Linear(in_features=4096, out_features=1024, bias=True)
            )
            (attention_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (ffn_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=700, out_features=128, bias=False)
  (vision_decoder_head): Linear(in_features=128, out_features=700, bias=False)
)
2025-07-15 19:31:53.151	g3084:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-15 19:31:53.152	g3084:0	olmo.data.data_loader:197	INFO	Loading train dataset chart_qa/train
2025-07-15 19:31:53.152	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_human.json
2025-07-15 19:31:53.222	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_augmented.json
2025-07-15 19:31:53.375	g3084:0	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-15 19:31:53.376	g3084:0	olmo.data.data_loader:219	INFO	chart_qa: 100.00
2025-07-15 19:31:53.377	g3084:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=2304 images=1 pooled_patches_idx=158
2025-07-15 19:31:53.378	g3084:0	olmo.data.data_loader:100	INFO	Loading eval dataset: chart_qa/validation
2025-07-15 19:31:53.378	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_human.json
2025-07-15 19:31:53.398	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_augmented.json
2025-07-15 19:31:53.427	g3084:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=1792 images=1 pooled_patches_idx=158
2025-07-15 19:31:53.656	g3084:0	train:332	INFO	Starting training...
2025-07-15 19:31:53.658	g3084:0	olmo.train.trainer:817	INFO	Pre-train system metrics
    System/Peak GPU Memory (MB)=370.5
2025-07-15 19:31:57.598	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:01.683	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:02.305	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:02.743	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:03.148	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:03.560	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:03.844	g3084:0	olmo.train.trainer:817	INFO	[step=5/1000]
    train/CrossEntropyLoss=11.92
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0318
    train/Accuracy=0.0
    throughput/total_tokens=92,160
    throughput/device/tokens_per_second=47,488
    throughput/device/batches_per_second=2.576
2025-07-15 19:32:03.970	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:04.552	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:04.979	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:05.412	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:05.824	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:06.110	g3084:0	olmo.train.trainer:817	INFO	[step=10/1000]
    train/CrossEntropyLoss=11.91
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0305
    train/Accuracy=0.0
    throughput/total_tokens=184,320
    throughput/device/tokens_per_second=43,450
    throughput/device/batches_per_second=2.357
    System/Peak GPU Memory (MB)=29,214
2025-07-15 19:32:06.245	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:06.655	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:07.059	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:07.451	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:07.857	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:08.181	g3084:0	olmo.train.trainer:817	INFO	[step=15/1000]
    train/CrossEntropyLoss=11.90
    train/ZLoss=0.0143
    train/ImageGenLoss=0.7157
    train/Accuracy=0.0
    throughput/total_tokens=276,480
    throughput/device/tokens_per_second=43,818
    throughput/device/batches_per_second=2.377
2025-07-15 19:32:08.308	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:08.732	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:09.148	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:09.579	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:10.007	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:10.296	g3084:0	olmo.train.trainer:817	INFO	[step=20/1000]
    train/CrossEntropyLoss=11.83
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=368,640
    throughput/device/tokens_per_second=43,753
    throughput/device/batches_per_second=2.374
    System/Peak GPU Memory (MB)=29,214
2025-07-15 19:32:10.298	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:32:16.966	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:32:17.073	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:32:17.074	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 6.8 seconds
2025-07-15 19:32:17.253	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:17.662	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:18.093	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:18.521	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:18.938	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:19.229	g3084:0	olmo.train.trainer:817	INFO	[step=25/1000]
    train/CrossEntropyLoss=11.86
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=460,800
    throughput/device/tokens_per_second=46,344
    throughput/device/batches_per_second=2.514
2025-07-15 19:32:19.374	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:19.805	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:20.244	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:20.675	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:21.109	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:21.399	g3084:0	olmo.train.trainer:817	INFO	[step=30/1000]
    train/CrossEntropyLoss=11.83
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=552,960
    throughput/device/tokens_per_second=44,322
    throughput/device/batches_per_second=2.405
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:32:21.538	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:21.961	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:22.388	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:22.809	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:23.236	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:23.528	g3084:0	olmo.train.trainer:817	INFO	[step=35/1000]
    train/CrossEntropyLoss=11.81
    train/ZLoss=0.0143
    train/ImageGenLoss=2.000
    train/Accuracy=0.0
    throughput/total_tokens=645,120
    throughput/device/tokens_per_second=43,970
    throughput/device/batches_per_second=2.386
2025-07-15 19:32:23.666	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:24.092	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:24.517	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:24.941	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:25.369	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:25.659	g3084:0	olmo.train.trainer:817	INFO	[step=40/1000]
    train/CrossEntropyLoss=11.83
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=737,280
    throughput/device/tokens_per_second=43,790
    throughput/device/batches_per_second=2.376
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:32:25.660	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:32:29.762	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:32:29.777	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:32:29.778	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 4.1 seconds
2025-07-15 19:32:29.954	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:30.384	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:30.832	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:31.261	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:31.691	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:31.981	g3084:0	olmo.train.trainer:817	INFO	[step=45/1000]
    train/CrossEntropyLoss=11.75
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=829,440
    throughput/device/tokens_per_second=45,181
    throughput/device/batches_per_second=2.451
2025-07-15 19:32:32.136	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:32.562	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:33.021	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:33.458	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:33.888	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:34.180	g3084:0	olmo.train.trainer:817	INFO	[step=50/1000]
    train/CrossEntropyLoss=11.68
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=921,600
    throughput/device/tokens_per_second=43,492
    throughput/device/batches_per_second=2.360
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:32:34.336	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:34.744	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:35.176	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:35.625	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:36.061	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:36.354	g3084:0	olmo.train.trainer:817	INFO	[step=55/1000]
    train/CrossEntropyLoss=11.67
    train/ZLoss=0.0143
    train/ImageGenLoss=1.999
    train/Accuracy=0.0
    throughput/total_tokens=1,013,760
    throughput/device/tokens_per_second=43,115
    throughput/device/batches_per_second=2.339
2025-07-15 19:32:36.501	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:36.935	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:37.371	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:37.780	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:38.193	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:38.483	g3084:0	olmo.train.trainer:817	INFO	[step=60/1000]
    train/CrossEntropyLoss=11.72
    train/ZLoss=0.0143
    train/ImageGenLoss=2.000
    train/Accuracy=0.0
    throughput/total_tokens=1,105,920
    throughput/device/tokens_per_second=43,162
    throughput/device/batches_per_second=2.342
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:32:38.485	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:32:42.323	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:32:42.339	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:32:42.339	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.9 seconds
2025-07-15 19:32:42.526	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:42.950	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:43.387	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:43.838	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:44.274	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:44.563	g3084:0	olmo.train.trainer:817	INFO	[step=65/1000]
    train/CrossEntropyLoss=11.66
    train/ZLoss=0.0143
    train/ImageGenLoss=2.000
    train/Accuracy=0.0
    throughput/total_tokens=1,198,080
    throughput/device/tokens_per_second=44,969
    throughput/device/batches_per_second=2.440
2025-07-15 19:32:44.694	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:45.124	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:45.552	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:45.958	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:46.403	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:46.693	g3084:0	olmo.train.trainer:817	INFO	[step=70/1000]
    train/CrossEntropyLoss=11.65
    train/ZLoss=0.0143
    train/ImageGenLoss=2.000
    train/Accuracy=0.0
    throughput/total_tokens=1,290,240
    throughput/device/tokens_per_second=44,106
    throughput/device/batches_per_second=2.393
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:32:46.842	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:47.273	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:47.691	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:48.136	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:48.568	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:48.857	g3084:0	olmo.train.trainer:817	INFO	[step=75/1000]
    train/CrossEntropyLoss=11.57
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=1,382,400
    throughput/device/tokens_per_second=43,585
    throughput/device/batches_per_second=2.365
2025-07-15 19:32:48.990	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:49.409	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:49.821	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:50.257	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:50.683	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:50.976	g3084:0	olmo.train.trainer:817	INFO	[step=80/1000]
    train/CrossEntropyLoss=11.63
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0139
    throughput/total_tokens=1,474,560
    throughput/device/tokens_per_second=43,565
    throughput/device/batches_per_second=2.364
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:32:50.978	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:32:54.493	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:32:54.508	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:32:54.509	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.5 seconds
2025-07-15 19:32:54.665	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:55.089	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:55.521	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:55.966	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:56.399	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:56.688	g3084:0	olmo.train.trainer:817	INFO	[step=85/1000]
    train/CrossEntropyLoss=11.54
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0290
    throughput/total_tokens=1,566,720
    throughput/device/tokens_per_second=45,277
    throughput/device/batches_per_second=2.456
2025-07-15 19:32:56.828	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:57.266	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:57.692	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:58.122	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:58.562	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:58.852	g3084:0	olmo.train.trainer:817	INFO	[step=90/1000]
    train/CrossEntropyLoss=11.57
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0312
    throughput/total_tokens=1,658,880
    throughput/device/tokens_per_second=43,902
    throughput/device/batches_per_second=2.382
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:32:58.979	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:59.413	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:32:59.873	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:00.301	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:00.729	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:01.020	g3084:0	olmo.train.trainer:817	INFO	[step=95/1000]
    train/CrossEntropyLoss=11.53
    train/ZLoss=0.0143
    train/ImageGenLoss=2.000
    train/Accuracy=0.0441
    throughput/total_tokens=1,751,040
    throughput/device/tokens_per_second=43,421
    throughput/device/batches_per_second=2.356
2025-07-15 19:33:01.156	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:01.588	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:02.017	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:02.459	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:02.898	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:03.191	g3084:0	olmo.train.trainer:817	INFO	[step=100/1000]
    train/CrossEntropyLoss=11.51
    train/ZLoss=0.0143
    train/ImageGenLoss=2.000
    train/Accuracy=0.0411
    throughput/total_tokens=1,843,200
    throughput/device/tokens_per_second=43,175
    throughput/device/batches_per_second=2.342
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:33:03.193	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:33:06.986	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:33:07.002	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:33:07.002	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.8 seconds
2025-07-15 19:33:07.162	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:07.587	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:08.012	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:08.461	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:08.884	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:09.175	g3084:0	olmo.train.trainer:817	INFO	[step=105/1000]
    train/CrossEntropyLoss=11.49
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.1077
    throughput/total_tokens=1,935,360
    throughput/device/tokens_per_second=45,480
    throughput/device/batches_per_second=2.467
2025-07-15 19:33:09.335	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:09.765	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:10.212	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:10.643	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:11.071	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:11.362	g3084:0	olmo.train.trainer:817	INFO	[step=110/1000]
    train/CrossEntropyLoss=11.49
    train/ZLoss=0.0143
    train/ImageGenLoss=2.000
    train/Accuracy=0.1311
    throughput/total_tokens=2,027,520
    throughput/device/tokens_per_second=43,754
    throughput/device/batches_per_second=2.374
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:33:11.505	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:11.941	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:12.386	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:12.815	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:13.252	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:13.543	g3084:0	olmo.train.trainer:817	INFO	[step=115/1000]
    train/CrossEntropyLoss=11.42
    train/ZLoss=0.0143
    train/ImageGenLoss=2.000
    train/Accuracy=0.1690
    throughput/total_tokens=2,119,680
    throughput/device/tokens_per_second=43,240
    throughput/device/batches_per_second=2.346
2025-07-15 19:33:13.691	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:14.124	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:14.551	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:14.986	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:15.403	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:15.693	g3084:0	olmo.train.trainer:817	INFO	[step=120/1000]
    train/CrossEntropyLoss=11.47
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0735
    throughput/total_tokens=2,211,840
    throughput/device/tokens_per_second=43,145
    throughput/device/batches_per_second=2.341
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:33:15.695	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:33:19.488	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:33:19.503	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:33:19.504	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.8 seconds
2025-07-15 19:33:19.671	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:20.251	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:20.688	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:21.257	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:21.842	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:22.133	g3084:0	olmo.train.trainer:817	INFO	[step=125/1000]
    train/CrossEntropyLoss=11.42
    train/ZLoss=0.0143
    train/ImageGenLoss=2.000
    train/Accuracy=0.1806
    throughput/total_tokens=2,304,000
    throughput/device/tokens_per_second=37,239
    throughput/device/batches_per_second=2.020
2025-07-15 19:33:22.460	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:23.030	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:23.625	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:24.217	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:24.805	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:25.096	g3084:0	olmo.train.trainer:817	INFO	[step=130/1000]
    train/CrossEntropyLoss=11.48
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.1200
    throughput/total_tokens=2,396,160
    throughput/device/tokens_per_second=33,898
    throughput/device/batches_per_second=1.839
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:33:25.378	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:25.944	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:26.526	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:27.077	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:27.684	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:27.974	g3084:0	olmo.train.trainer:817	INFO	[step=135/1000]
    train/CrossEntropyLoss=11.36
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.2143
    throughput/total_tokens=2,488,320
    throughput/device/tokens_per_second=33,247
    throughput/device/batches_per_second=1.804
2025-07-15 19:33:28.343	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:28.889	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:29.431	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:29.989	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:30.585	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:30.876	g3084:0	olmo.train.trainer:817	INFO	[step=140/1000]
    train/CrossEntropyLoss=11.38
    train/ZLoss=0.0143
    train/ImageGenLoss=2.000
    train/Accuracy=0.1928
    throughput/total_tokens=2,580,480
    throughput/device/tokens_per_second=32,864
    throughput/device/batches_per_second=1.783
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:33:30.877	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:33:34.444	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:33:34.459	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:33:34.460	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.6 seconds
2025-07-15 19:33:34.716	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:35.285	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:35.837	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:36.444	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:37.036	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:37.327	g3084:0	olmo.train.trainer:817	INFO	[step=145/1000]
    train/CrossEntropyLoss=11.39
    train/ZLoss=0.0143
    train/ImageGenLoss=1.999
    train/Accuracy=0.1774
    throughput/total_tokens=2,672,640
    throughput/device/tokens_per_second=35,112
    throughput/device/batches_per_second=1.905
2025-07-15 19:33:37.627	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:38.308	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:38.891	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:39.461	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:40.075	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:40.365	g3084:0	olmo.train.trainer:817	INFO	[step=150/1000]
    train/CrossEntropyLoss=11.33
    train/ZLoss=0.0143
    train/ImageGenLoss=1.969
    train/Accuracy=0.2258
    throughput/total_tokens=2,764,800
    throughput/device/tokens_per_second=32,552
    throughput/device/batches_per_second=1.766
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:33:40.680	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:41.270	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:41.840	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:42.430	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:42.995	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:43.287	g3084:0	olmo.train.trainer:817	INFO	[step=155/1000]
    train/CrossEntropyLoss=11.36
    train/ZLoss=0.0143
    train/ImageGenLoss=1.969
    train/Accuracy=0.1975
    throughput/total_tokens=2,856,960
    throughput/device/tokens_per_second=32,207
    throughput/device/batches_per_second=1.747
2025-07-15 19:33:43.603	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:44.170	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:44.719	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:45.265	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:45.840	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:46.131	g3084:0	olmo.train.trainer:817	INFO	[step=160/1000]
    train/CrossEntropyLoss=11.30
    train/ZLoss=0.0143
    train/ImageGenLoss=1.969
    train/Accuracy=0.2442
    throughput/total_tokens=2,949,120
    throughput/device/tokens_per_second=32,257
    throughput/device/batches_per_second=1.750
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:33:46.133	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:33:49.742	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:33:49.757	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:33:49.758	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.6 seconds
2025-07-15 19:33:50.063	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:50.620	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:51.162	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:51.770	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:52.318	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:52.609	g3084:0	olmo.train.trainer:817	INFO	[step=165/1000]
    train/CrossEntropyLoss=11.36
    train/ZLoss=0.0143
    train/ImageGenLoss=1.969
    train/Accuracy=0.1831
    throughput/total_tokens=3,041,280
    throughput/device/tokens_per_second=36,021
    throughput/device/batches_per_second=1.954
2025-07-15 19:33:52.863	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:53.406	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:53.943	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:54.498	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:55.046	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:55.337	g3084:0	olmo.train.trainer:817	INFO	[step=170/1000]
    train/CrossEntropyLoss=11.34
    train/ZLoss=0.0142
    train/ImageGenLoss=1.968
    train/Accuracy=0.2167
    throughput/total_tokens=3,133,440
    throughput/device/tokens_per_second=34,871
    throughput/device/batches_per_second=1.892
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:33:55.605	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:56.162	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:56.686	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:57.260	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:57.823	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:58.112	g3084:0	olmo.train.trainer:817	INFO	[step=175/1000]
    train/CrossEntropyLoss=11.26
    train/ZLoss=0.0142
    train/ImageGenLoss=1.968
    train/Accuracy=0.2222
    throughput/total_tokens=3,225,600
    throughput/device/tokens_per_second=34,294
    throughput/device/batches_per_second=1.861
2025-07-15 19:33:58.387	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:58.929	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:33:59.490	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:00.066	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:00.603	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:00.895	g3084:0	olmo.train.trainer:817	INFO	[step=180/1000]
    train/CrossEntropyLoss=11.34
    train/ZLoss=0.0142
    train/ImageGenLoss=1.968
    train/Accuracy=0.2154
    throughput/total_tokens=3,317,760
    throughput/device/tokens_per_second=33,994
    throughput/device/batches_per_second=1.844
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:34:00.897	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:34:04.746	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:34:04.761	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:34:04.762	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.9 seconds
2025-07-15 19:34:05.085	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:05.643	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:06.235	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:06.805	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:07.361	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:07.653	g3084:0	olmo.train.trainer:817	INFO	[step=185/1000]
    train/CrossEntropyLoss=11.26
    train/ZLoss=0.0142
    train/ImageGenLoss=1.967
    train/Accuracy=0.2254
    throughput/total_tokens=3,409,920
    throughput/device/tokens_per_second=35,711
    throughput/device/batches_per_second=1.937
2025-07-15 19:34:07.913	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:08.549	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:09.176	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:09.756	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:10.299	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:10.589	g3084:0	olmo.train.trainer:817	INFO	[step=190/1000]
    train/CrossEntropyLoss=11.20
    train/ZLoss=0.0142
    train/ImageGenLoss=1.967
    train/Accuracy=0.2453
    throughput/total_tokens=3,502,080
    throughput/device/tokens_per_second=33,411
    throughput/device/batches_per_second=1.813
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:34:10.901	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:11.458	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:12.020	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:12.546	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:13.087	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:13.378	g3084:0	olmo.train.trainer:817	INFO	[step=195/1000]
    train/CrossEntropyLoss=11.26
    train/ZLoss=0.0142
    train/ImageGenLoss=1.965
    train/Accuracy=0.2500
    throughput/total_tokens=3,594,240
    throughput/device/tokens_per_second=33,285
    throughput/device/batches_per_second=1.806
2025-07-15 19:34:13.668	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:14.197	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:14.738	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:15.287	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:15.832	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:16.123	g3084:0	olmo.train.trainer:817	INFO	[step=200/1000]
    train/CrossEntropyLoss=11.23
    train/ZLoss=0.0142
    train/ImageGenLoss=1.966
    train/Accuracy=0.2949
    throughput/total_tokens=3,686,400
    throughput/device/tokens_per_second=33,358
    throughput/device/batches_per_second=1.810
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:34:16.125	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:34:19.733	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:34:19.748	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:34:19.748	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.6 seconds
2025-07-15 19:34:20.047	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:20.583	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:21.135	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:21.707	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:22.241	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:22.531	g3084:0	olmo.train.trainer:817	INFO	[step=205/1000]
    train/CrossEntropyLoss=11.24
    train/ZLoss=0.0142
    train/ImageGenLoss=1.965
    train/Accuracy=0.3000
    throughput/total_tokens=3,778,560
    throughput/device/tokens_per_second=36,908
    throughput/device/batches_per_second=2.002
2025-07-15 19:34:22.871	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:23.430	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:23.993	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:24.522	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:25.093	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:25.382	g3084:0	olmo.train.trainer:817	INFO	[step=210/1000]
    train/CrossEntropyLoss=11.20
    train/ZLoss=0.0142
    train/ImageGenLoss=1.961
    train/Accuracy=0.2500
    throughput/total_tokens=3,870,720
    throughput/device/tokens_per_second=34,468
    throughput/device/batches_per_second=1.870
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:34:25.675	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:26.250	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:26.818	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:27.376	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:27.915	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:28.206	g3084:0	olmo.train.trainer:817	INFO	[step=215/1000]
    train/CrossEntropyLoss=11.20
    train/ZLoss=0.0142
    train/ImageGenLoss=1.957
    train/Accuracy=0.1940
    throughput/total_tokens=3,962,880
    throughput/device/tokens_per_second=33,835
    throughput/device/batches_per_second=1.836
2025-07-15 19:34:28.490	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:29.039	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:29.645	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:30.267	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:30.970	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:31.260	g3084:0	olmo.train.trainer:817	INFO	[step=220/1000]
    train/CrossEntropyLoss=11.19
    train/ZLoss=0.0142
    train/ImageGenLoss=1.944
    train/Accuracy=0.2386
    throughput/total_tokens=4,055,040
    throughput/device/tokens_per_second=32,839
    throughput/device/batches_per_second=1.782
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:34:31.262	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:34:35.015	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:34:35.031	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:34:35.031	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.8 seconds
2025-07-15 19:34:35.316	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:35.857	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:36.403	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:36.966	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:37.557	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:37.847	g3084:0	olmo.train.trainer:817	INFO	[step=225/1000]
    train/CrossEntropyLoss=11.26
    train/ZLoss=0.0142
    train/ImageGenLoss=1.887
    train/Accuracy=0.1967
    throughput/total_tokens=4,147,200
    throughput/device/tokens_per_second=36,231
    throughput/device/batches_per_second=1.966
2025-07-15 19:34:38.134	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:38.691	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:39.266	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:39.842	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:40.390	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:40.681	g3084:0	olmo.train.trainer:817	INFO	[step=230/1000]
    train/CrossEntropyLoss=11.19
    train/ZLoss=0.0142
    train/ImageGenLoss=1.135
    train/Accuracy=0.2188
    throughput/total_tokens=4,239,360
    throughput/device/tokens_per_second=34,274
    throughput/device/batches_per_second=1.860
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:34:40.947	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:41.498	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:42.083	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:42.644	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:43.225	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:43.518	g3084:0	olmo.train.trainer:817	INFO	[step=235/1000]
    train/CrossEntropyLoss=11.15
    train/ZLoss=0.0142
    train/ImageGenLoss=0.0941
    train/Accuracy=0.2877
    throughput/total_tokens=4,331,520
    throughput/device/tokens_per_second=33,656
    throughput/device/batches_per_second=1.826
2025-07-15 19:34:43.828	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:44.445	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:45.003	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:45.529	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:46.072	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:46.362	g3084:0	olmo.train.trainer:817	INFO	[step=240/1000]
    train/CrossEntropyLoss=11.23
    train/ZLoss=0.0142
    train/ImageGenLoss=0.0213
    train/Accuracy=0.1977
    throughput/total_tokens=4,423,680
    throughput/device/tokens_per_second=33,336
    throughput/device/batches_per_second=1.809
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:34:46.363	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:34:49.920	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:34:49.935	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:34:49.936	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.6 seconds
2025-07-15 19:34:50.244	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:50.759	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:51.274	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:51.807	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:52.389	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:52.679	g3084:0	olmo.train.trainer:817	INFO	[step=245/1000]
    train/CrossEntropyLoss=11.14
    train/ZLoss=0.0142
    train/ImageGenLoss=0.0092
    train/Accuracy=0.2647
    throughput/total_tokens=4,515,840
    throughput/device/tokens_per_second=37,658
    throughput/device/batches_per_second=2.043
2025-07-15 19:34:52.946	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:53.485	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:54.010	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:54.595	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:55.151	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:55.443	g3084:0	olmo.train.trainer:817	INFO	[step=250/1000]
    train/CrossEntropyLoss=11.13
    train/ZLoss=0.0142
    train/ImageGenLoss=0.0035
    train/Accuracy=0.2985
    throughput/total_tokens=4,608,000
    throughput/device/tokens_per_second=35,373
    throughput/device/batches_per_second=1.919
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:34:55.688	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:56.300	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:56.840	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:57.432	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:58.021	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:58.311	g3084:0	olmo.train.trainer:817	INFO	[step=255/1000]
    train/CrossEntropyLoss=11.16
    train/ZLoss=0.0142
    train/ImageGenLoss=0.0024
    train/Accuracy=0.2361
    throughput/total_tokens=4,700,160
    throughput/device/tokens_per_second=34,221
    throughput/device/batches_per_second=1.857
2025-07-15 19:34:58.585	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:59.157	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:34:59.753	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:00.326	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:00.907	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:01.197	g3084:0	olmo.train.trainer:817	INFO	[step=260/1000]
    train/CrossEntropyLoss=11.12
    train/ZLoss=0.0142
    train/ImageGenLoss=0.0003
    train/Accuracy=0.2121
    throughput/total_tokens=4,792,320
    throughput/device/tokens_per_second=33,618
    throughput/device/batches_per_second=1.824
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:35:01.199	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:35:05.014	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:35:05.029	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:35:05.030	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.8 seconds
2025-07-15 19:35:05.401	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:06.017	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:06.608	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:07.151	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:07.858	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:08.148	g3084:0	olmo.train.trainer:817	INFO	[step=265/1000]
    train/CrossEntropyLoss=11.12
    train/ZLoss=0.0142
    train/ImageGenLoss=-0.001110471785068512
    train/Accuracy=0.2069
    throughput/total_tokens=4,884,480
    throughput/device/tokens_per_second=33,399
    throughput/device/batches_per_second=1.812
2025-07-15 19:35:08.442	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:09.036	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:09.581	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:10.166	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:10.733	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:11.024	g3084:0	olmo.train.trainer:817	INFO	[step=270/1000]
    train/CrossEntropyLoss=11.10
    train/ZLoss=0.0142
    train/ImageGenLoss=-0.0005690658581443131
    train/Accuracy=0.2738
    throughput/total_tokens=4,976,640
    throughput/device/tokens_per_second=32,712
    throughput/device/batches_per_second=1.775
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:35:11.297	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:11.880	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:12.516	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:13.104	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:13.666	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:13.957	g3084:0	olmo.train.trainer:817	INFO	[step=275/1000]
    train/CrossEntropyLoss=11.06
    train/ZLoss=0.0141
    train/ImageGenLoss=-0.00021967697830405086
    train/Accuracy=0.2571
    throughput/total_tokens=5,068,800
    throughput/device/tokens_per_second=32,268
    throughput/device/batches_per_second=1.751
2025-07-15 19:35:14.210	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:14.749	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:15.297	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:15.901	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:16.459	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:16.750	g3084:0	olmo.train.trainer:817	INFO	[step=280/1000]
    train/CrossEntropyLoss=11.06
    train/ZLoss=0.0141
    train/ImageGenLoss=-0.0006136441952548921
    train/Accuracy=0.2388
    throughput/total_tokens=5,160,960
    throughput/device/tokens_per_second=32,448
    throughput/device/batches_per_second=1.760
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:35:16.752	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:35:20.335	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:35:20.350	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:35:20.351	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.6 seconds
2025-07-15 19:35:20.648	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:21.223	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:21.736	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:22.289	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:22.865	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:23.156	g3084:0	olmo.train.trainer:817	INFO	[step=285/1000]
    train/CrossEntropyLoss=11.04
    train/ZLoss=0.0141
    train/ImageGenLoss=-0.00014917778025846928
    train/Accuracy=0.2985
    throughput/total_tokens=5,253,120
    throughput/device/tokens_per_second=36,555
    throughput/device/batches_per_second=1.983
2025-07-15 19:35:23.443	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:24.038	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:24.622	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:25.216	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:25.823	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:26.114	g3084:0	olmo.train.trainer:817	INFO	[step=290/1000]
    train/CrossEntropyLoss=11.18
    train/ZLoss=0.0141
    train/ImageGenLoss=-0.0005546900210902095
    train/Accuracy=0.1831
    throughput/total_tokens=5,345,280
    throughput/device/tokens_per_second=33,642
    throughput/device/batches_per_second=1.825
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:35:26.521	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:27.104	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:27.721	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:28.308	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:28.931	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:29.223	g3084:0	olmo.train.trainer:817	INFO	[step=295/1000]
    train/CrossEntropyLoss=11.03
    train/ZLoss=0.0141
    train/ImageGenLoss=6.0640166338998824e-05
    train/Accuracy=0.2874
    throughput/total_tokens=5,437,440
    throughput/device/tokens_per_second=32,192
    throughput/device/batches_per_second=1.747
2025-07-15 19:35:29.527	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:30.113	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:30.696	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:31.229	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:31.770	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:32.061	g3084:0	olmo.train.trainer:817	INFO	[step=300/1000]
    train/CrossEntropyLoss=11.02
    train/ZLoss=0.0141
    train/ImageGenLoss=-0.0006557684391736984
    train/Accuracy=0.2381
    throughput/total_tokens=5,529,600
    throughput/device/tokens_per_second=32,264
    throughput/device/batches_per_second=1.750
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:35:32.062	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:35:35.633	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:35:35.649	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:35:35.649	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.6 seconds
2025-07-15 19:35:35.950	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:36.469	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:37.006	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:37.542	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:38.341	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:38.633	g3084:0	olmo.train.trainer:817	INFO	[step=305/1000]
    train/CrossEntropyLoss=10.99
    train/ZLoss=0.0141
    train/ImageGenLoss=-0.00023264114861376584
    train/Accuracy=0.3333
    throughput/total_tokens=5,621,760
    throughput/device/tokens_per_second=34,185
    throughput/device/batches_per_second=1.855
2025-07-15 19:35:38.942	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:39.512	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:40.110	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:40.721	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:41.325	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:41.617	g3084:0	olmo.train.trainer:817	INFO	[step=310/1000]
    train/CrossEntropyLoss=11.02
    train/ZLoss=0.0141
    train/ImageGenLoss=-0.0004100120277144015
    train/Accuracy=0.2838
    throughput/total_tokens=5,713,920
    throughput/device/tokens_per_second=32,453
    throughput/device/batches_per_second=1.761
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:35:41.917	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:42.545	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:43.148	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:43.681	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:44.252	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:44.547	g3084:0	olmo.train.trainer:817	INFO	[step=315/1000]
    train/CrossEntropyLoss=10.92
    train/ZLoss=0.0141
    train/ImageGenLoss=-0.0006249084835872054
    train/Accuracy=0.3056
    throughput/total_tokens=5,806,080
    throughput/device/tokens_per_second=32,110
    throughput/device/batches_per_second=1.742
2025-07-15 19:35:44.834	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:45.387	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:45.933	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:46.469	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:47.026	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:47.315	g3084:0	olmo.train.trainer:817	INFO	[step=320/1000]
    train/CrossEntropyLoss=10.94
    train/ZLoss=0.0141
    train/ImageGenLoss=0.0009
    train/Accuracy=0.2778
    throughput/total_tokens=5,898,240
    throughput/device/tokens_per_second=32,400
    throughput/device/batches_per_second=1.758
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:35:47.316	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:35:50.825	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:35:50.840	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:35:50.841	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.5 seconds
2025-07-15 19:35:51.138	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:51.657	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:52.220	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:52.777	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:53.358	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:53.649	g3084:0	olmo.train.trainer:817	INFO	[step=325/1000]
    train/CrossEntropyLoss=10.99
    train/ZLoss=0.0141
    train/ImageGenLoss=0.0002
    train/Accuracy=0.2800
    throughput/total_tokens=5,990,400
    throughput/device/tokens_per_second=36,517
    throughput/device/batches_per_second=1.981
2025-07-15 19:35:53.902	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:54.440	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:55.002	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:55.546	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:56.113	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:56.404	g3084:0	olmo.train.trainer:817	INFO	[step=330/1000]
    train/CrossEntropyLoss=10.96
    train/ZLoss=0.0141
    train/ImageGenLoss=-0.00044274682295508683
    train/Accuracy=0.2456
    throughput/total_tokens=6,082,560
    throughput/device/tokens_per_second=34,919
    throughput/device/batches_per_second=1.895
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:35:56.693	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:57.227	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:57.809	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:58.402	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:58.963	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:35:59.253	g3084:0	olmo.train.trainer:817	INFO	[step=335/1000]
    train/CrossEntropyLoss=10.95
    train/ZLoss=0.0141
    train/ImageGenLoss=0.0007
    train/Accuracy=0.2545
    throughput/total_tokens=6,174,720
    throughput/device/tokens_per_second=34,016
    throughput/device/batches_per_second=1.845
2025-07-15 19:35:59.541	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:00.148	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:00.689	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:01.276	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:01.851	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:02.143	g3084:0	olmo.train.trainer:817	INFO	[step=340/1000]
    train/CrossEntropyLoss=10.90
    train/ZLoss=0.0141
    train/ImageGenLoss=-0.00035569799365475774
    train/Accuracy=0.2794
    throughput/total_tokens=6,266,880
    throughput/device/tokens_per_second=33,461
    throughput/device/batches_per_second=1.815
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:36:02.144	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:36:05.835	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:36:05.850	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:36:05.850	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.7 seconds
2025-07-15 19:36:06.109	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:06.653	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:07.204	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:07.782	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:08.382	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:08.674	g3084:0	olmo.train.trainer:817	INFO	[step=345/1000]
    train/CrossEntropyLoss=10.89
    train/ZLoss=0.0141
    train/ImageGenLoss=-0.0001841762859839946
    train/Accuracy=0.3205
    throughput/total_tokens=6,359,040
    throughput/device/tokens_per_second=35,760
    throughput/device/batches_per_second=1.940
2025-07-15 19:36:08.929	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:09.484	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:10.066	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:10.579	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:11.136	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:11.426	g3084:0	olmo.train.trainer:817	INFO	[step=350/1000]
    train/CrossEntropyLoss=10.91
    train/ZLoss=0.0141
    train/ImageGenLoss=0.0010
    train/Accuracy=0.3115
    throughput/total_tokens=6,451,200
    throughput/device/tokens_per_second=34,584
    throughput/device/batches_per_second=1.876
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:36:11.692	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:12.272	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:12.811	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:13.374	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:13.947	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:14.236	g3084:0	olmo.train.trainer:817	INFO	[step=355/1000]
    train/CrossEntropyLoss=10.93
    train/ZLoss=0.0141
    train/ImageGenLoss=-0.0002802422677632421
    train/Accuracy=0.2877
    throughput/total_tokens=6,543,360
    throughput/device/tokens_per_second=33,967
    throughput/device/batches_per_second=1.843
2025-07-15 19:36:14.534	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:15.137	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:15.644	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:16.182	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:16.773	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:17.064	g3084:0	olmo.train.trainer:817	INFO	[step=360/1000]
    train/CrossEntropyLoss=10.98
    train/ZLoss=0.0141
    train/ImageGenLoss=-2.4414310246356763e-05
    train/Accuracy=0.2667
    throughput/total_tokens=6,635,520
    throughput/device/tokens_per_second=33,613
    throughput/device/batches_per_second=1.824
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:36:17.066	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:36:20.680	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:36:20.695	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:36:20.696	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.6 seconds
2025-07-15 19:36:21.012	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:21.576	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:22.075	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:22.662	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:23.232	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:23.524	g3084:0	olmo.train.trainer:817	INFO	[step=365/1000]
    train/CrossEntropyLoss=10.94
    train/ZLoss=0.0140
    train/ImageGenLoss=0.0002
    train/Accuracy=0.2807
    throughput/total_tokens=6,727,680
    throughput/device/tokens_per_second=36,505
    throughput/device/batches_per_second=1.981
2025-07-15 19:36:23.776	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:24.334	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:24.886	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:25.463	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:26.018	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:26.307	g3084:0	olmo.train.trainer:817	INFO	[step=370/1000]
    train/CrossEntropyLoss=10.83
    train/ZLoss=0.0141
    train/ImageGenLoss=-0.0003237328492105007
    train/Accuracy=0.3200
    throughput/total_tokens=6,819,840
    throughput/device/tokens_per_second=34,724
    throughput/device/batches_per_second=1.884
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:36:26.890	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:27.466	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:28.047	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:28.597	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:29.166	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:29.457	g3084:0	olmo.train.trainer:817	INFO	[step=375/1000]
    train/CrossEntropyLoss=10.88
    train/ZLoss=0.0141
    train/ImageGenLoss=-0.0003204518579877913
    train/Accuracy=0.3143
    throughput/total_tokens=6,912,000
    throughput/device/tokens_per_second=32,687
    throughput/device/batches_per_second=1.773
2025-07-15 19:36:29.721	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:30.286	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:30.855	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:31.405	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:31.945	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:32.236	g3084:0	olmo.train.trainer:817	INFO	[step=380/1000]
    train/CrossEntropyLoss=10.92
    train/ZLoss=0.0140
    train/ImageGenLoss=-0.0007684760494157672
    train/Accuracy=0.2800
    throughput/total_tokens=7,004,160
    throughput/device/tokens_per_second=32,806
    throughput/device/batches_per_second=1.780
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:36:32.238	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:36:35.891	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:36:35.906	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:36:35.907	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.7 seconds
2025-07-15 19:36:36.254	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:36.806	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:37.376	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:37.908	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:38.470	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:38.761	g3084:0	olmo.train.trainer:817	INFO	[step=385/1000]
    train/CrossEntropyLoss=10.90
    train/ZLoss=0.0140
    train/ImageGenLoss=-0.0007182746776379645
    train/Accuracy=0.2958
    throughput/total_tokens=7,096,320
    throughput/device/tokens_per_second=36,582
    throughput/device/batches_per_second=1.985
2025-07-15 19:36:39.014	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:39.536	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:40.089	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:40.640	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:41.192	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:41.481	g3084:0	olmo.train.trainer:817	INFO	[step=390/1000]
    train/CrossEntropyLoss=10.92
    train/ZLoss=0.0140
    train/ImageGenLoss=-0.0007510039722546935
    train/Accuracy=0.2714
    throughput/total_tokens=7,188,480
    throughput/device/tokens_per_second=35,183
    throughput/device/batches_per_second=1.909
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:36:41.727	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:42.325	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:42.855	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:43.412	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:43.959	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:44.254	g3084:0	olmo.train.trainer:817	INFO	[step=395/1000]
    train/CrossEntropyLoss=10.97
    train/ZLoss=0.0140
    train/ImageGenLoss=0.0007
    train/Accuracy=0.2615
    throughput/total_tokens=7,280,640
    throughput/device/tokens_per_second=34,504
    throughput/device/batches_per_second=1.872
2025-07-15 19:36:44.522	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:45.104	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:45.665	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:46.198	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:46.782	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:47.073	g3084:0	olmo.train.trainer:817	INFO	[step=400/1000]
    train/CrossEntropyLoss=10.83
    train/ZLoss=0.0140
    train/ImageGenLoss=0.0005
    train/Accuracy=0.3143
    throughput/total_tokens=7,372,800
    throughput/device/tokens_per_second=34,034
    throughput/device/batches_per_second=1.846
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:36:47.075	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:36:51.186	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:36:51.201	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:36:51.202	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 4.1 seconds
2025-07-15 19:36:51.706	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:52.277	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:52.840	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:53.379	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:54.020	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:54.312	g3084:0	olmo.train.trainer:817	INFO	[step=405/1000]
    train/CrossEntropyLoss=10.84
    train/ZLoss=0.0140
    train/ImageGenLoss=-1.9585093014029553e-06
    train/Accuracy=0.2987
    throughput/total_tokens=7,464,960
    throughput/device/tokens_per_second=35,189
    throughput/device/batches_per_second=1.909
2025-07-15 19:36:54.675	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:55.223	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:55.786	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:56.313	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:56.860	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:57.150	g3084:0	olmo.train.trainer:817	INFO	[step=410/1000]
    train/CrossEntropyLoss=10.81
    train/ZLoss=0.0140
    train/ImageGenLoss=-9.736108040669933e-05
    train/Accuracy=0.3158
    throughput/total_tokens=7,557,120
    throughput/device/tokens_per_second=33,778
    throughput/device/batches_per_second=1.833
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:36:57.350	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:57.897	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:58.438	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:58.985	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:59.550	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:36:59.839	g3084:0	olmo.train.trainer:817	INFO	[step=415/1000]
    train/CrossEntropyLoss=10.85
    train/ZLoss=0.0140
    train/ImageGenLoss=-0.0006905175978317857
    train/Accuracy=0.2794
    throughput/total_tokens=7,649,280
    throughput/device/tokens_per_second=33,941
    throughput/device/batches_per_second=1.841
2025-07-15 19:37:00.098	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:00.672	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:01.211	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:01.799	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:02.370	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:02.663	g3084:0	olmo.train.trainer:817	INFO	[step=420/1000]
    train/CrossEntropyLoss=10.82
    train/ZLoss=0.0140
    train/ImageGenLoss=-0.00047263409942388535
    train/Accuracy=0.2899
    throughput/total_tokens=7,741,440
    throughput/device/tokens_per_second=33,606
    throughput/device/batches_per_second=1.823
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:37:02.665	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:37:06.350	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:37:06.365	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:37:06.366	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.7 seconds
2025-07-15 19:37:06.720	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:07.322	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:07.874	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:08.418	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:09.018	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:09.310	g3084:0	olmo.train.trainer:817	INFO	[step=425/1000]
    train/CrossEntropyLoss=10.85
    train/ZLoss=0.0140
    train/ImageGenLoss=-0.0005807090201415122
    train/Accuracy=0.2464
    throughput/total_tokens=7,833,600
    throughput/device/tokens_per_second=35,406
    throughput/device/batches_per_second=1.921
2025-07-15 19:37:09.574	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:10.125	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:10.694	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:11.263	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:11.777	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:12.067	g3084:0	olmo.train.trainer:817	INFO	[step=430/1000]
    train/CrossEntropyLoss=10.89
    train/ZLoss=0.0140
    train/ImageGenLoss=-0.00017570200725458562
    train/Accuracy=0.2400
    throughput/total_tokens=7,925,760
    throughput/device/tokens_per_second=34,389
    throughput/device/batches_per_second=1.866
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:37:12.356	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:12.917	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:13.496	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:14.027	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:14.540	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:14.831	g3084:0	olmo.train.trainer:817	INFO	[step=435/1000]
    train/CrossEntropyLoss=11.22
    train/ZLoss=0.0140
    train/ImageGenLoss=-0.0002949351619463414
    train/Accuracy=0.1728
    throughput/total_tokens=8,017,920
    throughput/device/tokens_per_second=34,032
    throughput/device/batches_per_second=1.846
2025-07-15 19:37:15.054	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:15.624	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:16.171	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:16.724	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:17.295	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:17.586	g3084:0	olmo.train.trainer:817	INFO	[step=440/1000]
    train/CrossEntropyLoss=10.88
    train/ZLoss=0.0140
    train/ImageGenLoss=-0.0003272832836955786
    train/Accuracy=0.2576
    throughput/total_tokens=8,110,080
    throughput/device/tokens_per_second=33,887
    throughput/device/batches_per_second=1.838
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:37:17.587	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:37:21.147	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:37:21.162	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:37:21.162	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.6 seconds
2025-07-15 19:37:21.459	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:22.009	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:22.582	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:23.147	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:23.680	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:23.969	g3084:0	olmo.train.trainer:817	INFO	[step=445/1000]
    train/CrossEntropyLoss=10.84
    train/ZLoss=0.0140
    train/ImageGenLoss=3.738817758858204e-05
    train/Accuracy=0.2319
    throughput/total_tokens=8,202,240
    throughput/device/tokens_per_second=36,527
    throughput/device/batches_per_second=1.982
2025-07-15 19:37:24.228	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:24.902	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:25.307	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:25.838	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:26.386	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:26.675	g3084:0	olmo.train.trainer:817	INFO	[step=450/1000]
    train/CrossEntropyLoss=10.74
    train/ZLoss=0.0140
    train/ImageGenLoss=-0.00019742002768907696
    train/Accuracy=0.3333
    throughput/total_tokens=8,294,400
    throughput/device/tokens_per_second=35,250
    throughput/device/batches_per_second=1.912
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:37:26.918	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:27.472	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:28.013	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:28.568	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:29.143	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:29.435	g3084:0	olmo.train.trainer:817	INFO	[step=455/1000]
    train/CrossEntropyLoss=10.88
    train/ZLoss=0.0140
    train/ImageGenLoss=-0.0004807047953363508
    train/Accuracy=0.2632
    throughput/total_tokens=8,386,560
    throughput/device/tokens_per_second=34,605
    throughput/device/batches_per_second=1.877
2025-07-15 19:37:29.732	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:30.282	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:30.826	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:31.393	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:32.004	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:32.294	g3084:0	olmo.train.trainer:817	INFO	[step=460/1000]
    train/CrossEntropyLoss=10.77
    train/ZLoss=0.0140
    train/ImageGenLoss=-0.00037093990249559283
    train/Accuracy=0.2857
    throughput/total_tokens=8,478,720
    throughput/device/tokens_per_second=33,983
    throughput/device/batches_per_second=1.844
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:37:32.296	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:37:35.755	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:37:35.769	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:37:35.770	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.5 seconds
2025-07-15 19:37:36.018	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:36.582	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:37.130	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:37.635	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:38.216	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:38.502	g3084:0	olmo.train.trainer:817	INFO	[step=465/1000]
    train/CrossEntropyLoss=10.72
    train/ZLoss=0.0140
    train/ImageGenLoss=0.0001
    train/Accuracy=0.3143
    throughput/total_tokens=8,570,880
    throughput/device/tokens_per_second=36,902
    throughput/device/batches_per_second=2.002
2025-07-15 19:37:38.768	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:39.324	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:39.870	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:40.448	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:41.006	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:41.295	g3084:0	olmo.train.trainer:817	INFO	[step=470/1000]
    train/CrossEntropyLoss=10.71
    train/ZLoss=0.0140
    train/ImageGenLoss=-0.0005190924275666475
    train/Accuracy=0.3375
    throughput/total_tokens=8,663,040
    throughput/device/tokens_per_second=34,846
    throughput/device/batches_per_second=1.891
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:37:41.565	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:42.055	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:42.640	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:43.256	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:43.856	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:44.142	g3084:0	olmo.train.trainer:817	INFO	[step=475/1000]
    train/CrossEntropyLoss=10.79
    train/ZLoss=0.0140
    train/ImageGenLoss=0.0001
    train/Accuracy=0.2558
    throughput/total_tokens=8,755,200
    throughput/device/tokens_per_second=33,977
    throughput/device/batches_per_second=1.843
2025-07-15 19:37:44.444	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:44.978	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:45.482	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:46.031	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:46.605	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:46.894	g3084:0	olmo.train.trainer:817	INFO	[step=480/1000]
    train/CrossEntropyLoss=10.80
    train/ZLoss=0.0140
    train/ImageGenLoss=-0.00046699418453499675
    train/Accuracy=0.3000
    throughput/total_tokens=8,847,360
    throughput/device/tokens_per_second=33,856
    throughput/device/batches_per_second=1.837
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:37:46.895	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:37:50.308	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:37:50.322	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:37:50.323	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.4 seconds
2025-07-15 19:37:50.585	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:51.130	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:51.663	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:52.204	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:52.758	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:53.044	g3084:0	olmo.train.trainer:817	INFO	[step=485/1000]
    train/CrossEntropyLoss=10.86
    train/ZLoss=0.0139
    train/ImageGenLoss=-0.0005137172993272543
    train/Accuracy=0.2083
    throughput/total_tokens=8,939,520
    throughput/device/tokens_per_second=37,295
    throughput/device/batches_per_second=2.023
2025-07-15 19:37:53.306	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:53.817	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:54.344	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:54.923	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:55.458	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:55.747	g3084:0	olmo.train.trainer:817	INFO	[step=490/1000]
    train/CrossEntropyLoss=10.91
    train/ZLoss=0.0139
    train/ImageGenLoss=-0.00043388991616666317
    train/Accuracy=0.2581
    throughput/total_tokens=9,031,680
    throughput/device/tokens_per_second=35,631
    throughput/device/batches_per_second=1.933
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:37:56.033	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:56.547	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:57.115	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:57.607	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:58.132	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:58.417	g3084:0	olmo.train.trainer:817	INFO	[step=495/1000]
    train/CrossEntropyLoss=10.63
    train/ZLoss=0.0140
    train/ImageGenLoss=-0.00044064997928217053
    train/Accuracy=0.3636
    throughput/total_tokens=9,123,840
    throughput/device/tokens_per_second=35,245
    throughput/device/batches_per_second=1.912
2025-07-15 19:37:58.663	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:59.175	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:37:59.747	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:38:00.301	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:39:32.776	g3084:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-15 19:39:32.863	g3084:0	train:54	INFO	Configuration:
2025-07-15 19:39:32.864	g3084:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=128, n_heads=2, n_kv_heads=None, head_dim=None, qkv_bias=False, clip_qkv=None, n_layers=1, mlp_ratio=4, mlp_hidden_size=None, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=10000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='default', layer_norm_with_affine=True, layer_norm_eps=None, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=True, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.1, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=None, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2-7B', tokenizer_dir=None), init_path=None, init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='openai', image_default_input_size=(336, 336), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1024, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=1, image_head_dim=64, image_mlp_dim=4096, image_mlp_activations='gelu', image_dropout_rate=0.0, image_num_pos=577, image_norm_eps=1e-05, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path=None, resize_mode='default', pad_value=0.0, normalize='openai'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-1,), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='resize', max_crops=1, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear', per_image_output_tokens=64), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'chart_qa': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=20, inf_evaluators=[InfDatasetEvaluatorConfig(label='chart_qa', data=DataLoaderConfig(dataset='chart_qa', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='relaxed_correctness,scifi_relaxed_correctness,em', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=16, console_log_interval=5, include_image=False)], inf_eval_interval=20, eval_on_last_step=True, eval_on_load=False, save_folder='debug_run', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint=None, allow_resume=True, max_duration=1000, global_train_batch_size=8, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=None, beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=5, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=1000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-15 19:39:32.895	g3084:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-15 19:39:35.234	g3084:0	root:123	INFO	Padding tokenizer with 416 tokens
2025-07-15 19:39:37.313	g3084:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-15 19:39:37.467	g3084:0	train:191	INFO	Total number of parameters: 58,006,016
2025-07-15 19:39:37.468	g3084:0	train:192	INFO	Number of non-embedding parameters: 38,525,440
2025-07-15 19:39:37.469	g3084:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 234
2025-07-15 19:39:37.469	g3084:0	train:196	INFO	Model:
2025-07-15 19:39:37.469	g3084:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0): FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=128, out_features=128, bias=True)
          (ff_out): Linear(in_features=256, out_features=128, bias=True)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): LayerNorm()
          (ff_norm): LayerNorm()
          (att_proj): Linear(in_features=128, out_features=384, bias=True)
          (ff_proj): Linear(in_features=128, out_features=512, bias=True)
        )
      )
    )
    (ln_f): FSDPLayerNorm()
    (emb_drop): Dropout(p=0.1, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=128, out_features=152192, bias=True)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=1024, out_features=1024, bias=True)
        (wk): Linear(in_features=1024, out_features=1024, bias=True)
        (wv): Linear(in_features=1024, out_features=1024, bias=True)
        (wo): Linear(in_features=1024, out_features=1024, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1024, out_features=256, bias=False)
        (w2): Linear(in_features=256, out_features=128, bias=False)
        (w3): Linear(in_features=1024, out_features=256, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1024, bias=False)
      (pre_ln): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0): FSDPResidualAttentionBlock(
            (attention): ViTMultiHeadDotProductAttention(
              (wq): Linear(in_features=1024, out_features=1024, bias=True)
              (wk): Linear(in_features=1024, out_features=1024, bias=True)
              (wv): Linear(in_features=1024, out_features=1024, bias=True)
              (wo): Linear(in_features=1024, out_features=1024, bias=True)
              (residual_dropout): Dropout(p=0.0, inplace=False)
            )
            (feed_forward): ViTMLP(
              (w1): Linear(in_features=1024, out_features=4096, bias=True)
              (act): GELUActivation()
              (w2): Linear(in_features=4096, out_features=1024, bias=True)
            )
            (attention_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (ffn_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=700, out_features=128, bias=False)
  (vision_decoder_head): Linear(in_features=128, out_features=700, bias=False)
)
2025-07-15 19:39:37.480	g3084:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-15 19:39:37.481	g3084:0	olmo.data.data_loader:197	INFO	Loading train dataset chart_qa/train
2025-07-15 19:39:37.481	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_human.json
2025-07-15 19:39:37.542	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_augmented.json
2025-07-15 19:39:37.671	g3084:0	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-15 19:39:37.672	g3084:0	olmo.data.data_loader:219	INFO	chart_qa: 100.00
2025-07-15 19:39:37.674	g3084:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=2304 images=1 pooled_patches_idx=158
2025-07-15 19:39:37.674	g3084:0	olmo.data.data_loader:100	INFO	Loading eval dataset: chart_qa/validation
2025-07-15 19:39:37.675	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_human.json
2025-07-15 19:39:37.688	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_augmented.json
2025-07-15 19:39:37.720	g3084:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=1792 images=1 pooled_patches_idx=158
2025-07-15 19:39:37.965	g3084:0	train:332	INFO	Starting training...
2025-07-15 19:39:37.967	g3084:0	olmo.train.trainer:817	INFO	Pre-train system metrics
    System/Peak GPU Memory (MB)=370.5
2025-07-15 19:39:42.494	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:39:47.008	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:39:47.644	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:39:48.069	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:39:48.493	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:39:48.912	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:39:49.201	g3084:0	olmo.train.trainer:817	INFO	[step=5/1000]
    train/CrossEntropyLoss=11.92
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0318
    train/Accuracy=0.0
    throughput/total_tokens=92,160
    throughput/device/tokens_per_second=46,918
    throughput/device/batches_per_second=2.545
2025-07-15 19:39:49.333	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:39:49.761	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:39:50.187	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:39:50.627	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:39:51.054	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:39:51.344	g3084:0	olmo.train.trainer:817	INFO	[step=10/1000]
    train/CrossEntropyLoss=11.91
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0305
    train/Accuracy=0.0
    throughput/total_tokens=184,320
    throughput/device/tokens_per_second=44,670
    throughput/device/batches_per_second=2.424
    System/Peak GPU Memory (MB)=29,214
2025-07-15 19:39:51.491	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:39:51.913	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:39:52.330	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:39:52.739	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:39:53.158	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:39:53.447	g3084:0	olmo.train.trainer:817	INFO	[step=15/1000]
    train/CrossEntropyLoss=11.90
    train/ZLoss=0.0143
    train/ImageGenLoss=0.7157
    train/Accuracy=0.0
    throughput/total_tokens=276,480
    throughput/device/tokens_per_second=44,361
    throughput/device/batches_per_second=2.407
2025-07-15 19:39:53.585	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:39:54.014	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:39:54.425	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:39:54.859	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:39:55.293	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:39:55.583	g3084:0	olmo.train.trainer:817	INFO	[step=20/1000]
    train/CrossEntropyLoss=11.83
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=368,640
    throughput/device/tokens_per_second=44,036
    throughput/device/batches_per_second=2.389
    System/Peak GPU Memory (MB)=29,214
2025-07-15 19:39:55.585	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:41:26.339	g3084:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-15 19:41:26.446	g3084:0	train:54	INFO	Configuration:
2025-07-15 19:41:26.447	g3084:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=128, n_heads=2, n_kv_heads=None, head_dim=None, qkv_bias=False, clip_qkv=None, n_layers=1, mlp_ratio=4, mlp_hidden_size=None, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=10000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='default', layer_norm_with_affine=True, layer_norm_eps=None, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=True, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.1, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=None, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2-7B', tokenizer_dir=None), init_path=None, init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='openai', image_default_input_size=(336, 336), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1024, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=1, image_head_dim=64, image_mlp_dim=4096, image_mlp_activations='gelu', image_dropout_rate=0.0, image_num_pos=577, image_norm_eps=1e-05, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path=None, resize_mode='default', pad_value=0.0, normalize='openai'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-1,), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='resize', max_crops=1, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear', per_image_output_tokens=64), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'chart_qa': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=20, inf_evaluators=[InfDatasetEvaluatorConfig(label='chart_qa', data=DataLoaderConfig(dataset='chart_qa', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='relaxed_correctness,scifi_relaxed_correctness,em', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=16, console_log_interval=5, include_image=False)], inf_eval_interval=20, eval_on_last_step=True, eval_on_load=False, save_folder='debug_run', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint=None, allow_resume=True, max_duration=1000, global_train_batch_size=8, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=None, beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=5, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=1000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-15 19:41:26.479	g3084:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-15 19:41:28.793	g3084:0	root:123	INFO	Padding tokenizer with 416 tokens
2025-07-15 19:41:30.871	g3084:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-15 19:41:31.016	g3084:0	train:191	INFO	Total number of parameters: 58,006,016
2025-07-15 19:41:31.017	g3084:0	train:192	INFO	Number of non-embedding parameters: 38,525,440
2025-07-15 19:41:31.018	g3084:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 234
2025-07-15 19:41:31.018	g3084:0	train:196	INFO	Model:
2025-07-15 19:41:31.018	g3084:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0): FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=128, out_features=128, bias=True)
          (ff_out): Linear(in_features=256, out_features=128, bias=True)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): LayerNorm()
          (ff_norm): LayerNorm()
          (att_proj): Linear(in_features=128, out_features=384, bias=True)
          (ff_proj): Linear(in_features=128, out_features=512, bias=True)
        )
      )
    )
    (ln_f): FSDPLayerNorm()
    (emb_drop): Dropout(p=0.1, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=128, out_features=152192, bias=True)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=1024, out_features=1024, bias=True)
        (wk): Linear(in_features=1024, out_features=1024, bias=True)
        (wv): Linear(in_features=1024, out_features=1024, bias=True)
        (wo): Linear(in_features=1024, out_features=1024, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1024, out_features=256, bias=False)
        (w2): Linear(in_features=256, out_features=128, bias=False)
        (w3): Linear(in_features=1024, out_features=256, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1024, bias=False)
      (pre_ln): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0): FSDPResidualAttentionBlock(
            (attention): ViTMultiHeadDotProductAttention(
              (wq): Linear(in_features=1024, out_features=1024, bias=True)
              (wk): Linear(in_features=1024, out_features=1024, bias=True)
              (wv): Linear(in_features=1024, out_features=1024, bias=True)
              (wo): Linear(in_features=1024, out_features=1024, bias=True)
              (residual_dropout): Dropout(p=0.0, inplace=False)
            )
            (feed_forward): ViTMLP(
              (w1): Linear(in_features=1024, out_features=4096, bias=True)
              (act): GELUActivation()
              (w2): Linear(in_features=4096, out_features=1024, bias=True)
            )
            (attention_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (ffn_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=700, out_features=128, bias=False)
  (vision_decoder_head): Linear(in_features=128, out_features=700, bias=False)
)
2025-07-15 19:41:31.058	g3084:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-15 19:41:31.059	g3084:0	olmo.data.data_loader:197	INFO	Loading train dataset chart_qa/train
2025-07-15 19:41:31.059	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_human.json
2025-07-15 19:41:31.130	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_augmented.json
2025-07-15 19:41:31.295	g3084:0	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-15 19:41:31.296	g3084:0	olmo.data.data_loader:219	INFO	chart_qa: 100.00
2025-07-15 19:41:31.298	g3084:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=2304 images=1 pooled_patches_idx=158
2025-07-15 19:41:31.298	g3084:0	olmo.data.data_loader:100	INFO	Loading eval dataset: chart_qa/validation
2025-07-15 19:41:31.299	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_human.json
2025-07-15 19:41:31.322	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_augmented.json
2025-07-15 19:41:31.338	g3084:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=1792 images=1 pooled_patches_idx=158
2025-07-15 19:41:31.573	g3084:0	train:332	INFO	Starting training...
2025-07-15 19:41:31.574	g3084:0	olmo.train.trainer:817	INFO	Pre-train system metrics
    System/Peak GPU Memory (MB)=370.5
2025-07-15 19:41:35.814	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:41:40.090	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:41:40.681	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:41:41.100	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:41:41.515	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:41:41.936	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:41:42.227	g3084:0	olmo.train.trainer:817	INFO	[step=5/1000]
    train/CrossEntropyLoss=11.92
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0318
    train/Accuracy=0.0
    throughput/total_tokens=92,160
    throughput/device/tokens_per_second=47,297
    throughput/device/batches_per_second=2.566
2025-07-15 19:41:42.356	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:41:42.784	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:41:43.242	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:41:43.675	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:41:44.095	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:41:44.381	g3084:0	olmo.train.trainer:817	INFO	[step=10/1000]
    train/CrossEntropyLoss=11.91
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0305
    train/Accuracy=0.0
    throughput/total_tokens=184,320
    throughput/device/tokens_per_second=44,675
    throughput/device/batches_per_second=2.424
    System/Peak GPU Memory (MB)=29,214
2025-07-15 19:41:44.522	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:41:44.937	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:41:45.347	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:41:45.750	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:41:46.164	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:41:46.453	g3084:0	olmo.train.trainer:817	INFO	[step=15/1000]
    train/CrossEntropyLoss=11.90
    train/ZLoss=0.0143
    train/ImageGenLoss=0.7157
    train/Accuracy=0.0
    throughput/total_tokens=276,480
    throughput/device/tokens_per_second=44,608
    throughput/device/batches_per_second=2.420
2025-07-15 19:41:46.588	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:41:47.017	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:41:47.425	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:41:47.849	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:41:48.275	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:41:48.564	g3084:0	olmo.train.trainer:817	INFO	[step=20/1000]
    train/CrossEntropyLoss=11.83
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=368,640
    throughput/device/tokens_per_second=44,353
    throughput/device/batches_per_second=2.406
    System/Peak GPU Memory (MB)=29,214
2025-07-15 19:41:48.566	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:42:29.636	g3084:0	olmo.util:177	CRITICAL	Uncaught BdbQuit: 
Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/Umolmo/launch_scripts/train_multitask_model.py", line 396, in <module>
    run_trainer(cfg)
  File "/gscratch/krishna/mahtab/Umolmo/scripts/train.py", line 333, in run_trainer
    trainer.fit()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 1146, in fit
    eval_metrics = self.inference_eval()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 865, in inference_eval
    dataset_metrics = evaluator.run(
  File "/gscratch/krishna/mahtab/Umolmo/olmo/eval/inf_evaluator.py", line 213, in run
    olmo_gen_output = model.generate(
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py", line 720, in generate
    if end_token_id is not None and (next_token == end_token_id).all():
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py", line 720, in generate
    if end_token_id is not None and (next_token == end_token_id).all():
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/bdb.py", line 90, in trace_dispatch
    return self.dispatch_line(frame)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/bdb.py", line 115, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit
2025-07-15 19:42:51.093	g3084:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-15 19:42:51.165	g3084:0	train:54	INFO	Configuration:
2025-07-15 19:42:51.166	g3084:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=128, n_heads=2, n_kv_heads=None, head_dim=None, qkv_bias=False, clip_qkv=None, n_layers=1, mlp_ratio=4, mlp_hidden_size=None, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=10000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='default', layer_norm_with_affine=True, layer_norm_eps=None, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=True, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.1, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=None, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2-7B', tokenizer_dir=None), init_path=None, init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='openai', image_default_input_size=(336, 336), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1024, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=1, image_head_dim=64, image_mlp_dim=4096, image_mlp_activations='gelu', image_dropout_rate=0.0, image_num_pos=577, image_norm_eps=1e-05, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path=None, resize_mode='default', pad_value=0.0, normalize='openai'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-1,), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='resize', max_crops=1, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear', per_image_output_tokens=64), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'chart_qa': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=20, inf_evaluators=[InfDatasetEvaluatorConfig(label='chart_qa', data=DataLoaderConfig(dataset='chart_qa', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='relaxed_correctness,scifi_relaxed_correctness,em', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=16, console_log_interval=5, include_image=False)], inf_eval_interval=20, eval_on_last_step=True, eval_on_load=False, save_folder='debug_run', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint=None, allow_resume=True, max_duration=1000, global_train_batch_size=8, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=None, beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=5, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=1000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-15 19:42:51.208	g3084:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-15 19:42:53.594	g3084:0	root:123	INFO	Padding tokenizer with 416 tokens
2025-07-15 19:42:55.558	g3084:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-15 19:42:55.707	g3084:0	train:191	INFO	Total number of parameters: 58,006,016
2025-07-15 19:42:55.707	g3084:0	train:192	INFO	Number of non-embedding parameters: 38,525,440
2025-07-15 19:42:55.708	g3084:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 234
2025-07-15 19:42:55.709	g3084:0	train:196	INFO	Model:
2025-07-15 19:42:55.709	g3084:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0): FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=128, out_features=128, bias=True)
          (ff_out): Linear(in_features=256, out_features=128, bias=True)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): LayerNorm()
          (ff_norm): LayerNorm()
          (att_proj): Linear(in_features=128, out_features=384, bias=True)
          (ff_proj): Linear(in_features=128, out_features=512, bias=True)
        )
      )
    )
    (ln_f): FSDPLayerNorm()
    (emb_drop): Dropout(p=0.1, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=128, out_features=152192, bias=True)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=1024, out_features=1024, bias=True)
        (wk): Linear(in_features=1024, out_features=1024, bias=True)
        (wv): Linear(in_features=1024, out_features=1024, bias=True)
        (wo): Linear(in_features=1024, out_features=1024, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1024, out_features=256, bias=False)
        (w2): Linear(in_features=256, out_features=128, bias=False)
        (w3): Linear(in_features=1024, out_features=256, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1024, bias=False)
      (pre_ln): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0): FSDPResidualAttentionBlock(
            (attention): ViTMultiHeadDotProductAttention(
              (wq): Linear(in_features=1024, out_features=1024, bias=True)
              (wk): Linear(in_features=1024, out_features=1024, bias=True)
              (wv): Linear(in_features=1024, out_features=1024, bias=True)
              (wo): Linear(in_features=1024, out_features=1024, bias=True)
              (residual_dropout): Dropout(p=0.0, inplace=False)
            )
            (feed_forward): ViTMLP(
              (w1): Linear(in_features=1024, out_features=4096, bias=True)
              (act): GELUActivation()
              (w2): Linear(in_features=4096, out_features=1024, bias=True)
            )
            (attention_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (ffn_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=700, out_features=128, bias=False)
  (vision_decoder_head): Linear(in_features=128, out_features=700, bias=False)
)
2025-07-15 19:42:55.720	g3084:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-15 19:42:55.721	g3084:0	olmo.data.data_loader:197	INFO	Loading train dataset chart_qa/train
2025-07-15 19:42:55.721	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_human.json
2025-07-15 19:42:55.756	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_augmented.json
2025-07-15 19:42:55.855	g3084:0	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-15 19:42:55.855	g3084:0	olmo.data.data_loader:219	INFO	chart_qa: 100.00
2025-07-15 19:42:55.857	g3084:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=2304 images=1 pooled_patches_idx=158
2025-07-15 19:42:55.858	g3084:0	olmo.data.data_loader:100	INFO	Loading eval dataset: chart_qa/validation
2025-07-15 19:42:55.858	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_human.json
2025-07-15 19:42:55.865	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_augmented.json
2025-07-15 19:42:55.870	g3084:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=1792 images=1 pooled_patches_idx=158
2025-07-15 19:42:56.105	g3084:0	train:332	INFO	Starting training...
2025-07-15 19:42:56.107	g3084:0	olmo.train.trainer:817	INFO	Pre-train system metrics
    System/Peak GPU Memory (MB)=370.5
2025-07-15 19:42:59.621	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:43:03.933	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:43:04.531	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:43:04.954	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:43:05.373	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:43:05.786	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:43:06.076	g3084:0	olmo.train.trainer:817	INFO	[step=5/1000]
    train/CrossEntropyLoss=11.92
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0318
    train/Accuracy=0.0
    throughput/total_tokens=92,160
    throughput/device/tokens_per_second=47,282
    throughput/device/batches_per_second=2.565
2025-07-15 19:43:06.206	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:43:06.634	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:43:07.055	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:43:07.489	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:43:07.913	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:43:08.202	g3084:0	olmo.train.trainer:817	INFO	[step=10/1000]
    train/CrossEntropyLoss=11.91
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0305
    train/Accuracy=0.0
    throughput/total_tokens=184,320
    throughput/device/tokens_per_second=45,017
    throughput/device/batches_per_second=2.442
    System/Peak GPU Memory (MB)=29,214
2025-07-15 19:43:08.347	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:43:08.770	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:43:09.187	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:43:09.599	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:43:10.023	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:43:10.313	g3084:0	olmo.train.trainer:817	INFO	[step=15/1000]
    train/CrossEntropyLoss=11.90
    train/ZLoss=0.0143
    train/ImageGenLoss=0.7157
    train/Accuracy=0.0
    throughput/total_tokens=276,480
    throughput/device/tokens_per_second=44,520
    throughput/device/batches_per_second=2.415
2025-07-15 19:43:10.454	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:43:10.882	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:43:11.290	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:43:11.717	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:43:12.147	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:43:12.436	g3084:0	olmo.train.trainer:817	INFO	[step=20/1000]
    train/CrossEntropyLoss=11.83
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=368,640
    throughput/device/tokens_per_second=44,221
    throughput/device/batches_per_second=2.399
    System/Peak GPU Memory (MB)=29,214
2025-07-15 19:43:12.438	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:43:25.096	g3084:0	olmo.util:177	CRITICAL	Uncaught BdbQuit: 
Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/Umolmo/launch_scripts/train_multitask_model.py", line 396, in <module>
    run_trainer(cfg)
  File "/gscratch/krishna/mahtab/Umolmo/scripts/train.py", line 333, in run_trainer
    trainer.fit()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 1146, in fit
    eval_metrics = self.inference_eval()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 865, in inference_eval
    dataset_metrics = evaluator.run(
  File "/gscratch/krishna/mahtab/Umolmo/olmo/eval/inf_evaluator.py", line 213, in run
    olmo_gen_output = model.generate(
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py", line 726, in generate
    return OLMoGenerateOutput(
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py", line 726, in generate
    return OLMoGenerateOutput(
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/bdb.py", line 90, in trace_dispatch
    return self.dispatch_line(frame)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/bdb.py", line 115, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit
2025-07-15 19:43:47.489	g3084:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-15 19:43:47.561	g3084:0	train:54	INFO	Configuration:
2025-07-15 19:43:47.562	g3084:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=128, n_heads=2, n_kv_heads=None, head_dim=None, qkv_bias=False, clip_qkv=None, n_layers=1, mlp_ratio=4, mlp_hidden_size=None, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=10000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='default', layer_norm_with_affine=True, layer_norm_eps=None, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=True, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.1, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=None, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2-7B', tokenizer_dir=None), init_path=None, init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='openai', image_default_input_size=(336, 336), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1024, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=1, image_head_dim=64, image_mlp_dim=4096, image_mlp_activations='gelu', image_dropout_rate=0.0, image_num_pos=577, image_norm_eps=1e-05, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path=None, resize_mode='default', pad_value=0.0, normalize='openai'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-1,), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='resize', max_crops=1, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear', per_image_output_tokens=64), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'chart_qa': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=20, inf_evaluators=[InfDatasetEvaluatorConfig(label='chart_qa', data=DataLoaderConfig(dataset='chart_qa', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='relaxed_correctness,scifi_relaxed_correctness,em', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=16, console_log_interval=5, include_image=False)], inf_eval_interval=20, eval_on_last_step=True, eval_on_load=False, save_folder='debug_run', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint=None, allow_resume=True, max_duration=1000, global_train_batch_size=8, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=None, beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=5, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=1000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-15 19:43:47.593	g3084:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-15 19:43:49.863	g3084:0	root:123	INFO	Padding tokenizer with 416 tokens
2025-07-15 19:43:51.821	g3084:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-15 19:43:51.968	g3084:0	train:191	INFO	Total number of parameters: 58,006,016
2025-07-15 19:43:51.969	g3084:0	train:192	INFO	Number of non-embedding parameters: 38,525,440
2025-07-15 19:43:51.970	g3084:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 234
2025-07-15 19:43:51.970	g3084:0	train:196	INFO	Model:
2025-07-15 19:43:51.971	g3084:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0): FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=128, out_features=128, bias=True)
          (ff_out): Linear(in_features=256, out_features=128, bias=True)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): LayerNorm()
          (ff_norm): LayerNorm()
          (att_proj): Linear(in_features=128, out_features=384, bias=True)
          (ff_proj): Linear(in_features=128, out_features=512, bias=True)
        )
      )
    )
    (ln_f): FSDPLayerNorm()
    (emb_drop): Dropout(p=0.1, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=128, out_features=152192, bias=True)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=1024, out_features=1024, bias=True)
        (wk): Linear(in_features=1024, out_features=1024, bias=True)
        (wv): Linear(in_features=1024, out_features=1024, bias=True)
        (wo): Linear(in_features=1024, out_features=1024, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1024, out_features=256, bias=False)
        (w2): Linear(in_features=256, out_features=128, bias=False)
        (w3): Linear(in_features=1024, out_features=256, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1024, bias=False)
      (pre_ln): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0): FSDPResidualAttentionBlock(
            (attention): ViTMultiHeadDotProductAttention(
              (wq): Linear(in_features=1024, out_features=1024, bias=True)
              (wk): Linear(in_features=1024, out_features=1024, bias=True)
              (wv): Linear(in_features=1024, out_features=1024, bias=True)
              (wo): Linear(in_features=1024, out_features=1024, bias=True)
              (residual_dropout): Dropout(p=0.0, inplace=False)
            )
            (feed_forward): ViTMLP(
              (w1): Linear(in_features=1024, out_features=4096, bias=True)
              (act): GELUActivation()
              (w2): Linear(in_features=4096, out_features=1024, bias=True)
            )
            (attention_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (ffn_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=700, out_features=128, bias=False)
  (vision_decoder_head): Linear(in_features=128, out_features=700, bias=False)
)
2025-07-15 19:43:51.980	g3084:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-15 19:43:51.981	g3084:0	olmo.data.data_loader:197	INFO	Loading train dataset chart_qa/train
2025-07-15 19:43:51.981	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_human.json
2025-07-15 19:43:52.067	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_augmented.json
2025-07-15 19:43:52.166	g3084:0	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-15 19:43:52.166	g3084:0	olmo.data.data_loader:219	INFO	chart_qa: 100.00
2025-07-15 19:43:52.168	g3084:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=2304 images=1 pooled_patches_idx=158
2025-07-15 19:43:52.169	g3084:0	olmo.data.data_loader:100	INFO	Loading eval dataset: chart_qa/validation
2025-07-15 19:43:52.169	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_human.json
2025-07-15 19:43:52.175	g3084:0	root:438	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_augmented.json
2025-07-15 19:43:52.180	g3084:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=1792 images=1 pooled_patches_idx=158
2025-07-15 19:43:52.418	g3084:0	train:332	INFO	Starting training...
2025-07-15 19:43:52.419	g3084:0	olmo.train.trainer:817	INFO	Pre-train system metrics
    System/Peak GPU Memory (MB)=370.5
2025-07-15 19:43:55.986	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:00.250	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:00.849	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:01.270	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:01.705	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:02.129	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:02.419	g3084:0	olmo.train.trainer:817	INFO	[step=5/1000]
    train/CrossEntropyLoss=11.92
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0318
    train/Accuracy=0.0
    throughput/total_tokens=92,160
    throughput/device/tokens_per_second=46,549
    throughput/device/batches_per_second=2.525
2025-07-15 19:44:02.550	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:02.990	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:03.415	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:03.853	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:04.276	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:04.564	g3084:0	olmo.train.trainer:817	INFO	[step=10/1000]
    train/CrossEntropyLoss=11.91
    train/ZLoss=0.0143
    train/ImageGenLoss=0.0305
    train/Accuracy=0.0
    throughput/total_tokens=184,320
    throughput/device/tokens_per_second=44,490
    throughput/device/batches_per_second=2.414
    System/Peak GPU Memory (MB)=29,214
2025-07-15 19:44:04.707	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:05.130	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:05.550	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:05.958	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:06.380	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:06.671	g3084:0	olmo.train.trainer:817	INFO	[step=15/1000]
    train/CrossEntropyLoss=11.90
    train/ZLoss=0.0143
    train/ImageGenLoss=0.7157
    train/Accuracy=0.0
    throughput/total_tokens=276,480
    throughput/device/tokens_per_second=44,218
    throughput/device/batches_per_second=2.399
2025-07-15 19:44:06.809	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:07.239	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:07.650	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:08.079	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:08.509	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:08.800	g3084:0	olmo.train.trainer:817	INFO	[step=20/1000]
    train/CrossEntropyLoss=11.83
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=368,640
    throughput/device/tokens_per_second=43,972
    throughput/device/batches_per_second=2.386
    System/Peak GPU Memory (MB)=29,214
2025-07-15 19:44:08.801	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:44:13.834	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:44:13.850	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:44:13.851	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 5.0 seconds
2025-07-15 19:44:14.025	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:14.431	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:14.852	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:15.273	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:15.687	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:15.977	g3084:0	olmo.train.trainer:817	INFO	[step=25/1000]
    train/CrossEntropyLoss=11.86
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=460,800
    throughput/device/tokens_per_second=46,923
    throughput/device/batches_per_second=2.546
2025-07-15 19:44:16.130	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:16.556	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:16.995	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:17.423	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:17.852	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:18.141	g3084:0	olmo.train.trainer:817	INFO	[step=30/1000]
    train/CrossEntropyLoss=11.83
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=552,960
    throughput/device/tokens_per_second=44,647
    throughput/device/batches_per_second=2.422
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:44:18.279	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:18.694	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:19.119	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:19.534	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:19.956	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:20.247	g3084:0	olmo.train.trainer:817	INFO	[step=35/1000]
    train/CrossEntropyLoss=11.81
    train/ZLoss=0.0143
    train/ImageGenLoss=2.000
    train/Accuracy=0.0
    throughput/total_tokens=645,120
    throughput/device/tokens_per_second=44,345
    throughput/device/batches_per_second=2.406
2025-07-15 19:44:20.386	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:20.810	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:21.237	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:21.661	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:22.090	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:22.380	g3084:0	olmo.train.trainer:817	INFO	[step=40/1000]
    train/CrossEntropyLoss=11.83
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=737,280
    throughput/device/tokens_per_second=44,060
    throughput/device/batches_per_second=2.390
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:44:22.382	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:44:26.356	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:44:26.370	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:44:26.371	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 4.0 seconds
2025-07-15 19:44:26.535	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:26.950	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:27.385	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:27.802	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:28.220	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:28.507	g3084:0	olmo.train.trainer:817	INFO	[step=45/1000]
    train/CrossEntropyLoss=11.75
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=829,440
    throughput/device/tokens_per_second=46,462
    throughput/device/batches_per_second=2.521
2025-07-15 19:44:28.664	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:29.085	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:29.522	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:29.955	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:30.375	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:30.663	g3084:0	olmo.train.trainer:817	INFO	[step=50/1000]
    train/CrossEntropyLoss=11.68
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0
    throughput/total_tokens=921,600
    throughput/device/tokens_per_second=44,520
    throughput/device/batches_per_second=2.415
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:44:30.802	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:31.200	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:31.624	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:32.060	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:32.480	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:32.769	g3084:0	olmo.train.trainer:817	INFO	[step=55/1000]
    train/CrossEntropyLoss=11.67
    train/ZLoss=0.0143
    train/ImageGenLoss=1.999
    train/Accuracy=0.0
    throughput/total_tokens=1,013,760
    throughput/device/tokens_per_second=44,268
    throughput/device/batches_per_second=2.402
2025-07-15 19:44:32.907	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:33.328	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:33.763	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:34.169	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:34.576	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:34.866	g3084:0	olmo.train.trainer:817	INFO	[step=60/1000]
    train/CrossEntropyLoss=11.72
    train/ZLoss=0.0143
    train/ImageGenLoss=1.999
    train/Accuracy=0.0
    throughput/total_tokens=1,105,920
    throughput/device/tokens_per_second=44,186
    throughput/device/batches_per_second=2.397
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:44:34.868	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:44:38.404	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:44:38.419	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:44:38.419	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.6 seconds
2025-07-15 19:44:38.583	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:38.990	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:39.410	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:39.825	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:40.244	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:40.529	g3084:0	olmo.train.trainer:817	INFO	[step=65/1000]
    train/CrossEntropyLoss=11.66
    train/ZLoss=0.0143
    train/ImageGenLoss=2.000
    train/Accuracy=0.0
    throughput/total_tokens=1,198,080
    throughput/device/tokens_per_second=47,066
    throughput/device/batches_per_second=2.554
2025-07-15 19:44:40.650	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:41.066	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:41.478	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:41.877	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:42.323	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:42.611	g3084:0	olmo.train.trainer:817	INFO	[step=70/1000]
    train/CrossEntropyLoss=11.65
    train/ZLoss=0.0143
    train/ImageGenLoss=1.999
    train/Accuracy=0.0
    throughput/total_tokens=1,290,240
    throughput/device/tokens_per_second=45,623
    throughput/device/batches_per_second=2.475
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:44:42.752	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:43.173	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:43.573	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:43.993	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:44.400	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:44.681	g3084:0	olmo.train.trainer:817	INFO	[step=75/1000]
    train/CrossEntropyLoss=11.57
    train/ZLoss=0.0143
    train/ImageGenLoss=2.000
    train/Accuracy=0.0
    throughput/total_tokens=1,382,400
    throughput/device/tokens_per_second=45,248
    throughput/device/batches_per_second=2.455
2025-07-15 19:44:44.799	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:45.190	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:45.575	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:45.980	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:46.378	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:46.663	g3084:0	olmo.train.trainer:817	INFO	[step=80/1000]
    train/CrossEntropyLoss=11.63
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0139
    throughput/total_tokens=1,474,560
    throughput/device/tokens_per_second=45,554
    throughput/device/batches_per_second=2.471
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:44:46.665	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:44:49.947	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:44:49.962	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:44:49.963	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.3 seconds
2025-07-15 19:44:50.105	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:50.506	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:50.916	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:51.341	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:51.740	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:52.019	g3084:0	olmo.train.trainer:817	INFO	[step=85/1000]
    train/CrossEntropyLoss=11.54
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0290
    throughput/total_tokens=1,566,720
    throughput/device/tokens_per_second=47,831
    throughput/device/batches_per_second=2.595
2025-07-15 19:44:52.138	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:52.551	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:52.947	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:53.346	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:53.756	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:54.035	g3084:0	olmo.train.trainer:817	INFO	[step=90/1000]
    train/CrossEntropyLoss=11.57
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0312
    throughput/total_tokens=1,658,880
    throughput/device/tokens_per_second=46,759
    throughput/device/batches_per_second=2.537
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:44:54.144	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:54.547	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:54.965	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:55.362	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:55.760	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:56.039	g3084:0	olmo.train.trainer:817	INFO	[step=95/1000]
    train/CrossEntropyLoss=11.53
    train/ZLoss=0.0143
    train/ImageGenLoss=2.000
    train/Accuracy=0.0441
    throughput/total_tokens=1,751,040
    throughput/device/tokens_per_second=46,493
    throughput/device/batches_per_second=2.522
2025-07-15 19:44:56.156	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:56.558	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:56.950	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:57.352	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:57.757	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:44:58.037	g3084:0	olmo.train.trainer:817	INFO	[step=100/1000]
    train/CrossEntropyLoss=11.51
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0411
    throughput/total_tokens=1,843,200
    throughput/device/tokens_per_second=46,404
    throughput/device/batches_per_second=2.518
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:44:58.039	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:45:01.469	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:45:01.484	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:45:01.484	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.4 seconds
2025-07-15 19:45:01.618	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:02.021	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:02.420	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:02.846	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:03.242	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:03.522	g3084:0	olmo.train.trainer:817	INFO	[step=105/1000]
    train/CrossEntropyLoss=11.49
    train/ZLoss=0.0143
    train/ImageGenLoss=2.000
    train/Accuracy=0.1077
    throughput/total_tokens=1,935,360
    throughput/device/tokens_per_second=48,075
    throughput/device/batches_per_second=2.608
2025-07-15 19:45:03.663	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:04.066	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:04.488	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:04.935	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:05.333	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:05.615	g3084:0	olmo.train.trainer:817	INFO	[step=110/1000]
    train/CrossEntropyLoss=11.49
    train/ZLoss=0.0143
    train/ImageGenLoss=2.000
    train/Accuracy=0.1311
    throughput/total_tokens=2,027,520
    throughput/device/tokens_per_second=45,966
    throughput/device/batches_per_second=2.494
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:45:05.739	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:06.169	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:06.587	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:06.993	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:07.396	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:07.678	g3084:0	olmo.train.trainer:817	INFO	[step=115/1000]
    train/CrossEntropyLoss=11.42
    train/ZLoss=0.0143
    train/ImageGenLoss=2.000
    train/Accuracy=0.1690
    throughput/total_tokens=2,119,680
    throughput/device/tokens_per_second=45,522
    throughput/device/batches_per_second=2.470
2025-07-15 19:45:07.806	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:08.209	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:08.606	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:09.013	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:09.402	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:09.681	g3084:0	olmo.train.trainer:817	INFO	[step=120/1000]
    train/CrossEntropyLoss=11.47
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.0735
    throughput/total_tokens=2,211,840
    throughput/device/tokens_per_second=45,645
    throughput/device/batches_per_second=2.476
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:45:09.683	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:45:13.142	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:45:13.157	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:45:13.157	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.5 seconds
2025-07-15 19:45:13.295	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:13.836	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:14.099	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:14.500	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:14.906	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:15.187	g3084:0	olmo.train.trainer:817	INFO	[step=125/1000]
    train/CrossEntropyLoss=11.42
    train/ZLoss=0.0143
    train/ImageGenLoss=2.000
    train/Accuracy=0.1806
    throughput/total_tokens=2,304,000
    throughput/device/tokens_per_second=48,420
    throughput/device/batches_per_second=2.627
2025-07-15 19:45:15.307	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:15.702	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:16.093	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:16.496	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:16.901	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:17.180	g3084:0	olmo.train.trainer:817	INFO	[step=130/1000]
    train/CrossEntropyLoss=11.48
    train/ZLoss=0.0143
    train/ImageGenLoss=2.000
    train/Accuracy=0.1200
    throughput/total_tokens=2,396,160
    throughput/device/tokens_per_second=47,301
    throughput/device/batches_per_second=2.566
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:45:17.311	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:17.707	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:18.096	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:18.498	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:18.889	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:19.173	g3084:0	olmo.train.trainer:817	INFO	[step=135/1000]
    train/CrossEntropyLoss=11.36
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.2143
    throughput/total_tokens=2,488,320
    throughput/device/tokens_per_second=46,947
    throughput/device/batches_per_second=2.547
2025-07-15 19:45:19.321	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:19.721	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:20.116	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:20.509	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:20.919	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:21.204	g3084:0	olmo.train.trainer:817	INFO	[step=140/1000]
    train/CrossEntropyLoss=11.38
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.1928
    throughput/total_tokens=2,580,480
    throughput/device/tokens_per_second=46,545
    throughput/device/batches_per_second=2.525
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:45:21.205	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:45:24.595	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:45:24.610	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:45:24.611	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.4 seconds
2025-07-15 19:45:24.752	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:25.166	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:25.587	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:26.014	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:26.415	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:26.701	g3084:0	olmo.train.trainer:817	INFO	[step=145/1000]
    train/CrossEntropyLoss=11.39
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.1774
    throughput/total_tokens=2,672,640
    throughput/device/tokens_per_second=46,995
    throughput/device/batches_per_second=2.550
2025-07-15 19:45:26.839	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:27.280	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:27.695	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:28.117	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:28.542	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:28.831	g3084:0	olmo.train.trainer:817	INFO	[step=150/1000]
    train/CrossEntropyLoss=11.32
    train/ZLoss=0.0143
    train/ImageGenLoss=2.000
    train/Accuracy=0.2419
    throughput/total_tokens=2,764,800
    throughput/device/tokens_per_second=45,059
    throughput/device/batches_per_second=2.445
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:45:28.972	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:29.391	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:29.804	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:30.251	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:30.693	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:30.980	g3084:0	olmo.train.trainer:817	INFO	[step=155/1000]
    train/CrossEntropyLoss=11.36
    train/ZLoss=0.0143
    train/ImageGenLoss=2.001
    train/Accuracy=0.2222
    throughput/total_tokens=2,856,960
    throughput/device/tokens_per_second=44,306
    throughput/device/batches_per_second=2.404
2025-07-15 19:45:31.116	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:31.534	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:31.959	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:32.371	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:32.798	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:33.084	g3084:0	olmo.train.trainer:817	INFO	[step=160/1000]
    train/CrossEntropyLoss=11.30
    train/ZLoss=0.0143
    train/ImageGenLoss=2.000
    train/Accuracy=0.2442
    throughput/total_tokens=2,949,120
    throughput/device/tokens_per_second=44,179
    throughput/device/batches_per_second=2.397
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:45:33.086	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:45:36.499	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:45:36.514	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:45:36.515	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.4 seconds
2025-07-15 19:45:36.677	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:37.102	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:37.525	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:37.958	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:38.381	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:38.669	g3084:0	olmo.train.trainer:817	INFO	[step=165/1000]
    train/CrossEntropyLoss=11.36
    train/ZLoss=0.0143
    train/ImageGenLoss=1.998
    train/Accuracy=0.1831
    throughput/total_tokens=3,041,280
    throughput/device/tokens_per_second=45,961
    throughput/device/batches_per_second=2.494
2025-07-15 19:45:38.815	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:39.223	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:39.631	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:40.052	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:40.472	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:40.761	g3084:0	olmo.train.trainer:817	INFO	[step=170/1000]
    train/CrossEntropyLoss=11.34
    train/ZLoss=0.0142
    train/ImageGenLoss=1.998
    train/Accuracy=0.2167
    throughput/total_tokens=3,133,440
    throughput/device/tokens_per_second=44,990
    throughput/device/batches_per_second=2.441
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:45:40.908	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:41.340	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:41.764	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:42.189	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:42.619	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:42.908	g3084:0	olmo.train.trainer:817	INFO	[step=175/1000]
    train/CrossEntropyLoss=11.26
    train/ZLoss=0.0142
    train/ImageGenLoss=1.989
    train/Accuracy=0.2222
    throughput/total_tokens=3,225,600
    throughput/device/tokens_per_second=44,282
    throughput/device/batches_per_second=2.402
2025-07-15 19:45:43.075	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:43.499	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:43.976	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:44.391	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:44.812	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:45.101	g3084:0	olmo.train.trainer:817	INFO	[step=180/1000]
    train/CrossEntropyLoss=11.34
    train/ZLoss=0.0142
    train/ImageGenLoss=1.950
    train/Accuracy=0.2154
    throughput/total_tokens=3,317,760
    throughput/device/tokens_per_second=43,697
    throughput/device/batches_per_second=2.371
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:45:45.102	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:45:48.698	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:45:48.713	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:45:48.713	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.6 seconds
2025-07-15 19:45:48.870	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:49.315	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:49.783	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:50.207	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:50.640	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:50.930	g3084:0	olmo.train.trainer:817	INFO	[step=185/1000]
    train/CrossEntropyLoss=11.26
    train/ZLoss=0.0142
    train/ImageGenLoss=1.064
    train/Accuracy=0.2254
    throughput/total_tokens=3,409,920
    throughput/device/tokens_per_second=44,461
    throughput/device/batches_per_second=2.412
2025-07-15 19:45:51.075	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:51.505	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:51.951	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:52.405	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:52.831	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:53.120	g3084:0	olmo.train.trainer:817	INFO	[step=190/1000]
    train/CrossEntropyLoss=11.20
    train/ZLoss=0.0142
    train/ImageGenLoss=0.1196
    train/Accuracy=0.2453
    throughput/total_tokens=3,502,080
    throughput/device/tokens_per_second=43,247
    throughput/device/batches_per_second=2.346
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:45:53.266	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:53.694	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:54.105	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:54.515	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:54.938	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:55.225	g3084:0	olmo.train.trainer:817	INFO	[step=195/1000]
    train/CrossEntropyLoss=11.26
    train/ZLoss=0.0142
    train/ImageGenLoss=0.0588
    train/Accuracy=0.2500
    throughput/total_tokens=3,594,240
    throughput/device/tokens_per_second=43,417
    throughput/device/batches_per_second=2.356
2025-07-15 19:45:55.362	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:55.779	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:56.204	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:56.610	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:57.024	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:45:57.312	g3084:0	olmo.train.trainer:817	INFO	[step=200/1000]
    train/CrossEntropyLoss=11.23
    train/ZLoss=0.0142
    train/ImageGenLoss=0.0446
    train/Accuracy=0.2949
    throughput/total_tokens=3,686,400
    throughput/device/tokens_per_second=43,602
    throughput/device/batches_per_second=2.366
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:45:57.314	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:46:00.749	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:46:00.763	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:46:00.764	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.4 seconds
2025-07-15 19:46:00.919	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:01.335	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:01.775	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:02.202	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:02.648	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:02.936	g3084:0	olmo.train.trainer:817	INFO	[step=205/1000]
    train/CrossEntropyLoss=11.24
    train/ZLoss=0.0142
    train/ImageGenLoss=0.0414
    train/Accuracy=0.3000
    throughput/total_tokens=3,778,560
    throughput/device/tokens_per_second=45,416
    throughput/device/batches_per_second=2.464
2025-07-15 19:46:03.083	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:03.510	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:03.933	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:04.357	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:04.797	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:05.090	g3084:0	olmo.train.trainer:817	INFO	[step=210/1000]
    train/CrossEntropyLoss=11.20
    train/ZLoss=0.0142
    train/ImageGenLoss=0.0377
    train/Accuracy=0.2500
    throughput/total_tokens=3,870,720
    throughput/device/tokens_per_second=44,070
    throughput/device/batches_per_second=2.391
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:46:05.238	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:05.665	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:06.091	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:06.511	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:06.926	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:07.213	g3084:0	olmo.train.trainer:817	INFO	[step=215/1000]
    train/CrossEntropyLoss=11.20
    train/ZLoss=0.0142
    train/ImageGenLoss=0.0350
    train/Accuracy=0.1940
    throughput/total_tokens=3,962,880
    throughput/device/tokens_per_second=43,844
    throughput/device/batches_per_second=2.379
2025-07-15 19:46:07.360	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:07.772	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:08.190	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:08.627	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:09.038	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:09.325	g3084:0	olmo.train.trainer:817	INFO	[step=220/1000]
    train/CrossEntropyLoss=11.19
    train/ZLoss=0.0142
    train/ImageGenLoss=0.0335
    train/Accuracy=0.2386
    throughput/total_tokens=4,055,040
    throughput/device/tokens_per_second=43,794
    throughput/device/batches_per_second=2.376
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:46:09.326	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:46:12.896	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:46:12.911	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:46:12.912	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.6 seconds
2025-07-15 19:46:13.063	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:13.474	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:13.886	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:14.311	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:14.744	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:15.031	g3084:0	olmo.train.trainer:817	INFO	[step=225/1000]
    train/CrossEntropyLoss=11.26
    train/ZLoss=0.0142
    train/ImageGenLoss=0.0337
    train/Accuracy=0.1967
    throughput/total_tokens=4,147,200
    throughput/device/tokens_per_second=46,527
    throughput/device/batches_per_second=2.524
2025-07-15 19:46:15.174	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:15.578	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:15.992	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:16.411	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:16.832	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:17.122	g3084:0	olmo.train.trainer:817	INFO	[step=230/1000]
    train/CrossEntropyLoss=11.19
    train/ZLoss=0.0142
    train/ImageGenLoss=0.0334
    train/Accuracy=0.2188
    throughput/total_tokens=4,239,360
    throughput/device/tokens_per_second=45,279
    throughput/device/batches_per_second=2.457
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:46:17.270	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:17.685	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:18.111	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:18.536	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:18.960	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:19.248	g3084:0	olmo.train.trainer:817	INFO	[step=235/1000]
    train/CrossEntropyLoss=11.15
    train/ZLoss=0.0142
    train/ImageGenLoss=0.0326
    train/Accuracy=0.2877
    throughput/total_tokens=4,331,520
    throughput/device/tokens_per_second=44,615
    throughput/device/batches_per_second=2.421
2025-07-15 19:46:19.378	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:19.797	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:20.227	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:20.639	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:21.057	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:21.344	g3084:0	olmo.train.trainer:817	INFO	[step=240/1000]
    train/CrossEntropyLoss=11.23
    train/ZLoss=0.0142
    train/ImageGenLoss=0.0322
    train/Accuracy=0.1977
    throughput/total_tokens=4,423,680
    throughput/device/tokens_per_second=44,450
    throughput/device/batches_per_second=2.412
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:46:21.346	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:46:24.752	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:46:24.767	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:46:24.768	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.4 seconds
2025-07-15 19:46:24.926	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:25.346	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:25.760	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:26.181	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:26.602	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:26.887	g3084:0	olmo.train.trainer:817	INFO	[step=245/1000]
    train/CrossEntropyLoss=11.14
    train/ZLoss=0.0142
    train/ImageGenLoss=0.0320
    train/Accuracy=0.2647
    throughput/total_tokens=4,515,840
    throughput/device/tokens_per_second=46,692
    throughput/device/batches_per_second=2.533
2025-07-15 19:46:27.015	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:27.434	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:27.848	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:28.270	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:28.684	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:28.974	g3084:0	olmo.train.trainer:817	INFO	[step=250/1000]
    train/CrossEntropyLoss=11.13
    train/ZLoss=0.0142
    train/ImageGenLoss=0.0325
    train/Accuracy=0.2985
    throughput/total_tokens=4,608,000
    throughput/device/tokens_per_second=45,403
    throughput/device/batches_per_second=2.463
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:46:29.135	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:29.557	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:29.980	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:30.405	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:30.826	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:31.113	g3084:0	olmo.train.trainer:817	INFO	[step=255/1000]
    train/CrossEntropyLoss=11.16
    train/ZLoss=0.0142
    train/ImageGenLoss=0.0315
    train/Accuracy=0.2361
    throughput/total_tokens=4,700,160
    throughput/device/tokens_per_second=44,596
    throughput/device/batches_per_second=2.420
2025-07-15 19:46:31.253	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:31.681	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:32.100	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:32.506	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:32.934	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:33.221	g3084:0	olmo.train.trainer:817	INFO	[step=260/1000]
    train/CrossEntropyLoss=11.12
    train/ZLoss=0.0142
    train/ImageGenLoss=0.0313
    train/Accuracy=0.2121
    throughput/total_tokens=4,792,320
    throughput/device/tokens_per_second=44,374
    throughput/device/batches_per_second=2.407
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:46:33.223	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:46:36.804	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:46:36.819	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:46:36.820	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.6 seconds
2025-07-15 19:46:36.971	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:37.398	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:37.819	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:38.247	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:38.678	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:38.965	g3084:0	olmo.train.trainer:817	INFO	[step=265/1000]
    train/CrossEntropyLoss=11.12
    train/ZLoss=0.0142
    train/ImageGenLoss=0.0311
    train/Accuracy=0.2069
    throughput/total_tokens=4,884,480
    throughput/device/tokens_per_second=45,942
    throughput/device/batches_per_second=2.493
2025-07-15 19:46:39.095	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:39.532	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:39.954	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:40.409	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:40.844	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:41.132	g3084:0	olmo.train.trainer:817	INFO	[step=270/1000]
    train/CrossEntropyLoss=11.10
    train/ZLoss=0.0142
    train/ImageGenLoss=0.0310
    train/Accuracy=0.2738
    throughput/total_tokens=4,976,640
    throughput/device/tokens_per_second=44,173
    throughput/device/batches_per_second=2.397
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:46:41.267	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:41.673	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:42.107	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:42.534	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:42.968	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:43.259	g3084:0	olmo.train.trainer:817	INFO	[step=275/1000]
    train/CrossEntropyLoss=11.06
    train/ZLoss=0.0141
    train/ImageGenLoss=0.0316
    train/Accuracy=0.2571
    throughput/total_tokens=5,068,800
    throughput/device/tokens_per_second=43,882
    throughput/device/batches_per_second=2.381
2025-07-15 19:46:43.398	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:43.811	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:44.233	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:44.662	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:45.083	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:45.372	g3084:0	olmo.train.trainer:817	INFO	[step=280/1000]
    train/CrossEntropyLoss=11.06
    train/ZLoss=0.0141
    train/ImageGenLoss=0.0310
    train/Accuracy=0.2388
    throughput/total_tokens=5,160,960
    throughput/device/tokens_per_second=43,820
    throughput/device/batches_per_second=2.377
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:46:45.373	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:46:48.822	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:46:48.837	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:46:48.837	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.5 seconds
2025-07-15 19:46:48.996	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:49.426	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:49.849	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:50.268	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:50.689	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:50.976	g3084:0	olmo.train.trainer:817	INFO	[step=285/1000]
    train/CrossEntropyLoss=11.04
    train/ZLoss=0.0141
    train/ImageGenLoss=0.0308
    train/Accuracy=0.2985
    throughput/total_tokens=5,253,120
    throughput/device/tokens_per_second=46,242
    throughput/device/batches_per_second=2.509
2025-07-15 19:46:51.114	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:51.538	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:51.949	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:52.377	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:52.788	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:53.075	g3084:0	olmo.train.trainer:817	INFO	[step=290/1000]
    train/CrossEntropyLoss=11.18
    train/ZLoss=0.0141
    train/ImageGenLoss=0.0324
    train/Accuracy=0.1831
    throughput/total_tokens=5,345,280
    throughput/device/tokens_per_second=45,047
    throughput/device/batches_per_second=2.444
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:46:53.229	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:53.643	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:54.054	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:54.480	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:54.897	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:55.185	g3084:0	olmo.train.trainer:817	INFO	[step=295/1000]
    train/CrossEntropyLoss=11.03
    train/ZLoss=0.0141
    train/ImageGenLoss=0.0308
    train/Accuracy=0.2874
    throughput/total_tokens=5,437,440
    throughput/device/tokens_per_second=44,579
    throughput/device/batches_per_second=2.419
2025-07-15 19:46:55.336	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:55.755	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:56.194	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:56.618	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:57.032	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:46:57.320	g3084:0	olmo.train.trainer:817	INFO	[step=300/1000]
    train/CrossEntropyLoss=11.02
    train/ZLoss=0.0141
    train/ImageGenLoss=0.0306
    train/Accuracy=0.2381
    throughput/total_tokens=5,529,600
    throughput/device/tokens_per_second=44,220
    throughput/device/batches_per_second=2.399
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:46:57.322	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:47:00.783	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:47:00.798	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:47:00.799	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.5 seconds
2025-07-15 19:47:00.959	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:01.388	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:01.803	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:02.227	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:02.658	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:02.946	g3084:0	olmo.train.trainer:817	INFO	[step=305/1000]
    train/CrossEntropyLoss=10.99
    train/ZLoss=0.0141
    train/ImageGenLoss=0.0305
    train/Accuracy=0.3333
    throughput/total_tokens=5,621,760
    throughput/device/tokens_per_second=46,090
    throughput/device/batches_per_second=2.501
2025-07-15 19:47:03.083	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:03.541	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:03.973	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:04.394	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:04.827	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:05.115	g3084:0	olmo.train.trainer:817	INFO	[step=310/1000]
    train/CrossEntropyLoss=11.02
    train/ZLoss=0.0141
    train/ImageGenLoss=0.0304
    train/Accuracy=0.2838
    throughput/total_tokens=5,713,920
    throughput/device/tokens_per_second=44,220
    throughput/device/batches_per_second=2.399
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:47:05.244	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:05.680	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:06.098	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:06.526	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:06.952	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:07.239	g3084:0	olmo.train.trainer:817	INFO	[step=315/1000]
    train/CrossEntropyLoss=10.92
    train/ZLoss=0.0141
    train/ImageGenLoss=0.0307
    train/Accuracy=0.3056
    throughput/total_tokens=5,806,080
    throughput/device/tokens_per_second=43,939
    throughput/device/batches_per_second=2.384
2025-07-15 19:47:07.378	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:07.794	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:08.218	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:08.634	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:09.050	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:09.336	g3084:0	olmo.train.trainer:817	INFO	[step=320/1000]
    train/CrossEntropyLoss=10.94
    train/ZLoss=0.0141
    train/ImageGenLoss=0.0309
    train/Accuracy=0.2778
    throughput/total_tokens=5,898,240
    throughput/device/tokens_per_second=43,944
    throughput/device/batches_per_second=2.384
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:47:09.337	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:47:12.781	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:47:12.795	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:47:12.796	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.5 seconds
2025-07-15 19:47:12.972	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:13.390	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:13.814	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:14.237	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:14.653	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:14.939	g3084:0	olmo.train.trainer:817	INFO	[step=325/1000]
    train/CrossEntropyLoss=10.99
    train/ZLoss=0.0141
    train/ImageGenLoss=0.0308
    train/Accuracy=0.2800
    throughput/total_tokens=5,990,400
    throughput/device/tokens_per_second=46,558
    throughput/device/batches_per_second=2.526
2025-07-15 19:47:15.091	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:15.503	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:15.929	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:16.350	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:16.760	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:17.046	g3084:0	olmo.train.trainer:817	INFO	[step=330/1000]
    train/CrossEntropyLoss=10.96
    train/ZLoss=0.0141
    train/ImageGenLoss=0.0307
    train/Accuracy=0.2456
    throughput/total_tokens=6,082,560
    throughput/device/tokens_per_second=45,113
    throughput/device/batches_per_second=2.448
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:47:17.187	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:17.608	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:18.023	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:18.438	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:18.863	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:19.150	g3084:0	olmo.train.trainer:817	INFO	[step=335/1000]
    train/CrossEntropyLoss=10.95
    train/ZLoss=0.0141
    train/ImageGenLoss=0.0321
    train/Accuracy=0.2545
    throughput/total_tokens=6,174,720
    throughput/device/tokens_per_second=44,665
    throughput/device/batches_per_second=2.423
2025-07-15 19:47:19.291	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:19.719	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:20.129	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:20.565	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:21.000	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:21.290	g3084:0	olmo.train.trainer:817	INFO	[step=340/1000]
    train/CrossEntropyLoss=10.90
    train/ZLoss=0.0141
    train/ImageGenLoss=0.0309
    train/Accuracy=0.2794
    throughput/total_tokens=6,266,880
    throughput/device/tokens_per_second=44,259
    throughput/device/batches_per_second=2.401
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:47:21.291	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:47:24.724	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:47:24.739	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:47:24.740	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.4 seconds
2025-07-15 19:47:24.899	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:25.331	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:25.759	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:26.180	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:26.600	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:26.887	g3084:0	olmo.train.trainer:817	INFO	[step=345/1000]
    train/CrossEntropyLoss=10.89
    train/ZLoss=0.0141
    train/ImageGenLoss=0.0320
    train/Accuracy=0.3205
    throughput/total_tokens=6,359,040
    throughput/device/tokens_per_second=46,065
    throughput/device/batches_per_second=2.499
2025-07-15 19:47:27.036	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:27.453	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:27.864	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:28.280	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:28.710	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:28.999	g3084:0	olmo.train.trainer:817	INFO	[step=350/1000]
    train/CrossEntropyLoss=10.91
    train/ZLoss=0.0141
    train/ImageGenLoss=0.0323
    train/Accuracy=0.3115
    throughput/total_tokens=6,451,200
    throughput/device/tokens_per_second=44,825
    throughput/device/batches_per_second=2.432
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:47:29.143	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:29.579	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:29.998	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:30.420	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:30.849	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:31.135	g3084:0	olmo.train.trainer:817	INFO	[step=355/1000]
    train/CrossEntropyLoss=10.93
    train/ZLoss=0.0141
    train/ImageGenLoss=0.0304
    train/Accuracy=0.2877
    throughput/total_tokens=6,543,360
    throughput/device/tokens_per_second=44,246
    throughput/device/batches_per_second=2.401
2025-07-15 19:47:31.297	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:31.737	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:32.154	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:32.572	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:32.986	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:33.274	g3084:0	olmo.train.trainer:817	INFO	[step=360/1000]
    train/CrossEntropyLoss=10.98
    train/ZLoss=0.0141
    train/ImageGenLoss=0.0298
    train/Accuracy=0.2667
    throughput/total_tokens=6,635,520
    throughput/device/tokens_per_second=43,952
    throughput/device/batches_per_second=2.385
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:47:33.275	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:47:36.681	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:47:36.696	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:47:36.696	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.4 seconds
2025-07-15 19:47:36.861	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:37.344	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:37.748	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:38.173	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:38.603	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:38.893	g3084:0	olmo.train.trainer:817	INFO	[step=365/1000]
    train/CrossEntropyLoss=10.94
    train/ZLoss=0.0140
    train/ImageGenLoss=0.0081
    train/Accuracy=0.2807
    throughput/total_tokens=6,727,680
    throughput/device/tokens_per_second=45,078
    throughput/device/batches_per_second=2.446
2025-07-15 19:47:39.032	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:39.461	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:39.891	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:40.307	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:40.728	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:41.014	g3084:0	olmo.train.trainer:817	INFO	[step=370/1000]
    train/CrossEntropyLoss=10.83
    train/ZLoss=0.0141
    train/ImageGenLoss=0.0019
    train/Accuracy=0.3200
    throughput/total_tokens=6,819,840
    throughput/device/tokens_per_second=44,253
    throughput/device/batches_per_second=2.401
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:47:41.149	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:41.571	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:42.008	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:42.423	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:42.858	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:43.145	g3084:0	olmo.train.trainer:817	INFO	[step=375/1000]
    train/CrossEntropyLoss=10.88
    train/ZLoss=0.0141
    train/ImageGenLoss=-0.0004628374590538442
    train/Accuracy=0.3143
    throughput/total_tokens=6,912,000
    throughput/device/tokens_per_second=43,913
    throughput/device/batches_per_second=2.382
2025-07-15 19:47:43.286	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:43.721	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:44.151	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:44.566	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:44.980	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:45.266	g3084:0	olmo.train.trainer:817	INFO	[step=380/1000]
    train/CrossEntropyLoss=10.92
    train/ZLoss=0.0140
    train/ImageGenLoss=-8.476472430629656e-05
    train/Accuracy=0.2800
    throughput/total_tokens=7,004,160
    throughput/device/tokens_per_second=43,799
    throughput/device/batches_per_second=2.376
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:47:45.267	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:47:48.672	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:47:48.687	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:47:48.687	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.4 seconds
2025-07-15 19:47:48.853	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:49.276	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:49.691	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:50.104	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:50.515	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:50.802	g3084:0	olmo.train.trainer:817	INFO	[step=385/1000]
    train/CrossEntropyLoss=10.90
    train/ZLoss=0.0140
    train/ImageGenLoss=-0.000963227532338351
    train/Accuracy=0.2958
    throughput/total_tokens=7,096,320
    throughput/device/tokens_per_second=46,973
    throughput/device/batches_per_second=2.548
2025-07-15 19:47:50.937	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:51.352	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:51.807	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:52.250	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:52.680	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:52.970	g3084:0	olmo.train.trainer:817	INFO	[step=390/1000]
    train/CrossEntropyLoss=10.92
    train/ZLoss=0.0140
    train/ImageGenLoss=-0.0009443255257792771
    train/Accuracy=0.2714
    throughput/total_tokens=7,188,480
    throughput/device/tokens_per_second=44,634
    throughput/device/batches_per_second=2.422
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:47:53.107	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:53.519	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:53.934	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:54.362	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:54.782	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:55.072	g3084:0	olmo.train.trainer:817	INFO	[step=395/1000]
    train/CrossEntropyLoss=10.97
    train/ZLoss=0.0140
    train/ImageGenLoss=-0.0009536745492368937
    train/Accuracy=0.2615
    throughput/total_tokens=7,280,640
    throughput/device/tokens_per_second=44,369
    throughput/device/batches_per_second=2.407
2025-07-15 19:47:55.218	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:55.673	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:56.105	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:56.523	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:56.992	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:47:57.281	g3084:0	olmo.train.trainer:817	INFO	[step=400/1000]
    train/CrossEntropyLoss=10.83
    train/ZLoss=0.0140
    train/ImageGenLoss=0.0003
    train/Accuracy=0.3143
    throughput/total_tokens=7,372,800
    throughput/device/tokens_per_second=43,676
    throughput/device/batches_per_second=2.370
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:47:57.283	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:48:00.698	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:48:00.713	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:48:00.713	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.4 seconds
2025-07-15 19:48:00.869	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:01.288	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:01.705	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:02.115	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:02.557	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:02.845	g3084:0	olmo.train.trainer:817	INFO	[step=405/1000]
    train/CrossEntropyLoss=10.84
    train/ZLoss=0.0140
    train/ImageGenLoss=-0.0005519615951925516
    train/Accuracy=0.2987
    throughput/total_tokens=7,464,960
    throughput/device/tokens_per_second=46,363
    throughput/device/batches_per_second=2.515
2025-07-15 19:48:02.992	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:03.436	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:03.862	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:04.293	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:04.703	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:04.992	g3084:0	olmo.train.trainer:817	INFO	[step=410/1000]
    train/CrossEntropyLoss=10.81
    train/ZLoss=0.0140
    train/ImageGenLoss=-0.0006254388717934489
    train/Accuracy=0.3158
    throughput/total_tokens=7,557,120
    throughput/device/tokens_per_second=44,580
    throughput/device/batches_per_second=2.419
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:48:05.166	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:05.589	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:06.004	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:06.428	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:06.854	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:07.143	g3084:0	olmo.train.trainer:817	INFO	[step=415/1000]
    train/CrossEntropyLoss=10.85
    train/ZLoss=0.0140
    train/ImageGenLoss=-0.00011823563545476645
    train/Accuracy=0.2794
    throughput/total_tokens=7,649,280
    throughput/device/tokens_per_second=43,982
    throughput/device/batches_per_second=2.386
2025-07-15 19:48:07.278	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:07.732	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:08.156	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:08.587	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:09.016	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:09.306	g3084:0	olmo.train.trainer:817	INFO	[step=420/1000]
    train/CrossEntropyLoss=10.82
    train/ZLoss=0.0140
    train/ImageGenLoss=-0.0004709131608251482
    train/Accuracy=0.2899
    throughput/total_tokens=7,741,440
    throughput/device/tokens_per_second=43,636
    throughput/device/batches_per_second=2.367
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:48:09.307	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:48:12.734	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:48:12.749	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:48:12.750	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.4 seconds
2025-07-15 19:48:12.903	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:13.332	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:13.754	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:14.172	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:14.591	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:14.878	g3084:0	olmo.train.trainer:817	INFO	[step=425/1000]
    train/CrossEntropyLoss=10.85
    train/ZLoss=0.0140
    train/ImageGenLoss=0.0010
    train/Accuracy=0.2464
    throughput/total_tokens=7,833,600
    throughput/device/tokens_per_second=46,375
    throughput/device/batches_per_second=2.516
2025-07-15 19:48:15.029	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:15.461	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:15.906	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:16.397	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:16.821	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:17.109	g3084:0	olmo.train.trainer:817	INFO	[step=430/1000]
    train/CrossEntropyLoss=10.89
    train/ZLoss=0.0140
    train/ImageGenLoss=0.0007
    train/Accuracy=0.2400
    throughput/total_tokens=7,925,760
    throughput/device/tokens_per_second=43,700
    throughput/device/batches_per_second=2.371
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:48:17.253	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:17.666	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:18.101	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:18.522	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:18.971	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:19.258	g3084:0	olmo.train.trainer:817	INFO	[step=435/1000]
    train/CrossEntropyLoss=11.22
    train/ZLoss=0.0140
    train/ImageGenLoss=-0.0007361929165199399
    train/Accuracy=0.1728
    throughput/total_tokens=8,017,920
    throughput/device/tokens_per_second=43,422
    throughput/device/batches_per_second=2.356
2025-07-15 19:48:19.393	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:19.822	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:20.234	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:20.661	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:21.081	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:21.370	g3084:0	olmo.train.trainer:817	INFO	[step=440/1000]
    train/CrossEntropyLoss=10.88
    train/ZLoss=0.0140
    train/ImageGenLoss=0.0008
    train/Accuracy=0.2576
    throughput/total_tokens=8,110,080
    throughput/device/tokens_per_second=43,475
    throughput/device/batches_per_second=2.359
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:48:21.372	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:48:24.802	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:48:24.816	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:48:24.817	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.4 seconds
2025-07-15 19:48:24.995	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:25.416	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:25.836	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:26.269	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:26.688	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:26.976	g3084:0	olmo.train.trainer:817	INFO	[step=445/1000]
    train/CrossEntropyLoss=10.84
    train/ZLoss=0.0140
    train/ImageGenLoss=-0.0004345520865172148
    train/Accuracy=0.2319
    throughput/total_tokens=8,202,240
    throughput/device/tokens_per_second=46,245
    throughput/device/batches_per_second=2.509
2025-07-15 19:48:27.119	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:27.685	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:27.967	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:28.426	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:28.853	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:29.144	g3084:0	olmo.train.trainer:817	INFO	[step=450/1000]
    train/CrossEntropyLoss=10.74
    train/ZLoss=0.0140
    train/ImageGenLoss=-0.0006132564740255475
    train/Accuracy=0.3333
    throughput/total_tokens=8,294,400
    throughput/device/tokens_per_second=44,308
    throughput/device/batches_per_second=2.404
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:48:29.295	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:29.717	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:30.214	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:30.623	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:31.045	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:31.332	g3084:0	olmo.train.trainer:817	INFO	[step=455/1000]
    train/CrossEntropyLoss=10.88
    train/ZLoss=0.0140
    train/ImageGenLoss=-0.0005569588392972946
    train/Accuracy=0.2632
    throughput/total_tokens=8,386,560
    throughput/device/tokens_per_second=43,545
    throughput/device/batches_per_second=2.362
2025-07-15 19:48:31.465	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:31.883	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:32.298	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:32.714	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:33.128	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:33.417	g3084:0	olmo.train.trainer:817	INFO	[step=460/1000]
    train/CrossEntropyLoss=10.77
    train/ZLoss=0.0140
    train/ImageGenLoss=-0.0005926164449192584
    train/Accuracy=0.2857
    throughput/total_tokens=8,478,720
    throughput/device/tokens_per_second=43,712
    throughput/device/batches_per_second=2.372
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:48:33.418	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:48:36.856	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:48:36.871	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:48:36.871	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.5 seconds
2025-07-15 19:48:37.033	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:37.454	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:37.870	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:38.292	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:38.722	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:39.009	g3084:0	olmo.train.trainer:817	INFO	[step=465/1000]
    train/CrossEntropyLoss=10.72
    train/ZLoss=0.0140
    train/ImageGenLoss=-0.000270345073658973
    train/Accuracy=0.3143
    throughput/total_tokens=8,570,880
    throughput/device/tokens_per_second=46,345
    throughput/device/batches_per_second=2.514
2025-07-15 19:48:39.148	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:39.581	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:40.013	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:40.425	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:40.850	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:41.139	g3084:0	olmo.train.trainer:817	INFO	[step=470/1000]
    train/CrossEntropyLoss=10.71
    train/ZLoss=0.0140
    train/ImageGenLoss=-0.0005981421563774347
    train/Accuracy=0.3375
    throughput/total_tokens=8,663,040
    throughput/device/tokens_per_second=44,764
    throughput/device/batches_per_second=2.429
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:48:41.286	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:41.729	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:42.158	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:42.582	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:43.020	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:43.309	g3084:0	olmo.train.trainer:817	INFO	[step=475/1000]
    train/CrossEntropyLoss=10.79
    train/ZLoss=0.0140
    train/ImageGenLoss=0.0176
    train/Accuracy=0.2558
    throughput/total_tokens=8,755,200
    throughput/device/tokens_per_second=43,965
    throughput/device/batches_per_second=2.385
2025-07-15 19:48:43.460	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:43.899	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:44.332	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:44.754	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:45.185	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:45.474	g3084:0	olmo.train.trainer:817	INFO	[step=480/1000]
    train/CrossEntropyLoss=10.80
    train/ZLoss=0.0140
    train/ImageGenLoss=0.0026
    train/Accuracy=0.3000
    throughput/total_tokens=8,847,360
    throughput/device/tokens_per_second=43,613
    throughput/device/batches_per_second=2.366
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:48:45.475	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:48:48.945	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:48:48.960	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:48:48.961	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.5 seconds
2025-07-15 19:48:49.106	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:49.515	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:49.939	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:50.358	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:50.783	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:51.071	g3084:0	olmo.train.trainer:817	INFO	[step=485/1000]
    train/CrossEntropyLoss=10.86
    train/ZLoss=0.0139
    train/ImageGenLoss=-0.00020512612536549568
    train/Accuracy=0.2083
    throughput/total_tokens=8,939,520
    throughput/device/tokens_per_second=46,612
    throughput/device/batches_per_second=2.529
2025-07-15 19:48:51.208	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:51.632	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:52.057	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:52.482	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:52.915	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:53.205	g3084:0	olmo.train.trainer:817	INFO	[step=490/1000]
    train/CrossEntropyLoss=10.91
    train/ZLoss=0.0139
    train/ImageGenLoss=-0.0007011727429926395
    train/Accuracy=0.2581
    throughput/total_tokens=9,031,680
    throughput/device/tokens_per_second=44,835
    throughput/device/batches_per_second=2.433
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:48:53.341	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:53.781	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:54.206	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:54.622	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:55.039	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:55.330	g3084:0	olmo.train.trainer:817	INFO	[step=495/1000]
    train/CrossEntropyLoss=10.63
    train/ZLoss=0.0140
    train/ImageGenLoss=-0.00066954898647964
    train/Accuracy=0.3636
    throughput/total_tokens=9,123,840
    throughput/device/tokens_per_second=44,336
    throughput/device/batches_per_second=2.405
2025-07-15 19:48:55.467	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:55.887	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:56.310	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:56.741	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:57.312	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:48:57.601	g3084:0	olmo.train.trainer:817	INFO	[step=500/1000]
    train/CrossEntropyLoss=10.71
    train/ZLoss=0.0139
    train/ImageGenLoss=-0.0007998629589565098
    train/Accuracy=0.3333
    throughput/total_tokens=9,216,000
    throughput/device/tokens_per_second=43,334
    throughput/device/batches_per_second=2.351
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:48:57.603	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:49:01.052	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:49:01.067	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:49:01.067	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.5 seconds
2025-07-15 19:49:01.500	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:01.881	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:02.461	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:03.049	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:03.623	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:03.910	g3084:0	olmo.train.trainer:817	INFO	[step=505/1000]
    train/CrossEntropyLoss=10.76
    train/ZLoss=0.0139
    train/ImageGenLoss=-0.0005745890666730702
    train/Accuracy=0.2667
    throughput/total_tokens=9,308,160
    throughput/device/tokens_per_second=35,958
    throughput/device/batches_per_second=1.951
2025-07-15 19:49:04.144	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:04.675	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:05.299	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:05.868	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:06.432	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:06.720	g3084:0	olmo.train.trainer:817	INFO	[step=510/1000]
    train/CrossEntropyLoss=10.66
    train/ZLoss=0.0140
    train/ImageGenLoss=-0.00043844932224601507
    train/Accuracy=0.3500
    throughput/total_tokens=9,400,320
    throughput/device/tokens_per_second=34,308
    throughput/device/batches_per_second=1.861
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:49:07.026	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:07.622	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:08.208	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:08.828	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:09.360	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:09.648	g3084:0	olmo.train.trainer:817	INFO	[step=515/1000]
    train/CrossEntropyLoss=10.64
    train/ZLoss=0.0140
    train/ImageGenLoss=0.0067
    train/Accuracy=0.3797
    throughput/total_tokens=9,492,480
    throughput/device/tokens_per_second=33,310
    throughput/device/batches_per_second=1.807
2025-07-15 19:49:09.858	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:10.353	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:10.869	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:11.448	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:12.047	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:12.335	g3084:0	olmo.train.trainer:817	INFO	[step=520/1000]
    train/CrossEntropyLoss=10.75
    train/ZLoss=0.0139
    train/ImageGenLoss=0.0116
    train/Accuracy=0.2561
    throughput/total_tokens=9,584,640
    throughput/device/tokens_per_second=33,551
    throughput/device/batches_per_second=1.820
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:49:12.337	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:49:15.777	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:49:15.792	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:49:15.793	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.5 seconds
2025-07-15 19:49:16.074	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:16.726	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:17.281	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:17.813	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:18.316	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:18.603	g3084:0	olmo.train.trainer:817	INFO	[step=525/1000]
    train/CrossEntropyLoss=10.73
    train/ZLoss=0.0139
    train/ImageGenLoss=-0.0005455269711092114
    train/Accuracy=0.2603
    throughput/total_tokens=9,676,800
    throughput/device/tokens_per_second=36,259
    throughput/device/batches_per_second=1.967
2025-07-15 19:49:18.835	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:19.348	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:19.877	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:20.395	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:20.880	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:21.167	g3084:0	olmo.train.trainer:817	INFO	[step=530/1000]
    train/CrossEntropyLoss=10.76
    train/ZLoss=0.0139
    train/ImageGenLoss=-0.0005963568692095578
    train/Accuracy=0.2747
    throughput/total_tokens=9,768,960
    throughput/device/tokens_per_second=36,101
    throughput/device/batches_per_second=1.959
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:49:21.427	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:21.962	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:22.485	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:23.025	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:23.551	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:23.839	g3084:0	olmo.train.trainer:817	INFO	[step=535/1000]
    train/CrossEntropyLoss=10.64
    train/ZLoss=0.0139
    train/ImageGenLoss=-0.0007648335886187851
    train/Accuracy=0.3056
    throughput/total_tokens=9,861,120
    throughput/device/tokens_per_second=35,546
    throughput/device/batches_per_second=1.929
2025-07-15 19:49:24.126	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:24.658	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:25.212	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:25.738	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:26.295	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:26.583	g3084:0	olmo.train.trainer:817	INFO	[step=540/1000]
    train/CrossEntropyLoss=10.72
    train/ZLoss=0.0139
    train/ImageGenLoss=-0.0007533522439189255
    train/Accuracy=0.3108
    throughput/total_tokens=9,953,280
    throughput/device/tokens_per_second=35,036
    throughput/device/batches_per_second=1.901
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:49:26.585	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:49:30.039	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:49:30.054	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:49:30.055	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.5 seconds
2025-07-15 19:49:30.383	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:30.908	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:31.434	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:31.961	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:32.512	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:32.801	g3084:0	olmo.train.trainer:817	INFO	[step=545/1000]
    train/CrossEntropyLoss=10.64
    train/ZLoss=0.0139
    train/ImageGenLoss=0.0044
    train/Accuracy=0.2877
    throughput/total_tokens=10,045,440
    throughput/device/tokens_per_second=37,911
    throughput/device/batches_per_second=2.057
2025-07-15 19:49:33.066	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:33.578	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:34.096	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:34.653	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:35.208	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:35.495	g3084:0	olmo.train.trainer:817	INFO	[step=550/1000]
    train/CrossEntropyLoss=10.66
    train/ZLoss=0.0139
    train/ImageGenLoss=0.0042
    train/Accuracy=0.2933
    throughput/total_tokens=10,137,600
    throughput/device/tokens_per_second=35,968
    throughput/device/batches_per_second=1.951
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:49:35.763	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:36.299	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:36.844	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:37.335	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:37.876	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:38.165	g3084:0	olmo.train.trainer:817	INFO	[step=555/1000]
    train/CrossEntropyLoss=10.64
    train/ZLoss=0.0139
    train/ImageGenLoss=0.0014
    train/Accuracy=0.3247
    throughput/total_tokens=10,229,760
    throughput/device/tokens_per_second=35,473
    throughput/device/batches_per_second=1.925
2025-07-15 19:49:38.473	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:39.012	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:39.578	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:40.128	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:40.669	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:40.959	g3084:0	olmo.train.trainer:817	INFO	[step=560/1000]
    train/CrossEntropyLoss=10.68
    train/ZLoss=0.0139
    train/ImageGenLoss=-0.0005517200916074216
    train/Accuracy=0.3544
    throughput/total_tokens=10,321,920
    throughput/device/tokens_per_second=34,817
    throughput/device/batches_per_second=1.889
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:49:40.960	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:49:44.436	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:49:44.450	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:49:44.451	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.5 seconds
2025-07-15 19:49:44.744	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:45.288	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:45.840	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:46.358	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:46.893	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:47.182	g3084:0	olmo.train.trainer:817	INFO	[step=565/1000]
    train/CrossEntropyLoss=10.52
    train/ZLoss=0.0139
    train/ImageGenLoss=-0.0001268427149625495
    train/Accuracy=0.3438
    throughput/total_tokens=10,414,080
    throughput/device/tokens_per_second=37,602
    throughput/device/batches_per_second=2.040
2025-07-15 19:49:47.412	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:48.004	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:48.496	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:49.057	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:49.580	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:49.868	g3084:0	olmo.train.trainer:817	INFO	[step=570/1000]
    train/CrossEntropyLoss=10.63
    train/ZLoss=0.0139
    train/ImageGenLoss=-0.0003039382863789797
    train/Accuracy=0.3506
    throughput/total_tokens=10,506,240
    throughput/device/tokens_per_second=35,882
    throughput/device/batches_per_second=1.947
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:49:50.138	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:50.738	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:51.261	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:51.806	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:52.361	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:52.650	g3084:0	olmo.train.trainer:817	INFO	[step=575/1000]
    train/CrossEntropyLoss=10.69
    train/ZLoss=0.0139
    train/ImageGenLoss=0.0006
    train/Accuracy=0.3205
    throughput/total_tokens=10,598,400
    throughput/device/tokens_per_second=34,914
    throughput/device/batches_per_second=1.894
2025-07-15 19:49:52.939	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:53.472	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:54.036	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:54.617	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:55.150	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:55.439	g3084:0	olmo.train.trainer:817	INFO	[step=580/1000]
    train/CrossEntropyLoss=10.52
    train/ZLoss=0.0139
    train/ImageGenLoss=-0.000797622837126255
    train/Accuracy=0.4028
    throughput/total_tokens=10,690,560
    throughput/device/tokens_per_second=34,427
    throughput/device/batches_per_second=1.868
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:49:55.441	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:49:58.883	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:49:58.897	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:49:58.898	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.5 seconds
2025-07-15 19:49:59.296	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:49:59.838	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:00.401	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:00.963	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:01.493	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:01.781	g3084:0	olmo.train.trainer:817	INFO	[step=585/1000]
    train/CrossEntropyLoss=10.68
    train/ZLoss=0.0139
    train/ImageGenLoss=-0.0003551008412614465
    train/Accuracy=0.3485
    throughput/total_tokens=10,782,720
    throughput/device/tokens_per_second=36,894
    throughput/device/batches_per_second=2.002
2025-07-15 19:50:02.067	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:02.675	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:03.203	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:03.752	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:04.295	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:04.583	g3084:0	olmo.train.trainer:817	INFO	[step=590/1000]
    train/CrossEntropyLoss=10.56
    train/ZLoss=0.0139
    train/ImageGenLoss=0.0005
    train/Accuracy=0.3770
    throughput/total_tokens=10,874,880
    throughput/device/tokens_per_second=34,780
    throughput/device/batches_per_second=1.887
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:50:04.877	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:05.433	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:06.010	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:06.555	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:07.093	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:07.383	g3084:0	olmo.train.trainer:817	INFO	[step=595/1000]
    train/CrossEntropyLoss=10.56
    train/ZLoss=0.0139
    train/ImageGenLoss=-0.00041635436355136335
    train/Accuracy=0.3182
    throughput/total_tokens=10,967,040
    throughput/device/tokens_per_second=34,133
    throughput/device/batches_per_second=1.852
2025-07-15 19:50:07.668	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:08.189	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:08.746	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:09.270	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:09.840	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:10.128	g3084:0	olmo.train.trainer:817	INFO	[step=600/1000]
    train/CrossEntropyLoss=10.55
    train/ZLoss=0.0139
    train/ImageGenLoss=0.0012
    train/Accuracy=0.3614
    throughput/total_tokens=11,059,200
    throughput/device/tokens_per_second=33,993
    throughput/device/batches_per_second=1.844
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:50:10.130	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:50:13.584	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:50:13.599	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:50:13.600	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.5 seconds
2025-07-15 19:50:13.873	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:14.443	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:14.982	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:15.564	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:16.106	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:16.394	g3084:0	olmo.train.trainer:817	INFO	[step=605/1000]
    train/CrossEntropyLoss=10.46
    train/ZLoss=0.0139
    train/ImageGenLoss=-0.00011416907364036888
    train/Accuracy=0.4103
    throughput/total_tokens=11,151,360
    throughput/device/tokens_per_second=36,377
    throughput/device/batches_per_second=1.974
2025-07-15 19:50:16.665	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:17.211	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:17.753	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:18.319	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:18.925	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:19.213	g3084:0	olmo.train.trainer:817	INFO	[step=610/1000]
    train/CrossEntropyLoss=10.66
    train/ZLoss=0.0138
    train/ImageGenLoss=0.0002
    train/Accuracy=0.2500
    throughput/total_tokens=11,243,520
    throughput/device/tokens_per_second=34,438
    throughput/device/batches_per_second=1.868
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:50:19.467	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:20.050	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:20.611	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:21.186	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:21.752	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:22.042	g3084:0	olmo.train.trainer:817	INFO	[step=615/1000]
    train/CrossEntropyLoss=10.62
    train/ZLoss=0.0139
    train/ImageGenLoss=-0.0004804293275810778
    train/Accuracy=0.3429
    throughput/total_tokens=11,335,680
    throughput/device/tokens_per_second=33,796
    throughput/device/batches_per_second=1.834
2025-07-15 19:50:22.298	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:23.723	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:24.351	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:24.906	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:25.467	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:25.755	g3084:0	olmo.train.trainer:817	INFO	[step=620/1000]
    train/CrossEntropyLoss=10.55
    train/ZLoss=0.0139
    train/ImageGenLoss=-2.0997475076001137e-05
    train/Accuracy=0.3590
    throughput/total_tokens=11,427,840
    throughput/device/tokens_per_second=30,994
    throughput/device/batches_per_second=1.682
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:50:25.757	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:50:29.213	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:50:29.228	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:50:29.229	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.5 seconds
2025-07-15 19:50:29.476	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:30.016	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:30.547	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:31.062	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:31.591	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:31.878	g3084:0	olmo.train.trainer:817	INFO	[step=625/1000]
    train/CrossEntropyLoss=10.66
    train/ZLoss=0.0139
    train/ImageGenLoss=-0.0001559664960950613
    train/Accuracy=0.3099
    throughput/total_tokens=11,520,000
    throughput/device/tokens_per_second=38,167
    throughput/device/batches_per_second=2.071
2025-07-15 19:50:32.111	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:32.629	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:33.188	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:33.705	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:34.191	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:34.481	g3084:0	olmo.train.trainer:817	INFO	[step=630/1000]
    train/CrossEntropyLoss=10.56
    train/ZLoss=0.0139
    train/ImageGenLoss=0.0015
    train/Accuracy=0.3548
    throughput/total_tokens=11,612,160
    throughput/device/tokens_per_second=36,740
    throughput/device/batches_per_second=1.993
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:50:34.771	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:35.342	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:35.885	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:36.426	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:36.969	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:37.257	g3084:0	olmo.train.trainer:817	INFO	[step=635/1000]
    train/CrossEntropyLoss=10.61
    train/ZLoss=0.0138
    train/ImageGenLoss=-0.0011263207998126745
    train/Accuracy=0.2754
    throughput/total_tokens=11,704,320
    throughput/device/tokens_per_second=35,477
    throughput/device/batches_per_second=1.925
2025-07-15 19:50:37.505	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:38.076	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:38.621	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:39.153	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:39.710	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:39.999	g3084:0	olmo.train.trainer:817	INFO	[step=640/1000]
    train/CrossEntropyLoss=10.52
    train/ZLoss=0.0139
    train/ImageGenLoss=-0.00022452324628829956
    train/Accuracy=0.3492
    throughput/total_tokens=11,796,480
    throughput/device/tokens_per_second=34,992
    throughput/device/batches_per_second=1.898
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:50:40.001	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:50:43.472	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:50:43.486	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:50:43.487	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.5 seconds
2025-07-15 19:50:43.737	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:44.269	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:44.815	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:45.336	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:45.924	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:46.214	g3084:0	olmo.train.trainer:817	INFO	[step=645/1000]
    train/CrossEntropyLoss=10.61
    train/ZLoss=0.0138
    train/ImageGenLoss=-0.0004439625481609255
    train/Accuracy=0.2787
    throughput/total_tokens=11,888,640
    throughput/device/tokens_per_second=37,017
    throughput/device/batches_per_second=2.008
2025-07-15 19:50:46.486	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:47.068	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:47.617	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:48.131	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:48.653	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:48.943	g3084:0	olmo.train.trainer:817	INFO	[step=650/1000]
    train/CrossEntropyLoss=10.74
    train/ZLoss=0.0138
    train/ImageGenLoss=0.0011
    train/Accuracy=0.2603
    throughput/total_tokens=11,980,800
    throughput/device/tokens_per_second=35,322
    throughput/device/batches_per_second=1.916
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:50:49.208	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:49.762	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:50.294	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:50.828	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:51.368	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:51.657	g3084:0	olmo.train.trainer:817	INFO	[step=655/1000]
    train/CrossEntropyLoss=10.58
    train/ZLoss=0.0139
    train/ImageGenLoss=-0.0005406361306086183
    train/Accuracy=0.3103
    throughput/total_tokens=12,072,960
    throughput/device/tokens_per_second=34,855
    throughput/device/batches_per_second=1.891
2025-07-15 19:50:52.018	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:52.567	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:53.328	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:53.888	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:54.414	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:54.703	g3084:0	olmo.train.trainer:817	INFO	[step=660/1000]
    train/CrossEntropyLoss=10.57
    train/ZLoss=0.0139
    train/ImageGenLoss=-0.0002593630342744291
    train/Accuracy=0.3194
    throughput/total_tokens=12,165,120
    throughput/device/tokens_per_second=33,578
    throughput/device/batches_per_second=1.822
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:50:54.705	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:50:58.150	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:50:58.165	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:50:58.165	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.5 seconds
2025-07-15 19:50:58.399	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:58.931	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:59.444	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:50:59.973	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:00.536	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:00.827	g3084:0	olmo.train.trainer:817	INFO	[step=665/1000]
    train/CrossEntropyLoss=10.48
    train/ZLoss=0.0138
    train/ImageGenLoss=-0.0008754748851060867
    train/Accuracy=0.3667
    throughput/total_tokens=12,257,280
    throughput/device/tokens_per_second=37,769
    throughput/device/batches_per_second=2.049
2025-07-15 19:51:01.105	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:01.636	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:02.173	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:02.724	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:03.272	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:03.564	g3084:0	olmo.train.trainer:817	INFO	[step=670/1000]
    train/CrossEntropyLoss=10.53
    train/ZLoss=0.0138
    train/ImageGenLoss=-0.0007975092739798129
    train/Accuracy=0.3333
    throughput/total_tokens=12,349,440
    throughput/device/tokens_per_second=35,607
    throughput/device/batches_per_second=1.932
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:51:03.801	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:04.454	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:05.088	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:05.718	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:06.272	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:06.562	g3084:0	olmo.train.trainer:817	INFO	[step=675/1000]
    train/CrossEntropyLoss=10.59
    train/ZLoss=0.0138
    train/ImageGenLoss=0.0089
    train/Accuracy=0.3125
    throughput/total_tokens=12,441,600
    throughput/device/tokens_per_second=33,817
    throughput/device/batches_per_second=1.835
2025-07-15 19:51:06.823	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:07.444	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:08.019	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:08.606	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:09.098	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:09.386	g3084:0	olmo.train.trainer:817	INFO	[step=680/1000]
    train/CrossEntropyLoss=10.40
    train/ZLoss=0.0139
    train/ImageGenLoss=-0.00024143693735823035
    train/Accuracy=0.3636
    throughput/total_tokens=12,533,760
    throughput/device/tokens_per_second=33,515
    throughput/device/batches_per_second=1.818
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:51:09.388	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:51:12.785	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:51:12.800	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:51:12.800	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.4 seconds
2025-07-15 19:51:13.026	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:13.560	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:14.083	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:14.572	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:15.140	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:15.421	g3084:0	olmo.train.trainer:817	INFO	[step=685/1000]
    train/CrossEntropyLoss=10.45
    train/ZLoss=0.0138
    train/ImageGenLoss=-0.0003865048347506672
    train/Accuracy=0.3387
    throughput/total_tokens=12,625,920
    throughput/device/tokens_per_second=38,284
    throughput/device/batches_per_second=2.077
2025-07-15 19:51:15.767	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:16.270	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:16.879	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:17.428	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:17.983	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:18.264	g3084:0	olmo.train.trainer:817	INFO	[step=690/1000]
    train/CrossEntropyLoss=10.82
    train/ZLoss=0.0138
    train/ImageGenLoss=-0.0004926756955683231
    train/Accuracy=0.1607
    throughput/total_tokens=12,718,080
    throughput/device/tokens_per_second=35,112
    throughput/device/batches_per_second=1.905
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:51:18.512	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:19.020	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:19.498	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:20.029	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:20.516	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:20.796	g3084:0	olmo.train.trainer:817	INFO	[step=695/1000]
    train/CrossEntropyLoss=10.43
    train/ZLoss=0.0138
    train/ImageGenLoss=0.0003
    train/Accuracy=0.3824
    throughput/total_tokens=12,810,240
    throughput/device/tokens_per_second=35,526
    throughput/device/batches_per_second=1.927
2025-07-15 19:51:21.056	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:21.595	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:22.094	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:22.690	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:23.216	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:23.496	g3084:0	olmo.train.trainer:817	INFO	[step=700/1000]
    train/CrossEntropyLoss=10.46
    train/ZLoss=0.0139
    train/ImageGenLoss=0.0012
    train/Accuracy=0.3770
    throughput/total_tokens=12,902,400
    throughput/device/tokens_per_second=35,167
    throughput/device/batches_per_second=1.908
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:51:23.498	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:51:26.770	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:51:26.785	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:51:26.785	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.3 seconds
2025-07-15 19:51:26.991	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:27.497	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:28.028	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:28.540	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:29.057	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:29.338	g3084:0	olmo.train.trainer:817	INFO	[step=705/1000]
    train/CrossEntropyLoss=10.55
    train/ZLoss=0.0138
    train/ImageGenLoss=0.0006
    train/Accuracy=0.3457
    throughput/total_tokens=12,994,560
    throughput/device/tokens_per_second=39,069
    throughput/device/batches_per_second=2.120
2025-07-15 19:51:29.565	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:30.081	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:30.585	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:31.077	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:31.589	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:31.868	g3084:0	olmo.train.trainer:817	INFO	[step=710/1000]
    train/CrossEntropyLoss=10.48
    train/ZLoss=0.0138
    train/ImageGenLoss=0.0012
    train/Accuracy=0.3571
    throughput/total_tokens=13,086,720
    throughput/device/tokens_per_second=37,705
    throughput/device/batches_per_second=2.046
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:51:32.079	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:32.565	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:33.105	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:33.650	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:34.223	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:34.503	g3084:0	olmo.train.trainer:817	INFO	[step=715/1000]
    train/CrossEntropyLoss=10.59
    train/ZLoss=0.0138
    train/ImageGenLoss=0.0836
    train/Accuracy=0.2903
    throughput/total_tokens=13,178,880
    throughput/device/tokens_per_second=36,745
    throughput/device/batches_per_second=1.994
2025-07-15 19:51:34.713	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:35.263	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:35.754	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:36.316	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:36.820	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:37.099	g3084:0	olmo.train.trainer:817	INFO	[step=720/1000]
    train/CrossEntropyLoss=10.62
    train/ZLoss=0.0138
    train/ImageGenLoss=0.0004
    train/Accuracy=0.2877
    throughput/total_tokens=13,271,040
    throughput/device/tokens_per_second=36,427
    throughput/device/batches_per_second=1.976
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:51:37.101	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:51:40.406	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:51:40.421	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:51:40.421	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.3 seconds
2025-07-15 19:51:40.866	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:41.276	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:41.753	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:42.346	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:42.851	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:43.130	g3084:0	olmo.train.trainer:817	INFO	[step=725/1000]
    train/CrossEntropyLoss=10.54
    train/ZLoss=0.0138
    train/ImageGenLoss=-0.00094865687424317
    train/Accuracy=0.2821
    throughput/total_tokens=13,363,200
    throughput/device/tokens_per_second=38,183
    throughput/device/batches_per_second=2.072
2025-07-15 19:51:43.389	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:43.912	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:44.445	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:44.989	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:45.489	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:45.768	g3084:0	olmo.train.trainer:817	INFO	[step=730/1000]
    train/CrossEntropyLoss=10.52
    train/ZLoss=0.0138
    train/ImageGenLoss=0.0004
    train/Accuracy=0.3056
    throughput/total_tokens=13,455,360
    throughput/device/tokens_per_second=36,492
    throughput/device/batches_per_second=1.980
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:51:46.014	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:46.536	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:47.048	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:47.554	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:48.049	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:48.328	g3084:0	olmo.train.trainer:817	INFO	[step=735/1000]
    train/CrossEntropyLoss=10.54
    train/ZLoss=0.0138
    train/ImageGenLoss=-0.00027933655655942857
    train/Accuracy=0.3067
    throughput/total_tokens=13,547,520
    throughput/device/tokens_per_second=36,322
    throughput/device/batches_per_second=1.971
2025-07-15 19:51:48.540	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:49.022	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:49.656	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:49.997	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:50.513	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:50.793	g3084:0	olmo.train.trainer:817	INFO	[step=740/1000]
    train/CrossEntropyLoss=10.80
    train/ZLoss=0.0138
    train/ImageGenLoss=-0.00021990781533531845
    train/Accuracy=0.2237
    throughput/total_tokens=13,639,680
    throughput/device/tokens_per_second=36,584
    throughput/device/batches_per_second=1.985
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:51:50.795	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:51:54.078	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:51:54.093	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:51:54.094	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.3 seconds
2025-07-15 19:51:54.323	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:54.828	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:55.417	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:56.016	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:56.560	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:56.847	g3084:0	olmo.train.trainer:817	INFO	[step=745/1000]
    train/CrossEntropyLoss=10.55
    train/ZLoss=0.0138
    train/ImageGenLoss=-0.0008646264323033392
    train/Accuracy=0.2941
    throughput/total_tokens=13,731,840
    throughput/device/tokens_per_second=36,332
    throughput/device/batches_per_second=1.971
2025-07-15 19:51:57.070	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:57.569	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:58.090	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:58.593	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:59.085	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:51:59.372	g3084:0	olmo.train.trainer:817	INFO	[step=750/1000]
    train/CrossEntropyLoss=10.45
    train/ZLoss=0.0138
    train/ImageGenLoss=0.0026
    train/Accuracy=0.3014
    throughput/total_tokens=13,824,000
    throughput/device/tokens_per_second=36,423
    throughput/device/batches_per_second=1.976
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:51:59.648	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:00.128	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:00.692	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:01.180	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:01.732	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:02.019	g3084:0	olmo.train.trainer:817	INFO	[step=755/1000]
    train/CrossEntropyLoss=10.53
    train/ZLoss=0.0138
    train/ImageGenLoss=-0.0006136337178759277
    train/Accuracy=0.3065
    throughput/total_tokens=13,916,160
    throughput/device/tokens_per_second=35,867
    throughput/device/batches_per_second=1.946
2025-07-15 19:52:02.279	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:02.775	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:03.283	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:03.810	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:04.456	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:04.743	g3084:0	olmo.train.trainer:817	INFO	[step=760/1000]
    train/CrossEntropyLoss=10.58
    train/ZLoss=0.0138
    train/ImageGenLoss=-0.000388988817576319
    train/Accuracy=0.3171
    throughput/total_tokens=14,008,320
    throughput/device/tokens_per_second=35,337
    throughput/device/batches_per_second=1.917
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:52:04.745	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:52:08.196	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:52:08.211	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:52:08.212	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.5 seconds
2025-07-15 19:52:08.463	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:09.045	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:09.580	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:10.152	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:10.699	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:10.990	g3084:0	olmo.train.trainer:817	INFO	[step=765/1000]
    train/CrossEntropyLoss=10.50
    train/ZLoss=0.0138
    train/ImageGenLoss=-0.00017857589409686625
    train/Accuracy=0.3467
    throughput/total_tokens=14,100,480
    throughput/device/tokens_per_second=36,282
    throughput/device/batches_per_second=1.968
2025-07-15 19:52:11.256	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:11.751	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:12.268	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:12.760	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:13.347	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:13.639	g3084:0	olmo.train.trainer:817	INFO	[step=770/1000]
    train/CrossEntropyLoss=10.51
    train/ZLoss=0.0138
    train/ImageGenLoss=0.0114
    train/Accuracy=0.2836
    throughput/total_tokens=14,192,640
    throughput/device/tokens_per_second=35,520
    throughput/device/batches_per_second=1.927
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:52:13.922	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:14.473	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:14.991	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:15.589	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:16.115	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:16.404	g3084:0	olmo.train.trainer:817	INFO	[step=775/1000]
    train/CrossEntropyLoss=10.41
    train/ZLoss=0.0138
    train/ImageGenLoss=0.0013
    train/Accuracy=0.3538
    throughput/total_tokens=14,284,800
    throughput/device/tokens_per_second=34,759
    throughput/device/batches_per_second=1.886
2025-07-15 19:52:16.686	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:17.210	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:17.751	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:18.308	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:18.834	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:19.121	g3084:0	olmo.train.trainer:817	INFO	[step=780/1000]
    train/CrossEntropyLoss=10.49
    train/ZLoss=0.0138
    train/ImageGenLoss=-8.474862261209637e-05
    train/Accuracy=0.3333
    throughput/total_tokens=14,376,960
    throughput/device/tokens_per_second=34,546
    throughput/device/batches_per_second=1.874
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:52:19.122	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:52:22.590	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:52:22.605	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:52:22.606	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.5 seconds
2025-07-15 19:52:22.849	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:23.415	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:23.947	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:24.523	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:25.060	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:25.351	g3084:0	olmo.train.trainer:817	INFO	[step=785/1000]
    train/CrossEntropyLoss=10.53
    train/ZLoss=0.0138
    train/ImageGenLoss=0.0021
    train/Accuracy=0.2985
    throughput/total_tokens=14,469,120
    throughput/device/tokens_per_second=36,655
    throughput/device/batches_per_second=1.989
2025-07-15 19:52:25.578	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:26.161	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:26.718	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:27.270	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:27.821	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:28.111	g3084:0	olmo.train.trainer:817	INFO	[step=790/1000]
    train/CrossEntropyLoss=10.50
    train/ZLoss=0.0138
    train/ImageGenLoss=-0.00025360306608490646
    train/Accuracy=0.2676
    throughput/total_tokens=14,561,280
    throughput/device/tokens_per_second=34,949
    throughput/device/batches_per_second=1.896
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:52:28.377	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:28.894	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:29.441	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:30.010	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:30.561	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:30.849	g3084:0	olmo.train.trainer:817	INFO	[step=795/1000]
    train/CrossEntropyLoss=10.39
    train/ZLoss=0.0138
    train/ImageGenLoss=-0.0005173175013624132
    train/Accuracy=0.3548
    throughput/total_tokens=14,653,440
    throughput/device/tokens_per_second=34,507
    throughput/device/batches_per_second=1.872
2025-07-15 19:52:31.136	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:31.649	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:32.130	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:32.703	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:33.249	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:33.536	g3084:0	olmo.train.trainer:817	INFO	[step=800/1000]
    train/CrossEntropyLoss=10.48
    train/ZLoss=0.0138
    train/ImageGenLoss=1.814
    train/Accuracy=0.3889
    throughput/total_tokens=14,745,600
    throughput/device/tokens_per_second=34,454
    throughput/device/batches_per_second=1.869
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:52:33.538	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:52:37.007	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:52:37.022	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:52:37.022	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.5 seconds
2025-07-15 19:52:37.272	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:37.860	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:38.404	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:38.985	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:39.537	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:39.829	g3084:0	olmo.train.trainer:817	INFO	[step=805/1000]
    train/CrossEntropyLoss=10.45
    train/ZLoss=0.0138
    train/ImageGenLoss=0.0023
    train/Accuracy=0.3134
    throughput/total_tokens=14,837,760
    throughput/device/tokens_per_second=35,868
    throughput/device/batches_per_second=1.946
2025-07-15 19:52:40.052	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:40.597	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:41.163	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:41.650	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:42.263	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:42.554	g3084:0	olmo.train.trainer:817	INFO	[step=810/1000]
    train/CrossEntropyLoss=10.57
    train/ZLoss=0.0137
    train/ImageGenLoss=0.0006
    train/Accuracy=0.2105
    throughput/total_tokens=14,929,920
    throughput/device/tokens_per_second=34,817
    throughput/device/batches_per_second=1.889
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:52:42.798	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:43.350	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:43.878	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:44.442	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:45.032	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:45.319	g3084:0	olmo.train.trainer:817	INFO	[step=815/1000]
    train/CrossEntropyLoss=10.43
    train/ZLoss=0.0138
    train/ImageGenLoss=-0.0003827703185379505
    train/Accuracy=0.3243
    throughput/total_tokens=15,022,080
    throughput/device/tokens_per_second=34,304
    throughput/device/batches_per_second=1.861
2025-07-15 19:52:45.588	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:46.129	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:46.720	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:47.253	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:47.797	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:48.083	g3084:0	olmo.train.trainer:817	INFO	[step=820/1000]
    train/CrossEntropyLoss=10.47
    train/ZLoss=0.0138
    train/ImageGenLoss=-0.00041652750223875046
    train/Accuracy=0.3521
    throughput/total_tokens=15,114,240
    throughput/device/tokens_per_second=34,058
    throughput/device/batches_per_second=1.848
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:52:48.085	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:52:51.579	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:52:51.594	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:52:51.595	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.5 seconds
2025-07-15 19:52:51.862	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:52.415	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:52.954	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:53.483	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:54.089	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:54.379	g3084:0	olmo.train.trainer:817	INFO	[step=825/1000]
    train/CrossEntropyLoss=10.62
    train/ZLoss=0.0138
    train/ImageGenLoss=0.0004
    train/Accuracy=0.2817
    throughput/total_tokens=15,206,400
    throughput/device/tokens_per_second=36,430
    throughput/device/batches_per_second=1.976
2025-07-15 19:52:54.655	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:55.224	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:55.769	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:56.344	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:56.891	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:57.179	g3084:0	olmo.train.trainer:817	INFO	[step=830/1000]
    train/CrossEntropyLoss=10.54
    train/ZLoss=0.0138
    train/ImageGenLoss=-0.0007848149980418384
    train/Accuracy=0.2941
    throughput/total_tokens=15,298,560
    throughput/device/tokens_per_second=34,585
    throughput/device/batches_per_second=1.876
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:52:57.394	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:57.933	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:58.491	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:58.983	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:59.506	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:52:59.793	g3084:0	olmo.train.trainer:817	INFO	[step=835/1000]
    train/CrossEntropyLoss=10.54
    train/ZLoss=0.0138
    train/ImageGenLoss=0.0035
    train/Accuracy=0.2987
    throughput/total_tokens=15,390,720
    throughput/device/tokens_per_second=34,803
    throughput/device/batches_per_second=1.888
2025-07-15 19:53:00.051	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:00.600	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:01.277	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:01.690	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:02.250	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:02.538	g3084:0	olmo.train.trainer:817	INFO	[step=840/1000]
    train/CrossEntropyLoss=10.38
    train/ZLoss=0.0138
    train/ImageGenLoss=0.0054
    train/Accuracy=0.3235
    throughput/total_tokens=15,482,880
    throughput/device/tokens_per_second=34,489
    throughput/device/batches_per_second=1.871
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:53:02.539	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:53:06.138	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:53:06.153	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:53:06.154	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.6 seconds
2025-07-15 19:53:06.402	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:06.923	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:07.469	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:08.002	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:08.546	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:08.837	g3084:0	olmo.train.trainer:817	INFO	[step=845/1000]
    train/CrossEntropyLoss=10.38
    train/ZLoss=0.0138
    train/ImageGenLoss=0.0008
    train/Accuracy=0.3472
    throughput/total_tokens=15,575,040
    throughput/device/tokens_per_second=37,643
    throughput/device/batches_per_second=2.042
2025-07-15 19:53:09.114	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:09.678	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:10.199	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:10.739	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:11.305	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:11.594	g3084:0	olmo.train.trainer:817	INFO	[step=850/1000]
    train/CrossEntropyLoss=10.46
    train/ZLoss=0.0138
    train/ImageGenLoss=-0.0009975112043321133
    train/Accuracy=0.2857
    throughput/total_tokens=15,667,200
    throughput/device/tokens_per_second=35,411
    throughput/device/batches_per_second=1.921
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:53:11.850	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:12.388	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:12.920	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:13.466	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:14.011	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:14.297	g3084:0	olmo.train.trainer:817	INFO	[step=855/1000]
    train/CrossEntropyLoss=10.37
    train/ZLoss=0.0138
    train/ImageGenLoss=0.0009
    train/Accuracy=0.3889
    throughput/total_tokens=15,759,360
    throughput/device/tokens_per_second=34,959
    throughput/device/batches_per_second=1.897
2025-07-15 19:53:14.567	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:15.081	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:15.613	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:16.140	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:16.693	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:16.983	g3084:0	olmo.train.trainer:817	INFO	[step=860/1000]
    train/CrossEntropyLoss=10.45
    train/ZLoss=0.0138
    train/ImageGenLoss=-0.0008103798609226942
    train/Accuracy=0.3472
    throughput/total_tokens=15,851,520
    throughput/device/tokens_per_second=34,796
    throughput/device/batches_per_second=1.888
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:53:16.985	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:53:20.531	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:53:20.546	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:53:20.547	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.6 seconds
2025-07-15 19:53:20.825	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:21.366	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:21.939	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:22.455	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:22.985	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:23.275	g3084:0	olmo.train.trainer:817	INFO	[step=865/1000]
    train/CrossEntropyLoss=10.43
    train/ZLoss=0.0138
    train/ImageGenLoss=-0.00018785065913107246
    train/Accuracy=0.3030
    throughput/total_tokens=15,943,680
    throughput/device/tokens_per_second=37,424
    throughput/device/batches_per_second=2.030
2025-07-15 19:53:23.503	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:24.019	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:24.601	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:25.113	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:25.683	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:25.970	g3084:0	olmo.train.trainer:817	INFO	[step=870/1000]
    train/CrossEntropyLoss=10.46
    train/ZLoss=0.0138
    train/ImageGenLoss=-0.0007269188645295799
    train/Accuracy=0.2969
    throughput/total_tokens=16,035,840
    throughput/device/tokens_per_second=35,736
    throughput/device/batches_per_second=1.939
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:53:26.230	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:26.770	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:27.313	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:27.853	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:28.382	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:28.669	g3084:0	olmo.train.trainer:817	INFO	[step=875/1000]
    train/CrossEntropyLoss=10.45
    train/ZLoss=0.0138
    train/ImageGenLoss=0.0023
    train/Accuracy=0.3906
    throughput/total_tokens=16,128,000
    throughput/device/tokens_per_second=35,188
    throughput/device/batches_per_second=1.909
2025-07-15 19:53:28.901	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:29.459	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:29.996	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:30.554	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:31.097	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:31.390	g3084:0	olmo.train.trainer:817	INFO	[step=880/1000]
    train/CrossEntropyLoss=10.45
    train/ZLoss=0.0138
    train/ImageGenLoss=-0.000949316076003015
    train/Accuracy=0.3544
    throughput/total_tokens=16,220,160
    throughput/device/tokens_per_second=34,852
    throughput/device/batches_per_second=1.891
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:53:31.391	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:53:34.945	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:53:34.960	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:53:34.961	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.6 seconds
2025-07-15 19:53:35.231	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:35.791	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:36.296	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:36.874	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:37.417	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:37.706	g3084:0	olmo.train.trainer:817	INFO	[step=885/1000]
    train/CrossEntropyLoss=10.52
    train/ZLoss=0.0138
    train/ImageGenLoss=0.1283
    train/Accuracy=0.3563
    throughput/total_tokens=16,312,320
    throughput/device/tokens_per_second=37,042
    throughput/device/batches_per_second=2.010
2025-07-15 19:53:37.950	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:38.475	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:38.911	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:39.492	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:39.977	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:40.264	g3084:0	olmo.train.trainer:817	INFO	[step=890/1000]
    train/CrossEntropyLoss=10.54
    train/ZLoss=0.0138
    train/ImageGenLoss=0.0010
    train/Accuracy=0.3284
    throughput/total_tokens=16,404,480
    throughput/device/tokens_per_second=36,534
    throughput/device/batches_per_second=1.982
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:53:40.574	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:41.123	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:41.658	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:42.187	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:42.734	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:43.022	g3084:0	olmo.train.trainer:817	INFO	[step=895/1000]
    train/CrossEntropyLoss=10.51
    train/ZLoss=0.0138
    train/ImageGenLoss=-0.0013621908146888018
    train/Accuracy=0.3478
    throughput/total_tokens=16,496,640
    throughput/device/tokens_per_second=35,430
    throughput/device/batches_per_second=1.922
2025-07-15 19:53:43.322	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:43.897	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:44.465	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:45.015	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:45.546	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:45.837	g3084:0	olmo.train.trainer:817	INFO	[step=900/1000]
    train/CrossEntropyLoss=10.34
    train/ZLoss=0.0138
    train/ImageGenLoss=-2.3806467652320862e-05
    train/Accuracy=0.3699
    throughput/total_tokens=16,588,800
    throughput/device/tokens_per_second=34,718
    throughput/device/batches_per_second=1.884
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:53:45.839	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:53:49.377	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:53:49.392	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:53:49.393	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.6 seconds
2025-07-15 19:53:49.708	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:50.237	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:50.788	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:51.327	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:51.868	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:52.157	g3084:0	olmo.train.trainer:817	INFO	[step=905/1000]
    train/CrossEntropyLoss=10.37
    train/ZLoss=0.0138
    train/ImageGenLoss=-0.0001611553452676162
    train/Accuracy=0.3562
    throughput/total_tokens=16,680,960
    throughput/device/tokens_per_second=37,431
    throughput/device/batches_per_second=2.031
2025-07-15 19:53:52.431	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:52.950	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:53.459	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:54.038	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:54.609	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:54.896	g3084:0	olmo.train.trainer:817	INFO	[step=910/1000]
    train/CrossEntropyLoss=10.50
    train/ZLoss=0.0138
    train/ImageGenLoss=-6.66890264255926e-05
    train/Accuracy=0.2899
    throughput/total_tokens=16,773,120
    throughput/device/tokens_per_second=35,444
    throughput/device/batches_per_second=1.923
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:53:55.163	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:55.698	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:56.261	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:56.782	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:57.273	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:57.561	g3084:0	olmo.train.trainer:817	INFO	[step=915/1000]
    train/CrossEntropyLoss=10.42
    train/ZLoss=0.0138
    train/ImageGenLoss=-0.0001190120674436912
    train/Accuracy=0.4267
    throughput/total_tokens=16,865,280
    throughput/device/tokens_per_second=35,148
    throughput/device/batches_per_second=1.907
2025-07-15 19:53:57.809	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:58.381	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:58.924	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:59.440	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:53:59.927	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:00.218	g3084:0	olmo.train.trainer:817	INFO	[step=920/1000]
    train/CrossEntropyLoss=10.43
    train/ZLoss=0.0138
    train/ImageGenLoss=-0.00014487704902421683
    train/Accuracy=0.3433
    throughput/total_tokens=16,957,440
    throughput/device/tokens_per_second=35,032
    throughput/device/batches_per_second=1.901
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:54:00.220	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:54:03.798	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:54:03.814	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:54:03.814	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.6 seconds
2025-07-15 19:54:04.184	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:04.735	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:05.282	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:05.797	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:06.321	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:06.609	g3084:0	olmo.train.trainer:817	INFO	[step=925/1000]
    train/CrossEntropyLoss=10.48
    train/ZLoss=0.0138
    train/ImageGenLoss=-0.0005094305379316211
    train/Accuracy=0.3636
    throughput/total_tokens=17,049,600
    throughput/device/tokens_per_second=37,796
    throughput/device/batches_per_second=2.051
2025-07-15 19:54:06.869	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:07.366	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:07.927	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:08.456	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:09.046	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:09.333	g3084:0	olmo.train.trainer:817	INFO	[step=930/1000]
    train/CrossEntropyLoss=10.39
    train/ZLoss=0.0138
    train/ImageGenLoss=-0.000541902903933078
    train/Accuracy=0.3284
    throughput/total_tokens=17,141,760
    throughput/device/tokens_per_second=35,712
    throughput/device/batches_per_second=1.938
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:54:09.636	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:10.184	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:10.725	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:11.302	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:11.840	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:12.129	g3084:0	olmo.train.trainer:817	INFO	[step=935/1000]
    train/CrossEntropyLoss=10.44
    train/ZLoss=0.0138
    train/ImageGenLoss=-0.0001315286644967273
    train/Accuracy=0.3810
    throughput/total_tokens=17,233,920
    throughput/device/tokens_per_second=34,741
    throughput/device/batches_per_second=1.885
2025-07-15 19:54:12.323	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:12.922	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:13.492	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:14.035	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:14.598	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:14.889	g3084:0	olmo.train.trainer:817	INFO	[step=940/1000]
    train/CrossEntropyLoss=10.49
    train/ZLoss=0.0138
    train/ImageGenLoss=0.0026
    train/Accuracy=0.3333
    throughput/total_tokens=17,326,080
    throughput/device/tokens_per_second=34,397
    throughput/device/batches_per_second=1.866
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:54:14.890	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:54:18.423	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:54:18.438	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:54:18.439	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.5 seconds
2025-07-15 19:54:18.730	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:19.248	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:19.831	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:20.362	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:20.856	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:21.145	g3084:0	olmo.train.trainer:817	INFO	[step=945/1000]
    train/CrossEntropyLoss=10.47
    train/ZLoss=0.0138
    train/ImageGenLoss=-0.00015947624342516065
    train/Accuracy=0.3377
    throughput/total_tokens=17,418,240
    throughput/device/tokens_per_second=37,961
    throughput/device/batches_per_second=2.060
2025-07-15 19:54:21.380	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:21.920	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:22.425	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:22.937	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:23.499	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:23.786	g3084:0	olmo.train.trainer:817	INFO	[step=950/1000]
    train/CrossEntropyLoss=10.42
    train/ZLoss=0.0138
    train/ImageGenLoss=0.0001
    train/Accuracy=0.3030
    throughput/total_tokens=17,510,400
    throughput/device/tokens_per_second=36,362
    throughput/device/batches_per_second=1.973
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:54:24.029	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:24.548	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:25.105	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:25.621	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:26.150	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:26.441	g3084:0	olmo.train.trainer:817	INFO	[step=955/1000]
    train/CrossEntropyLoss=10.42
    train/ZLoss=0.0138
    train/ImageGenLoss=-0.0007222015410661697
    train/Accuracy=0.3433
    throughput/total_tokens=17,602,560
    throughput/device/tokens_per_second=35,796
    throughput/device/batches_per_second=1.942
2025-07-15 19:54:26.696	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:27.277	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:27.843	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:28.410	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:28.929	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:29.221	g3084:0	olmo.train.trainer:817	INFO	[step=960/1000]
    train/CrossEntropyLoss=10.36
    train/ZLoss=0.0138
    train/ImageGenLoss=0.0011
    train/Accuracy=0.3099
    throughput/total_tokens=17,694,720
    throughput/device/tokens_per_second=35,097
    throughput/device/batches_per_second=1.904
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:54:29.222	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:54:32.790	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:54:32.805	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:54:32.806	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.6 seconds
2025-07-15 19:54:33.096	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:33.629	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:34.235	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:34.797	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:35.308	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:35.597	g3084:0	olmo.train.trainer:817	INFO	[step=965/1000]
    train/CrossEntropyLoss=10.44
    train/ZLoss=0.0138
    train/ImageGenLoss=0.0025
    train/Accuracy=0.3636
    throughput/total_tokens=17,786,880
    throughput/device/tokens_per_second=36,666
    throughput/device/batches_per_second=1.989
2025-07-15 19:54:35.865	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:36.425	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:36.908	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:37.469	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:38.017	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:38.310	g3084:0	olmo.train.trainer:817	INFO	[step=970/1000]
    train/CrossEntropyLoss=10.45
    train/ZLoss=0.0138
    train/ImageGenLoss=-0.0007577225915156305
    train/Accuracy=0.3455
    throughput/total_tokens=17,879,040
    throughput/device/tokens_per_second=35,268
    throughput/device/batches_per_second=1.913
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:54:38.570	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:39.176	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:39.714	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:40.317	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:40.845	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:41.135	g3084:0	olmo.train.trainer:817	INFO	[step=975/1000]
    train/CrossEntropyLoss=10.41
    train/ZLoss=0.0137
    train/ImageGenLoss=0.0986
    train/Accuracy=0.3281
    throughput/total_tokens=17,971,200
    throughput/device/tokens_per_second=34,339
    throughput/device/batches_per_second=1.863
2025-07-15 19:54:41.366	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:41.970	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:42.496	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:43.030	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:43.569	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:43.860	g3084:0	olmo.train.trainer:817	INFO	[step=980/1000]
    train/CrossEntropyLoss=10.44
    train/ZLoss=0.0138
    train/ImageGenLoss=-0.0007354388362728059
    train/Accuracy=0.3239
    throughput/total_tokens=18,063,360
    throughput/device/tokens_per_second=34,207
    throughput/device/batches_per_second=1.856
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:54:43.862	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:54:47.393	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:54:47.408	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:54:47.409	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.5 seconds
2025-07-15 19:54:47.685	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:48.241	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:48.721	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:49.291	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:49.807	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:50.096	g3084:0	olmo.train.trainer:817	INFO	[step=985/1000]
    train/CrossEntropyLoss=10.59
    train/ZLoss=0.0138
    train/ImageGenLoss=0.0003
    train/Accuracy=0.2907
    throughput/total_tokens=18,155,520
    throughput/device/tokens_per_second=38,035
    throughput/device/batches_per_second=2.064
2025-07-15 19:54:50.341	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:50.837	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:51.305	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:51.832	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:52.340	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:52.628	g3084:0	olmo.train.trainer:817	INFO	[step=990/1000]
    train/CrossEntropyLoss=10.33
    train/ZLoss=0.0138
    train/ImageGenLoss=-0.0004866865056101233
    train/Accuracy=0.4110
    throughput/total_tokens=18,247,680
    throughput/device/tokens_per_second=37,196
    throughput/device/batches_per_second=2.018
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:54:52.940	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:53.450	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:54.049	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:54.557	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:55.040	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:55.331	g3084:0	olmo.train.trainer:817	INFO	[step=995/1000]
    train/CrossEntropyLoss=10.38
    train/ZLoss=0.0138
    train/ImageGenLoss=-0.0004306461487431079
    train/Accuracy=0.3429
    throughput/total_tokens=18,339,840
    throughput/device/tokens_per_second=36,103
    throughput/device/batches_per_second=1.959
2025-07-15 19:54:55.586	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:56.079	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:56.636	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:57.159	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:57.701	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:463: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-15 19:54:57.992	g3084:0	olmo.train.trainer:817	INFO	[step=1000/1000]
    train/CrossEntropyLoss=10.47
    train/ZLoss=0.0138
    train/ImageGenLoss=0.0002
    train/Accuracy=0.3521
    throughput/total_tokens=18,432,000
    throughput/device/tokens_per_second=35,726
    throughput/device/batches_per_second=1.938
    System/Peak GPU Memory (MB)=29,215
2025-07-15 19:54:57.993	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'chart_qa'...
2025-07-15 19:55:01.485	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-15 19:55:01.500	g3084:0	olmo.train.trainer:817	INFO	chart_qa
    em=0.0
    em_aug=0.0
    em_human=0.0
    relaxed_correctness=0.0
    relaxed_correctness_aug=0.0
    relaxed_correctness_human=0.0
    scifi_relaxed_correctness=0.0
    scifi_relaxed_correctness_aug=0.0
    scifi_relaxed_correctness_human=0.0
2025-07-15 19:55:01.501	g3084:0	olmo.train.trainer:874	INFO	Eval for 'chart_qa' done in 3.5 seconds
2025-07-15 19:55:01.501	g3084:0	olmo.train.trainer:1195	INFO	Saving final checkpoint...
2025-07-15 19:55:03.551	g3084:0	olmo.train.trainer:1197	INFO	Checkpoint saved to debug_run/step1000
2025-07-15 19:55:03.553	g3084:0	train:334	INFO	Training complete
2025-07-16 13:02:28.357	g3084:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-16 13:02:28.376	g3084:0	olmo.util:177	CRITICAL	Uncaught NotImplementedError: depth
Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/Umolmo/launch_scripts/train_multitask_model.py", line 294, in <module>
    evaluation = get_evaluation(
  File "/gscratch/krishna/mahtab/Umolmo/launch_scripts/utils.py", line 208, in get_evaluation
    evaluator = get_evaluator(name)
  File "/gscratch/krishna/mahtab/Umolmo/launch_scripts/utils.py", line 137, in get_evaluator
    raise NotImplementedError(name)
NotImplementedError: depth
2025-07-16 13:04:36.374	g3084:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-16 13:16:49.359	g3084:0	olmo.util:177	CRITICAL	Uncaught BdbQuit: 
Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/Umolmo/launch_scripts/train_multitask_model.py", line 294, in <module>
    evaluation = get_evaluation(
  File "/gscratch/krishna/mahtab/Umolmo/launch_scripts/utils.py", line 209, in get_evaluation
  File "/gscratch/krishna/mahtab/Umolmo/launch_scripts/utils.py", line 75, in get_evaluator
    if name in ["text_vqa", "okvqa", "coco_2014_vqa", "coco_2014_vqa_multi"]:
  File "/gscratch/krishna/mahtab/Umolmo/launch_scripts/utils.py", line 75, in get_evaluator
    if name in ["text_vqa", "okvqa", "coco_2014_vqa", "coco_2014_vqa_multi"]:
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/bdb.py", line 90, in trace_dispatch
    return self.dispatch_line(frame)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/bdb.py", line 115, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit
2025-07-16 13:17:10.978	g3084:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-16 13:17:11.218	g3084:0	train:54	INFO	Configuration:
2025-07-16 13:17:11.218	g3084:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=128, n_heads=2, n_kv_heads=None, head_dim=None, qkv_bias=False, clip_qkv=None, n_layers=1, mlp_ratio=4, mlp_hidden_size=None, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=10000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='default', layer_norm_with_affine=True, layer_norm_eps=None, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=True, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.1, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=None, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2-7B', tokenizer_dir=None), init_path=None, init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='openai', image_default_input_size=(336, 336), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1024, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=1, image_head_dim=64, image_mlp_dim=4096, image_mlp_activations='gelu', image_dropout_rate=0.0, image_num_pos=577, image_norm_eps=1e-05, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path=None, resize_mode='default', pad_value=0.0, normalize='openai'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-1,), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='resize', max_crops=1, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear', per_image_output_tokens=64), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'depth': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=20, inf_evaluators=[InfDatasetEvaluatorConfig(label='depth', data=DataLoaderConfig(dataset='depth', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=16, console_log_interval=5, include_image=False)], inf_eval_interval=20, eval_on_last_step=True, eval_on_load=False, save_folder='debug_run', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint=None, allow_resume=True, max_duration=1000, global_train_batch_size=8, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=None, beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=5, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=1000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-16 13:17:11.557	g3084:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-16 13:17:13.927	g3084:0	root:123	INFO	Padding tokenizer with 416 tokens
2025-07-16 13:17:17.907	g3084:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-16 13:17:18.443	g3084:0	train:191	INFO	Total number of parameters: 58,006,016
2025-07-16 13:17:18.444	g3084:0	train:192	INFO	Number of non-embedding parameters: 38,525,440
2025-07-16 13:17:18.445	g3084:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 234
2025-07-16 13:17:18.446	g3084:0	train:196	INFO	Model:
2025-07-16 13:17:18.446	g3084:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0): FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=128, out_features=128, bias=True)
          (ff_out): Linear(in_features=256, out_features=128, bias=True)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): LayerNorm()
          (ff_norm): LayerNorm()
          (att_proj): Linear(in_features=128, out_features=384, bias=True)
          (ff_proj): Linear(in_features=128, out_features=512, bias=True)
        )
      )
    )
    (ln_f): FSDPLayerNorm()
    (emb_drop): Dropout(p=0.1, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=128, out_features=152192, bias=True)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=1024, out_features=1024, bias=True)
        (wk): Linear(in_features=1024, out_features=1024, bias=True)
        (wv): Linear(in_features=1024, out_features=1024, bias=True)
        (wo): Linear(in_features=1024, out_features=1024, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1024, out_features=256, bias=False)
        (w2): Linear(in_features=256, out_features=128, bias=False)
        (w3): Linear(in_features=1024, out_features=256, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1024, bias=False)
      (pre_ln): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0): FSDPResidualAttentionBlock(
            (attention): ViTMultiHeadDotProductAttention(
              (wq): Linear(in_features=1024, out_features=1024, bias=True)
              (wk): Linear(in_features=1024, out_features=1024, bias=True)
              (wv): Linear(in_features=1024, out_features=1024, bias=True)
              (wo): Linear(in_features=1024, out_features=1024, bias=True)
              (residual_dropout): Dropout(p=0.0, inplace=False)
            )
            (feed_forward): ViTMLP(
              (w1): Linear(in_features=1024, out_features=4096, bias=True)
              (act): GELUActivation()
              (w2): Linear(in_features=4096, out_features=1024, bias=True)
            )
            (attention_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (ffn_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=700, out_features=128, bias=False)
  (vision_decoder_head): Linear(in_features=128, out_features=700, bias=False)
)
2025-07-16 13:17:18.456	g3084:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-16 13:17:18.456	g3084:0	olmo.data.data_loader:197	INFO	Loading train dataset depth/train
2025-07-16 13:17:18.457	g3084:0	olmo.util:177	CRITICAL	Uncaught NotImplementedError: ('depth', 'train')
Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/Umolmo/launch_scripts/train_multitask_model.py", line 396, in <module>
    run_trainer(cfg)
  File "/gscratch/krishna/mahtab/Umolmo/scripts/train.py", line 205, in run_trainer
    train_loader = cfg.data.build_train_dataloader(cfg.model, cfg.global_train_batch_size, device)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/data/data_loader.py", line 198, in build_train_dataloader
    dataset = get_dataset_by_name(name, self.split)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/data/get_dataset.py", line 245, in get_dataset_by_name
    raise NotImplementedError(dataset_name, split)
NotImplementedError: ('depth', 'train')
2025-07-16 13:49:48.646	g3084:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-16 13:49:48.847	g3084:0	train:54	INFO	Configuration:
2025-07-16 13:49:48.848	g3084:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=128, n_heads=2, n_kv_heads=None, head_dim=None, qkv_bias=False, clip_qkv=None, n_layers=1, mlp_ratio=4, mlp_hidden_size=None, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=10000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='default', layer_norm_with_affine=True, layer_norm_eps=None, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=True, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.1, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=None, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2-7B', tokenizer_dir=None), init_path=None, init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='openai', image_default_input_size=(336, 336), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1024, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=1, image_head_dim=64, image_mlp_dim=4096, image_mlp_activations='gelu', image_dropout_rate=0.0, image_num_pos=577, image_norm_eps=1e-05, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path=None, resize_mode='default', pad_value=0.0, normalize='openai'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-1,), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='resize', max_crops=1, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear', per_image_output_tokens=64), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'chart_qa': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=20, inf_evaluators=[InfDatasetEvaluatorConfig(label='chart_qa', data=DataLoaderConfig(dataset='chart_qa', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='relaxed_correctness,scifi_relaxed_correctness,em', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=16, console_log_interval=5, include_image=False)], inf_eval_interval=20, eval_on_last_step=True, eval_on_load=False, save_folder='debug_run', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint=None, allow_resume=True, max_duration=1000, global_train_batch_size=8, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=None, beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=5, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=1000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-16 13:49:49.172	g3084:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-16 13:49:51.625	g3084:0	root:123	INFO	Padding tokenizer with 416 tokens
2025-07-16 13:49:54.178	g3084:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-16 13:49:54.634	g3084:0	train:191	INFO	Total number of parameters: 58,006,016
2025-07-16 13:49:54.635	g3084:0	train:192	INFO	Number of non-embedding parameters: 38,525,440
2025-07-16 13:49:54.636	g3084:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 234
2025-07-16 13:49:54.636	g3084:0	train:196	INFO	Model:
2025-07-16 13:49:54.636	g3084:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0): FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=128, out_features=128, bias=True)
          (ff_out): Linear(in_features=256, out_features=128, bias=True)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): LayerNorm()
          (ff_norm): LayerNorm()
          (att_proj): Linear(in_features=128, out_features=384, bias=True)
          (ff_proj): Linear(in_features=128, out_features=512, bias=True)
        )
      )
    )
    (ln_f): FSDPLayerNorm()
    (emb_drop): Dropout(p=0.1, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=128, out_features=152192, bias=True)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=1024, out_features=1024, bias=True)
        (wk): Linear(in_features=1024, out_features=1024, bias=True)
        (wv): Linear(in_features=1024, out_features=1024, bias=True)
        (wo): Linear(in_features=1024, out_features=1024, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1024, out_features=256, bias=False)
        (w2): Linear(in_features=256, out_features=128, bias=False)
        (w3): Linear(in_features=1024, out_features=256, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1024, bias=False)
      (pre_ln): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0): FSDPResidualAttentionBlock(
            (attention): ViTMultiHeadDotProductAttention(
              (wq): Linear(in_features=1024, out_features=1024, bias=True)
              (wk): Linear(in_features=1024, out_features=1024, bias=True)
              (wv): Linear(in_features=1024, out_features=1024, bias=True)
              (wo): Linear(in_features=1024, out_features=1024, bias=True)
              (residual_dropout): Dropout(p=0.0, inplace=False)
            )
            (feed_forward): ViTMLP(
              (w1): Linear(in_features=1024, out_features=4096, bias=True)
              (act): GELUActivation()
              (w2): Linear(in_features=4096, out_features=1024, bias=True)
            )
            (attention_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (ffn_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=700, out_features=128, bias=False)
  (vision_decoder_head): Linear(in_features=128, out_features=700, bias=False)
)
2025-07-16 13:49:54.656	g3084:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-16 13:49:54.656	g3084:0	olmo.data.data_loader:197	INFO	Loading train dataset chart_qa/train
2025-07-16 13:49:54.657	g3084:0	root:437	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_human.json
2025-07-16 13:49:54.709	g3084:0	root:437	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_augmented.json
2025-07-16 13:49:54.848	g3084:0	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-16 13:49:54.849	g3084:0	olmo.data.data_loader:219	INFO	chart_qa: 100.00
2025-07-16 13:49:54.851	g3084:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=2304 images=1 pooled_patches_idx=158
2025-07-16 13:49:54.852	g3084:0	olmo.data.data_loader:100	INFO	Loading eval dataset: chart_qa/validation
2025-07-16 13:49:54.852	g3084:0	root:437	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_human.json
2025-07-16 13:49:54.872	g3084:0	root:437	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_augmented.json
2025-07-16 13:49:54.895	g3084:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=1792 images=1 pooled_patches_idx=158
2025-07-16 13:49:58.174	g3084:0	train:332	INFO	Starting training...
2025-07-16 13:49:58.175	g3084:0	olmo.train.trainer:817	INFO	Pre-train system metrics
    System/Peak GPU Memory (MB)=370.5
2025-07-16 13:54:42.479	g3084:0	olmo.util:177	CRITICAL	Uncaught BdbQuit: 
Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/Umolmo/launch_scripts/train_multitask_model.py", line 396, in <module>
    run_trainer(cfg)
  File "/gscratch/krishna/mahtab/Umolmo/scripts/train.py", line 333, in run_trainer
    trainer.fit()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 1021, in fit
    for batch in self.train_loader:
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 733, in __next__
    data = self._next_data()
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 789, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 33, in fetch
    data.append(next(self.dataset_iter))
  File "/gscratch/krishna/mahtab/Umolmo/olmo/data/iterable_dataset_mixture.py", line 122, in __iter__
    yield dataset.get(int(shuffled_order[count % len(dataset)]), epoch)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/data/dataset.py", line 70, in get
    item = self.preprocessor(item, rng, **self.preprocessor_kwargs)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/model_preprocessor.py", line 394, in __call__
    messages, formatter_metadata = self.formater(example, self.is_training, self.for_inference, rng)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/data_formatter.py", line 645, in __call__
    return self._format_example(ex, ex, is_training, for_inference, rng)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/data_formatter.py", line 588, in _format_example
    prompt, response, extra_metadata = self.get_user_prompt(message, is_training, for_inference=for_inference, rng=rng)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/data_formatter.py", line 571, in get_user_prompt
    return prompt, output, metadata
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/data_formatter.py", line 571, in get_user_prompt
    return prompt, output, metadata
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/bdb.py", line 90, in trace_dispatch
    return self.dispatch_line(frame)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/bdb.py", line 115, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit
2025-07-16 13:55:07.755	g3084:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-16 13:55:07.823	g3084:0	train:54	INFO	Configuration:
2025-07-16 13:55:07.823	g3084:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=128, n_heads=2, n_kv_heads=None, head_dim=None, qkv_bias=False, clip_qkv=None, n_layers=1, mlp_ratio=4, mlp_hidden_size=None, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=10000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='default', layer_norm_with_affine=True, layer_norm_eps=None, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=True, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.1, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=None, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2-7B', tokenizer_dir=None), init_path=None, init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='openai', image_default_input_size=(336, 336), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1024, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=1, image_head_dim=64, image_mlp_dim=4096, image_mlp_activations='gelu', image_dropout_rate=0.0, image_num_pos=577, image_norm_eps=1e-05, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path=None, resize_mode='default', pad_value=0.0, normalize='openai'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-1,), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='resize', max_crops=1, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear', per_image_output_tokens=64), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'chart_qa': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=20, inf_evaluators=[InfDatasetEvaluatorConfig(label='chart_qa', data=DataLoaderConfig(dataset='chart_qa', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='relaxed_correctness,scifi_relaxed_correctness,em', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=16, console_log_interval=5, include_image=False)], inf_eval_interval=20, eval_on_last_step=True, eval_on_load=False, save_folder='debug_run', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint=None, allow_resume=True, max_duration=1000, global_train_batch_size=8, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=None, beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=5, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=1000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-16 13:55:08.172	g3084:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-16 13:55:10.161	g3084:0	root:123	INFO	Padding tokenizer with 416 tokens
2025-07-16 13:55:11.887	g3084:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-16 13:55:12.029	g3084:0	train:191	INFO	Total number of parameters: 58,006,016
2025-07-16 13:55:12.030	g3084:0	train:192	INFO	Number of non-embedding parameters: 38,525,440
2025-07-16 13:55:12.031	g3084:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 234
2025-07-16 13:55:12.031	g3084:0	train:196	INFO	Model:
2025-07-16 13:55:12.031	g3084:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0): FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=128, out_features=128, bias=True)
          (ff_out): Linear(in_features=256, out_features=128, bias=True)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): LayerNorm()
          (ff_norm): LayerNorm()
          (att_proj): Linear(in_features=128, out_features=384, bias=True)
          (ff_proj): Linear(in_features=128, out_features=512, bias=True)
        )
      )
    )
    (ln_f): FSDPLayerNorm()
    (emb_drop): Dropout(p=0.1, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=128, out_features=152192, bias=True)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=1024, out_features=1024, bias=True)
        (wk): Linear(in_features=1024, out_features=1024, bias=True)
        (wv): Linear(in_features=1024, out_features=1024, bias=True)
        (wo): Linear(in_features=1024, out_features=1024, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1024, out_features=256, bias=False)
        (w2): Linear(in_features=256, out_features=128, bias=False)
        (w3): Linear(in_features=1024, out_features=256, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1024, bias=False)
      (pre_ln): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0): FSDPResidualAttentionBlock(
            (attention): ViTMultiHeadDotProductAttention(
              (wq): Linear(in_features=1024, out_features=1024, bias=True)
              (wk): Linear(in_features=1024, out_features=1024, bias=True)
              (wv): Linear(in_features=1024, out_features=1024, bias=True)
              (wo): Linear(in_features=1024, out_features=1024, bias=True)
              (residual_dropout): Dropout(p=0.0, inplace=False)
            )
            (feed_forward): ViTMLP(
              (w1): Linear(in_features=1024, out_features=4096, bias=True)
              (act): GELUActivation()
              (w2): Linear(in_features=4096, out_features=1024, bias=True)
            )
            (attention_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (ffn_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=700, out_features=128, bias=False)
  (vision_decoder_head): Linear(in_features=128, out_features=700, bias=False)
)
2025-07-16 13:55:12.072	g3084:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-16 13:55:12.073	g3084:0	olmo.data.data_loader:197	INFO	Loading train dataset chart_qa/train
2025-07-16 13:55:12.073	g3084:0	root:437	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_human.json
2025-07-16 13:55:12.157	g3084:0	root:437	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_augmented.json
2025-07-16 13:55:12.298	g3084:0	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-16 13:55:12.299	g3084:0	olmo.data.data_loader:219	INFO	chart_qa: 100.00
2025-07-16 13:55:12.300	g3084:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=2304 images=1 pooled_patches_idx=158
2025-07-16 13:55:12.301	g3084:0	olmo.data.data_loader:100	INFO	Loading eval dataset: chart_qa/validation
2025-07-16 13:55:12.302	g3084:0	root:437	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_human.json
2025-07-16 13:55:12.322	g3084:0	root:437	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_augmented.json
2025-07-16 13:55:12.345	g3084:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=1792 images=1 pooled_patches_idx=158
2025-07-16 13:55:12.963	g3084:0	train:332	INFO	Starting training...
2025-07-16 13:55:12.964	g3084:0	olmo.train.trainer:817	INFO	Pre-train system metrics
    System/Peak GPU Memory (MB)=370.5
2025-07-16 14:24:30.259	g3084:0	olmo.util:177	CRITICAL	Uncaught BdbQuit: 
Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/Umolmo/launch_scripts/train_multitask_model.py", line 396, in <module>
    run_trainer(cfg)
  File "/gscratch/krishna/mahtab/Umolmo/scripts/train.py", line 333, in run_trainer
    trainer.fit()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 1021, in fit
    for batch in self.train_loader:
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 733, in __next__
    data = self._next_data()
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 789, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 33, in fetch
    data.append(next(self.dataset_iter))
  File "/gscratch/krishna/mahtab/Umolmo/olmo/data/iterable_dataset_mixture.py", line 122, in __iter__
    yield dataset.get(int(shuffled_order[count % len(dataset)]), epoch)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/data/dataset.py", line 70, in get
    item = self.preprocessor(item, rng, **self.preprocessor_kwargs)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/model_preprocessor.py", line 394, in __call__
    messages, formatter_metadata = self.formater(example, self.is_training, self.for_inference, rng)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/data_formatter.py", line 645, in __call__
    else:
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/data_formatter.py", line 622, in _format_example
    messages = self.format_messages(messages)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/bdb.py", line 94, in trace_dispatch
    return self.dispatch_return(frame, arg)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/bdb.py", line 156, in dispatch_return
    if self.quitting: raise BdbQuit
bdb.BdbQuit
2025-07-16 14:26:23.811	g3084:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-16 14:26:23.880	g3084:0	train:54	INFO	Configuration:
2025-07-16 14:26:23.880	g3084:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=128, n_heads=2, n_kv_heads=None, head_dim=None, qkv_bias=False, clip_qkv=None, n_layers=1, mlp_ratio=4, mlp_hidden_size=None, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=10000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='default', layer_norm_with_affine=True, layer_norm_eps=None, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=True, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.1, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=None, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2-7B', tokenizer_dir=None), init_path=None, init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='openai', image_default_input_size=(336, 336), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1024, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=1, image_head_dim=64, image_mlp_dim=4096, image_mlp_activations='gelu', image_dropout_rate=0.0, image_num_pos=577, image_norm_eps=1e-05, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path=None, resize_mode='default', pad_value=0.0, normalize='openai'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-1,), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='resize', max_crops=1, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear', per_image_output_tokens=64), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'chart_qa': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=20, inf_evaluators=[InfDatasetEvaluatorConfig(label='chart_qa', data=DataLoaderConfig(dataset='chart_qa', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='relaxed_correctness,scifi_relaxed_correctness,em', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=16, console_log_interval=5, include_image=False)], inf_eval_interval=20, eval_on_last_step=True, eval_on_load=False, save_folder='debug_run', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint=None, allow_resume=True, max_duration=1000, global_train_batch_size=8, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=None, beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=5, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=1000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-16 14:26:24.227	g3084:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-16 14:26:26.220	g3084:0	root:123	INFO	Padding tokenizer with 416 tokens
2025-07-16 14:26:27.891	g3084:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-16 14:26:28.037	g3084:0	train:191	INFO	Total number of parameters: 58,006,016
2025-07-16 14:26:28.038	g3084:0	train:192	INFO	Number of non-embedding parameters: 38,525,440
2025-07-16 14:26:28.039	g3084:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 234
2025-07-16 14:26:28.039	g3084:0	train:196	INFO	Model:
2025-07-16 14:26:28.040	g3084:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0): FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=128, out_features=128, bias=True)
          (ff_out): Linear(in_features=256, out_features=128, bias=True)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): LayerNorm()
          (ff_norm): LayerNorm()
          (att_proj): Linear(in_features=128, out_features=384, bias=True)
          (ff_proj): Linear(in_features=128, out_features=512, bias=True)
        )
      )
    )
    (ln_f): FSDPLayerNorm()
    (emb_drop): Dropout(p=0.1, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=128, out_features=152192, bias=True)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=1024, out_features=1024, bias=True)
        (wk): Linear(in_features=1024, out_features=1024, bias=True)
        (wv): Linear(in_features=1024, out_features=1024, bias=True)
        (wo): Linear(in_features=1024, out_features=1024, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1024, out_features=256, bias=False)
        (w2): Linear(in_features=256, out_features=128, bias=False)
        (w3): Linear(in_features=1024, out_features=256, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1024, bias=False)
      (pre_ln): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0): FSDPResidualAttentionBlock(
            (attention): ViTMultiHeadDotProductAttention(
              (wq): Linear(in_features=1024, out_features=1024, bias=True)
              (wk): Linear(in_features=1024, out_features=1024, bias=True)
              (wv): Linear(in_features=1024, out_features=1024, bias=True)
              (wo): Linear(in_features=1024, out_features=1024, bias=True)
              (residual_dropout): Dropout(p=0.0, inplace=False)
            )
            (feed_forward): ViTMLP(
              (w1): Linear(in_features=1024, out_features=4096, bias=True)
              (act): GELUActivation()
              (w2): Linear(in_features=4096, out_features=1024, bias=True)
            )
            (attention_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (ffn_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=700, out_features=128, bias=False)
  (vision_decoder_head): Linear(in_features=128, out_features=700, bias=False)
)
2025-07-16 14:26:28.077	g3084:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-16 14:26:28.078	g3084:0	olmo.data.data_loader:197	INFO	Loading train dataset chart_qa/train
2025-07-16 14:26:28.078	g3084:0	root:437	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_human.json
2025-07-16 14:26:28.136	g3084:0	root:437	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/train/train_augmented.json
2025-07-16 14:26:28.277	g3084:0	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-16 14:26:28.278	g3084:0	olmo.data.data_loader:219	INFO	chart_qa: 100.00
2025-07-16 14:26:28.280	g3084:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=2304 images=1 pooled_patches_idx=158
2025-07-16 14:26:28.281	g3084:0	olmo.data.data_loader:100	INFO	Loading eval dataset: chart_qa/validation
2025-07-16 14:26:28.282	g3084:0	root:437	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_human.json
2025-07-16 14:26:28.309	g3084:0	root:437	INFO	Loading chartqa data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/chartqa/val/val_augmented.json
2025-07-16 14:26:28.344	g3084:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=1792 images=1 pooled_patches_idx=158
2025-07-16 14:26:31.035	g3084:0	train:332	INFO	Starting training...
2025-07-16 14:26:31.036	g3084:0	olmo.train.trainer:817	INFO	Pre-train system metrics
    System/Peak GPU Memory (MB)=370.5
2025-07-16 14:34:32.827	g3084:0	olmo.util:177	CRITICAL	Uncaught BdbQuit: 
Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/Umolmo/launch_scripts/train_multitask_model.py", line 396, in <module>
    run_trainer(cfg)
  File "/gscratch/krishna/mahtab/Umolmo/scripts/train.py", line 333, in run_trainer
    trainer.fit()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 1021, in fit
    for batch in self.train_loader:
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 733, in __next__
    data = self._next_data()
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 789, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 33, in fetch
    data.append(next(self.dataset_iter))
  File "/gscratch/krishna/mahtab/Umolmo/olmo/data/iterable_dataset_mixture.py", line 122, in __iter__
    yield dataset.get(int(shuffled_order[count % len(dataset)]), epoch)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/data/dataset.py", line 70, in get
    item = self.preprocessor(item, rng, **self.preprocessor_kwargs)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/model_preprocessor.py", line 394, in __call__
    messages, formatter_metadata = self.formater(example, self.is_training, self.for_inference, rng)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/data_formatter.py", line 646, in __call__
    return self._format_example(ex, ex, is_training, for_inference, rng)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/data_formatter.py", line 606, in _format_example
    if len(prefix) > 0 and len(messages[0]) > 0:
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/data_formatter.py", line 606, in _format_example
    if len(prefix) > 0 and len(messages[0]) > 0:
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/bdb.py", line 90, in trace_dispatch
    return self.dispatch_line(frame)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/bdb.py", line 115, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit
2025-07-16 14:35:04.415	g3084:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-16 14:35:04.488	g3084:0	train:54	INFO	Configuration:
2025-07-16 14:35:04.488	g3084:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=128, n_heads=2, n_kv_heads=None, head_dim=None, qkv_bias=False, clip_qkv=None, n_layers=1, mlp_ratio=4, mlp_hidden_size=None, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=10000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='default', layer_norm_with_affine=True, layer_norm_eps=None, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=True, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.1, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=None, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2-7B', tokenizer_dir=None), init_path=None, init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='openai', image_default_input_size=(336, 336), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1024, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=1, image_head_dim=64, image_mlp_dim=4096, image_mlp_activations='gelu', image_dropout_rate=0.0, image_num_pos=577, image_norm_eps=1e-05, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path=None, resize_mode='default', pad_value=0.0, normalize='openai'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-1,), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='resize', max_crops=1, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear', per_image_output_tokens=64), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'depth': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=20, inf_evaluators=[InfDatasetEvaluatorConfig(label='depth', data=DataLoaderConfig(dataset='depth', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=16, console_log_interval=5, include_image=False)], inf_eval_interval=20, eval_on_last_step=True, eval_on_load=False, save_folder='debug_run', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint=None, allow_resume=True, max_duration=1000, global_train_batch_size=8, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=None, beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=5, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=1000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-16 14:35:04.826	g3084:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-16 14:35:06.888	g3084:0	root:123	INFO	Padding tokenizer with 416 tokens
2025-07-16 14:35:08.651	g3084:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-16 14:35:08.794	g3084:0	train:191	INFO	Total number of parameters: 58,006,016
2025-07-16 14:35:08.795	g3084:0	train:192	INFO	Number of non-embedding parameters: 38,525,440
2025-07-16 14:35:08.796	g3084:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 234
2025-07-16 14:35:08.796	g3084:0	train:196	INFO	Model:
2025-07-16 14:35:08.796	g3084:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0): FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=128, out_features=128, bias=True)
          (ff_out): Linear(in_features=256, out_features=128, bias=True)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): LayerNorm()
          (ff_norm): LayerNorm()
          (att_proj): Linear(in_features=128, out_features=384, bias=True)
          (ff_proj): Linear(in_features=128, out_features=512, bias=True)
        )
      )
    )
    (ln_f): FSDPLayerNorm()
    (emb_drop): Dropout(p=0.1, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=128, out_features=152192, bias=True)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=1024, out_features=1024, bias=True)
        (wk): Linear(in_features=1024, out_features=1024, bias=True)
        (wv): Linear(in_features=1024, out_features=1024, bias=True)
        (wo): Linear(in_features=1024, out_features=1024, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1024, out_features=256, bias=False)
        (w2): Linear(in_features=256, out_features=128, bias=False)
        (w3): Linear(in_features=1024, out_features=256, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1024, bias=False)
      (pre_ln): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0): FSDPResidualAttentionBlock(
            (attention): ViTMultiHeadDotProductAttention(
              (wq): Linear(in_features=1024, out_features=1024, bias=True)
              (wk): Linear(in_features=1024, out_features=1024, bias=True)
              (wv): Linear(in_features=1024, out_features=1024, bias=True)
              (wo): Linear(in_features=1024, out_features=1024, bias=True)
              (residual_dropout): Dropout(p=0.0, inplace=False)
            )
            (feed_forward): ViTMLP(
              (w1): Linear(in_features=1024, out_features=4096, bias=True)
              (act): GELUActivation()
              (w2): Linear(in_features=4096, out_features=1024, bias=True)
            )
            (attention_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (ffn_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=700, out_features=128, bias=False)
  (vision_decoder_head): Linear(in_features=128, out_features=700, bias=False)
)
2025-07-16 14:35:08.818	g3084:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-16 14:35:08.819	g3084:0	olmo.data.data_loader:197	INFO	Loading train dataset depth/train
2025-07-16 14:35:08.819	g3084:0	olmo.util:177	CRITICAL	Uncaught NameError: name 'use_exp' is not defined
Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/Umolmo/launch_scripts/train_multitask_model.py", line 396, in <module>
    run_trainer(cfg)
  File "/gscratch/krishna/mahtab/Umolmo/scripts/train.py", line 205, in run_trainer
    train_loader = cfg.data.build_train_dataloader(cfg.model, cfg.global_train_batch_size, device)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/data/data_loader.py", line 198, in build_train_dataloader
    dataset = get_dataset_by_name(name, self.split)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/data/get_dataset.py", line 240, in get_dataset_by_name
    return Depth(split=split)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/data/mmseek_datasets.py", line 25, in __init__
    self.use_exp = use_exp
NameError: name 'use_exp' is not defined
2025-07-16 14:35:41.870	g3084:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-16 14:35:41.954	g3084:0	train:54	INFO	Configuration:
2025-07-16 14:35:41.955	g3084:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=128, n_heads=2, n_kv_heads=None, head_dim=None, qkv_bias=False, clip_qkv=None, n_layers=1, mlp_ratio=4, mlp_hidden_size=None, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=10000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='default', layer_norm_with_affine=True, layer_norm_eps=None, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=True, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.1, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=None, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2-7B', tokenizer_dir=None), init_path=None, init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='openai', image_default_input_size=(336, 336), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1024, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=1, image_head_dim=64, image_mlp_dim=4096, image_mlp_activations='gelu', image_dropout_rate=0.0, image_num_pos=577, image_norm_eps=1e-05, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path=None, resize_mode='default', pad_value=0.0, normalize='openai'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-1,), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='resize', max_crops=1, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear', per_image_output_tokens=64), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'depth': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=20, inf_evaluators=[InfDatasetEvaluatorConfig(label='depth', data=DataLoaderConfig(dataset='depth', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=16, console_log_interval=5, include_image=False)], inf_eval_interval=20, eval_on_last_step=True, eval_on_load=False, save_folder='debug_run', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint=None, allow_resume=True, max_duration=1000, global_train_batch_size=8, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=None, beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=5, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=1000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-16 14:35:42.318	g3084:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-16 14:35:44.615	g3084:0	root:123	INFO	Padding tokenizer with 416 tokens
2025-07-16 14:35:46.266	g3084:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-16 14:35:46.410	g3084:0	train:191	INFO	Total number of parameters: 58,006,016
2025-07-16 14:35:46.411	g3084:0	train:192	INFO	Number of non-embedding parameters: 38,525,440
2025-07-16 14:35:46.412	g3084:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 234
2025-07-16 14:35:46.412	g3084:0	train:196	INFO	Model:
2025-07-16 14:35:46.412	g3084:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0): FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=128, out_features=128, bias=True)
          (ff_out): Linear(in_features=256, out_features=128, bias=True)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): LayerNorm()
          (ff_norm): LayerNorm()
          (att_proj): Linear(in_features=128, out_features=384, bias=True)
          (ff_proj): Linear(in_features=128, out_features=512, bias=True)
        )
      )
    )
    (ln_f): FSDPLayerNorm()
    (emb_drop): Dropout(p=0.1, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=128, out_features=152192, bias=True)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=1024, out_features=1024, bias=True)
        (wk): Linear(in_features=1024, out_features=1024, bias=True)
        (wv): Linear(in_features=1024, out_features=1024, bias=True)
        (wo): Linear(in_features=1024, out_features=1024, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1024, out_features=256, bias=False)
        (w2): Linear(in_features=256, out_features=128, bias=False)
        (w3): Linear(in_features=1024, out_features=256, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1024, bias=False)
      (pre_ln): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0): FSDPResidualAttentionBlock(
            (attention): ViTMultiHeadDotProductAttention(
              (wq): Linear(in_features=1024, out_features=1024, bias=True)
              (wk): Linear(in_features=1024, out_features=1024, bias=True)
              (wv): Linear(in_features=1024, out_features=1024, bias=True)
              (wo): Linear(in_features=1024, out_features=1024, bias=True)
              (residual_dropout): Dropout(p=0.0, inplace=False)
            )
            (feed_forward): ViTMLP(
              (w1): Linear(in_features=1024, out_features=4096, bias=True)
              (act): GELUActivation()
              (w2): Linear(in_features=4096, out_features=1024, bias=True)
            )
            (attention_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (ffn_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=700, out_features=128, bias=False)
  (vision_decoder_head): Linear(in_features=128, out_features=700, bias=False)
)
2025-07-16 14:35:46.435	g3084:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-16 14:35:46.436	g3084:0	olmo.data.data_loader:197	INFO	Loading train dataset depth/train
2025-07-16 14:35:46.436	g3084:0	olmo.util:177	CRITICAL	Uncaught NameError: name 'parts' is not defined
Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/Umolmo/launch_scripts/train_multitask_model.py", line 396, in <module>
    run_trainer(cfg)
  File "/gscratch/krishna/mahtab/Umolmo/scripts/train.py", line 205, in run_trainer
    train_loader = cfg.data.build_train_dataloader(cfg.model, cfg.global_train_batch_size, device)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/data/data_loader.py", line 198, in build_train_dataloader
    dataset = get_dataset_by_name(name, self.split)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/data/get_dataset.py", line 240, in get_dataset_by_name
    return Depth(split=split)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/data/mmseek_datasets.py", line 25, in __init__
    super().__init__(split)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/data/dataset.py", line 79, in __init__
    self.data = self.load()[:self.sample]
  File "/gscratch/krishna/mahtab/Umolmo/olmo/data/mmseek_datasets.py", line 33, in load
    for part in parts:
NameError: name 'parts' is not defined. Did you mean: 'vars'?
2025-07-16 14:36:32.623	g3084:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-16 14:36:32.730	g3084:0	train:54	INFO	Configuration:
2025-07-16 14:36:32.730	g3084:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=128, n_heads=2, n_kv_heads=None, head_dim=None, qkv_bias=False, clip_qkv=None, n_layers=1, mlp_ratio=4, mlp_hidden_size=None, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=10000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='default', layer_norm_with_affine=True, layer_norm_eps=None, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=True, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.1, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=None, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2-7B', tokenizer_dir=None), init_path=None, init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='openai', image_default_input_size=(336, 336), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1024, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=1, image_head_dim=64, image_mlp_dim=4096, image_mlp_activations='gelu', image_dropout_rate=0.0, image_num_pos=577, image_norm_eps=1e-05, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path=None, resize_mode='default', pad_value=0.0, normalize='openai'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-1,), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='resize', max_crops=1, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear', per_image_output_tokens=64), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'depth': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=20, inf_evaluators=[InfDatasetEvaluatorConfig(label='depth', data=DataLoaderConfig(dataset='depth', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=16, console_log_interval=5, include_image=False)], inf_eval_interval=20, eval_on_last_step=True, eval_on_load=False, save_folder='debug_run', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint=None, allow_resume=True, max_duration=1000, global_train_batch_size=8, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=None, beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=5, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=1000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-16 14:36:33.065	g3084:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-16 14:36:35.171	g3084:0	root:123	INFO	Padding tokenizer with 416 tokens
2025-07-16 14:36:36.879	g3084:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-16 14:36:37.022	g3084:0	train:191	INFO	Total number of parameters: 58,006,016
2025-07-16 14:36:37.022	g3084:0	train:192	INFO	Number of non-embedding parameters: 38,525,440
2025-07-16 14:36:37.023	g3084:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 234
2025-07-16 14:36:37.024	g3084:0	train:196	INFO	Model:
2025-07-16 14:36:37.024	g3084:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0): FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=128, out_features=128, bias=True)
          (ff_out): Linear(in_features=256, out_features=128, bias=True)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): LayerNorm()
          (ff_norm): LayerNorm()
          (att_proj): Linear(in_features=128, out_features=384, bias=True)
          (ff_proj): Linear(in_features=128, out_features=512, bias=True)
        )
      )
    )
    (ln_f): FSDPLayerNorm()
    (emb_drop): Dropout(p=0.1, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=128, out_features=152192, bias=True)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=1024, out_features=1024, bias=True)
        (wk): Linear(in_features=1024, out_features=1024, bias=True)
        (wv): Linear(in_features=1024, out_features=1024, bias=True)
        (wo): Linear(in_features=1024, out_features=1024, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1024, out_features=256, bias=False)
        (w2): Linear(in_features=256, out_features=128, bias=False)
        (w3): Linear(in_features=1024, out_features=256, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1024, bias=False)
      (pre_ln): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0): FSDPResidualAttentionBlock(
            (attention): ViTMultiHeadDotProductAttention(
              (wq): Linear(in_features=1024, out_features=1024, bias=True)
              (wk): Linear(in_features=1024, out_features=1024, bias=True)
              (wv): Linear(in_features=1024, out_features=1024, bias=True)
              (wo): Linear(in_features=1024, out_features=1024, bias=True)
              (residual_dropout): Dropout(p=0.0, inplace=False)
            )
            (feed_forward): ViTMLP(
              (w1): Linear(in_features=1024, out_features=4096, bias=True)
              (act): GELUActivation()
              (w2): Linear(in_features=4096, out_features=1024, bias=True)
            )
            (attention_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (ffn_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=700, out_features=128, bias=False)
  (vision_decoder_head): Linear(in_features=128, out_features=700, bias=False)
)
2025-07-16 14:36:37.077	g3084:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-16 14:36:37.077	g3084:0	olmo.data.data_loader:197	INFO	Loading train dataset depth/train
2025-07-16 14:36:37.078	g3084:0	olmo.util:177	CRITICAL	Uncaught NameError: name 'CHARTQA_SOURCE' is not defined
Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/Umolmo/launch_scripts/train_multitask_model.py", line 396, in <module>
    run_trainer(cfg)
  File "/gscratch/krishna/mahtab/Umolmo/scripts/train.py", line 205, in run_trainer
    train_loader = cfg.data.build_train_dataloader(cfg.model, cfg.global_train_batch_size, device)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/data/data_loader.py", line 198, in build_train_dataloader
    dataset = get_dataset_by_name(name, self.split)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/data/get_dataset.py", line 240, in get_dataset_by_name
    return Depth(split=split)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/data/mmseek_datasets.py", line 25, in __init__
    super().__init__(split)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/data/dataset.py", line 79, in __init__
    self.data = self.load()[:self.sample]
  File "/gscratch/krishna/mahtab/Umolmo/olmo/data/mmseek_datasets.py", line 33, in load
    src = f"{CHARTQA_SOURCE}/{DEPTH_SOURCE}/{split}.json"
NameError: name 'CHARTQA_SOURCE' is not defined
2025-07-16 14:37:18.182	g3084:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-16 14:37:18.269	g3084:0	train:54	INFO	Configuration:
2025-07-16 14:37:18.269	g3084:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=128, n_heads=2, n_kv_heads=None, head_dim=None, qkv_bias=False, clip_qkv=None, n_layers=1, mlp_ratio=4, mlp_hidden_size=None, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=10000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='default', layer_norm_with_affine=True, layer_norm_eps=None, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=True, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.1, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=None, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2-7B', tokenizer_dir=None), init_path=None, init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='openai', image_default_input_size=(336, 336), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1024, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=1, image_head_dim=64, image_mlp_dim=4096, image_mlp_activations='gelu', image_dropout_rate=0.0, image_num_pos=577, image_norm_eps=1e-05, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path=None, resize_mode='default', pad_value=0.0, normalize='openai'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-1,), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='resize', max_crops=1, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear', per_image_output_tokens=64), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'depth': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=20, inf_evaluators=[InfDatasetEvaluatorConfig(label='depth', data=DataLoaderConfig(dataset='depth', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=16, console_log_interval=5, include_image=False)], inf_eval_interval=20, eval_on_last_step=True, eval_on_load=False, save_folder='debug_run', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint=None, allow_resume=True, max_duration=1000, global_train_batch_size=8, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=None, beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=5, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=1000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-16 14:37:18.588	g3084:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-16 14:37:20.579	g3084:0	root:123	INFO	Padding tokenizer with 416 tokens
2025-07-16 14:37:22.230	g3084:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-16 14:37:22.373	g3084:0	train:191	INFO	Total number of parameters: 58,006,016
2025-07-16 14:37:22.374	g3084:0	train:192	INFO	Number of non-embedding parameters: 38,525,440
2025-07-16 14:37:22.375	g3084:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 234
2025-07-16 14:37:22.375	g3084:0	train:196	INFO	Model:
2025-07-16 14:37:22.376	g3084:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0): FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=128, out_features=128, bias=True)
          (ff_out): Linear(in_features=256, out_features=128, bias=True)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): LayerNorm()
          (ff_norm): LayerNorm()
          (att_proj): Linear(in_features=128, out_features=384, bias=True)
          (ff_proj): Linear(in_features=128, out_features=512, bias=True)
        )
      )
    )
    (ln_f): FSDPLayerNorm()
    (emb_drop): Dropout(p=0.1, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=128, out_features=152192, bias=True)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=1024, out_features=1024, bias=True)
        (wk): Linear(in_features=1024, out_features=1024, bias=True)
        (wv): Linear(in_features=1024, out_features=1024, bias=True)
        (wo): Linear(in_features=1024, out_features=1024, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1024, out_features=256, bias=False)
        (w2): Linear(in_features=256, out_features=128, bias=False)
        (w3): Linear(in_features=1024, out_features=256, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1024, bias=False)
      (pre_ln): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0): FSDPResidualAttentionBlock(
            (attention): ViTMultiHeadDotProductAttention(
              (wq): Linear(in_features=1024, out_features=1024, bias=True)
              (wk): Linear(in_features=1024, out_features=1024, bias=True)
              (wv): Linear(in_features=1024, out_features=1024, bias=True)
              (wo): Linear(in_features=1024, out_features=1024, bias=True)
              (residual_dropout): Dropout(p=0.0, inplace=False)
            )
            (feed_forward): ViTMLP(
              (w1): Linear(in_features=1024, out_features=4096, bias=True)
              (act): GELUActivation()
              (w2): Linear(in_features=4096, out_features=1024, bias=True)
            )
            (attention_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (ffn_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=700, out_features=128, bias=False)
  (vision_decoder_head): Linear(in_features=128, out_features=700, bias=False)
)
2025-07-16 14:37:22.402	g3084:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-16 14:37:22.402	g3084:0	olmo.data.data_loader:197	INFO	Loading train dataset depth/train
2025-07-16 14:37:22.402	g3084:0	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/train/train.json
2025-07-16 14:37:22.454	g3084:0	olmo.util:177	CRITICAL	Uncaught KeyError: 'label'
Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/Umolmo/launch_scripts/train_multitask_model.py", line 396, in <module>
    run_trainer(cfg)
  File "/gscratch/krishna/mahtab/Umolmo/scripts/train.py", line 205, in run_trainer
    train_loader = cfg.data.build_train_dataloader(cfg.model, cfg.global_train_batch_size, device)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/data/data_loader.py", line 198, in build_train_dataloader
    dataset = get_dataset_by_name(name, self.split)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/data/get_dataset.py", line 240, in get_dataset_by_name
    return Depth(split=split)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/data/mmseek_datasets.py", line 25, in __init__
    super().__init__(split)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/data/dataset.py", line 79, in __init__
    self.data = self.load()[:self.sample]
  File "/gscratch/krishna/mahtab/Umolmo/olmo/data/mmseek_datasets.py", line 41, in load
    answers=ex["label"],
KeyError: 'label'
2025-07-16 14:37:59.683	g3084:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-16 14:37:59.779	g3084:0	train:54	INFO	Configuration:
2025-07-16 14:37:59.779	g3084:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=128, n_heads=2, n_kv_heads=None, head_dim=None, qkv_bias=False, clip_qkv=None, n_layers=1, mlp_ratio=4, mlp_hidden_size=None, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=10000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='default', layer_norm_with_affine=True, layer_norm_eps=None, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=True, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.1, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=None, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2-7B', tokenizer_dir=None), init_path=None, init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='openai', image_default_input_size=(336, 336), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1024, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=1, image_head_dim=64, image_mlp_dim=4096, image_mlp_activations='gelu', image_dropout_rate=0.0, image_num_pos=577, image_norm_eps=1e-05, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path=None, resize_mode='default', pad_value=0.0, normalize='openai'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-1,), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='resize', max_crops=1, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear', per_image_output_tokens=64), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'depth': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=20, inf_evaluators=[InfDatasetEvaluatorConfig(label='depth', data=DataLoaderConfig(dataset='depth', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=16, console_log_interval=5, include_image=False)], inf_eval_interval=20, eval_on_last_step=True, eval_on_load=False, save_folder='debug_run', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint=None, allow_resume=True, max_duration=1000, global_train_batch_size=8, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=None, beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=5, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=1000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-16 14:38:00.118	g3084:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-16 14:38:02.137	g3084:0	root:123	INFO	Padding tokenizer with 416 tokens
2025-07-16 14:38:03.770	g3084:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-16 14:38:03.914	g3084:0	train:191	INFO	Total number of parameters: 58,006,016
2025-07-16 14:38:03.915	g3084:0	train:192	INFO	Number of non-embedding parameters: 38,525,440
2025-07-16 14:38:03.915	g3084:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 234
2025-07-16 14:38:03.916	g3084:0	train:196	INFO	Model:
2025-07-16 14:38:03.916	g3084:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0): FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=128, out_features=128, bias=True)
          (ff_out): Linear(in_features=256, out_features=128, bias=True)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): LayerNorm()
          (ff_norm): LayerNorm()
          (att_proj): Linear(in_features=128, out_features=384, bias=True)
          (ff_proj): Linear(in_features=128, out_features=512, bias=True)
        )
      )
    )
    (ln_f): FSDPLayerNorm()
    (emb_drop): Dropout(p=0.1, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=128, out_features=152192, bias=True)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=1024, out_features=1024, bias=True)
        (wk): Linear(in_features=1024, out_features=1024, bias=True)
        (wv): Linear(in_features=1024, out_features=1024, bias=True)
        (wo): Linear(in_features=1024, out_features=1024, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1024, out_features=256, bias=False)
        (w2): Linear(in_features=256, out_features=128, bias=False)
        (w3): Linear(in_features=1024, out_features=256, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1024, bias=False)
      (pre_ln): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0): FSDPResidualAttentionBlock(
            (attention): ViTMultiHeadDotProductAttention(
              (wq): Linear(in_features=1024, out_features=1024, bias=True)
              (wk): Linear(in_features=1024, out_features=1024, bias=True)
              (wv): Linear(in_features=1024, out_features=1024, bias=True)
              (wo): Linear(in_features=1024, out_features=1024, bias=True)
              (residual_dropout): Dropout(p=0.0, inplace=False)
            )
            (feed_forward): ViTMLP(
              (w1): Linear(in_features=1024, out_features=4096, bias=True)
              (act): GELUActivation()
              (w2): Linear(in_features=4096, out_features=1024, bias=True)
            )
            (attention_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (ffn_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=700, out_features=128, bias=False)
  (vision_decoder_head): Linear(in_features=128, out_features=700, bias=False)
)
2025-07-16 14:38:03.943	g3084:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-16 14:38:03.944	g3084:0	olmo.data.data_loader:197	INFO	Loading train dataset depth/train
2025-07-16 14:38:03.944	g3084:0	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/train/train.json
2025-07-16 14:38:03.993	g3084:0	olmo.util:177	CRITICAL	Uncaught KeyError: 'image_output_paths'
Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/Umolmo/launch_scripts/train_multitask_model.py", line 396, in <module>
    run_trainer(cfg)
  File "/gscratch/krishna/mahtab/Umolmo/scripts/train.py", line 205, in run_trainer
    train_loader = cfg.data.build_train_dataloader(cfg.model, cfg.global_train_batch_size, device)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/data/data_loader.py", line 198, in build_train_dataloader
    dataset = get_dataset_by_name(name, self.split)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/data/get_dataset.py", line 240, in get_dataset_by_name
    return Depth(split=split)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/data/mmseek_datasets.py", line 25, in __init__
    super().__init__(split)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/data/dataset.py", line 79, in __init__
    self.data = self.load()[:self.sample]
  File "/gscratch/krishna/mahtab/Umolmo/olmo/data/mmseek_datasets.py", line 42, in load
    image_outputs = ex['image_output_paths'],
KeyError: 'image_output_paths'
2025-07-16 14:39:35.212	g3084:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-16 14:39:35.295	g3084:0	train:54	INFO	Configuration:
2025-07-16 14:39:35.295	g3084:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=128, n_heads=2, n_kv_heads=None, head_dim=None, qkv_bias=False, clip_qkv=None, n_layers=1, mlp_ratio=4, mlp_hidden_size=None, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=10000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='default', layer_norm_with_affine=True, layer_norm_eps=None, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=True, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.1, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=None, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2-7B', tokenizer_dir=None), init_path=None, init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='openai', image_default_input_size=(336, 336), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1024, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=1, image_head_dim=64, image_mlp_dim=4096, image_mlp_activations='gelu', image_dropout_rate=0.0, image_num_pos=577, image_norm_eps=1e-05, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path=None, resize_mode='default', pad_value=0.0, normalize='openai'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-1,), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='resize', max_crops=1, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear', per_image_output_tokens=64), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'depth': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=20, inf_evaluators=[InfDatasetEvaluatorConfig(label='depth', data=DataLoaderConfig(dataset='depth', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=16, console_log_interval=5, include_image=False)], inf_eval_interval=20, eval_on_last_step=True, eval_on_load=False, save_folder='debug_run', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint=None, allow_resume=True, max_duration=1000, global_train_batch_size=8, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=None, beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=5, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=1000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-16 14:39:35.601	g3084:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-16 14:39:37.590	g3084:0	root:123	INFO	Padding tokenizer with 416 tokens
2025-07-16 14:39:39.223	g3084:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-16 14:39:40.737	g3084:0	train:191	INFO	Total number of parameters: 58,006,016
2025-07-16 14:39:40.737	g3084:0	train:192	INFO	Number of non-embedding parameters: 38,525,440
2025-07-16 14:39:40.738	g3084:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 234
2025-07-16 14:39:40.739	g3084:0	train:196	INFO	Model:
2025-07-16 14:39:40.739	g3084:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0): FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=128, out_features=128, bias=True)
          (ff_out): Linear(in_features=256, out_features=128, bias=True)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): LayerNorm()
          (ff_norm): LayerNorm()
          (att_proj): Linear(in_features=128, out_features=384, bias=True)
          (ff_proj): Linear(in_features=128, out_features=512, bias=True)
        )
      )
    )
    (ln_f): FSDPLayerNorm()
    (emb_drop): Dropout(p=0.1, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=128, out_features=152192, bias=True)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=1024, out_features=1024, bias=True)
        (wk): Linear(in_features=1024, out_features=1024, bias=True)
        (wv): Linear(in_features=1024, out_features=1024, bias=True)
        (wo): Linear(in_features=1024, out_features=1024, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1024, out_features=256, bias=False)
        (w2): Linear(in_features=256, out_features=128, bias=False)
        (w3): Linear(in_features=1024, out_features=256, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1024, bias=False)
      (pre_ln): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0): FSDPResidualAttentionBlock(
            (attention): ViTMultiHeadDotProductAttention(
              (wq): Linear(in_features=1024, out_features=1024, bias=True)
              (wk): Linear(in_features=1024, out_features=1024, bias=True)
              (wv): Linear(in_features=1024, out_features=1024, bias=True)
              (wo): Linear(in_features=1024, out_features=1024, bias=True)
              (residual_dropout): Dropout(p=0.0, inplace=False)
            )
            (feed_forward): ViTMLP(
              (w1): Linear(in_features=1024, out_features=4096, bias=True)
              (act): GELUActivation()
              (w2): Linear(in_features=4096, out_features=1024, bias=True)
            )
            (attention_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (ffn_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=700, out_features=128, bias=False)
  (vision_decoder_head): Linear(in_features=128, out_features=700, bias=False)
)
2025-07-16 14:39:40.760	g3084:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-16 14:39:40.760	g3084:0	olmo.data.data_loader:197	INFO	Loading train dataset depth/train
2025-07-16 14:39:40.761	g3084:0	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/train/train.json
2025-07-16 14:39:40.835	g3084:0	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-16 14:39:40.835	g3084:0	olmo.data.data_loader:219	INFO	depth: 100.00
2025-07-16 14:39:40.837	g3084:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=2304 images=1 pooled_patches_idx=158
2025-07-16 14:39:40.838	g3084:0	olmo.data.data_loader:100	INFO	Loading eval dataset: depth/validation
2025-07-16 14:39:40.838	g3084:0	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/val/val.json
2025-07-16 14:39:40.868	g3084:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=1792 images=1 pooled_patches_idx=158
2025-07-16 14:39:41.424	g3084:0	train:332	INFO	Starting training...
2025-07-16 14:39:41.425	g3084:0	olmo.train.trainer:817	INFO	Pre-train system metrics
    System/Peak GPU Memory (MB)=370.5
2025-07-16 14:43:10.079	g3084:0	olmo.util:177	CRITICAL	Uncaught BdbQuit: 
Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/Umolmo/launch_scripts/train_multitask_model.py", line 396, in <module>
    run_trainer(cfg)
  File "/gscratch/krishna/mahtab/Umolmo/scripts/train.py", line 333, in run_trainer
    trainer.fit()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 1021, in fit
    for batch in self.train_loader:
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 733, in __next__
    data = self._next_data()
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 789, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 33, in fetch
    data.append(next(self.dataset_iter))
  File "/gscratch/krishna/mahtab/Umolmo/olmo/data/iterable_dataset_mixture.py", line 122, in __iter__
    yield dataset.get(int(shuffled_order[count % len(dataset)]), epoch)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/data/dataset.py", line 70, in get
    item = self.preprocessor(item, rng, **self.preprocessor_kwargs)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/model_preprocessor.py", line 394, in __call__
    messages, formatter_metadata = self.formater(example, self.is_training, self.for_inference, rng)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/data_formatter.py", line 646, in __call__
    return self._format_example(ex, ex, is_training, for_inference, rng)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/data_formatter.py", line 606, in _format_example
    if len(prefix) > 0 and len(messages[0]) > 0:
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/data_formatter.py", line 606, in _format_example
    if len(prefix) > 0 and len(messages[0]) > 0:
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/bdb.py", line 90, in trace_dispatch
    return self.dispatch_line(frame)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/bdb.py", line 115, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit
2025-07-16 14:43:39.039	g3084:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-16 14:43:39.110	g3084:0	train:54	INFO	Configuration:
2025-07-16 14:43:39.111	g3084:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=128, n_heads=2, n_kv_heads=None, head_dim=None, qkv_bias=False, clip_qkv=None, n_layers=1, mlp_ratio=4, mlp_hidden_size=None, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=10000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='default', layer_norm_with_affine=True, layer_norm_eps=None, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=True, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.1, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=None, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2-7B', tokenizer_dir=None), init_path=None, init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='openai', image_default_input_size=(336, 336), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1024, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=1, image_head_dim=64, image_mlp_dim=4096, image_mlp_activations='gelu', image_dropout_rate=0.0, image_num_pos=577, image_norm_eps=1e-05, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path=None, resize_mode='default', pad_value=0.0, normalize='openai'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-1,), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='resize', max_crops=1, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear', per_image_output_tokens=64), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'depth': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=20, inf_evaluators=[InfDatasetEvaluatorConfig(label='depth', data=DataLoaderConfig(dataset='depth', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=16, console_log_interval=5, include_image=False)], inf_eval_interval=20, eval_on_last_step=True, eval_on_load=False, save_folder='debug_run', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint=None, allow_resume=True, max_duration=1000, global_train_batch_size=8, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=None, beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=5, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=1000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-16 14:43:39.463	g3084:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-16 14:43:41.896	g3084:0	root:123	INFO	Padding tokenizer with 416 tokens
2025-07-16 14:43:43.779	g3084:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-16 14:43:43.931	g3084:0	train:191	INFO	Total number of parameters: 58,006,016
2025-07-16 14:43:43.932	g3084:0	train:192	INFO	Number of non-embedding parameters: 38,525,440
2025-07-16 14:43:43.933	g3084:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 234
2025-07-16 14:43:43.933	g3084:0	train:196	INFO	Model:
2025-07-16 14:43:43.933	g3084:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0): FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=128, out_features=128, bias=True)
          (ff_out): Linear(in_features=256, out_features=128, bias=True)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): LayerNorm()
          (ff_norm): LayerNorm()
          (att_proj): Linear(in_features=128, out_features=384, bias=True)
          (ff_proj): Linear(in_features=128, out_features=512, bias=True)
        )
      )
    )
    (ln_f): FSDPLayerNorm()
    (emb_drop): Dropout(p=0.1, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=128, out_features=152192, bias=True)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=1024, out_features=1024, bias=True)
        (wk): Linear(in_features=1024, out_features=1024, bias=True)
        (wv): Linear(in_features=1024, out_features=1024, bias=True)
        (wo): Linear(in_features=1024, out_features=1024, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1024, out_features=256, bias=False)
        (w2): Linear(in_features=256, out_features=128, bias=False)
        (w3): Linear(in_features=1024, out_features=256, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1024, bias=False)
      (pre_ln): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0): FSDPResidualAttentionBlock(
            (attention): ViTMultiHeadDotProductAttention(
              (wq): Linear(in_features=1024, out_features=1024, bias=True)
              (wk): Linear(in_features=1024, out_features=1024, bias=True)
              (wv): Linear(in_features=1024, out_features=1024, bias=True)
              (wo): Linear(in_features=1024, out_features=1024, bias=True)
              (residual_dropout): Dropout(p=0.0, inplace=False)
            )
            (feed_forward): ViTMLP(
              (w1): Linear(in_features=1024, out_features=4096, bias=True)
              (act): GELUActivation()
              (w2): Linear(in_features=4096, out_features=1024, bias=True)
            )
            (attention_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (ffn_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=700, out_features=128, bias=False)
  (vision_decoder_head): Linear(in_features=128, out_features=700, bias=False)
)
2025-07-16 14:43:43.943	g3084:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-16 14:43:43.944	g3084:0	olmo.data.data_loader:197	INFO	Loading train dataset depth/train
2025-07-16 14:43:43.944	g3084:0	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/train/train.json
2025-07-16 14:43:44.022	g3084:0	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-16 14:43:44.022	g3084:0	olmo.data.data_loader:219	INFO	depth: 100.00
2025-07-16 14:43:44.024	g3084:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=2304 images=1 pooled_patches_idx=158
2025-07-16 14:43:44.025	g3084:0	olmo.data.data_loader:100	INFO	Loading eval dataset: depth/validation
2025-07-16 14:43:44.025	g3084:0	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/val/val.json
2025-07-16 14:43:44.027	g3084:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=1792 images=1 pooled_patches_idx=158
2025-07-16 14:43:44.267	g3084:0	train:332	INFO	Starting training...
2025-07-16 14:43:44.268	g3084:0	olmo.train.trainer:817	INFO	Pre-train system metrics
    System/Peak GPU Memory (MB)=370.5
2025-07-16 14:45:09.331	g3084:0	olmo.util:177	CRITICAL	Uncaught BdbQuit: 
Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/Umolmo/launch_scripts/train_multitask_model.py", line 396, in <module>
    run_trainer(cfg)
  File "/gscratch/krishna/mahtab/Umolmo/scripts/train.py", line 333, in run_trainer
    trainer.fit()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 1021, in fit
    for batch in self.train_loader:
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 733, in __next__
    data = self._next_data()
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/utils/data/dataloader.py", line 789, in _next_data
    data = self._dataset_fetcher.fetch(index)  # may raise StopIteration
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/utils/data/_utils/fetch.py", line 33, in fetch
    data.append(next(self.dataset_iter))
  File "/gscratch/krishna/mahtab/Umolmo/olmo/data/iterable_dataset_mixture.py", line 122, in __iter__
    yield dataset.get(int(shuffled_order[count % len(dataset)]), epoch)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/data/dataset.py", line 70, in get
    item = self.preprocessor(item, rng, **self.preprocessor_kwargs)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/model_preprocessor.py", line 394, in __call__
    messages, formatter_metadata = self.formater(example, self.is_training, self.for_inference, rng)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/data_formatter.py", line 646, in __call__
    return self._format_example(ex, ex, is_training, for_inference, rng)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/data_formatter.py", line 623, in _format_example
    return messages, metadata
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/data_formatter.py", line 623, in _format_example
    return messages, metadata
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/bdb.py", line 90, in trace_dispatch
    return self.dispatch_line(frame)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/bdb.py", line 115, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit
2025-07-16 14:46:50.546	g3084:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-16 14:46:50.665	g3084:0	train:54	INFO	Configuration:
2025-07-16 14:46:50.666	g3084:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=128, n_heads=2, n_kv_heads=None, head_dim=None, qkv_bias=False, clip_qkv=None, n_layers=1, mlp_ratio=4, mlp_hidden_size=None, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=10000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='default', layer_norm_with_affine=True, layer_norm_eps=None, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=True, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.1, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=None, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2-7B', tokenizer_dir=None), init_path=None, init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='openai', image_default_input_size=(336, 336), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1024, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=1, image_head_dim=64, image_mlp_dim=4096, image_mlp_activations='gelu', image_dropout_rate=0.0, image_num_pos=577, image_norm_eps=1e-05, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path=None, resize_mode='default', pad_value=0.0, normalize='openai'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-1,), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='resize', max_crops=1, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear', per_image_output_tokens=64), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'depth': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=20, inf_evaluators=[InfDatasetEvaluatorConfig(label='depth', data=DataLoaderConfig(dataset='depth', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=16, console_log_interval=5, include_image=False)], inf_eval_interval=20, eval_on_last_step=True, eval_on_load=False, save_folder='debug_run', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint=None, allow_resume=True, max_duration=1000, global_train_batch_size=8, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=None, beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=5, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=1000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-16 14:46:51.042	g3084:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-16 14:46:53.497	g3084:0	root:123	INFO	Padding tokenizer with 416 tokens
2025-07-16 14:46:55.886	g3084:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-16 14:46:56.098	g3084:0	train:191	INFO	Total number of parameters: 58,006,016
2025-07-16 14:46:56.099	g3084:0	train:192	INFO	Number of non-embedding parameters: 38,525,440
2025-07-16 14:46:56.100	g3084:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 234
2025-07-16 14:46:56.100	g3084:0	train:196	INFO	Model:
2025-07-16 14:46:56.101	g3084:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0): FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=128, out_features=128, bias=True)
          (ff_out): Linear(in_features=256, out_features=128, bias=True)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): LayerNorm()
          (ff_norm): LayerNorm()
          (att_proj): Linear(in_features=128, out_features=384, bias=True)
          (ff_proj): Linear(in_features=128, out_features=512, bias=True)
        )
      )
    )
    (ln_f): FSDPLayerNorm()
    (emb_drop): Dropout(p=0.1, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=128, out_features=152192, bias=True)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=1024, out_features=1024, bias=True)
        (wk): Linear(in_features=1024, out_features=1024, bias=True)
        (wv): Linear(in_features=1024, out_features=1024, bias=True)
        (wo): Linear(in_features=1024, out_features=1024, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1024, out_features=256, bias=False)
        (w2): Linear(in_features=256, out_features=128, bias=False)
        (w3): Linear(in_features=1024, out_features=256, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1024, bias=False)
      (pre_ln): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0): FSDPResidualAttentionBlock(
            (attention): ViTMultiHeadDotProductAttention(
              (wq): Linear(in_features=1024, out_features=1024, bias=True)
              (wk): Linear(in_features=1024, out_features=1024, bias=True)
              (wv): Linear(in_features=1024, out_features=1024, bias=True)
              (wo): Linear(in_features=1024, out_features=1024, bias=True)
              (residual_dropout): Dropout(p=0.0, inplace=False)
            )
            (feed_forward): ViTMLP(
              (w1): Linear(in_features=1024, out_features=4096, bias=True)
              (act): GELUActivation()
              (w2): Linear(in_features=4096, out_features=1024, bias=True)
            )
            (attention_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (ffn_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=700, out_features=128, bias=False)
  (vision_decoder_head): Linear(in_features=128, out_features=700, bias=False)
)
2025-07-16 14:46:56.111	g3084:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-16 14:46:56.112	g3084:0	olmo.data.data_loader:197	INFO	Loading train dataset depth/train
2025-07-16 14:46:56.113	g3084:0	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/train/train.json
2025-07-16 14:46:56.176	g3084:0	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-16 14:46:56.176	g3084:0	olmo.data.data_loader:219	INFO	depth: 100.00
2025-07-16 14:46:56.178	g3084:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=2304 images=1 pooled_patches_idx=158
2025-07-16 14:46:56.179	g3084:0	olmo.data.data_loader:100	INFO	Loading eval dataset: depth/validation
2025-07-16 14:46:56.179	g3084:0	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/val/val.json
2025-07-16 14:46:56.181	g3084:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=1792 images=1 pooled_patches_idx=158
2025-07-16 14:46:56.430	g3084:0	train:332	INFO	Starting training...
2025-07-16 14:46:56.431	g3084:0	olmo.train.trainer:817	INFO	Pre-train system metrics
    System/Peak GPU Memory (MB)=370.5
2025-07-16 14:48:23.069	g3084:0	olmo.util:177	CRITICAL	Uncaught BdbQuit: 
Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/Umolmo/launch_scripts/train_multitask_model.py", line 396, in <module>
    run_trainer(cfg)
  File "/gscratch/krishna/mahtab/Umolmo/scripts/train.py", line 333, in run_trainer
    trainer.fit()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 1045, in fit
    metrics = self.train_step(batch, compute_metrics=should_log_this_step)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 709, in train_step
    loss = self.train_batch(batch, True)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 658, in train_batch
    ce_loss, z_loss, image_gen_loss, model_out = self.model_forward(
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 590, in model_forward
    model_out = self.fsdp_model(
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1857, in _call_impl
    return inner()
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1805, in inner
    result = forward_call(*args, **kwargs)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py", line 405, in forward
    output_hidden_states = output_hidden_states if output_hidden_states is not None else False
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py", line 405, in forward
    output_hidden_states = output_hidden_states if output_hidden_states is not None else False
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/bdb.py", line 90, in trace_dispatch
    return self.dispatch_line(frame)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/bdb.py", line 115, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit
2025-07-16 14:48:47.125	g3084:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-16 14:48:47.199	g3084:0	train:54	INFO	Configuration:
2025-07-16 14:48:47.220	g3084:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=128, n_heads=2, n_kv_heads=None, head_dim=None, qkv_bias=False, clip_qkv=None, n_layers=1, mlp_ratio=4, mlp_hidden_size=None, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=10000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='default', layer_norm_with_affine=True, layer_norm_eps=None, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=True, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.1, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=None, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2-7B', tokenizer_dir=None), init_path=None, init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='openai', image_default_input_size=(336, 336), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1024, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=1, image_head_dim=64, image_mlp_dim=4096, image_mlp_activations='gelu', image_dropout_rate=0.0, image_num_pos=577, image_norm_eps=1e-05, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path=None, resize_mode='default', pad_value=0.0, normalize='openai'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-1,), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='resize', max_crops=1, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear', per_image_output_tokens=64), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'depth': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=20, inf_evaluators=[InfDatasetEvaluatorConfig(label='depth', data=DataLoaderConfig(dataset='depth', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=16, console_log_interval=5, include_image=False)], inf_eval_interval=20, eval_on_last_step=True, eval_on_load=False, save_folder='debug_run', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint=None, allow_resume=True, max_duration=1000, global_train_batch_size=8, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=None, beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=5, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=1000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-16 14:48:47.604	g3084:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-16 14:48:49.938	g3084:0	root:123	INFO	Padding tokenizer with 416 tokens
2025-07-16 14:48:51.802	g3084:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-16 14:48:51.953	g3084:0	train:191	INFO	Total number of parameters: 58,006,016
2025-07-16 14:48:51.954	g3084:0	train:192	INFO	Number of non-embedding parameters: 38,525,440
2025-07-16 14:48:51.955	g3084:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 234
2025-07-16 14:48:51.955	g3084:0	train:196	INFO	Model:
2025-07-16 14:48:51.955	g3084:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0): FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=128, out_features=128, bias=True)
          (ff_out): Linear(in_features=256, out_features=128, bias=True)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): LayerNorm()
          (ff_norm): LayerNorm()
          (att_proj): Linear(in_features=128, out_features=384, bias=True)
          (ff_proj): Linear(in_features=128, out_features=512, bias=True)
        )
      )
    )
    (ln_f): FSDPLayerNorm()
    (emb_drop): Dropout(p=0.1, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=128, out_features=152192, bias=True)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=1024, out_features=1024, bias=True)
        (wk): Linear(in_features=1024, out_features=1024, bias=True)
        (wv): Linear(in_features=1024, out_features=1024, bias=True)
        (wo): Linear(in_features=1024, out_features=1024, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1024, out_features=256, bias=False)
        (w2): Linear(in_features=256, out_features=128, bias=False)
        (w3): Linear(in_features=1024, out_features=256, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1024, bias=False)
      (pre_ln): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0): FSDPResidualAttentionBlock(
            (attention): ViTMultiHeadDotProductAttention(
              (wq): Linear(in_features=1024, out_features=1024, bias=True)
              (wk): Linear(in_features=1024, out_features=1024, bias=True)
              (wv): Linear(in_features=1024, out_features=1024, bias=True)
              (wo): Linear(in_features=1024, out_features=1024, bias=True)
              (residual_dropout): Dropout(p=0.0, inplace=False)
            )
            (feed_forward): ViTMLP(
              (w1): Linear(in_features=1024, out_features=4096, bias=True)
              (act): GELUActivation()
              (w2): Linear(in_features=4096, out_features=1024, bias=True)
            )
            (attention_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (ffn_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=700, out_features=128, bias=False)
  (vision_decoder_head): Linear(in_features=128, out_features=700, bias=False)
)
2025-07-16 14:48:51.966	g3084:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-16 14:48:51.967	g3084:0	olmo.data.data_loader:197	INFO	Loading train dataset depth/train
2025-07-16 14:48:51.967	g3084:0	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/train/train.json
2025-07-16 14:48:52.026	g3084:0	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-16 14:48:52.027	g3084:0	olmo.data.data_loader:219	INFO	depth: 100.00
2025-07-16 14:48:52.029	g3084:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=2304 images=1 pooled_patches_idx=158
2025-07-16 14:48:52.029	g3084:0	olmo.data.data_loader:100	INFO	Loading eval dataset: depth/validation
2025-07-16 14:48:52.030	g3084:0	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/val/val.json
2025-07-16 14:48:52.031	g3084:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=1792 images=1 pooled_patches_idx=158
2025-07-16 14:48:52.260	g3084:0	train:332	INFO	Starting training...
2025-07-16 14:48:52.262	g3084:0	olmo.train.trainer:817	INFO	Pre-train system metrics
    System/Peak GPU Memory (MB)=370.5
2025-07-16 14:49:18.167	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:49:18.998	g3084:0	olmo.util:177	CRITICAL	Uncaught RuntimeError: mat1 and mat2 shapes cannot be multiplied (256x1024 and 700x128)
Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/Umolmo/launch_scripts/train_multitask_model.py", line 396, in <module>
    run_trainer(cfg)
  File "/gscratch/krishna/mahtab/Umolmo/scripts/train.py", line 333, in run_trainer
    trainer.fit()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 1045, in fit
    metrics = self.train_step(batch, compute_metrics=should_log_this_step)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 709, in train_step
    loss = self.train_batch(batch, True)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 658, in train_batch
    ce_loss, z_loss, image_gen_loss, model_out = self.model_forward(
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/trainer.py", line 590, in model_forward
    model_out = self.fsdp_model(
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1857, in _call_impl
    return inner()
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1805, in inner
    result = forward_call(*args, **kwargs)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py", line 463, in forward
    image_output_features = self.vision_encoder_head(image_output_features)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
RuntimeError: mat1 and mat2 shapes cannot be multiplied (256x1024 and 700x128)
2025-07-16 14:51:00.149	g3084:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-16 14:51:00.245	g3084:0	train:54	INFO	Configuration:
2025-07-16 14:51:00.246	g3084:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=128, n_heads=2, n_kv_heads=None, head_dim=None, qkv_bias=False, clip_qkv=None, n_layers=1, mlp_ratio=4, mlp_hidden_size=None, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=10000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='default', layer_norm_with_affine=True, layer_norm_eps=None, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=True, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.1, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=None, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2-7B', tokenizer_dir=None), init_path=None, init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='openai', image_default_input_size=(336, 336), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1024, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=1, image_head_dim=64, image_mlp_dim=4096, image_mlp_activations='gelu', image_dropout_rate=0.0, image_num_pos=577, image_norm_eps=1e-05, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path=None, resize_mode='default', pad_value=0.0, normalize='openai'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-1,), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='resize', max_crops=1, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear', per_image_output_tokens=64), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'depth': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=20, inf_evaluators=[InfDatasetEvaluatorConfig(label='depth', data=DataLoaderConfig(dataset='depth', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=16, console_log_interval=5, include_image=False)], inf_eval_interval=20, eval_on_last_step=True, eval_on_load=False, save_folder='debug_run', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint=None, allow_resume=True, max_duration=1000, global_train_batch_size=8, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=None, beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=5, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=1000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-16 14:51:00.610	g3084:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-16 14:51:03.039	g3084:0	root:123	INFO	Padding tokenizer with 416 tokens
2025-07-16 14:51:04.782	g3084:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-16 14:51:04.937	g3084:0	train:191	INFO	Total number of parameters: 58,088,960
2025-07-16 14:51:04.938	g3084:0	train:192	INFO	Number of non-embedding parameters: 38,608,384
2025-07-16 14:51:04.939	g3084:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 234
2025-07-16 14:51:04.939	g3084:0	train:196	INFO	Model:
2025-07-16 14:51:04.939	g3084:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0): FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=128, out_features=128, bias=True)
          (ff_out): Linear(in_features=256, out_features=128, bias=True)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): LayerNorm()
          (ff_norm): LayerNorm()
          (att_proj): Linear(in_features=128, out_features=384, bias=True)
          (ff_proj): Linear(in_features=128, out_features=512, bias=True)
        )
      )
    )
    (ln_f): FSDPLayerNorm()
    (emb_drop): Dropout(p=0.1, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=128, out_features=152192, bias=True)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=1024, out_features=1024, bias=True)
        (wk): Linear(in_features=1024, out_features=1024, bias=True)
        (wv): Linear(in_features=1024, out_features=1024, bias=True)
        (wo): Linear(in_features=1024, out_features=1024, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1024, out_features=256, bias=False)
        (w2): Linear(in_features=256, out_features=128, bias=False)
        (w3): Linear(in_features=1024, out_features=256, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1024, bias=False)
      (pre_ln): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0): FSDPResidualAttentionBlock(
            (attention): ViTMultiHeadDotProductAttention(
              (wq): Linear(in_features=1024, out_features=1024, bias=True)
              (wk): Linear(in_features=1024, out_features=1024, bias=True)
              (wv): Linear(in_features=1024, out_features=1024, bias=True)
              (wo): Linear(in_features=1024, out_features=1024, bias=True)
              (residual_dropout): Dropout(p=0.0, inplace=False)
            )
            (feed_forward): ViTMLP(
              (w1): Linear(in_features=1024, out_features=4096, bias=True)
              (act): GELUActivation()
              (w2): Linear(in_features=4096, out_features=1024, bias=True)
            )
            (attention_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (ffn_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=1024, out_features=128, bias=False)
  (vision_decoder_head): Linear(in_features=128, out_features=1024, bias=False)
)
2025-07-16 14:51:04.950	g3084:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-16 14:51:04.951	g3084:0	olmo.data.data_loader:197	INFO	Loading train dataset depth/train
2025-07-16 14:51:04.951	g3084:0	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/train/train.json
2025-07-16 14:51:04.988	g3084:0	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-16 14:51:04.989	g3084:0	olmo.data.data_loader:219	INFO	depth: 100.00
2025-07-16 14:51:04.991	g3084:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=2304 images=1 pooled_patches_idx=158
2025-07-16 14:51:04.992	g3084:0	olmo.data.data_loader:100	INFO	Loading eval dataset: depth/validation
2025-07-16 14:51:04.992	g3084:0	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/val/val.json
2025-07-16 14:51:04.994	g3084:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=1792 images=1 pooled_patches_idx=158
2025-07-16 14:51:05.240	g3084:0	train:332	INFO	Starting training...
2025-07-16 14:51:05.241	g3084:0	olmo.train.trainer:817	INFO	Pre-train system metrics
    System/Peak GPU Memory (MB)=370.8
2025-07-16 14:51:09.991	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:51:17.849	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:51:18.986	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:51:19.929	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:51:20.755	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:51:21.648	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:51:21.942	g3084:0	olmo.train.trainer:817	INFO	[step=5/1000]
    train/CrossEntropyLoss=11.90
    train/ZLoss=0.0143
    train/ImageGenLoss=0.7284
    train/Accuracy=0.0
    throughput/total_tokens=92,160
    throughput/device/tokens_per_second=24,821
    throughput/device/batches_per_second=1.347
2025-07-16 14:51:22.379	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:51:23.152	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:51:24.003	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:51:24.881	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:51:25.597	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:51:25.885	g3084:0	olmo.train.trainer:817	INFO	[step=10/1000]
    train/CrossEntropyLoss=11.89
    train/ZLoss=0.0143
    train/ImageGenLoss=0.6477
    train/Accuracy=0.0
    throughput/total_tokens=184,320
    throughput/device/tokens_per_second=23,997
    throughput/device/batches_per_second=1.302
    System/Peak GPU Memory (MB)=29,225
2025-07-16 14:51:26.485	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:51:27.204	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:51:27.933	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:51:28.626	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:51:29.354	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:51:29.649	g3084:0	olmo.train.trainer:817	INFO	[step=15/1000]
    train/CrossEntropyLoss=11.89
    train/ZLoss=0.0143
    train/ImageGenLoss=0.6367
    train/Accuracy=0.0
    throughput/total_tokens=276,480
    throughput/device/tokens_per_second=24,167
    throughput/device/batches_per_second=1.311
2025-07-16 14:51:30.158	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:51:30.864	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:51:31.679	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:51:32.472	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:51:33.271	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:51:33.562	g3084:0	olmo.train.trainer:817	INFO	[step=20/1000]
    train/CrossEntropyLoss=11.90
    train/ZLoss=0.0143
    train/ImageGenLoss=0.6163
    train/Accuracy=0.0
    throughput/total_tokens=368,640
    throughput/device/tokens_per_second=24,004
    throughput/device/batches_per_second=1.302
    System/Peak GPU Memory (MB)=29,225
2025-07-16 14:51:33.563	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 14:51:39.966	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 14:51:39.967	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 14:51:39.968	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 6.4 seconds
2025-07-16 14:51:40.390	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:51:41.241	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:51:42.031	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:51:42.815	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:51:43.615	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:51:43.907	g3084:0	olmo.train.trainer:817	INFO	[step=25/1000]
    train/CrossEntropyLoss=11.88
    train/ZLoss=0.0143
    train/ImageGenLoss=0.5772
    train/Accuracy=0.0
    throughput/total_tokens=460,800
    throughput/device/tokens_per_second=26,105
    throughput/device/batches_per_second=1.416
2025-07-16 14:51:44.380	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:51:45.054	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:51:45.822	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:51:46.511	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:51:47.259	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:51:47.553	g3084:0	olmo.train.trainer:817	INFO	[step=30/1000]
    train/CrossEntropyLoss=11.86
    train/ZLoss=0.0143
    train/ImageGenLoss=0.6220
    train/Accuracy=0.0
    throughput/total_tokens=552,960
    throughput/device/tokens_per_second=25,687
    throughput/device/batches_per_second=1.394
    System/Peak GPU Memory (MB)=29,225
2025-07-16 14:51:48.047	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:51:48.814	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:51:49.692	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:51:50.372	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:51:51.116	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:51:51.411	g3084:0	olmo.train.trainer:817	INFO	[step=35/1000]
    train/CrossEntropyLoss=11.82
    train/ZLoss=0.0143
    train/ImageGenLoss=0.6488
    train/Accuracy=0.0
    throughput/total_tokens=645,120
    throughput/device/tokens_per_second=25,056
    throughput/device/batches_per_second=1.359
2025-07-16 14:51:51.942	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:51:52.794	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:51:53.516	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:51:54.258	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:51:54.974	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:51:55.264	g3084:0	olmo.train.trainer:817	INFO	[step=40/1000]
    train/CrossEntropyLoss=11.83
    train/ZLoss=0.0143
    train/ImageGenLoss=0.6807
    train/Accuracy=0.0
    throughput/total_tokens=737,280
    throughput/device/tokens_per_second=24,763
    throughput/device/batches_per_second=1.343
    System/Peak GPU Memory (MB)=29,225
2025-07-16 14:51:55.265	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 14:51:59.130	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 14:51:59.131	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 14:51:59.131	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 3.9 seconds
2025-07-16 14:51:59.620	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:52:00.283	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:52:00.985	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:52:01.859	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:52:02.604	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:52:02.900	g3084:0	olmo.train.trainer:817	INFO	[step=45/1000]
    train/CrossEntropyLoss=11.82
    train/ZLoss=0.0143
    train/ImageGenLoss=0.6246
    train/Accuracy=0.0
    throughput/total_tokens=829,440
    throughput/device/tokens_per_second=27,982
    throughput/device/batches_per_second=1.518
2025-07-16 14:52:03.323	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:52:04.082	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:52:04.804	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:52:05.528	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:52:06.238	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:52:06.530	g3084:0	olmo.train.trainer:817	INFO	[step=50/1000]
    train/CrossEntropyLoss=11.79
    train/ZLoss=0.0143
    train/ImageGenLoss=0.6885
    train/Accuracy=0.0
    throughput/total_tokens=921,600
    throughput/device/tokens_per_second=26,624
    throughput/device/batches_per_second=1.444
    System/Peak GPU Memory (MB)=29,225
2025-07-16 14:52:07.119	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:52:07.937	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:52:08.671	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:52:09.572	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:52:10.375	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:52:10.668	g3084:0	olmo.train.trainer:817	INFO	[step=55/1000]
    train/CrossEntropyLoss=11.77
    train/ZLoss=0.0143
    train/ImageGenLoss=0.6954
    train/Accuracy=0.0
    throughput/total_tokens=1,013,760
    throughput/device/tokens_per_second=24,995
    throughput/device/batches_per_second=1.356
2025-07-16 14:52:11.159	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:52:11.938	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:52:12.743	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:52:13.456	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:52:14.195	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:52:14.489	g3084:0	olmo.train.trainer:817	INFO	[step=60/1000]
    train/CrossEntropyLoss=11.78
    train/ZLoss=0.0143
    train/ImageGenLoss=0.6110
    train/Accuracy=0.0
    throughput/total_tokens=1,105,920
    throughput/device/tokens_per_second=24,772
    throughput/device/batches_per_second=1.344
    System/Peak GPU Memory (MB)=29,225
2025-07-16 14:52:14.490	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 14:52:18.407	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 14:52:18.408	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 14:52:18.421	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 3.9 seconds
2025-07-16 14:52:19.080	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:52:19.763	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:52:20.538	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:52:21.259	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:52:22.016	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:52:22.308	g3084:0	olmo.train.trainer:817	INFO	[step=65/1000]
    train/CrossEntropyLoss=11.75
    train/ZLoss=0.0143
    train/ImageGenLoss=0.7193
    train/Accuracy=0.0
    throughput/total_tokens=1,198,080
    throughput/device/tokens_per_second=28,437
    throughput/device/batches_per_second=1.543
2025-07-16 14:52:22.736	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:52:23.426	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:52:24.078	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:52:24.931	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:52:25.633	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:52:25.928	g3084:0	olmo.train.trainer:817	INFO	[step=70/1000]
    train/CrossEntropyLoss=11.72
    train/ZLoss=0.0143
    train/ImageGenLoss=0.6605
    train/Accuracy=0.0
    throughput/total_tokens=1,290,240
    throughput/device/tokens_per_second=26,869
    throughput/device/batches_per_second=1.458
    System/Peak GPU Memory (MB)=29,225
2025-07-16 14:52:26.373	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:52:27.063	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:52:27.778	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:52:28.483	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:52:29.319	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:52:29.614	g3084:0	olmo.train.trainer:817	INFO	[step=75/1000]
    train/CrossEntropyLoss=11.71
    train/ZLoss=0.0143
    train/ImageGenLoss=0.6124
    train/Accuracy=0.0
    throughput/total_tokens=1,382,400
    throughput/device/tokens_per_second=26,214
    throughput/device/batches_per_second=1.422
2025-07-16 14:52:30.036	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:52:30.757	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:52:31.439	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:52:32.243	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:52:32.998	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:52:33.293	g3084:0	olmo.train.trainer:817	INFO	[step=80/1000]
    train/CrossEntropyLoss=11.67
    train/ZLoss=0.0143
    train/ImageGenLoss=0.6538
    train/Accuracy=0.0
    throughput/total_tokens=1,474,560
    throughput/device/tokens_per_second=25,914
    throughput/device/batches_per_second=1.406
    System/Peak GPU Memory (MB)=29,225
2025-07-16 14:52:33.295	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 14:52:37.286	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 14:52:37.287	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 14:52:37.287	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 4.0 seconds
2025-07-16 14:52:37.780	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:52:38.470	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:52:39.128	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:52:39.999	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:52:40.873	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:52:41.164	g3084:0	olmo.train.trainer:817	INFO	[step=85/1000]
    train/CrossEntropyLoss=11.69
    train/ZLoss=0.0143
    train/ImageGenLoss=0.6660
    train/Accuracy=0.0
    throughput/total_tokens=1,566,720
    throughput/device/tokens_per_second=27,125
    throughput/device/batches_per_second=1.472
2025-07-16 14:52:41.617	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:52:42.452	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:52:43.289	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:52:44.151	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:52:44.875	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:52:45.169	g3084:0	olmo.train.trainer:817	INFO	[step=90/1000]
    train/CrossEntropyLoss=11.66
    train/ZLoss=0.0143
    train/ImageGenLoss=0.6483
    train/Accuracy=0.0
    throughput/total_tokens=1,658,880
    throughput/device/tokens_per_second=24,903
    throughput/device/batches_per_second=1.351
    System/Peak GPU Memory (MB)=29,225
2025-07-16 14:52:45.603	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:52:46.407	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:52:47.146	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:52:47.924	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:52:48.657	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:52:48.951	g3084:0	olmo.train.trainer:817	INFO	[step=95/1000]
    train/CrossEntropyLoss=11.63
    train/ZLoss=0.0143
    train/ImageGenLoss=0.6222
    train/Accuracy=0.0
    throughput/total_tokens=1,751,040
    throughput/device/tokens_per_second=24,721
    throughput/device/batches_per_second=1.341
2025-07-16 14:52:49.467	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:52:50.350	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:52:51.154	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:52:51.908	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:52:52.594	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:52:52.883	g3084:0	olmo.train.trainer:817	INFO	[step=100/1000]
    train/CrossEntropyLoss=11.63
    train/ZLoss=0.0143
    train/ImageGenLoss=0.6325
    train/Accuracy=0.0
    throughput/total_tokens=1,843,200
    throughput/device/tokens_per_second=24,388
    throughput/device/batches_per_second=1.323
    System/Peak GPU Memory (MB)=29,225
2025-07-16 14:52:52.884	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 14:52:56.844	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 14:52:56.844	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 14:52:56.845	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 4.0 seconds
2025-07-16 14:52:57.350	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:52:58.031	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:52:58.825	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:52:59.538	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:53:00.218	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:53:00.507	g3084:0	olmo.train.trainer:817	INFO	[step=105/1000]
    train/CrossEntropyLoss=11.60
    train/ZLoss=0.0143
    train/ImageGenLoss=0.5376
    train/Accuracy=0.0
    throughput/total_tokens=1,935,360
    throughput/device/tokens_per_second=29,068
    throughput/device/batches_per_second=1.577
2025-07-16 14:53:01.079	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:53:01.837	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:53:02.613	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:53:03.333	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:53:04.133	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:53:04.427	g3084:0	olmo.train.trainer:817	INFO	[step=110/1000]
    train/CrossEntropyLoss=11.62
    train/ZLoss=0.0143
    train/ImageGenLoss=0.6716
    train/Accuracy=0.0
    throughput/total_tokens=2,027,520
    throughput/device/tokens_per_second=25,998
    throughput/device/batches_per_second=1.410
    System/Peak GPU Memory (MB)=29,225
2025-07-16 14:53:04.939	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:53:05.677	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:53:06.366	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:53:07.013	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:53:07.839	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:53:08.129	g3084:0	olmo.train.trainer:817	INFO	[step=115/1000]
    train/CrossEntropyLoss=11.56
    train/ZLoss=0.0143
    train/ImageGenLoss=0.6444
    train/Accuracy=0.0100
    throughput/total_tokens=2,119,680
    throughput/device/tokens_per_second=25,617
    throughput/device/batches_per_second=1.390
2025-07-16 14:53:08.607	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:53:09.435	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:53:10.270	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:53:11.085	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:53:11.881	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:53:12.176	g3084:0	olmo.train.trainer:817	INFO	[step=120/1000]
    train/CrossEntropyLoss=11.57
    train/ZLoss=0.0143
    train/ImageGenLoss=0.5595
    train/Accuracy=0.0
    throughput/total_tokens=2,211,840
    throughput/device/tokens_per_second=24,842
    throughput/device/batches_per_second=1.348
    System/Peak GPU Memory (MB)=29,225
2025-07-16 14:53:12.178	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 14:53:16.114	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 14:53:16.115	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 14:53:16.115	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 3.9 seconds
2025-07-16 14:53:16.644	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:53:17.395	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:53:18.156	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:53:19.018	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:53:19.696	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:53:19.989	g3084:0	olmo.train.trainer:817	INFO	[step=125/1000]
    train/CrossEntropyLoss=11.54
    train/ZLoss=0.0143
    train/ImageGenLoss=0.6116
    train/Accuracy=0.0
    throughput/total_tokens=2,304,000
    throughput/device/tokens_per_second=27,444
    throughput/device/batches_per_second=1.489
2025-07-16 14:53:20.443	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:53:21.121	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:53:21.850	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:53:22.641	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:53:23.514	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:53:23.802	g3084:0	olmo.train.trainer:817	INFO	[step=130/1000]
    train/CrossEntropyLoss=11.51
    train/ZLoss=0.0143
    train/ImageGenLoss=0.5279
    train/Accuracy=0.0
    throughput/total_tokens=2,396,160
    throughput/device/tokens_per_second=25,704
    throughput/device/batches_per_second=1.395
    System/Peak GPU Memory (MB)=29,225
2025-07-16 14:53:24.298	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:53:25.176	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:53:25.914	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:53:26.747	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:53:27.486	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:53:27.780	g3084:0	olmo.train.trainer:817	INFO	[step=135/1000]
    train/CrossEntropyLoss=11.47
    train/ZLoss=0.0143
    train/ImageGenLoss=0.6747
    train/Accuracy=0.0
    throughput/total_tokens=2,488,320
    throughput/device/tokens_per_second=24,799
    throughput/device/batches_per_second=1.345
2025-07-16 14:53:28.240	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:53:29.021	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:53:29.748	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:53:30.490	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:53:31.337	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:53:31.631	g3084:0	olmo.train.trainer:817	INFO	[step=140/1000]
    train/CrossEntropyLoss=11.50
    train/ZLoss=0.0143
    train/ImageGenLoss=0.6364
    train/Accuracy=0.0
    throughput/total_tokens=2,580,480
    throughput/device/tokens_per_second=24,577
    throughput/device/batches_per_second=1.333
    System/Peak GPU Memory (MB)=29,225
2025-07-16 14:53:31.633	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 14:53:35.469	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 14:53:35.470	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 14:53:35.471	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 3.8 seconds
2025-07-16 14:53:35.955	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:53:36.671	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:53:37.407	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:53:38.264	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:53:39.035	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:53:39.327	g3084:0	olmo.train.trainer:817	INFO	[step=145/1000]
    train/CrossEntropyLoss=11.51
    train/ZLoss=0.0142
    train/ImageGenLoss=0.6340
    train/Accuracy=0.0091
    throughput/total_tokens=2,672,640
    throughput/device/tokens_per_second=27,227
    throughput/device/batches_per_second=1.477
2025-07-16 14:53:39.866	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:53:40.936	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:53:41.689	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:53:42.595	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:53:43.461	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:53:43.756	g3084:0	olmo.train.trainer:817	INFO	[step=150/1000]
    train/CrossEntropyLoss=11.52
    train/ZLoss=0.0142
    train/ImageGenLoss=0.5906
    train/Accuracy=0.0
    throughput/total_tokens=2,764,800
    throughput/device/tokens_per_second=23,591
    throughput/device/batches_per_second=1.280
    System/Peak GPU Memory (MB)=29,225
2025-07-16 14:53:44.466	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:53:45.268	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:53:46.211	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:53:47.072	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:53:47.844	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:53:48.137	g3084:0	olmo.train.trainer:817	INFO	[step=155/1000]
    train/CrossEntropyLoss=11.48
    train/ZLoss=0.0142
    train/ImageGenLoss=0.5781
    train/Accuracy=0.0088
    throughput/total_tokens=2,856,960
    throughput/device/tokens_per_second=22,671
    throughput/device/batches_per_second=1.230
2025-07-16 14:53:48.530	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:53:49.223	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:53:49.958	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:53:50.722	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:53:51.530	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:53:51.843	g3084:0	olmo.train.trainer:817	INFO	[step=160/1000]
    train/CrossEntropyLoss=11.46
    train/ZLoss=0.0142
    train/ImageGenLoss=0.6727
    train/Accuracy=0.0182
    throughput/total_tokens=2,949,120
    throughput/device/tokens_per_second=23,183
    throughput/device/batches_per_second=1.258
    System/Peak GPU Memory (MB)=29,225
2025-07-16 14:53:51.845	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 14:53:56.236	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 14:53:56.236	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 14:53:56.237	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 4.4 seconds
2025-07-16 14:53:56.698	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:53:57.519	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:53:58.286	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:53:59.007	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:53:59.778	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:54:00.071	g3084:0	olmo.train.trainer:817	INFO	[step=165/1000]
    train/CrossEntropyLoss=11.44
    train/ZLoss=0.0142
    train/ImageGenLoss=0.5748
    train/Accuracy=0.0098
    throughput/total_tokens=3,041,280
    throughput/device/tokens_per_second=27,210
    throughput/device/batches_per_second=1.476
2025-07-16 14:54:00.554	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:54:01.335	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:54:02.030	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:54:02.795	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:54:03.564	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:54:03.858	g3084:0	olmo.train.trainer:817	INFO	[step=170/1000]
    train/CrossEntropyLoss=11.39
    train/ZLoss=0.0142
    train/ImageGenLoss=0.5547
    train/Accuracy=0.0102
    throughput/total_tokens=3,133,440
    throughput/device/tokens_per_second=25,695
    throughput/device/batches_per_second=1.394
    System/Peak GPU Memory (MB)=29,225
2025-07-16 14:54:04.372	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:54:05.111	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:54:05.845	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:54:06.577	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:54:07.345	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:54:07.642	g3084:0	olmo.train.trainer:817	INFO	[step=175/1000]
    train/CrossEntropyLoss=11.40
    train/ZLoss=0.0142
    train/ImageGenLoss=0.5852
    train/Accuracy=0.0101
    throughput/total_tokens=3,225,600
    throughput/device/tokens_per_second=25,232
    throughput/device/batches_per_second=1.369
2025-07-16 14:54:08.147	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:54:08.989	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:54:09.682	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:54:10.446	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:54:11.166	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:54:11.458	g3084:0	olmo.train.trainer:817	INFO	[step=180/1000]
    train/CrossEntropyLoss=11.42
    train/ZLoss=0.0142
    train/ImageGenLoss=0.5565
    train/Accuracy=0.0171
    throughput/total_tokens=3,317,760
    throughput/device/tokens_per_second=24,952
    throughput/device/batches_per_second=1.354
    System/Peak GPU Memory (MB)=29,225
2025-07-16 14:54:11.460	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 14:54:15.464	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 14:54:15.465	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 14:54:15.496	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 4.0 seconds
2025-07-16 14:54:16.057	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:54:16.895	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:54:17.699	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:54:18.410	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:54:19.085	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:54:19.379	g3084:0	olmo.train.trainer:817	INFO	[step=185/1000]
    train/CrossEntropyLoss=11.34
    train/ZLoss=0.0142
    train/ImageGenLoss=0.5802
    train/Accuracy=0.0337
    throughput/total_tokens=3,409,920
    throughput/device/tokens_per_second=27,624
    throughput/device/batches_per_second=1.499
2025-07-16 14:54:19.849	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:54:20.550	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:54:21.439	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:54:22.177	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:54:22.958	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:54:23.252	g3084:0	olmo.train.trainer:817	INFO	[step=190/1000]
    train/CrossEntropyLoss=11.39
    train/ZLoss=0.0142
    train/ImageGenLoss=0.5957
    train/Accuracy=0.0174
    throughput/total_tokens=3,502,080
    throughput/device/tokens_per_second=25,569
    throughput/device/batches_per_second=1.387
    System/Peak GPU Memory (MB)=29,225
2025-07-16 14:54:23.728	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:54:24.580	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:54:25.391	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:54:26.211	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:54:26.988	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:54:27.278	g3084:0	olmo.train.trainer:817	INFO	[step=195/1000]
    train/CrossEntropyLoss=11.37
    train/ZLoss=0.0142
    train/ImageGenLoss=0.6354
    train/Accuracy=0.0099
    throughput/total_tokens=3,594,240
    throughput/device/tokens_per_second=24,607
    throughput/device/batches_per_second=1.335
2025-07-16 14:54:27.862	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:54:28.713	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:54:29.449	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:54:30.257	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:54:31.011	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:54:31.304	g3084:0	olmo.train.trainer:817	INFO	[step=200/1000]
    train/CrossEntropyLoss=11.33
    train/ZLoss=0.0142
    train/ImageGenLoss=0.6509
    train/Accuracy=0.0367
    throughput/total_tokens=3,686,400
    throughput/device/tokens_per_second=24,155
    throughput/device/batches_per_second=1.311
    System/Peak GPU Memory (MB)=29,225
2025-07-16 14:54:31.306	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 14:54:35.703	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 14:54:35.703	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 14:54:35.704	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 4.4 seconds
2025-07-16 14:54:36.235	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:54:37.161	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:54:38.053	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:54:38.857	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:54:39.778	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:54:40.066	g3084:0	olmo.train.trainer:817	INFO	[step=205/1000]
    train/CrossEntropyLoss=11.36
    train/ZLoss=0.0142
    train/ImageGenLoss=0.7033
    train/Accuracy=0.0244
    throughput/total_tokens=3,778,560
    throughput/device/tokens_per_second=23,974
    throughput/device/batches_per_second=1.301
2025-07-16 14:54:40.534	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:54:41.467	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:54:42.361	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:54:43.137	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:54:43.859	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:54:44.150	g3084:0	olmo.train.trainer:817	INFO	[step=210/1000]
    train/CrossEntropyLoss=11.33
    train/ZLoss=0.0142
    train/ImageGenLoss=0.5961
    train/Accuracy=0.0885
    throughput/total_tokens=3,870,720
    throughput/device/tokens_per_second=23,248
    throughput/device/batches_per_second=1.261
    System/Peak GPU Memory (MB)=29,225
2025-07-16 14:54:44.736	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:54:45.504	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:54:46.793	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:54:48.245	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:54:49.359	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:54:49.648	g3084:0	olmo.train.trainer:817	INFO	[step=215/1000]
    train/CrossEntropyLoss=11.28
    train/ZLoss=0.0142
    train/ImageGenLoss=0.5597
    train/Accuracy=0.0825
    throughput/total_tokens=3,962,880
    throughput/device/tokens_per_second=20,591
    throughput/device/batches_per_second=1.117
2025-07-16 14:54:50.484	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:54:51.770	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:54:52.649	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:54:53.826	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:54:55.086	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:54:55.377	g3084:0	olmo.train.trainer:817	INFO	[step=220/1000]
    train/CrossEntropyLoss=11.30
    train/ZLoss=0.0142
    train/ImageGenLoss=0.6661
    train/Accuracy=0.0777
    throughput/total_tokens=4,055,040
    throughput/device/tokens_per_second=19,244
    throughput/device/batches_per_second=1.044
    System/Peak GPU Memory (MB)=29,225
2025-07-16 14:54:55.379	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 14:54:59.683	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 14:54:59.684	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 14:54:59.684	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 4.3 seconds
2025-07-16 14:55:00.207	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:55:01.456	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:55:02.265	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:55:03.089	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:55:04.066	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:55:04.356	g3084:0	olmo.train.trainer:817	INFO	[step=225/1000]
    train/CrossEntropyLoss=11.24
    train/ZLoss=0.0142
    train/ImageGenLoss=0.6196
    train/Accuracy=0.1064
    throughput/total_tokens=4,147,200
    throughput/device/tokens_per_second=22,147
    throughput/device/batches_per_second=1.202
2025-07-16 14:55:05.011	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:55:05.929	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:55:07.000	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:55:07.845	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:55:08.787	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:55:09.078	g3084:0	olmo.train.trainer:817	INFO	[step=230/1000]
    train/CrossEntropyLoss=11.30
    train/ZLoss=0.0142
    train/ImageGenLoss=0.5827
    train/Accuracy=0.1667
    throughput/total_tokens=4,239,360
    throughput/device/tokens_per_second=20,748
    throughput/device/batches_per_second=1.126
    System/Peak GPU Memory (MB)=29,225
2025-07-16 14:55:09.728	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:55:10.536	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:55:11.598	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:55:12.475	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:55:13.548	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:55:13.842	g3084:0	olmo.train.trainer:817	INFO	[step=235/1000]
    train/CrossEntropyLoss=11.26
    train/ZLoss=0.0141
    train/ImageGenLoss=0.5712
    train/Accuracy=0.1652
    throughput/total_tokens=4,331,520
    throughput/device/tokens_per_second=20,258
    throughput/device/batches_per_second=1.099
2025-07-16 14:55:14.373	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:55:15.197	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:55:16.176	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:55:17.278	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:55:18.173	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:55:18.465	g3084:0	olmo.train.trainer:817	INFO	[step=240/1000]
    train/CrossEntropyLoss=11.24
    train/ZLoss=0.0141
    train/ImageGenLoss=0.5166
    train/Accuracy=0.1553
    throughput/total_tokens=4,423,680
    throughput/device/tokens_per_second=20,177
    throughput/device/batches_per_second=1.095
    System/Peak GPU Memory (MB)=29,225
2025-07-16 14:55:18.467	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 14:55:22.041	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 14:55:22.041	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 14:55:22.042	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 3.6 seconds
2025-07-16 14:55:22.714	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:55:23.435	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:55:24.316	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:55:25.163	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:55:26.122	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:55:26.416	g3084:0	olmo.train.trainer:817	INFO	[step=245/1000]
    train/CrossEntropyLoss=11.22
    train/ZLoss=0.0141
    train/ImageGenLoss=0.5487
    train/Accuracy=0.2095
    throughput/total_tokens=4,515,840
    throughput/device/tokens_per_second=24,802
    throughput/device/batches_per_second=1.346
2025-07-16 14:55:27.042	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:55:27.921	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:55:29.023	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:55:29.909	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:55:30.757	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:55:31.051	g3084:0	olmo.train.trainer:817	INFO	[step=250/1000]
    train/CrossEntropyLoss=11.22
    train/ZLoss=0.0141
    train/ImageGenLoss=0.6299
    train/Accuracy=0.2110
    throughput/total_tokens=4,608,000
    throughput/device/tokens_per_second=22,073
    throughput/device/batches_per_second=1.198
    System/Peak GPU Memory (MB)=29,225
2025-07-16 14:55:31.759	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:55:32.770	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:55:33.658	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:55:34.633	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:55:35.450	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:55:35.743	g3084:0	olmo.train.trainer:817	INFO	[step=255/1000]
    train/CrossEntropyLoss=11.19
    train/ZLoss=0.0141
    train/ImageGenLoss=0.5788
    train/Accuracy=0.2451
    throughput/total_tokens=4,700,160
    throughput/device/tokens_per_second=21,198
    throughput/device/batches_per_second=1.150
2025-07-16 14:55:36.385	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:55:37.301	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:55:38.401	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:55:39.286	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:55:40.234	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:55:40.529	g3084:0	olmo.train.trainer:817	INFO	[step=260/1000]
    train/CrossEntropyLoss=11.21
    train/ZLoss=0.0141
    train/ImageGenLoss=0.5991
    train/Accuracy=0.2393
    throughput/total_tokens=4,792,320
    throughput/device/tokens_per_second=20,677
    throughput/device/batches_per_second=1.122
    System/Peak GPU Memory (MB)=29,225
2025-07-16 14:55:40.531	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 14:55:43.887	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 14:55:43.888	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 14:55:43.888	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 3.4 seconds
2025-07-16 14:55:44.631	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:55:45.457	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:55:46.267	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:55:47.188	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:55:48.220	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:55:48.515	g3084:0	olmo.train.trainer:817	INFO	[step=265/1000]
    train/CrossEntropyLoss=11.15
    train/ZLoss=0.0141
    train/ImageGenLoss=0.5289
    train/Accuracy=0.3542
    throughput/total_tokens=4,884,480
    throughput/device/tokens_per_second=23,646
    throughput/device/batches_per_second=1.283
2025-07-16 14:55:49.667	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:55:50.952	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:55:51.694	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:55:53.007	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:55:53.790	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:55:54.082	g3084:0	olmo.train.trainer:817	INFO	[step=270/1000]
    train/CrossEntropyLoss=11.16
    train/ZLoss=0.0141
    train/ImageGenLoss=0.5698
    train/Accuracy=0.3084
    throughput/total_tokens=4,976,640
    throughput/device/tokens_per_second=19,475
    throughput/device/batches_per_second=1.057
    System/Peak GPU Memory (MB)=29,225
2025-07-16 14:55:54.587	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:55:55.815	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:55:56.636	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:55:57.511	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:55:58.313	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:55:58.604	g3084:0	olmo.train.trainer:817	INFO	[step=275/1000]
    train/CrossEntropyLoss=11.14
    train/ZLoss=0.0141
    train/ImageGenLoss=0.6485
    train/Accuracy=0.3229
    throughput/total_tokens=5,068,800
    throughput/device/tokens_per_second=19,767
    throughput/device/batches_per_second=1.072
2025-07-16 14:55:59.130	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:55:59.915	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:56:00.675	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:56:01.601	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:56:02.324	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:56:02.619	g3084:0	olmo.train.trainer:817	INFO	[step=280/1000]
    train/CrossEntropyLoss=11.12
    train/ZLoss=0.0141
    train/ImageGenLoss=0.6328
    train/Accuracy=0.3191
    throughput/total_tokens=5,160,960
    throughput/device/tokens_per_second=20,478
    throughput/device/batches_per_second=1.111
    System/Peak GPU Memory (MB)=29,225
2025-07-16 14:56:02.621	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 14:56:06.019	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 14:56:06.020	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 14:56:06.021	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 3.4 seconds
2025-07-16 14:56:06.657	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:56:07.391	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:56:08.114	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:56:08.834	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:56:09.745	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:56:10.039	g3084:0	olmo.train.trainer:817	INFO	[step=285/1000]
    train/CrossEntropyLoss=11.15
    train/ZLoss=0.0141
    train/ImageGenLoss=0.5674
    train/Accuracy=0.3364
    throughput/total_tokens=5,253,120
    throughput/device/tokens_per_second=27,152
    throughput/device/batches_per_second=1.473
2025-07-16 14:56:10.569	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:56:11.337	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:56:12.060	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:56:12.783	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:56:13.616	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:56:13.909	g3084:0	olmo.train.trainer:817	INFO	[step=290/1000]
    train/CrossEntropyLoss=11.12
    train/ZLoss=0.0141
    train/ImageGenLoss=0.5684
    train/Accuracy=0.3451
    throughput/total_tokens=5,345,280
    throughput/device/tokens_per_second=25,373
    throughput/device/batches_per_second=1.377
    System/Peak GPU Memory (MB)=29,225
2025-07-16 14:56:14.456	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:56:15.328	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:56:16.174	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:56:16.930	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:56:17.689	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:56:17.985	g3084:0	olmo.train.trainer:817	INFO	[step=295/1000]
    train/CrossEntropyLoss=11.12
    train/ZLoss=0.0141
    train/ImageGenLoss=0.6431
    train/Accuracy=0.3947
    throughput/total_tokens=5,437,440
    throughput/device/tokens_per_second=24,380
    throughput/device/batches_per_second=1.323
2025-07-16 14:56:18.447	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:56:19.247	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:56:20.036	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:56:20.817	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:56:21.672	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:56:21.966	g3084:0	olmo.train.trainer:817	INFO	[step=300/1000]
    train/CrossEntropyLoss=11.05
    train/ZLoss=0.0141
    train/ImageGenLoss=0.6218
    train/Accuracy=0.4286
    throughput/total_tokens=5,529,600
    throughput/device/tokens_per_second=24,061
    throughput/device/batches_per_second=1.305
    System/Peak GPU Memory (MB)=29,225
2025-07-16 14:56:21.968	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 14:56:25.387	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 14:56:25.388	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 14:56:25.388	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 3.4 seconds
2025-07-16 14:56:25.999	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:56:26.708	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:56:27.387	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:56:28.241	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:56:29.198	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:56:29.491	g3084:0	olmo.train.trainer:817	INFO	[step=305/1000]
    train/CrossEntropyLoss=11.10
    train/ZLoss=0.0141
    train/ImageGenLoss=0.6103
    train/Accuracy=0.3585
    throughput/total_tokens=5,621,760
    throughput/device/tokens_per_second=26,292
    throughput/device/batches_per_second=1.426
2025-07-16 14:56:29.993	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:56:30.853	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:56:31.681	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:56:32.503	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:56:33.201	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:56:33.494	g3084:0	olmo.train.trainer:817	INFO	[step=310/1000]
    train/CrossEntropyLoss=11.08
    train/ZLoss=0.0141
    train/ImageGenLoss=0.5850
    train/Accuracy=0.3750
    throughput/total_tokens=5,713,920
    throughput/device/tokens_per_second=24,550
    throughput/device/batches_per_second=1.332
    System/Peak GPU Memory (MB)=29,225
2025-07-16 14:56:34.021	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:56:34.930	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:56:35.752	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:56:36.718	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:56:37.624	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:56:37.916	g3084:0	olmo.train.trainer:817	INFO	[step=315/1000]
    train/CrossEntropyLoss=11.01
    train/ZLoss=0.0141
    train/ImageGenLoss=0.6345
    train/Accuracy=0.4624
    throughput/total_tokens=5,806,080
    throughput/device/tokens_per_second=23,175
    throughput/device/batches_per_second=1.257
2025-07-16 14:56:38.504	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:56:39.327	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:56:40.037	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:56:40.866	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:56:41.646	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:56:41.942	g3084:0	olmo.train.trainer:817	INFO	[step=320/1000]
    train/CrossEntropyLoss=11.02
    train/ZLoss=0.0141
    train/ImageGenLoss=0.5539
    train/Accuracy=0.4200
    throughput/total_tokens=5,898,240
    throughput/device/tokens_per_second=23,104
    throughput/device/batches_per_second=1.254
    System/Peak GPU Memory (MB)=29,225
2025-07-16 14:56:41.944	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 14:56:45.439	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 14:56:45.439	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 14:56:45.440	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 3.5 seconds
2025-07-16 14:56:45.906	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:56:46.756	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:56:47.534	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:56:48.361	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:56:49.148	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:56:49.442	g3084:0	olmo.train.trainer:817	INFO	[step=325/1000]
    train/CrossEntropyLoss=11.05
    train/ZLoss=0.0141
    train/ImageGenLoss=0.6657
    train/Accuracy=0.4324
    throughput/total_tokens=5,990,400
    throughput/device/tokens_per_second=25,969
    throughput/device/batches_per_second=1.409
2025-07-16 14:56:49.887	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:56:50.714	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:56:51.545	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:56:52.239	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:56:52.891	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:56:53.184	g3084:0	olmo.train.trainer:817	INFO	[step=330/1000]
    train/CrossEntropyLoss=11.06
    train/ZLoss=0.0140
    train/ImageGenLoss=0.6359
    train/Accuracy=0.3906
    throughput/total_tokens=6,082,560
    throughput/device/tokens_per_second=25,279
    throughput/device/batches_per_second=1.372
    System/Peak GPU Memory (MB)=29,225
2025-07-16 14:56:53.779	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:56:54.514	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:56:55.372	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:56:56.178	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:56:56.848	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:56:57.142	g3084:0	olmo.train.trainer:817	INFO	[step=335/1000]
    train/CrossEntropyLoss=10.99
    train/ZLoss=0.0140
    train/ImageGenLoss=0.6157
    train/Accuracy=0.4434
    throughput/total_tokens=6,174,720
    throughput/device/tokens_per_second=24,578
    throughput/device/batches_per_second=1.333
2025-07-16 14:56:57.639	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:56:58.471	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:56:59.201	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:57:00.086	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:57:00.948	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:57:01.243	g3084:0	olmo.train.trainer:817	INFO	[step=340/1000]
    train/CrossEntropyLoss=10.97
    train/ZLoss=0.0140
    train/ImageGenLoss=0.6124
    train/Accuracy=0.4766
    throughput/total_tokens=6,266,880
    throughput/device/tokens_per_second=24,016
    throughput/device/batches_per_second=1.303
    System/Peak GPU Memory (MB)=29,225
2025-07-16 14:57:01.244	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 14:57:04.790	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 14:57:04.791	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 14:57:04.791	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 3.5 seconds
2025-07-16 14:57:05.405	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:57:06.177	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:57:06.964	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:57:07.689	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:57:08.468	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:57:08.762	g3084:0	olmo.train.trainer:817	INFO	[step=345/1000]
    train/CrossEntropyLoss=10.97
    train/ZLoss=0.0140
    train/ImageGenLoss=0.6540
    train/Accuracy=0.4727
    throughput/total_tokens=6,359,040
    throughput/device/tokens_per_second=27,342
    throughput/device/batches_per_second=1.483
2025-07-16 14:57:09.321	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:57:10.117	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:57:10.920	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:57:11.683	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:57:12.405	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:57:12.694	g3084:0	olmo.train.trainer:817	INFO	[step=350/1000]
    train/CrossEntropyLoss=10.93
    train/ZLoss=0.0140
    train/ImageGenLoss=0.5925
    train/Accuracy=0.4600
    throughput/total_tokens=6,451,200
    throughput/device/tokens_per_second=25,240
    throughput/device/batches_per_second=1.369
    System/Peak GPU Memory (MB)=29,225
2025-07-16 14:57:13.111	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:57:13.829	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:57:14.638	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:57:15.464	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:57:16.250	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:57:16.543	g3084:0	olmo.train.trainer:817	INFO	[step=355/1000]
    train/CrossEntropyLoss=10.98
    train/ZLoss=0.0140
    train/ImageGenLoss=0.5367
    train/Accuracy=0.4737
    throughput/total_tokens=6,543,360
    throughput/device/tokens_per_second=24,791
    throughput/device/batches_per_second=1.345
2025-07-16 14:57:17.276	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:57:18.226	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:57:19.149	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:57:20.003	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:57:20.917	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:57:21.212	g3084:0	olmo.train.trainer:817	INFO	[step=360/1000]
    train/CrossEntropyLoss=10.88
    train/ZLoss=0.0140
    train/ImageGenLoss=0.6135
    train/Accuracy=0.5248
    throughput/total_tokens=6,635,520
    throughput/device/tokens_per_second=23,300
    throughput/device/batches_per_second=1.264
    System/Peak GPU Memory (MB)=29,225
2025-07-16 14:57:21.214	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 14:57:24.641	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 14:57:24.642	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 14:57:24.642	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 3.4 seconds
2025-07-16 14:57:25.466	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:57:26.321	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:57:27.300	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:57:28.501	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:57:29.376	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:57:29.674	g3084:0	olmo.train.trainer:817	INFO	[step=365/1000]
    train/CrossEntropyLoss=10.91
    train/ZLoss=0.0140
    train/ImageGenLoss=0.6423
    train/Accuracy=0.4571
    throughput/total_tokens=6,727,680
    throughput/device/tokens_per_second=21,827
    throughput/device/batches_per_second=1.184
2025-07-16 14:57:30.318	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:57:31.121	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:57:31.960	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:57:32.851	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:57:33.881	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:57:34.177	g3084:0	olmo.train.trainer:817	INFO	[step=370/1000]
    train/CrossEntropyLoss=10.94
    train/ZLoss=0.0140
    train/ImageGenLoss=0.5873
    train/Accuracy=0.4483
    throughput/total_tokens=6,819,840
    throughput/device/tokens_per_second=21,128
    throughput/device/batches_per_second=1.146
    System/Peak GPU Memory (MB)=29,225
2025-07-16 14:57:34.789	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:57:35.967	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:57:36.913	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:57:37.741	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:57:38.677	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:57:38.971	g3084:0	olmo.train.trainer:817	INFO	[step=375/1000]
    train/CrossEntropyLoss=10.87
    train/ZLoss=0.0140
    train/ImageGenLoss=0.6292
    train/Accuracy=0.5238
    throughput/total_tokens=6,912,000
    throughput/device/tokens_per_second=20,451
    throughput/device/batches_per_second=1.110
2025-07-16 14:57:39.539	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:57:40.268	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:57:41.208	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:57:42.106	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:57:42.959	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:57:43.254	g3084:0	olmo.train.trainer:817	INFO	[step=380/1000]
    train/CrossEntropyLoss=10.86
    train/ZLoss=0.0140
    train/ImageGenLoss=0.5309
    train/Accuracy=0.4685
    throughput/total_tokens=7,004,160
    throughput/device/tokens_per_second=20,708
    throughput/device/batches_per_second=1.124
    System/Peak GPU Memory (MB)=29,225
2025-07-16 14:57:43.256	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 14:57:46.666	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 14:57:46.667	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 14:57:46.667	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 3.4 seconds
2025-07-16 14:57:47.219	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:57:48.118	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:57:49.091	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:57:49.928	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:57:50.754	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:57:51.048	g3084:0	olmo.train.trainer:817	INFO	[step=385/1000]
    train/CrossEntropyLoss=10.84
    train/ZLoss=0.0140
    train/ImageGenLoss=0.5975
    train/Accuracy=0.5143
    throughput/total_tokens=7,096,320
    throughput/device/tokens_per_second=23,984
    throughput/device/batches_per_second=1.301
2025-07-16 14:57:51.428	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:57:52.459	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:57:53.277	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:57:54.130	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:57:55.022	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:57:55.316	g3084:0	olmo.train.trainer:817	INFO	[step=390/1000]
    train/CrossEntropyLoss=10.83
    train/ZLoss=0.0140
    train/ImageGenLoss=0.5621
    train/Accuracy=0.5288
    throughput/total_tokens=7,188,480
    throughput/device/tokens_per_second=22,726
    throughput/device/batches_per_second=1.233
    System/Peak GPU Memory (MB)=29,225
2025-07-16 14:57:55.756	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:57:56.686	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:57:57.638	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:57:58.548	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:57:59.405	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:57:59.699	g3084:0	olmo.train.trainer:817	INFO	[step=395/1000]
    train/CrossEntropyLoss=10.80
    train/ZLoss=0.0140
    train/ImageGenLoss=0.6640
    train/Accuracy=0.5253
    throughput/total_tokens=7,280,640
    throughput/device/tokens_per_second=22,129
    throughput/device/batches_per_second=1.201
2025-07-16 14:58:00.234	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:58:01.259	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:58:02.097	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:58:02.871	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:58:03.788	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:58:04.078	g3084:0	olmo.train.trainer:817	INFO	[step=400/1000]
    train/CrossEntropyLoss=10.78
    train/ZLoss=0.0140
    train/ImageGenLoss=0.6794
    train/Accuracy=0.5686
    throughput/total_tokens=7,372,800
    throughput/device/tokens_per_second=21,849
    throughput/device/batches_per_second=1.185
    System/Peak GPU Memory (MB)=29,225
2025-07-16 14:58:04.079	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 14:58:07.515	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 14:58:07.516	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 14:58:07.517	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 3.4 seconds
2025-07-16 14:58:08.102	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:58:08.941	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:58:10.133	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:58:11.258	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:58:12.077	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:58:12.372	g3084:0	olmo.train.trainer:817	INFO	[step=405/1000]
    train/CrossEntropyLoss=10.84
    train/ZLoss=0.0140
    train/ImageGenLoss=0.6989
    train/Accuracy=0.5130
    throughput/total_tokens=7,464,960
    throughput/device/tokens_per_second=21,517
    throughput/device/batches_per_second=1.167
2025-07-16 14:58:12.896	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:58:13.724	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:58:14.541	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:58:15.881	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:58:16.914	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:58:17.208	g3084:0	olmo.train.trainer:817	INFO	[step=410/1000]
    train/CrossEntropyLoss=10.84
    train/ZLoss=0.0140
    train/ImageGenLoss=0.6285
    train/Accuracy=0.5207
    throughput/total_tokens=7,557,120
    throughput/device/tokens_per_second=20,213
    throughput/device/batches_per_second=1.097
    System/Peak GPU Memory (MB)=29,225
2025-07-16 14:58:17.899	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:58:18.890	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:58:19.799	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:58:20.678	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:58:21.598	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:58:21.892	g3084:0	olmo.train.trainer:817	INFO	[step=415/1000]
    train/CrossEntropyLoss=10.76
    train/ZLoss=0.0140
    train/ImageGenLoss=0.6449
    train/Accuracy=0.5556
    throughput/total_tokens=7,649,280
    throughput/device/tokens_per_second=20,030
    throughput/device/batches_per_second=1.087
2025-07-16 14:58:22.477	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:58:23.441	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:58:24.347	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:58:25.150	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:58:26.190	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:58:26.481	g3084:0	olmo.train.trainer:817	INFO	[step=420/1000]
    train/CrossEntropyLoss=10.77
    train/ZLoss=0.0140
    train/ImageGenLoss=0.6439
    train/Accuracy=0.5327
    throughput/total_tokens=7,741,440
    throughput/device/tokens_per_second=20,043
    throughput/device/batches_per_second=1.087
    System/Peak GPU Memory (MB)=29,225
2025-07-16 14:58:26.483	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 14:58:29.971	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 14:58:29.971	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 14:58:29.972	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 3.5 seconds
2025-07-16 14:58:30.712	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:58:31.528	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:58:32.418	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:58:33.344	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:58:34.086	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:58:34.381	g3084:0	olmo.train.trainer:817	INFO	[step=425/1000]
    train/CrossEntropyLoss=10.75
    train/ZLoss=0.0140
    train/ImageGenLoss=0.6239
    train/Accuracy=0.5849
    throughput/total_tokens=7,833,600
    throughput/device/tokens_per_second=25,022
    throughput/device/batches_per_second=1.358
2025-07-16 14:58:34.933	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:58:35.676	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:58:36.471	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:58:37.251	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:58:38.059	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:58:38.354	g3084:0	olmo.train.trainer:817	INFO	[step=430/1000]
    train/CrossEntropyLoss=10.74
    train/ZLoss=0.0140
    train/ImageGenLoss=0.6029
    train/Accuracy=0.5619
    throughput/total_tokens=7,925,760
    throughput/device/tokens_per_second=24,075
    throughput/device/batches_per_second=1.306
    System/Peak GPU Memory (MB)=29,225
2025-07-16 14:58:38.838	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:58:39.547	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:58:40.375	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:58:41.224	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:58:41.976	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:58:42.271	g3084:0	olmo.train.trainer:817	INFO	[step=435/1000]
    train/CrossEntropyLoss=10.78
    train/ZLoss=0.0140
    train/ImageGenLoss=0.5418
    train/Accuracy=0.5246
    throughput/total_tokens=8,017,920
    throughput/device/tokens_per_second=23,888
    throughput/device/batches_per_second=1.296
2025-07-16 14:58:42.803	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:58:43.517	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:58:44.334	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:58:45.110	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:58:45.941	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:58:46.237	g3084:0	olmo.train.trainer:817	INFO	[step=440/1000]
    train/CrossEntropyLoss=10.71
    train/ZLoss=0.0140
    train/ImageGenLoss=0.5917
    train/Accuracy=0.5758
    throughput/total_tokens=8,110,080
    throughput/device/tokens_per_second=23,724
    throughput/device/batches_per_second=1.287
    System/Peak GPU Memory (MB)=29,225
2025-07-16 14:58:46.239	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 14:58:49.653	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 14:58:49.654	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 14:58:49.654	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 3.4 seconds
2025-07-16 14:58:50.256	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:58:51.185	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:58:52.020	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:58:52.940	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:58:53.636	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:58:53.930	g3084:0	olmo.train.trainer:817	INFO	[step=445/1000]
    train/CrossEntropyLoss=10.70
    train/ZLoss=0.0140
    train/ImageGenLoss=0.5990
    train/Accuracy=0.5701
    throughput/total_tokens=8,202,240
    throughput/device/tokens_per_second=24,993
    throughput/device/batches_per_second=1.356
2025-07-16 14:58:54.426	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:58:55.369	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:58:56.184	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:58:57.004	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:58:57.890	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:58:58.181	g3084:0	olmo.train.trainer:817	INFO	[step=450/1000]
    train/CrossEntropyLoss=10.68
    train/ZLoss=0.0140
    train/ImageGenLoss=0.5512
    train/Accuracy=0.5727
    throughput/total_tokens=8,294,400
    throughput/device/tokens_per_second=23,219
    throughput/device/batches_per_second=1.260
    System/Peak GPU Memory (MB)=29,225
2025-07-16 14:58:59.113	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:59:00.060	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:59:00.915	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:59:01.936	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:59:02.816	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:59:03.109	g3084:0	olmo.train.trainer:817	INFO	[step=455/1000]
    train/CrossEntropyLoss=10.71
    train/ZLoss=0.0140
    train/ImageGenLoss=0.5946
    train/Accuracy=0.5487
    throughput/total_tokens=8,386,560
    throughput/device/tokens_per_second=21,488
    throughput/device/batches_per_second=1.166
2025-07-16 14:59:03.665	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:59:04.638	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:59:05.522	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:59:06.628	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:59:07.404	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:59:07.692	g3084:0	olmo.train.trainer:817	INFO	[step=460/1000]
    train/CrossEntropyLoss=10.69
    train/ZLoss=0.0139
    train/ImageGenLoss=0.5556
    train/Accuracy=0.5826
    throughput/total_tokens=8,478,720
    throughput/device/tokens_per_second=21,126
    throughput/device/batches_per_second=1.146
    System/Peak GPU Memory (MB)=29,225
2025-07-16 14:59:07.693	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 14:59:10.993	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 14:59:10.994	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 14:59:10.994	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 3.3 seconds
2025-07-16 14:59:11.770	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:59:13.290	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:59:14.105	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:59:15.219	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:59:16.667	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:59:16.961	g3084:0	olmo.train.trainer:817	INFO	[step=465/1000]
    train/CrossEntropyLoss=10.69
    train/ZLoss=0.0139
    train/ImageGenLoss=0.6403
    train/Accuracy=0.5656
    throughput/total_tokens=8,570,880
    throughput/device/tokens_per_second=17,709
    throughput/device/batches_per_second=0.9608
2025-07-16 14:59:17.736	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:59:18.719	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:59:19.933	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:59:20.832	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:59:21.746	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:59:22.039	g3084:0	olmo.train.trainer:817	INFO	[step=470/1000]
    train/CrossEntropyLoss=10.71
    train/ZLoss=0.0139
    train/ImageGenLoss=0.5533
    train/Accuracy=0.5470
    throughput/total_tokens=8,663,040
    throughput/device/tokens_per_second=17,926
    throughput/device/batches_per_second=0.9726
    System/Peak GPU Memory (MB)=29,225
2025-07-16 14:59:22.468	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:59:23.212	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:59:24.098	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:59:24.906	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:59:25.699	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:59:25.993	g3084:0	olmo.train.trainer:817	INFO	[step=475/1000]
    train/CrossEntropyLoss=10.60
    train/ZLoss=0.0139
    train/ImageGenLoss=0.5677
    train/Accuracy=0.5644
    throughput/total_tokens=8,755,200
    throughput/device/tokens_per_second=19,421
    throughput/device/batches_per_second=1.054
2025-07-16 14:59:26.618	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:59:27.445	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:59:28.304	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:59:29.372	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:59:30.210	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:59:30.506	g3084:0	olmo.train.trainer:817	INFO	[step=480/1000]
    train/CrossEntropyLoss=10.64
    train/ZLoss=0.0139
    train/ImageGenLoss=0.6466
    train/Accuracy=0.5556
    throughput/total_tokens=8,847,360
    throughput/device/tokens_per_second=19,663
    throughput/device/batches_per_second=1.067
    System/Peak GPU Memory (MB)=29,225
2025-07-16 14:59:30.507	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 14:59:33.859	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 14:59:33.860	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 14:59:33.860	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 3.4 seconds
2025-07-16 14:59:34.556	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:59:35.600	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:59:36.543	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:59:37.623	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:59:38.805	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:59:39.097	g3084:0	olmo.train.trainer:817	INFO	[step=485/1000]
    train/CrossEntropyLoss=10.64
    train/ZLoss=0.0139
    train/ImageGenLoss=0.6201
    train/Accuracy=0.5526
    throughput/total_tokens=8,939,520
    throughput/device/tokens_per_second=20,233
    throughput/device/batches_per_second=1.098
2025-07-16 14:59:39.659	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:59:40.512	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:59:41.364	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:59:42.140	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:59:42.918	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:59:43.212	g3084:0	olmo.train.trainer:817	INFO	[step=490/1000]
    train/CrossEntropyLoss=10.63
    train/ZLoss=0.0139
    train/ImageGenLoss=0.6635
    train/Accuracy=0.5229
    throughput/total_tokens=9,031,680
    throughput/device/tokens_per_second=21,258
    throughput/device/batches_per_second=1.153
    System/Peak GPU Memory (MB)=29,225
2025-07-16 14:59:43.678	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:59:44.650	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:59:45.522	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:59:46.590	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:59:47.414	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:59:47.709	g3084:0	olmo.train.trainer:817	INFO	[step=495/1000]
    train/CrossEntropyLoss=10.61
    train/ZLoss=0.0139
    train/ImageGenLoss=0.5399
    train/Accuracy=0.5888
    throughput/total_tokens=9,123,840
    throughput/device/tokens_per_second=20,997
    throughput/device/batches_per_second=1.139
2025-07-16 14:59:48.370	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:59:49.750	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:59:50.835	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:59:51.715	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:59:52.572	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:59:52.866	g3084:0	olmo.train.trainer:817	INFO	[step=500/1000]
    train/CrossEntropyLoss=10.63
    train/ZLoss=0.0139
    train/ImageGenLoss=0.5370
    train/Accuracy=0.5739
    throughput/total_tokens=9,216,000
    throughput/device/tokens_per_second=20,117
    throughput/device/batches_per_second=1.091
    System/Peak GPU Memory (MB)=29,225
2025-07-16 14:59:52.868	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 14:59:56.242	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 14:59:56.243	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 14:59:56.243	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 3.4 seconds
2025-07-16 14:59:56.719	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:59:57.614	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:59:58.433	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:59:59.184	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 14:59:59.964	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:00:00.256	g3084:0	olmo.train.trainer:817	INFO	[step=505/1000]
    train/CrossEntropyLoss=10.64
    train/ZLoss=0.0139
    train/ImageGenLoss=0.5522
    train/Accuracy=0.5556
    throughput/total_tokens=9,308,160
    throughput/device/tokens_per_second=25,958
    throughput/device/batches_per_second=1.408
2025-07-16 15:00:00.699	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:00:01.478	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:00:02.370	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:00:03.148	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:00:03.965	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:00:04.258	g3084:0	olmo.train.trainer:817	INFO	[step=510/1000]
    train/CrossEntropyLoss=10.61
    train/ZLoss=0.0139
    train/ImageGenLoss=0.5398
    train/Accuracy=0.5664
    throughput/total_tokens=9,400,320
    throughput/device/tokens_per_second=24,406
    throughput/device/batches_per_second=1.324
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:00:04.978	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:00:05.891	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:00:06.748	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:00:07.623	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:00:08.531	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:00:08.822	g3084:0	olmo.train.trainer:817	INFO	[step=515/1000]
    train/CrossEntropyLoss=10.56
    train/ZLoss=0.0139
    train/ImageGenLoss=0.5073
    train/Accuracy=0.5514
    throughput/total_tokens=9,492,480
    throughput/device/tokens_per_second=22,818
    throughput/device/batches_per_second=1.238
2025-07-16 15:00:09.293	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:00:10.051	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:00:10.851	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:00:11.700	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:00:12.469	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:00:12.763	g3084:0	olmo.train.trainer:817	INFO	[step=520/1000]
    train/CrossEntropyLoss=10.53
    train/ZLoss=0.0139
    train/ImageGenLoss=0.5518
    train/Accuracy=0.5895
    throughput/total_tokens=9,584,640
    throughput/device/tokens_per_second=22,958
    throughput/device/batches_per_second=1.246
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:00:12.765	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 15:00:16.118	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 15:00:16.119	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 15:00:16.119	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 3.4 seconds
2025-07-16 15:00:16.651	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:00:17.520	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:00:18.359	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:00:19.240	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:00:20.238	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:00:20.529	g3084:0	olmo.train.trainer:817	INFO	[step=525/1000]
    train/CrossEntropyLoss=10.55
    train/ZLoss=0.0139
    train/ImageGenLoss=0.5125
    train/Accuracy=0.5648
    throughput/total_tokens=9,676,800
    throughput/device/tokens_per_second=23,683
    throughput/device/batches_per_second=1.285
2025-07-16 15:00:21.034	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:00:21.918	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:00:22.876	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:00:23.688	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:00:24.398	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:00:24.688	g3084:0	olmo.train.trainer:817	INFO	[step=530/1000]
    train/CrossEntropyLoss=10.53
    train/ZLoss=0.0139
    train/ImageGenLoss=0.5716
    train/Accuracy=0.5577
    throughput/total_tokens=9,768,960
    throughput/device/tokens_per_second=22,896
    throughput/device/batches_per_second=1.242
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:00:25.165	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:00:25.839	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:00:26.639	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:00:27.466	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:00:28.335	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:00:28.630	g3084:0	olmo.train.trainer:817	INFO	[step=535/1000]
    train/CrossEntropyLoss=10.58
    train/ZLoss=0.0139
    train/ImageGenLoss=0.5958
    train/Accuracy=0.5610
    throughput/total_tokens=9,861,120
    throughput/device/tokens_per_second=23,055
    throughput/device/batches_per_second=1.251
2025-07-16 15:00:29.096	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:00:30.073	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:00:31.085	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:00:31.922	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:00:32.839	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:00:33.130	g3084:0	olmo.train.trainer:817	INFO	[step=540/1000]
    train/CrossEntropyLoss=10.50
    train/ZLoss=0.0139
    train/ImageGenLoss=0.6321
    train/Accuracy=0.5825
    throughput/total_tokens=9,953,280
    throughput/device/tokens_per_second=22,352
    throughput/device/batches_per_second=1.213
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:00:33.131	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 15:00:36.560	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 15:00:36.561	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 15:00:36.562	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 3.4 seconds
2025-07-16 15:00:37.287	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:00:38.030	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:00:38.928	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:00:39.804	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:00:40.666	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:00:40.960	g3084:0	olmo.train.trainer:817	INFO	[step=545/1000]
    train/CrossEntropyLoss=10.56
    train/ZLoss=0.0139
    train/ImageGenLoss=0.6546
    train/Accuracy=0.5526
    throughput/total_tokens=10,045,440
    throughput/device/tokens_per_second=24,994
    throughput/device/batches_per_second=1.356
2025-07-16 15:00:41.808	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:00:42.722	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:00:43.455	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:00:44.554	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:00:45.481	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:00:45.778	g3084:0	olmo.train.trainer:817	INFO	[step=550/1000]
    train/CrossEntropyLoss=10.49
    train/ZLoss=0.0139
    train/ImageGenLoss=0.5849
    train/Accuracy=0.5926
    throughput/total_tokens=10,137,600
    throughput/device/tokens_per_second=21,674
    throughput/device/batches_per_second=1.176
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:00:46.509	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:00:48.070	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:00:48.857	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:00:49.610	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:00:50.460	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:00:50.756	g3084:0	olmo.train.trainer:817	INFO	[step=555/1000]
    train/CrossEntropyLoss=10.48
    train/ZLoss=0.0139
    train/ImageGenLoss=0.6196
    train/Accuracy=0.5686
    throughput/total_tokens=10,229,760
    throughput/device/tokens_per_second=20,505
    throughput/device/batches_per_second=1.113
2025-07-16 15:00:51.335	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:00:52.108	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:00:53.141	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:00:54.069	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:00:54.803	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:00:55.098	g3084:0	olmo.train.trainer:817	INFO	[step=560/1000]
    train/CrossEntropyLoss=10.49
    train/ZLoss=0.0139
    train/ImageGenLoss=0.6500
    train/Accuracy=0.6078
    throughput/total_tokens=10,321,920
    throughput/device/tokens_per_second=20,681
    throughput/device/batches_per_second=1.122
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:00:55.100	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 15:00:58.587	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 15:00:58.588	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 15:00:58.589	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 3.5 seconds
2025-07-16 15:00:59.072	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:00:59.895	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:01:00.706	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:01:01.649	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:01:02.452	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:01:02.753	g3084:0	olmo.train.trainer:817	INFO	[step=565/1000]
    train/CrossEntropyLoss=10.45
    train/ZLoss=0.0139
    train/ImageGenLoss=0.5868
    train/Accuracy=0.5773
    throughput/total_tokens=10,414,080
    throughput/device/tokens_per_second=24,948
    throughput/device/batches_per_second=1.354
2025-07-16 15:01:03.305	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:01:04.043	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:01:04.916	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:01:05.842	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:01:06.629	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:01:06.925	g3084:0	olmo.train.trainer:817	INFO	[step=570/1000]
    train/CrossEntropyLoss=10.48
    train/ZLoss=0.0139
    train/ImageGenLoss=0.6404
    train/Accuracy=0.5340
    throughput/total_tokens=10,506,240
    throughput/device/tokens_per_second=23,433
    throughput/device/batches_per_second=1.271
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:01:07.487	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:01:08.315	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:01:09.045	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:01:09.817	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:01:10.617	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:01:10.910	g3084:0	olmo.train.trainer:817	INFO	[step=575/1000]
    train/CrossEntropyLoss=10.53
    train/ZLoss=0.0139
    train/ImageGenLoss=0.6140
    train/Accuracy=0.5948
    throughput/total_tokens=10,598,400
    throughput/device/tokens_per_second=23,328
    throughput/device/batches_per_second=1.266
2025-07-16 15:01:11.587	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:01:12.377	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:01:13.155	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:01:13.887	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:01:14.665	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:01:14.959	g3084:0	olmo.train.trainer:817	INFO	[step=580/1000]
    train/CrossEntropyLoss=10.43
    train/ZLoss=0.0139
    train/ImageGenLoss=0.5594
    train/Accuracy=0.5900
    throughput/total_tokens=10,690,560
    throughput/device/tokens_per_second=23,184
    throughput/device/batches_per_second=1.258
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:01:14.961	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 15:01:18.473	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 15:01:18.474	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 15:01:18.474	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 3.5 seconds
2025-07-16 15:01:19.040	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:01:19.775	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:01:20.953	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:01:21.792	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:01:22.790	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:01:23.085	g3084:0	olmo.train.trainer:817	INFO	[step=585/1000]
    train/CrossEntropyLoss=10.45
    train/ZLoss=0.0139
    train/ImageGenLoss=0.5432
    train/Accuracy=0.6095
    throughput/total_tokens=10,782,720
    throughput/device/tokens_per_second=22,711
    throughput/device/batches_per_second=1.232
2025-07-16 15:01:23.651	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:01:24.535	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:01:25.487	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:01:26.272	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:01:27.255	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:01:27.551	g3084:0	olmo.train.trainer:817	INFO	[step=590/1000]
    train/CrossEntropyLoss=10.44
    train/ZLoss=0.0139
    train/ImageGenLoss=0.5495
    train/Accuracy=0.6095
    throughput/total_tokens=10,874,880
    throughput/device/tokens_per_second=21,624
    throughput/device/batches_per_second=1.173
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:01:28.030	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:01:28.949	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:01:29.760	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:01:30.709	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:01:31.488	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:01:31.783	g3084:0	olmo.train.trainer:817	INFO	[step=595/1000]
    train/CrossEntropyLoss=10.45
    train/ZLoss=0.0139
    train/ImageGenLoss=0.6579
    train/Accuracy=0.6036
    throughput/total_tokens=10,967,040
    throughput/device/tokens_per_second=21,674
    throughput/device/batches_per_second=1.176
2025-07-16 15:01:32.221	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:01:33.085	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:01:33.848	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:01:34.784	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:01:35.517	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:01:35.812	g3084:0	olmo.train.trainer:817	INFO	[step=600/1000]
    train/CrossEntropyLoss=10.44
    train/ZLoss=0.0139
    train/ImageGenLoss=0.6485
    train/Accuracy=0.6034
    throughput/total_tokens=11,059,200
    throughput/device/tokens_per_second=21,963
    throughput/device/batches_per_second=1.192
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:01:35.814	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 15:01:39.230	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 15:01:39.231	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 15:01:39.231	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 3.4 seconds
2025-07-16 15:01:39.961	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:01:40.756	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:01:41.619	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:01:42.624	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:01:43.553	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:01:43.848	g3084:0	olmo.train.trainer:817	INFO	[step=605/1000]
    train/CrossEntropyLoss=10.43
    train/ZLoss=0.0139
    train/ImageGenLoss=0.6467
    train/Accuracy=0.6019
    throughput/total_tokens=11,151,360
    throughput/device/tokens_per_second=23,631
    throughput/device/batches_per_second=1.282
2025-07-16 15:01:44.402	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:01:45.207	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:01:46.087	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:01:46.818	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:01:47.641	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:01:47.935	g3084:0	olmo.train.trainer:817	INFO	[step=610/1000]
    train/CrossEntropyLoss=10.46
    train/ZLoss=0.0139
    train/ImageGenLoss=0.5966
    train/Accuracy=0.6000
    throughput/total_tokens=11,243,520
    throughput/device/tokens_per_second=23,077
    throughput/device/batches_per_second=1.252
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:01:48.396	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:01:49.265	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:01:50.127	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:01:50.897	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:01:51.732	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:01:52.028	g3084:0	olmo.train.trainer:817	INFO	[step=615/1000]
    train/CrossEntropyLoss=10.37
    train/ZLoss=0.0139
    train/ImageGenLoss=0.6028
    train/Accuracy=0.6224
    throughput/total_tokens=11,335,680
    throughput/device/tokens_per_second=22,888
    throughput/device/batches_per_second=1.242
2025-07-16 15:01:52.511	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:01:53.332	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:01:54.118	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:01:54.897	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:01:55.639	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:01:55.933	g3084:0	olmo.train.trainer:817	INFO	[step=620/1000]
    train/CrossEntropyLoss=10.37
    train/ZLoss=0.0139
    train/ImageGenLoss=0.5263
    train/Accuracy=0.6117
    throughput/total_tokens=11,427,840
    throughput/device/tokens_per_second=23,061
    throughput/device/batches_per_second=1.251
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:01:55.935	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 15:01:59.331	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 15:01:59.332	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 15:01:59.332	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 3.4 seconds
2025-07-16 15:01:59.879	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:02:00.811	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:02:01.489	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:02:02.216	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:02:03.012	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:02:03.304	g3084:0	olmo.train.trainer:817	INFO	[step=625/1000]
    train/CrossEntropyLoss=10.41
    train/ZLoss=0.0139
    train/ImageGenLoss=0.5225
    train/Accuracy=0.6000
    throughput/total_tokens=11,520,000
    throughput/device/tokens_per_second=26,797
    throughput/device/batches_per_second=1.454
2025-07-16 15:02:03.737	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:02:04.435	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:02:05.147	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:02:05.981	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:02:06.832	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:02:07.127	g3084:0	olmo.train.trainer:817	INFO	[step=630/1000]
    train/CrossEntropyLoss=10.39
    train/ZLoss=0.0138
    train/ImageGenLoss=0.6165
    train/Accuracy=0.6075
    throughput/total_tokens=11,612,160
    throughput/device/tokens_per_second=25,384
    throughput/device/batches_per_second=1.377
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:02:07.555	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:02:08.481	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:02:09.286	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:02:10.139	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:02:10.884	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:02:11.173	g3084:0	olmo.train.trainer:817	INFO	[step=635/1000]
    train/CrossEntropyLoss=10.42
    train/ZLoss=0.0138
    train/ImageGenLoss=0.5947
    train/Accuracy=0.6226
    throughput/total_tokens=11,704,320
    throughput/device/tokens_per_second=24,450
    throughput/device/batches_per_second=1.326
2025-07-16 15:02:11.728	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:02:12.725	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:02:13.467	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:02:14.128	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:02:14.843	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:02:15.137	g3084:0	olmo.train.trainer:817	INFO	[step=640/1000]
    train/CrossEntropyLoss=10.39
    train/ZLoss=0.0138
    train/ImageGenLoss=0.6152
    train/Accuracy=0.5983
    throughput/total_tokens=11,796,480
    throughput/device/tokens_per_second=24,140
    throughput/device/batches_per_second=1.310
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:02:15.138	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 15:02:18.527	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 15:02:18.528	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 15:02:18.529	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 3.4 seconds
2025-07-16 15:02:19.101	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:02:19.830	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:02:20.579	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:02:21.382	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:02:22.235	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:02:22.528	g3084:0	olmo.train.trainer:817	INFO	[step=645/1000]
    train/CrossEntropyLoss=10.37
    train/ZLoss=0.0138
    train/ImageGenLoss=0.6158
    train/Accuracy=0.6147
    throughput/total_tokens=11,888,640
    throughput/device/tokens_per_second=26,788
    throughput/device/batches_per_second=1.453
2025-07-16 15:02:22.995	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:02:23.734	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:02:24.474	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:02:25.214	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:02:25.988	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:02:26.282	g3084:0	olmo.train.trainer:817	INFO	[step=650/1000]
    train/CrossEntropyLoss=10.38
    train/ZLoss=0.0138
    train/ImageGenLoss=0.6182
    train/Accuracy=0.6106
    throughput/total_tokens=11,980,800
    throughput/device/tokens_per_second=25,623
    throughput/device/batches_per_second=1.390
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:02:26.748	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:02:27.518	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:02:28.194	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:02:29.057	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:02:29.716	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:02:30.004	g3084:0	olmo.train.trainer:817	INFO	[step=655/1000]
    train/CrossEntropyLoss=10.39
    train/ZLoss=0.0138
    train/ImageGenLoss=0.5505
    train/Accuracy=0.5943
    throughput/total_tokens=12,072,960
    throughput/device/tokens_per_second=25,327
    throughput/device/batches_per_second=1.374
2025-07-16 15:02:30.496	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:02:31.275	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:02:32.176	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:02:32.845	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:02:33.602	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:02:33.897	g3084:0	olmo.train.trainer:817	INFO	[step=660/1000]
    train/CrossEntropyLoss=10.32
    train/ZLoss=0.0138
    train/ImageGenLoss=0.5452
    train/Accuracy=0.5825
    throughput/total_tokens=12,165,120
    throughput/device/tokens_per_second=24,894
    throughput/device/batches_per_second=1.351
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:02:33.898	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 15:02:37.272	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 15:02:37.272	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 15:02:37.273	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 3.4 seconds
2025-07-16 15:02:37.726	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:02:38.547	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:02:39.314	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:02:40.097	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:02:40.986	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:02:41.280	g3084:0	olmo.train.trainer:817	INFO	[step=665/1000]
    train/CrossEntropyLoss=10.37
    train/ZLoss=0.0138
    train/ImageGenLoss=0.5818
    train/Accuracy=0.5929
    throughput/total_tokens=12,257,280
    throughput/device/tokens_per_second=25,820
    throughput/device/batches_per_second=1.401
2025-07-16 15:02:41.697	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:02:42.553	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:02:43.260	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:02:44.118	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:02:45.031	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:02:45.321	g3084:0	olmo.train.trainer:817	INFO	[step=670/1000]
    train/CrossEntropyLoss=10.34
    train/ZLoss=0.0138
    train/ImageGenLoss=0.5572
    train/Accuracy=0.6190
    throughput/total_tokens=12,349,440
    throughput/device/tokens_per_second=24,223
    throughput/device/batches_per_second=1.314
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:02:45.757	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:02:46.687	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:02:47.452	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:02:48.272	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:02:48.989	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:02:49.282	g3084:0	olmo.train.trainer:817	INFO	[step=675/1000]
    train/CrossEntropyLoss=10.30
    train/ZLoss=0.0138
    train/ImageGenLoss=0.6138
    train/Accuracy=0.6535
    throughput/total_tokens=12,441,600
    throughput/device/tokens_per_second=23,895
    throughput/device/batches_per_second=1.296
2025-07-16 15:02:49.726	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:02:50.529	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:02:51.263	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:02:52.125	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:02:52.860	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:02:53.151	g3084:0	olmo.train.trainer:817	INFO	[step=680/1000]
    train/CrossEntropyLoss=10.32
    train/ZLoss=0.0138
    train/ImageGenLoss=0.6238
    train/Accuracy=0.5909
    throughput/total_tokens=12,533,760
    throughput/device/tokens_per_second=23,876
    throughput/device/batches_per_second=1.295
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:02:53.153	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 15:02:56.622	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 15:02:56.623	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 15:02:56.624	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 3.5 seconds
2025-07-16 15:02:57.113	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:02:57.957	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:02:58.785	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:02:59.644	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:03:00.443	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:03:00.736	g3084:0	olmo.train.trainer:817	INFO	[step=685/1000]
    train/CrossEntropyLoss=10.37
    train/ZLoss=0.0138
    train/ImageGenLoss=0.6415
    train/Accuracy=0.6034
    throughput/total_tokens=12,625,920
    throughput/device/tokens_per_second=25,337
    throughput/device/batches_per_second=1.375
2025-07-16 15:03:01.151	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:03:01.884	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:03:02.765	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:03:03.550	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:03:04.591	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:03:04.883	g3084:0	olmo.train.trainer:817	INFO	[step=690/1000]
    train/CrossEntropyLoss=10.36
    train/ZLoss=0.0138
    train/ImageGenLoss=0.5773
    train/Accuracy=0.6050
    throughput/total_tokens=12,718,080
    throughput/device/tokens_per_second=23,682
    throughput/device/batches_per_second=1.285
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:03:05.576	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:03:06.394	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:03:07.241	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:03:07.977	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:03:08.714	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:03:09.008	g3084:0	olmo.train.trainer:817	INFO	[step=695/1000]
    train/CrossEntropyLoss=10.33
    train/ZLoss=0.0138
    train/ImageGenLoss=0.5818
    train/Accuracy=0.6182
    throughput/total_tokens=12,810,240
    throughput/device/tokens_per_second=23,217
    throughput/device/batches_per_second=1.260
2025-07-16 15:03:09.558	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:03:10.414	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:03:11.163	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:03:11.857	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:03:12.628	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:03:12.920	g3084:0	olmo.train.trainer:817	INFO	[step=700/1000]
    train/CrossEntropyLoss=10.31
    train/ZLoss=0.0138
    train/ImageGenLoss=0.6095
    train/Accuracy=0.6161
    throughput/total_tokens=12,902,400
    throughput/device/tokens_per_second=23,301
    throughput/device/batches_per_second=1.264
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:03:12.922	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 15:03:16.358	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 15:03:16.359	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 15:03:16.359	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 3.4 seconds
2025-07-16 15:03:16.813	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:03:17.521	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:03:18.289	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:03:19.017	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:03:19.877	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:03:20.171	g3084:0	olmo.train.trainer:817	INFO	[step=705/1000]
    train/CrossEntropyLoss=10.30
    train/ZLoss=0.0138
    train/ImageGenLoss=0.5571
    train/Accuracy=0.6100
    throughput/total_tokens=12,994,560
    throughput/device/tokens_per_second=27,332
    throughput/device/batches_per_second=1.483
2025-07-16 15:03:20.913	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:03:21.639	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:03:22.476	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:03:23.249	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:03:24.023	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:03:24.315	g3084:0	olmo.train.trainer:817	INFO	[step=710/1000]
    train/CrossEntropyLoss=10.27
    train/ZLoss=0.0138
    train/ImageGenLoss=0.5111
    train/Accuracy=0.5870
    throughput/total_tokens=13,086,720
    throughput/device/tokens_per_second=24,525
    throughput/device/batches_per_second=1.331
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:03:24.945	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:03:25.750	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:03:26.455	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:03:27.284	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:03:28.174	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:03:28.464	g3084:0	olmo.train.trainer:817	INFO	[step=715/1000]
    train/CrossEntropyLoss=10.26
    train/ZLoss=0.0138
    train/ImageGenLoss=0.6048
    train/Accuracy=0.6364
    throughput/total_tokens=13,178,880
    throughput/device/tokens_per_second=23,701
    throughput/device/batches_per_second=1.286
2025-07-16 15:03:29.061	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:03:29.806	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:03:30.566	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:03:31.348	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:03:32.085	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:03:32.379	g3084:0	olmo.train.trainer:817	INFO	[step=720/1000]
    train/CrossEntropyLoss=10.20
    train/ZLoss=0.0138
    train/ImageGenLoss=0.5620
    train/Accuracy=0.6264
    throughput/total_tokens=13,271,040
    throughput/device/tokens_per_second=23,662
    throughput/device/batches_per_second=1.284
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:03:32.381	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 15:03:35.786	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 15:03:35.787	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 15:03:35.787	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 3.4 seconds
2025-07-16 15:03:36.249	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:03:37.048	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:03:37.782	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:03:38.634	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:03:39.346	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:03:39.638	g3084:0	olmo.train.trainer:817	INFO	[step=725/1000]
    train/CrossEntropyLoss=10.28
    train/ZLoss=0.0138
    train/ImageGenLoss=0.5734
    train/Accuracy=0.6170
    throughput/total_tokens=13,363,200
    throughput/device/tokens_per_second=27,088
    throughput/device/batches_per_second=1.470
2025-07-16 15:03:40.102	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:03:40.871	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:03:41.557	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:03:42.242	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:03:43.020	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:03:43.311	g3084:0	olmo.train.trainer:817	INFO	[step=730/1000]
    train/CrossEntropyLoss=10.27
    train/ZLoss=0.0138
    train/ImageGenLoss=0.4844
    train/Accuracy=0.5789
    throughput/total_tokens=13,455,360
    throughput/device/tokens_per_second=26,054
    throughput/device/batches_per_second=1.414
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:03:43.795	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:03:44.672	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:03:45.399	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:03:46.101	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:03:46.875	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:03:47.169	g3084:0	olmo.train.trainer:817	INFO	[step=735/1000]
    train/CrossEntropyLoss=10.30
    train/ZLoss=0.0138
    train/ImageGenLoss=0.5823
    train/Accuracy=0.6238
    throughput/total_tokens=13,547,520
    throughput/device/tokens_per_second=25,288
    throughput/device/batches_per_second=1.372
2025-07-16 15:03:47.613	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:03:48.371	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:03:49.222	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:03:49.946	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:03:50.742	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:03:51.032	g3084:0	olmo.train.trainer:817	INFO	[step=740/1000]
    train/CrossEntropyLoss=10.27
    train/ZLoss=0.0138
    train/ImageGenLoss=0.5518
    train/Accuracy=0.6216
    throughput/total_tokens=13,639,680
    throughput/device/tokens_per_second=24,914
    throughput/device/batches_per_second=1.352
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:03:51.034	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 15:03:54.455	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 15:03:54.456	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 15:03:54.456	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 3.4 seconds
2025-07-16 15:03:55.062	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:03:55.830	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:03:56.755	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:03:57.446	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:03:58.318	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:03:58.612	g3084:0	olmo.train.trainer:817	INFO	[step=745/1000]
    train/CrossEntropyLoss=10.25
    train/ZLoss=0.0138
    train/ImageGenLoss=0.6409
    train/Accuracy=0.5888
    throughput/total_tokens=13,731,840
    throughput/device/tokens_per_second=25,865
    throughput/device/batches_per_second=1.403
2025-07-16 15:03:59.081	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:03:59.858	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:04:00.580	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:04:01.453	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:04:02.282	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:04:02.570	g3084:0	olmo.train.trainer:817	INFO	[step=750/1000]
    train/CrossEntropyLoss=10.30
    train/ZLoss=0.0138
    train/ImageGenLoss=0.5353
    train/Accuracy=0.6000
    throughput/total_tokens=13,824,000
    throughput/device/tokens_per_second=24,507
    throughput/device/batches_per_second=1.330
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:04:03.058	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:04:03.884	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:04:04.657	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:04:05.472	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:04:06.266	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:04:06.558	g3084:0	olmo.train.trainer:817	INFO	[step=755/1000]
    train/CrossEntropyLoss=10.24
    train/ZLoss=0.0138
    train/ImageGenLoss=0.5607
    train/Accuracy=0.6538
    throughput/total_tokens=13,916,160
    throughput/device/tokens_per_second=24,021
    throughput/device/batches_per_second=1.303
2025-07-16 15:04:06.988	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:04:07.783	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:04:08.488	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:04:09.205	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:04:10.172	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:04:10.464	g3084:0	olmo.train.trainer:817	INFO	[step=760/1000]
    train/CrossEntropyLoss=10.27
    train/ZLoss=0.0138
    train/ImageGenLoss=0.5515
    train/Accuracy=0.5872
    throughput/total_tokens=14,008,320
    throughput/device/tokens_per_second=23,914
    throughput/device/batches_per_second=1.297
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:04:10.465	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 15:04:13.892	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 15:04:13.893	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 15:04:13.893	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 3.4 seconds
2025-07-16 15:04:14.347	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:04:15.135	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:04:15.871	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:04:16.540	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:04:17.338	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:04:17.630	g3084:0	olmo.train.trainer:817	INFO	[step=765/1000]
    train/CrossEntropyLoss=10.29
    train/ZLoss=0.0138
    train/ImageGenLoss=0.5887
    train/Accuracy=0.6260
    throughput/total_tokens=14,100,480
    throughput/device/tokens_per_second=27,956
    throughput/device/batches_per_second=1.517
2025-07-16 15:04:18.069	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:04:18.823	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:04:19.537	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:04:20.377	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:04:21.094	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:04:21.389	g3084:0	olmo.train.trainer:817	INFO	[step=770/1000]
    train/CrossEntropyLoss=10.29
    train/ZLoss=0.0138
    train/ImageGenLoss=0.6357
    train/Accuracy=0.6075
    throughput/total_tokens=14,192,640
    throughput/device/tokens_per_second=26,127
    throughput/device/batches_per_second=1.418
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:04:21.924	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:04:22.679	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:04:23.395	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:04:24.134	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:04:24.853	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:04:25.146	g3084:0	olmo.train.trainer:817	INFO	[step=775/1000]
    train/CrossEntropyLoss=10.24
    train/ZLoss=0.0138
    train/ImageGenLoss=0.5514
    train/Accuracy=0.6020
    throughput/total_tokens=14,284,800
    throughput/device/tokens_per_second=25,571
    throughput/device/batches_per_second=1.387
2025-07-16 15:04:25.672	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:04:26.397	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:04:27.104	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:04:27.845	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:04:28.619	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:04:28.913	g3084:0	olmo.train.trainer:817	INFO	[step=780/1000]
    train/CrossEntropyLoss=10.28
    train/ZLoss=0.0138
    train/ImageGenLoss=0.5684
    train/Accuracy=0.6126
    throughput/total_tokens=14,376,960
    throughput/device/tokens_per_second=25,285
    throughput/device/batches_per_second=1.372
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:04:28.915	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 15:04:32.386	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 15:04:32.386	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 15:04:32.387	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 3.5 seconds
2025-07-16 15:04:32.983	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:04:33.725	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:04:34.504	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:04:35.367	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:04:36.145	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:04:36.437	g3084:0	olmo.train.trainer:817	INFO	[step=785/1000]
    train/CrossEntropyLoss=10.21
    train/ZLoss=0.0138
    train/ImageGenLoss=0.5218
    train/Accuracy=0.5941
    throughput/total_tokens=14,469,120
    throughput/device/tokens_per_second=26,579
    throughput/device/batches_per_second=1.442
2025-07-16 15:04:37.039	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:04:37.970	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:04:38.763	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:04:39.545	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:04:40.250	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:04:40.542	g3084:0	olmo.train.trainer:817	INFO	[step=790/1000]
    train/CrossEntropyLoss=10.23
    train/ZLoss=0.0138
    train/ImageGenLoss=0.5182
    train/Accuracy=0.6042
    throughput/total_tokens=14,561,280
    throughput/device/tokens_per_second=24,341
    throughput/device/batches_per_second=1.321
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:04:40.944	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:04:41.621	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:04:42.297	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:04:43.013	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:04:43.883	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:04:44.177	g3084:0	olmo.train.trainer:817	INFO	[step=795/1000]
    train/CrossEntropyLoss=10.27
    train/ZLoss=0.0138
    train/ImageGenLoss=0.5845
    train/Accuracy=0.6296
    throughput/total_tokens=14,653,440
    throughput/device/tokens_per_second=24,669
    throughput/device/batches_per_second=1.338
2025-07-16 15:04:44.813	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:04:45.580	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:04:46.348	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:04:47.155	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:04:47.885	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:04:48.181	g3084:0	olmo.train.trainer:817	INFO	[step=800/1000]
    train/CrossEntropyLoss=10.22
    train/ZLoss=0.0138
    train/ImageGenLoss=0.5282
    train/Accuracy=0.6344
    throughput/total_tokens=14,745,600
    throughput/device/tokens_per_second=24,235
    throughput/device/batches_per_second=1.315
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:04:48.183	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 15:04:51.759	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 15:04:51.760	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 15:04:51.760	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 3.6 seconds
2025-07-16 15:04:52.277	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:04:52.961	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:04:53.720	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:04:54.457	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:04:55.254	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:04:55.544	g3084:0	olmo.train.trainer:817	INFO	[step=805/1000]
    train/CrossEntropyLoss=10.28
    train/ZLoss=0.0138
    train/ImageGenLoss=0.5909
    train/Accuracy=0.6038
    throughput/total_tokens=14,837,760
    throughput/device/tokens_per_second=28,087
    throughput/device/batches_per_second=1.524
2025-07-16 15:04:56.004	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:04:56.815	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:04:57.510	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:04:58.314	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:04:59.030	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:04:59.324	g3084:0	olmo.train.trainer:817	INFO	[step=810/1000]
    train/CrossEntropyLoss=10.23
    train/ZLoss=0.0138
    train/ImageGenLoss=0.5717
    train/Accuracy=0.6214
    throughput/total_tokens=14,929,920
    throughput/device/tokens_per_second=26,106
    throughput/device/batches_per_second=1.416
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:04:59.748	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:05:00.429	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:05:01.174	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:05:01.883	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:05:02.644	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:05:02.939	g3084:0	olmo.train.trainer:817	INFO	[step=815/1000]
    train/CrossEntropyLoss=10.23
    train/ZLoss=0.0138
    train/ImageGenLoss=0.5254
    train/Accuracy=0.6040
    throughput/total_tokens=15,022,080
    throughput/device/tokens_per_second=25,898
    throughput/device/batches_per_second=1.405
2025-07-16 15:05:03.376	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:05:04.360	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:05:05.154	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:05:05.927	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:05:06.645	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:05:06.940	g3084:0	olmo.train.trainer:817	INFO	[step=820/1000]
    train/CrossEntropyLoss=10.26
    train/ZLoss=0.0138
    train/ImageGenLoss=0.4867
    train/Accuracy=0.6036
    throughput/total_tokens=15,114,240
    throughput/device/tokens_per_second=25,118
    throughput/device/batches_per_second=1.363
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:05:06.941	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 15:05:10.302	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 15:05:10.303	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 15:05:10.303	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 3.4 seconds
2025-07-16 15:05:10.861	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:05:11.554	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:05:12.325	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:05:13.044	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:05:13.776	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:05:14.070	g3084:0	olmo.train.trainer:817	INFO	[step=825/1000]
    train/CrossEntropyLoss=10.25
    train/ZLoss=0.0138
    train/ImageGenLoss=0.5631
    train/Accuracy=0.6612
    throughput/total_tokens=15,206,400
    throughput/device/tokens_per_second=28,603
    throughput/device/batches_per_second=1.552
2025-07-16 15:05:14.535	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:05:15.645	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:05:16.428	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:05:17.102	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:05:17.860	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:05:18.152	g3084:0	olmo.train.trainer:817	INFO	[step=830/1000]
    train/CrossEntropyLoss=10.22
    train/ZLoss=0.0138
    train/ImageGenLoss=0.5854
    train/Accuracy=0.6122
    throughput/total_tokens=15,298,560
    throughput/device/tokens_per_second=25,237
    throughput/device/batches_per_second=1.369
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:05:18.556	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:05:19.250	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:05:19.961	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:05:20.804	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:05:21.589	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:05:21.882	g3084:0	olmo.train.trainer:817	INFO	[step=835/1000]
    train/CrossEntropyLoss=10.21
    train/ZLoss=0.0138
    train/ImageGenLoss=0.6102
    train/Accuracy=0.5938
    throughput/total_tokens=15,390,720
    throughput/device/tokens_per_second=25,056
    throughput/device/batches_per_second=1.359
2025-07-16 15:05:22.217	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:05:22.972	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:05:23.747	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:05:24.506	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:05:25.172	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:05:25.466	g3084:0	olmo.train.trainer:817	INFO	[step=840/1000]
    train/CrossEntropyLoss=10.23
    train/ZLoss=0.0138
    train/ImageGenLoss=0.5343
    train/Accuracy=0.6068
    throughput/total_tokens=15,482,880
    throughput/device/tokens_per_second=25,219
    throughput/device/batches_per_second=1.368
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:05:25.467	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 15:05:29.012	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 15:05:29.012	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 15:05:29.013	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 3.5 seconds
2025-07-16 15:05:29.576	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:05:30.333	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:05:31.006	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:05:31.911	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:05:32.707	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:05:32.997	g3084:0	olmo.train.trainer:817	INFO	[step=845/1000]
    train/CrossEntropyLoss=10.18
    train/ZLoss=0.0138
    train/ImageGenLoss=0.5320
    train/Accuracy=0.6211
    throughput/total_tokens=15,575,040
    throughput/device/tokens_per_second=26,833
    throughput/device/batches_per_second=1.456
2025-07-16 15:05:33.539	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:05:34.260	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:05:34.994	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:05:35.858	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:05:36.722	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:05:37.016	g3084:0	olmo.train.trainer:817	INFO	[step=850/1000]
    train/CrossEntropyLoss=10.18
    train/ZLoss=0.0138
    train/ImageGenLoss=0.5434
    train/Accuracy=0.6190
    throughput/total_tokens=15,667,200
    throughput/device/tokens_per_second=24,730
    throughput/device/batches_per_second=1.342
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:05:37.623	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:05:38.372	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:05:39.163	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:05:39.914	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:05:40.864	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:05:41.158	g3084:0	olmo.train.trainer:817	INFO	[step=855/1000]
    train/CrossEntropyLoss=10.22
    train/ZLoss=0.0138
    train/ImageGenLoss=0.5672
    train/Accuracy=0.6410
    throughput/total_tokens=15,759,360
    throughput/device/tokens_per_second=23,842
    throughput/device/batches_per_second=1.294
2025-07-16 15:05:41.596	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:05:42.438	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:05:43.174	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:05:43.957	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:05:44.641	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:05:44.934	g3084:0	olmo.train.trainer:817	INFO	[step=860/1000]
    train/CrossEntropyLoss=10.23
    train/ZLoss=0.0138
    train/ImageGenLoss=0.5532
    train/Accuracy=0.6356
    throughput/total_tokens=15,851,520
    throughput/device/tokens_per_second=23,982
    throughput/device/batches_per_second=1.301
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:05:44.936	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 15:05:48.307	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 15:05:48.308	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 15:05:48.308	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 3.4 seconds
2025-07-16 15:05:48.750	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:05:49.453	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:05:50.249	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:05:51.021	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:05:51.761	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:05:52.056	g3084:0	olmo.train.trainer:817	INFO	[step=865/1000]
    train/CrossEntropyLoss=10.22
    train/ZLoss=0.0138
    train/ImageGenLoss=0.6201
    train/Accuracy=0.6019
    throughput/total_tokens=15,943,680
    throughput/device/tokens_per_second=27,770
    throughput/device/batches_per_second=1.507
2025-07-16 15:05:52.568	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:05:53.421	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:05:54.178	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:05:54.958	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:05:55.678	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:05:55.975	g3084:0	olmo.train.trainer:817	INFO	[step=870/1000]
    train/CrossEntropyLoss=10.17
    train/ZLoss=0.0138
    train/ImageGenLoss=0.5104
    train/Accuracy=0.6400
    throughput/total_tokens=16,035,840
    throughput/device/tokens_per_second=25,467
    throughput/device/batches_per_second=1.382
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:05:56.442	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:05:57.284	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:05:58.037	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:05:58.808	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:05:59.518	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:05:59.811	g3084:0	olmo.train.trainer:817	INFO	[step=875/1000]
    train/CrossEntropyLoss=10.21
    train/ZLoss=0.0138
    train/ImageGenLoss=0.5588
    train/Accuracy=0.5810
    throughput/total_tokens=16,128,000
    throughput/device/tokens_per_second=24,966
    throughput/device/batches_per_second=1.354
2025-07-16 15:06:00.466	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:06:01.205	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:06:01.941	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:06:02.651	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:06:03.334	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:06:03.630	g3084:0	olmo.train.trainer:817	INFO	[step=880/1000]
    train/CrossEntropyLoss=10.18
    train/ZLoss=0.0138
    train/ImageGenLoss=0.5302
    train/Accuracy=0.6204
    throughput/total_tokens=16,220,160
    throughput/device/tokens_per_second=24,753
    throughput/device/batches_per_second=1.343
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:06:03.632	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 15:06:07.049	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 15:06:07.050	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 15:06:07.050	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 3.4 seconds
2025-07-16 15:06:07.742	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:06:08.498	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:06:09.307	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:06:10.023	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:06:10.720	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:06:11.013	g3084:0	olmo.train.trainer:817	INFO	[step=885/1000]
    train/CrossEntropyLoss=10.18
    train/ZLoss=0.0138
    train/ImageGenLoss=0.5358
    train/Accuracy=0.6146
    throughput/total_tokens=16,312,320
    throughput/device/tokens_per_second=28,061
    throughput/device/batches_per_second=1.522
2025-07-16 15:06:11.441	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:06:12.272	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:06:13.051	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:06:13.755	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:06:14.460	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:06:14.752	g3084:0	olmo.train.trainer:817	INFO	[step=890/1000]
    train/CrossEntropyLoss=10.16
    train/ZLoss=0.0138
    train/ImageGenLoss=0.5412
    train/Accuracy=0.6346
    throughput/total_tokens=16,404,480
    throughput/device/tokens_per_second=26,247
    throughput/device/batches_per_second=1.424
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:06:15.127	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:06:15.903	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:06:16.638	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:06:17.546	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:06:18.186	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:06:18.480	g3084:0	olmo.train.trainer:817	INFO	[step=895/1000]
    train/CrossEntropyLoss=10.19
    train/ZLoss=0.0138
    train/ImageGenLoss=0.5461
    train/Accuracy=0.5900
    throughput/total_tokens=16,496,640
    throughput/device/tokens_per_second=25,716
    throughput/device/batches_per_second=1.395
2025-07-16 15:06:18.862	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:06:19.643	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:06:20.398	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:06:21.169	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:06:21.912	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:06:22.206	g3084:0	olmo.train.trainer:817	INFO	[step=900/1000]
    train/CrossEntropyLoss=10.20
    train/ZLoss=0.0138
    train/ImageGenLoss=0.5933
    train/Accuracy=0.6330
    throughput/total_tokens=16,588,800
    throughput/device/tokens_per_second=25,465
    throughput/device/batches_per_second=1.382
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:06:22.207	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 15:06:25.644	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 15:06:25.645	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 15:06:25.645	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 3.4 seconds
2025-07-16 15:06:26.108	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:06:26.925	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:06:27.760	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:06:28.521	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:06:29.419	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:06:29.714	g3084:0	olmo.train.trainer:817	INFO	[step=905/1000]
    train/CrossEntropyLoss=10.20
    train/ZLoss=0.0138
    train/ImageGenLoss=0.5086
    train/Accuracy=0.6239
    throughput/total_tokens=16,680,960
    throughput/device/tokens_per_second=25,460
    throughput/device/batches_per_second=1.381
2025-07-16 15:06:30.226	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:06:30.961	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:06:31.664	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:06:32.321	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:06:33.040	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:06:33.336	g3084:0	olmo.train.trainer:817	INFO	[step=910/1000]
    train/CrossEntropyLoss=10.19
    train/ZLoss=0.0138
    train/ImageGenLoss=0.6822
    train/Accuracy=0.6381
    throughput/total_tokens=16,773,120
    throughput/device/tokens_per_second=25,454
    throughput/device/batches_per_second=1.381
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:06:33.771	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:06:34.545	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:06:35.296	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:06:36.106	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:06:36.861	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:06:37.153	g3084:0	olmo.train.trainer:817	INFO	[step=915/1000]
    train/CrossEntropyLoss=10.19
    train/ZLoss=0.0138
    train/ImageGenLoss=0.6022
    train/Accuracy=0.6449
    throughput/total_tokens=16,865,280
    throughput/device/tokens_per_second=24,999
    throughput/device/batches_per_second=1.356
2025-07-16 15:06:37.562	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:06:38.267	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:06:39.078	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:06:39.684	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:06:40.495	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:06:40.788	g3084:0	olmo.train.trainer:817	INFO	[step=920/1000]
    train/CrossEntropyLoss=10.20
    train/ZLoss=0.0138
    train/ImageGenLoss=0.5616
    train/Accuracy=0.6102
    throughput/total_tokens=16,957,440
    throughput/device/tokens_per_second=25,087
    throughput/device/batches_per_second=1.361
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:06:40.790	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 15:06:44.266	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 15:06:44.266	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 15:06:44.267	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 3.5 seconds
2025-07-16 15:06:44.738	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:06:45.489	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:06:46.248	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:06:46.990	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:06:47.791	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:06:48.082	g3084:0	olmo.train.trainer:817	INFO	[step=925/1000]
    train/CrossEntropyLoss=10.12
    train/ZLoss=0.0138
    train/ImageGenLoss=0.5990
    train/Accuracy=0.6333
    throughput/total_tokens=17,049,600
    throughput/device/tokens_per_second=27,445
    throughput/device/batches_per_second=1.489
2025-07-16 15:06:48.570	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:06:49.299	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:06:50.027	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:06:50.828	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:06:51.552	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:06:51.843	g3084:0	olmo.train.trainer:817	INFO	[step=930/1000]
    train/CrossEntropyLoss=10.21
    train/ZLoss=0.0138
    train/ImageGenLoss=0.5494
    train/Accuracy=0.6000
    throughput/total_tokens=17,141,760
    throughput/device/tokens_per_second=25,894
    throughput/device/batches_per_second=1.405
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:06:52.475	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:06:53.464	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:06:54.221	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:06:54.956	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:06:55.651	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:06:55.944	g3084:0	olmo.train.trainer:817	INFO	[step=935/1000]
    train/CrossEntropyLoss=10.20
    train/ZLoss=0.0138
    train/ImageGenLoss=0.5341
    train/Accuracy=0.6055
    throughput/total_tokens=17,233,920
    throughput/device/tokens_per_second=24,642
    throughput/device/batches_per_second=1.337
2025-07-16 15:06:56.459	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:06:57.208	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:06:57.933	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:06:58.700	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:06:59.427	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:06:59.721	g3084:0	olmo.train.trainer:817	INFO	[step=940/1000]
    train/CrossEntropyLoss=10.16
    train/ZLoss=0.0138
    train/ImageGenLoss=0.5904
    train/Accuracy=0.6458
    throughput/total_tokens=17,326,080
    throughput/device/tokens_per_second=24,581
    throughput/device/batches_per_second=1.334
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:06:59.723	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 15:07:03.164	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 15:07:03.165	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 15:07:03.165	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 3.4 seconds
2025-07-16 15:07:03.644	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:07:04.477	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:07:05.177	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:07:05.936	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:07:06.702	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:07:06.996	g3084:0	olmo.train.trainer:817	INFO	[step=945/1000]
    train/CrossEntropyLoss=10.19
    train/ZLoss=0.0138
    train/ImageGenLoss=0.5921
    train/Accuracy=0.6262
    throughput/total_tokens=17,418,240
    throughput/device/tokens_per_second=27,379
    throughput/device/batches_per_second=1.485
2025-07-16 15:07:07.374	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:07:08.142	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:07:08.953	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:07:09.649	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:07:10.522	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:07:10.816	g3084:0	olmo.train.trainer:817	INFO	[step=950/1000]
    train/CrossEntropyLoss=10.19
    train/ZLoss=0.0138
    train/ImageGenLoss=0.5912
    train/Accuracy=0.6339
    throughput/total_tokens=17,510,400
    throughput/device/tokens_per_second=25,650
    throughput/device/batches_per_second=1.392
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:07:11.241	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:07:11.981	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:07:12.809	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:07:13.694	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:07:14.540	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:07:14.828	g3084:0	olmo.train.trainer:817	INFO	[step=955/1000]
    train/CrossEntropyLoss=10.21
    train/ZLoss=0.0138
    train/ImageGenLoss=0.5752
    train/Accuracy=0.6239
    throughput/total_tokens=17,602,560
    throughput/device/tokens_per_second=24,688
    throughput/device/batches_per_second=1.339
2025-07-16 15:07:15.470	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:07:16.270	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:07:17.071	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:07:17.730	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:07:18.408	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:07:18.703	g3084:0	olmo.train.trainer:817	INFO	[step=960/1000]
    train/CrossEntropyLoss=10.19
    train/ZLoss=0.0138
    train/ImageGenLoss=0.4551
    train/Accuracy=0.6293
    throughput/total_tokens=17,694,720
    throughput/device/tokens_per_second=24,456
    throughput/device/batches_per_second=1.327
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:07:18.705	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 15:07:22.149	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 15:07:22.150	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 15:07:22.150	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 3.4 seconds
2025-07-16 15:07:22.576	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:07:23.382	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:07:24.132	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:07:24.890	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:07:25.796	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:07:26.092	g3084:0	olmo.train.trainer:817	INFO	[step=965/1000]
    train/CrossEntropyLoss=10.16
    train/ZLoss=0.0138
    train/ImageGenLoss=0.5055
    train/Accuracy=0.6146
    throughput/total_tokens=17,786,880
    throughput/device/tokens_per_second=26,115
    throughput/device/batches_per_second=1.417
2025-07-16 15:07:26.542	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:07:27.233	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:07:27.966	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:07:28.638	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:07:29.489	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:07:29.778	g3084:0	olmo.train.trainer:817	INFO	[step=970/1000]
    train/CrossEntropyLoss=10.21
    train/ZLoss=0.0138
    train/ImageGenLoss=0.4749
    train/Accuracy=0.6333
    throughput/total_tokens=17,879,040
    throughput/device/tokens_per_second=25,547
    throughput/device/batches_per_second=1.386
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:07:30.145	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:07:30.870	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:07:31.887	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:07:32.617	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:07:33.359	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:07:33.651	g3084:0	olmo.train.trainer:817	INFO	[step=975/1000]
    train/CrossEntropyLoss=10.19
    train/ZLoss=0.0138
    train/ImageGenLoss=0.5254
    train/Accuracy=0.6195
    throughput/total_tokens=17,971,200
    throughput/device/tokens_per_second=24,935
    throughput/device/batches_per_second=1.353
2025-07-16 15:07:34.041	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:07:34.762	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:07:35.492	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:07:36.218	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:07:36.982	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:07:37.278	g3084:0	olmo.train.trainer:817	INFO	[step=980/1000]
    train/CrossEntropyLoss=10.22
    train/ZLoss=0.0138
    train/ImageGenLoss=0.5004
    train/Accuracy=0.5929
    throughput/total_tokens=18,063,360
    throughput/device/tokens_per_second=25,053
    throughput/device/batches_per_second=1.359
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:07:37.279	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 15:07:40.783	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 15:07:40.784	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 15:07:40.784	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 3.5 seconds
2025-07-16 15:07:41.278	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:07:42.082	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:07:42.803	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:07:43.570	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:07:44.435	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:07:44.721	g3084:0	olmo.train.trainer:817	INFO	[step=985/1000]
    train/CrossEntropyLoss=10.14
    train/ZLoss=0.0138
    train/ImageGenLoss=0.5804
    train/Accuracy=0.6186
    throughput/total_tokens=18,155,520
    throughput/device/tokens_per_second=26,665
    throughput/device/batches_per_second=1.447
2025-07-16 15:07:45.231	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:07:45.973	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:07:46.731	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:07:47.501	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:07:48.299	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:07:48.591	g3084:0	olmo.train.trainer:817	INFO	[step=990/1000]
    train/CrossEntropyLoss=10.16
    train/ZLoss=0.0138
    train/ImageGenLoss=0.5422
    train/Accuracy=0.6261
    throughput/total_tokens=18,247,680
    throughput/device/tokens_per_second=25,160
    throughput/device/batches_per_second=1.365
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:07:49.183	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:07:50.061	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:07:50.812	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:07:51.579	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:07:52.353	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:07:52.645	g3084:0	olmo.train.trainer:817	INFO	[step=995/1000]
    train/CrossEntropyLoss=10.19
    train/ZLoss=0.0138
    train/ImageGenLoss=0.5761
    train/Accuracy=0.6140
    throughput/total_tokens=18,339,840
    throughput/device/tokens_per_second=24,294
    throughput/device/batches_per_second=1.318
2025-07-16 15:07:53.100	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:07:53.979	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:07:54.756	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:07:55.486	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:07:56.194	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:07:56.488	g3084:0	olmo.train.trainer:817	INFO	[step=1000/1000]
    train/CrossEntropyLoss=10.17
    train/ZLoss=0.0138
    train/ImageGenLoss=0.5535
    train/Accuracy=0.6486
    throughput/total_tokens=18,432,000
    throughput/device/tokens_per_second=24,217
    throughput/device/batches_per_second=1.314
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:07:56.489	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 15:07:59.856	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 15:07:59.857	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 15:07:59.857	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 3.4 seconds
2025-07-16 15:07:59.858	g3084:0	olmo.train.trainer:1195	INFO	Saving final checkpoint...
2025-07-16 15:08:05.184	g3084:0	olmo.train.trainer:1197	INFO	Checkpoint saved to debug_run/step1000
2025-07-16 15:08:05.185	g3084:0	train:334	INFO	Training complete
2025-07-16 15:12:12.850	g3084:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-16 15:12:12.930	g3084:0	train:54	INFO	Configuration:
2025-07-16 15:12:12.930	g3084:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=128, n_heads=2, n_kv_heads=None, head_dim=None, qkv_bias=False, clip_qkv=None, n_layers=1, mlp_ratio=4, mlp_hidden_size=None, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=10000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='default', layer_norm_with_affine=True, layer_norm_eps=None, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=True, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.1, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=None, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2-7B', tokenizer_dir=None), init_path=None, init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='openai', image_default_input_size=(336, 336), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1024, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=1, image_head_dim=64, image_mlp_dim=4096, image_mlp_activations='gelu', image_dropout_rate=0.0, image_num_pos=577, image_norm_eps=1e-05, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path=None, resize_mode='default', pad_value=0.0, normalize='openai'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-1,), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='resize', max_crops=1, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear', per_image_output_tokens=64), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'depth': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=20, inf_evaluators=[InfDatasetEvaluatorConfig(label='depth', data=DataLoaderConfig(dataset='depth', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=16, console_log_interval=5, include_image=False)], inf_eval_interval=20, eval_on_last_step=True, eval_on_load=False, save_folder='debug_run', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint=None, allow_resume=True, max_duration=1000, global_train_batch_size=8, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=None, beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=5, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=1000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-16 15:12:13.272	g3084:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-16 15:12:15.715	g3084:0	root:123	INFO	Padding tokenizer with 416 tokens
2025-07-16 15:12:17.772	g3084:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-16 15:12:17.925	g3084:0	train:191	INFO	Total number of parameters: 58,088,960
2025-07-16 15:12:17.926	g3084:0	train:192	INFO	Number of non-embedding parameters: 38,608,384
2025-07-16 15:12:17.927	g3084:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 234
2025-07-16 15:12:17.927	g3084:0	train:196	INFO	Model:
2025-07-16 15:12:17.928	g3084:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0): FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=128, out_features=128, bias=True)
          (ff_out): Linear(in_features=256, out_features=128, bias=True)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): LayerNorm()
          (ff_norm): LayerNorm()
          (att_proj): Linear(in_features=128, out_features=384, bias=True)
          (ff_proj): Linear(in_features=128, out_features=512, bias=True)
        )
      )
    )
    (ln_f): FSDPLayerNorm()
    (emb_drop): Dropout(p=0.1, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=128, out_features=152192, bias=True)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=1024, out_features=1024, bias=True)
        (wk): Linear(in_features=1024, out_features=1024, bias=True)
        (wv): Linear(in_features=1024, out_features=1024, bias=True)
        (wo): Linear(in_features=1024, out_features=1024, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1024, out_features=256, bias=False)
        (w2): Linear(in_features=256, out_features=128, bias=False)
        (w3): Linear(in_features=1024, out_features=256, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1024, bias=False)
      (pre_ln): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0): FSDPResidualAttentionBlock(
            (attention): ViTMultiHeadDotProductAttention(
              (wq): Linear(in_features=1024, out_features=1024, bias=True)
              (wk): Linear(in_features=1024, out_features=1024, bias=True)
              (wv): Linear(in_features=1024, out_features=1024, bias=True)
              (wo): Linear(in_features=1024, out_features=1024, bias=True)
              (residual_dropout): Dropout(p=0.0, inplace=False)
            )
            (feed_forward): ViTMLP(
              (w1): Linear(in_features=1024, out_features=4096, bias=True)
              (act): GELUActivation()
              (w2): Linear(in_features=4096, out_features=1024, bias=True)
            )
            (attention_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (ffn_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=1024, out_features=128, bias=False)
  (vision_decoder_head): Linear(in_features=128, out_features=1024, bias=False)
)
2025-07-16 15:12:17.938	g3084:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-16 15:12:17.949	g3084:0	olmo.data.data_loader:197	INFO	Loading train dataset depth/train
2025-07-16 15:12:17.950	g3084:0	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/train/train.json
2025-07-16 15:12:18.045	g3084:0	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-16 15:12:18.046	g3084:0	olmo.data.data_loader:219	INFO	depth: 100.00
2025-07-16 15:12:18.048	g3084:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=2304 images=1 pooled_patches_idx=158
2025-07-16 15:12:18.049	g3084:0	olmo.data.data_loader:100	INFO	Loading eval dataset: depth/validation
2025-07-16 15:12:18.049	g3084:0	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/val/val.json
2025-07-16 15:12:18.070	g3084:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=1792 images=1 pooled_patches_idx=158
2025-07-16 15:12:18.311	g3084:0	train:332	INFO	Starting training...
2025-07-16 15:12:18.312	g3084:0	olmo.train.trainer:817	INFO	Pre-train system metrics
    System/Peak GPU Memory (MB)=370.8
2025-07-16 15:12:27.973	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:12:34.707	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:12:35.522	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:12:36.060	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:12:36.586	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:12:37.350	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:12:37.641	g3084:0	olmo.train.trainer:817	INFO	[step=5/1000]
    train/CrossEntropyLoss=11.90
    train/ZLoss=0.0143
    train/ImageGenLoss=0.7284
    train/Accuracy=0.0
    throughput/total_tokens=92,160
    throughput/device/tokens_per_second=34,566
    throughput/device/batches_per_second=1.875
2025-07-16 15:12:37.939	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:12:38.500	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:12:39.183	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:12:39.716	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:12:40.335	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:12:40.629	g3084:0	olmo.train.trainer:817	INFO	[step=10/1000]
    train/CrossEntropyLoss=11.89
    train/ZLoss=0.0143
    train/ImageGenLoss=0.6477
    train/Accuracy=0.0
    throughput/total_tokens=184,320
    throughput/device/tokens_per_second=32,395
    throughput/device/batches_per_second=1.758
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:12:41.036	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:12:41.604	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:12:42.149	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:12:42.705	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:12:43.359	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:12:43.652	g3084:0	olmo.train.trainer:817	INFO	[step=15/1000]
    train/CrossEntropyLoss=11.89
    train/ZLoss=0.0143
    train/ImageGenLoss=0.6367
    train/Accuracy=0.0
    throughput/total_tokens=276,480
    throughput/device/tokens_per_second=31,684
    throughput/device/batches_per_second=1.719
2025-07-16 15:12:44.302	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:12:44.910	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:12:45.473	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:12:46.046	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:12:46.620	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:12:46.919	g3084:0	olmo.train.trainer:817	INFO	[step=20/1000]
    train/CrossEntropyLoss=11.90
    train/ZLoss=0.0143
    train/ImageGenLoss=0.6163
    train/Accuracy=0.0
    throughput/total_tokens=368,640
    throughput/device/tokens_per_second=30,690
    throughput/device/batches_per_second=1.665
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:12:46.921	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 15:12:52.838	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 15:12:52.839	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 15:12:52.839	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 5.9 seconds
2025-07-16 15:12:53.176	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:12:53.842	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:12:54.389	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:12:54.965	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:12:55.613	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:12:55.905	g3084:0	olmo.train.trainer:817	INFO	[step=25/1000]
    train/CrossEntropyLoss=11.88
    train/ZLoss=0.0143
    train/ImageGenLoss=0.5772
    train/Accuracy=0.0
    throughput/total_tokens=460,800
    throughput/device/tokens_per_second=33,605
    throughput/device/batches_per_second=1.823
2025-07-16 15:12:56.178	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:12:56.756	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:12:57.299	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:12:57.925	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:12:58.510	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:12:58.804	g3084:0	olmo.train.trainer:817	INFO	[step=30/1000]
    train/CrossEntropyLoss=11.86
    train/ZLoss=0.0143
    train/ImageGenLoss=0.6220
    train/Accuracy=0.0
    throughput/total_tokens=552,960
    throughput/device/tokens_per_second=32,673
    throughput/device/batches_per_second=1.773
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:12:59.142	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:12:59.695	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:00.228	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:00.809	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:01.419	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:01.714	g3084:0	olmo.train.trainer:817	INFO	[step=35/1000]
    train/CrossEntropyLoss=11.82
    train/ZLoss=0.0143
    train/ImageGenLoss=0.6488
    train/Accuracy=0.0
    throughput/total_tokens=645,120
    throughput/device/tokens_per_second=32,330
    throughput/device/batches_per_second=1.754
2025-07-16 15:13:01.977	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:02.536	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:03.086	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:03.642	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:04.247	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:04.540	g3084:0	olmo.train.trainer:817	INFO	[step=40/1000]
    train/CrossEntropyLoss=11.83
    train/ZLoss=0.0143
    train/ImageGenLoss=0.6807
    train/Accuracy=0.0
    throughput/total_tokens=737,280
    throughput/device/tokens_per_second=32,402
    throughput/device/batches_per_second=1.758
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:13:04.542	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 15:13:08.403	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 15:13:08.404	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 15:13:08.404	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 3.9 seconds
2025-07-16 15:13:08.792	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:09.385	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:09.917	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:10.591	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:11.201	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:11.496	g3084:0	olmo.train.trainer:817	INFO	[step=45/1000]
    train/CrossEntropyLoss=11.82
    train/ZLoss=0.0143
    train/ImageGenLoss=0.6246
    train/Accuracy=0.0
    throughput/total_tokens=829,440
    throughput/device/tokens_per_second=33,916
    throughput/device/batches_per_second=1.840
2025-07-16 15:13:11.792	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:12.353	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:12.975	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:13.641	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:14.337	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:14.631	g3084:0	olmo.train.trainer:817	INFO	[step=50/1000]
    train/CrossEntropyLoss=11.79
    train/ZLoss=0.0143
    train/ImageGenLoss=0.6885
    train/Accuracy=0.0
    throughput/total_tokens=921,600
    throughput/device/tokens_per_second=31,493
    throughput/device/batches_per_second=1.709
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:13:14.902	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:15.402	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:16.014	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:16.561	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:17.112	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:17.405	g3084:0	olmo.train.trainer:817	INFO	[step=55/1000]
    train/CrossEntropyLoss=11.77
    train/ZLoss=0.0143
    train/ImageGenLoss=0.6954
    train/Accuracy=0.0
    throughput/total_tokens=1,013,760
    throughput/device/tokens_per_second=32,048
    throughput/device/batches_per_second=1.739
2025-07-16 15:13:17.708	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:18.302	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:18.946	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:19.543	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:20.178	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:20.471	g3084:0	olmo.train.trainer:817	INFO	[step=60/1000]
    train/CrossEntropyLoss=11.78
    train/ZLoss=0.0143
    train/ImageGenLoss=0.6110
    train/Accuracy=0.0
    throughput/total_tokens=1,105,920
    throughput/device/tokens_per_second=31,527
    throughput/device/batches_per_second=1.710
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:13:20.473	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 15:13:24.446	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 15:13:24.447	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 15:13:24.447	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 4.0 seconds
2025-07-16 15:13:24.842	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:25.362	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:26.127	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:26.770	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:27.315	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:27.603	g3084:0	olmo.train.trainer:817	INFO	[step=65/1000]
    train/CrossEntropyLoss=11.75
    train/ZLoss=0.0143
    train/ImageGenLoss=0.7194
    train/Accuracy=0.0
    throughput/total_tokens=1,198,080
    throughput/device/tokens_per_second=33,207
    throughput/device/batches_per_second=1.802
2025-07-16 15:13:27.801	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:28.359	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:29.034	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:29.670	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:30.270	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:30.562	g3084:0	olmo.train.trainer:817	INFO	[step=70/1000]
    train/CrossEntropyLoss=11.72
    train/ZLoss=0.0143
    train/ImageGenLoss=0.6605
    train/Accuracy=0.0
    throughput/total_tokens=1,290,240
    throughput/device/tokens_per_second=32,143
    throughput/device/batches_per_second=1.744
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:13:30.779	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:31.370	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:31.982	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:32.659	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:33.261	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:33.551	g3084:0	olmo.train.trainer:817	INFO	[step=75/1000]
    train/CrossEntropyLoss=11.71
    train/ZLoss=0.0143
    train/ImageGenLoss=0.6125
    train/Accuracy=0.0
    throughput/total_tokens=1,382,400
    throughput/device/tokens_per_second=31,694
    throughput/device/batches_per_second=1.720
2025-07-16 15:13:33.810	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:34.514	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:35.039	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:35.534	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:36.101	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:36.392	g3084:0	olmo.train.trainer:817	INFO	[step=80/1000]
    train/CrossEntropyLoss=11.67
    train/ZLoss=0.0143
    train/ImageGenLoss=0.6538
    train/Accuracy=0.0
    throughput/total_tokens=1,474,560
    throughput/device/tokens_per_second=31,877
    throughput/device/batches_per_second=1.729
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:13:36.394	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 15:13:40.331	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 15:13:40.332	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 15:13:40.332	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 3.9 seconds
2025-07-16 15:13:40.647	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:41.174	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:41.804	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:42.425	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:43.053	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:43.357	g3084:0	olmo.train.trainer:817	INFO	[step=85/1000]
    train/CrossEntropyLoss=11.69
    train/ZLoss=0.0143
    train/ImageGenLoss=0.6660
    train/Accuracy=0.0
    throughput/total_tokens=1,566,720
    throughput/device/tokens_per_second=33,837
    throughput/device/batches_per_second=1.836
2025-07-16 15:13:43.846	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:44.402	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:45.206	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:45.725	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:46.363	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:46.656	g3084:0	olmo.train.trainer:817	INFO	[step=90/1000]
    train/CrossEntropyLoss=11.66
    train/ZLoss=0.0143
    train/ImageGenLoss=0.6483
    train/Accuracy=0.0
    throughput/total_tokens=1,658,880
    throughput/device/tokens_per_second=30,608
    throughput/device/batches_per_second=1.661
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:13:46.963	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:47.621	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:48.299	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:48.902	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:49.479	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:49.766	g3084:0	olmo.train.trainer:817	INFO	[step=95/1000]
    train/CrossEntropyLoss=11.63
    train/ZLoss=0.0143
    train/ImageGenLoss=0.6222
    train/Accuracy=0.0
    throughput/total_tokens=1,751,040
    throughput/device/tokens_per_second=30,275
    throughput/device/batches_per_second=1.643
2025-07-16 15:13:50.119	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:50.669	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:51.292	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:51.856	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:52.395	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:52.687	g3084:0	olmo.train.trainer:817	INFO	[step=100/1000]
    train/CrossEntropyLoss=11.63
    train/ZLoss=0.0143
    train/ImageGenLoss=0.6324
    train/Accuracy=0.0
    throughput/total_tokens=1,843,200
    throughput/device/tokens_per_second=30,585
    throughput/device/batches_per_second=1.659
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:13:52.688	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 15:13:56.646	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 15:13:56.647	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 15:13:56.647	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 4.0 seconds
2025-07-16 15:13:56.890	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:57.453	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:58.032	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:58.529	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:59.157	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:13:59.448	g3084:0	olmo.train.trainer:817	INFO	[step=105/1000]
    train/CrossEntropyLoss=11.60
    train/ZLoss=0.0143
    train/ImageGenLoss=0.5376
    train/Accuracy=0.0
    throughput/total_tokens=1,935,360
    throughput/device/tokens_per_second=35,841
    throughput/device/batches_per_second=1.945
2025-07-16 15:13:59.710	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:00.256	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:00.949	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:01.586	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:02.174	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:02.464	g3084:0	olmo.train.trainer:817	INFO	[step=110/1000]
    train/CrossEntropyLoss=11.62
    train/ZLoss=0.0143
    train/ImageGenLoss=0.6715
    train/Accuracy=0.0
    throughput/total_tokens=2,027,520
    throughput/device/tokens_per_second=32,988
    throughput/device/batches_per_second=1.790
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:14:02.801	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:03.352	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:03.895	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:04.465	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:05.085	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:05.379	g3084:0	olmo.train.trainer:817	INFO	[step=115/1000]
    train/CrossEntropyLoss=11.56
    train/ZLoss=0.0143
    train/ImageGenLoss=0.6444
    train/Accuracy=0.0100
    throughput/total_tokens=2,119,680
    throughput/device/tokens_per_second=32,519
    throughput/device/batches_per_second=1.764
2025-07-16 15:14:05.616	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:06.208	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:06.826	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:07.457	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:08.160	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:08.450	g3084:0	olmo.train.trainer:817	INFO	[step=120/1000]
    train/CrossEntropyLoss=11.57
    train/ZLoss=0.0143
    train/ImageGenLoss=0.5595
    train/Accuracy=0.0
    throughput/total_tokens=2,211,840
    throughput/device/tokens_per_second=31,852
    throughput/device/batches_per_second=1.728
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:14:08.452	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 15:14:12.478	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 15:14:12.479	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 15:14:12.479	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 4.0 seconds
2025-07-16 15:14:12.748	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:13.275	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:13.891	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:14.430	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:15.089	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:15.384	g3084:0	olmo.train.trainer:817	INFO	[step=125/1000]
    train/CrossEntropyLoss=11.54
    train/ZLoss=0.0143
    train/ImageGenLoss=0.6116
    train/Accuracy=0.0
    throughput/total_tokens=2,304,000
    throughput/device/tokens_per_second=34,794
    throughput/device/batches_per_second=1.888
2025-07-16 15:14:15.759	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:16.387	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:17.109	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:17.646	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:18.265	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:18.558	g3084:0	olmo.train.trainer:817	INFO	[step=130/1000]
    train/CrossEntropyLoss=11.51
    train/ZLoss=0.0143
    train/ImageGenLoss=0.5279
    train/Accuracy=0.0
    throughput/total_tokens=2,396,160
    throughput/device/tokens_per_second=31,657
    throughput/device/batches_per_second=1.718
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:14:18.843	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:19.455	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:20.016	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:20.601	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:21.201	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:21.490	g3084:0	olmo.train.trainer:817	INFO	[step=135/1000]
    train/CrossEntropyLoss=11.47
    train/ZLoss=0.0143
    train/ImageGenLoss=0.6747
    train/Accuracy=0.0
    throughput/total_tokens=2,488,320
    throughput/device/tokens_per_second=31,579
    throughput/device/batches_per_second=1.713
2025-07-16 15:14:21.755	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:22.302	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:22.878	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:23.501	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:24.026	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:24.370	g3084:0	olmo.train.trainer:817	INFO	[step=140/1000]
    train/CrossEntropyLoss=11.50
    train/ZLoss=0.0143
    train/ImageGenLoss=0.6363
    train/Accuracy=0.0
    throughput/total_tokens=2,580,480
    throughput/device/tokens_per_second=31,685
    throughput/device/batches_per_second=1.719
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:14:24.372	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 15:14:28.246	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 15:14:28.246	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 15:14:28.247	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 3.9 seconds
2025-07-16 15:14:28.542	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:29.102	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:29.685	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:30.379	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:30.935	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:31.227	g3084:0	olmo.train.trainer:817	INFO	[step=145/1000]
    train/CrossEntropyLoss=11.51
    train/ZLoss=0.0142
    train/ImageGenLoss=0.6341
    train/Accuracy=0.0091
    throughput/total_tokens=2,672,640
    throughput/device/tokens_per_second=34,153
    throughput/device/batches_per_second=1.853
2025-07-16 15:14:31.551	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:32.106	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:32.657	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:33.278	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:33.936	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:34.230	g3084:0	olmo.train.trainer:817	INFO	[step=150/1000]
    train/CrossEntropyLoss=11.52
    train/ZLoss=0.0142
    train/ImageGenLoss=0.5907
    train/Accuracy=0.0
    throughput/total_tokens=2,764,800
    throughput/device/tokens_per_second=32,330
    throughput/device/batches_per_second=1.754
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:14:34.520	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:35.147	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:35.769	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:36.493	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:37.040	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:37.333	g3084:0	olmo.train.trainer:817	INFO	[step=155/1000]
    train/CrossEntropyLoss=11.48
    train/ZLoss=0.0142
    train/ImageGenLoss=0.5780
    train/Accuracy=0.0088
    throughput/total_tokens=2,856,960
    throughput/device/tokens_per_second=31,402
    throughput/device/batches_per_second=1.704
2025-07-16 15:14:37.553	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:38.264	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:38.794	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:39.354	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:39.949	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:40.242	g3084:0	olmo.train.trainer:817	INFO	[step=160/1000]
    train/CrossEntropyLoss=11.46
    train/ZLoss=0.0142
    train/ImageGenLoss=0.6727
    train/Accuracy=0.0182
    throughput/total_tokens=2,949,120
    throughput/device/tokens_per_second=31,474
    throughput/device/batches_per_second=1.708
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:14:40.243	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 15:14:44.438	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 15:14:44.438	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 15:14:44.439	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 4.2 seconds
2025-07-16 15:14:44.760	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:45.529	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:46.106	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:46.626	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:47.480	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:47.773	g3084:0	olmo.train.trainer:817	INFO	[step=165/1000]
    train/CrossEntropyLoss=11.44
    train/ZLoss=0.0142
    train/ImageGenLoss=0.5748
    train/Accuracy=0.0098
    throughput/total_tokens=3,041,280
    throughput/device/tokens_per_second=30,458
    throughput/device/batches_per_second=1.652
2025-07-16 15:14:48.029	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:48.537	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:49.103	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:49.635	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:50.279	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:50.571	g3084:0	olmo.train.trainer:817	INFO	[step=170/1000]
    train/CrossEntropyLoss=11.39
    train/ZLoss=0.0142
    train/ImageGenLoss=0.5547
    train/Accuracy=0.0102
    throughput/total_tokens=3,133,440
    throughput/device/tokens_per_second=31,655
    throughput/device/batches_per_second=1.717
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:14:50.861	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:51.504	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:52.158	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:52.704	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:53.274	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:53.564	g3084:0	olmo.train.trainer:817	INFO	[step=175/1000]
    train/CrossEntropyLoss=11.40
    train/ZLoss=0.0142
    train/ImageGenLoss=0.5852
    train/Accuracy=0.0101
    throughput/total_tokens=3,225,600
    throughput/device/tokens_per_second=31,358
    throughput/device/batches_per_second=1.701
2025-07-16 15:14:53.903	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:54.452	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:54.983	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:55.568	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:56.229	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:14:56.523	g3084:0	olmo.train.trainer:817	INFO	[step=180/1000]
    train/CrossEntropyLoss=11.42
    train/ZLoss=0.0142
    train/ImageGenLoss=0.5565
    train/Accuracy=0.0171
    throughput/total_tokens=3,317,760
    throughput/device/tokens_per_second=31,307
    throughput/device/batches_per_second=1.699
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:14:56.525	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 15:15:00.458	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 15:15:00.459	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 15:15:00.459	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 3.9 seconds
2025-07-16 15:15:00.746	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:01.431	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:02.200	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:02.765	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:03.343	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:03.635	g3084:0	olmo.train.trainer:817	INFO	[step=185/1000]
    train/CrossEntropyLoss=11.34
    train/ZLoss=0.0142
    train/ImageGenLoss=0.5803
    train/Accuracy=0.0337
    throughput/total_tokens=3,409,920
    throughput/device/tokens_per_second=31,761
    throughput/device/batches_per_second=1.723
2025-07-16 15:15:03.918	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:04.516	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:05.082	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:05.670	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:06.198	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:06.492	g3084:0	olmo.train.trainer:817	INFO	[step=190/1000]
    train/CrossEntropyLoss=11.39
    train/ZLoss=0.0142
    train/ImageGenLoss=0.5957
    train/Accuracy=0.0174
    throughput/total_tokens=3,502,080
    throughput/device/tokens_per_second=32,009
    throughput/device/batches_per_second=1.737
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:15:06.847	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:07.352	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:07.868	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:08.509	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:09.123	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:09.418	g3084:0	olmo.train.trainer:817	INFO	[step=195/1000]
    train/CrossEntropyLoss=11.37
    train/ZLoss=0.0142
    train/ImageGenLoss=0.6354
    train/Accuracy=0.0099
    throughput/total_tokens=3,594,240
    throughput/device/tokens_per_second=31,834
    throughput/device/batches_per_second=1.727
2025-07-16 15:15:09.761	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:10.360	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:10.919	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:11.630	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:12.178	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:12.471	g3084:0	olmo.train.trainer:817	INFO	[step=200/1000]
    train/CrossEntropyLoss=11.33
    train/ZLoss=0.0142
    train/ImageGenLoss=0.6510
    train/Accuracy=0.0367
    throughput/total_tokens=3,686,400
    throughput/device/tokens_per_second=31,407
    throughput/device/batches_per_second=1.704
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:15:12.473	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 15:15:16.830	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 15:15:16.830	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 15:15:16.831	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 4.4 seconds
2025-07-16 15:15:17.317	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:18.000	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:18.532	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:19.217	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:19.800	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:20.091	g3084:0	olmo.train.trainer:817	INFO	[step=205/1000]
    train/CrossEntropyLoss=11.36
    train/ZLoss=0.0142
    train/ImageGenLoss=0.7034
    train/Accuracy=0.0244
    throughput/total_tokens=3,778,560
    throughput/device/tokens_per_second=33,065
    throughput/device/batches_per_second=1.794
2025-07-16 15:15:20.414	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:21.017	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:21.631	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:22.168	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:22.731	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:23.023	g3084:0	olmo.train.trainer:817	INFO	[step=210/1000]
    train/CrossEntropyLoss=11.33
    train/ZLoss=0.0142
    train/ImageGenLoss=0.5961
    train/Accuracy=0.0885
    throughput/total_tokens=3,870,720
    throughput/device/tokens_per_second=32,228
    throughput/device/batches_per_second=1.748
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:15:23.383	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:24.018	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:24.523	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:25.116	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:25.633	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:25.924	g3084:0	olmo.train.trainer:817	INFO	[step=215/1000]
    train/CrossEntropyLoss=11.28
    train/ZLoss=0.0142
    train/ImageGenLoss=0.5596
    train/Accuracy=0.0825
    throughput/total_tokens=3,962,880
    throughput/device/tokens_per_second=32,072
    throughput/device/batches_per_second=1.740
2025-07-16 15:15:26.281	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:26.916	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:27.453	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:28.071	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:28.857	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:29.152	g3084:0	olmo.train.trainer:817	INFO	[step=220/1000]
    train/CrossEntropyLoss=11.30
    train/ZLoss=0.0142
    train/ImageGenLoss=0.6661
    train/Accuracy=0.0777
    throughput/total_tokens=4,055,040
    throughput/device/tokens_per_second=31,113
    throughput/device/batches_per_second=1.688
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:15:29.154	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 15:15:33.648	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 15:15:33.649	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 15:15:33.649	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 4.5 seconds
2025-07-16 15:15:33.924	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:34.455	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:34.972	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:35.609	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:36.291	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:36.577	g3084:0	olmo.train.trainer:817	INFO	[step=225/1000]
    train/CrossEntropyLoss=11.24
    train/ZLoss=0.0142
    train/ImageGenLoss=0.6195
    train/Accuracy=0.1064
    throughput/total_tokens=4,147,200
    throughput/device/tokens_per_second=34,549
    throughput/device/batches_per_second=1.874
2025-07-16 15:15:36.810	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:37.346	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:37.951	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:38.857	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:39.414	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:39.705	g3084:0	olmo.train.trainer:817	INFO	[step=230/1000]
    train/CrossEntropyLoss=11.30
    train/ZLoss=0.0142
    train/ImageGenLoss=0.5827
    train/Accuracy=0.1667
    throughput/total_tokens=4,239,360
    throughput/device/tokens_per_second=31,806
    throughput/device/batches_per_second=1.726
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:15:40.125	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:40.716	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:41.384	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:41.911	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:42.527	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:42.822	g3084:0	olmo.train.trainer:817	INFO	[step=235/1000]
    train/CrossEntropyLoss=11.26
    train/ZLoss=0.0141
    train/ImageGenLoss=0.5712
    train/Accuracy=0.1652
    throughput/total_tokens=4,331,520
    throughput/device/tokens_per_second=31,023
    throughput/device/batches_per_second=1.683
2025-07-16 15:15:43.105	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:43.884	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:44.626	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:45.519	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:46.125	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:46.419	g3084:0	olmo.train.trainer:817	INFO	[step=240/1000]
    train/CrossEntropyLoss=11.24
    train/ZLoss=0.0141
    train/ImageGenLoss=0.5167
    train/Accuracy=0.1650
    throughput/total_tokens=4,423,680
    throughput/device/tokens_per_second=29,469
    throughput/device/batches_per_second=1.599
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:15:46.421	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 15:15:49.980	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 15:15:49.981	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 15:15:49.981	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 3.6 seconds
2025-07-16 15:15:50.338	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:51.031	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:51.686	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:52.390	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:52.926	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:53.218	g3084:0	olmo.train.trainer:817	INFO	[step=245/1000]
    train/CrossEntropyLoss=11.22
    train/ZLoss=0.0141
    train/ImageGenLoss=0.5486
    train/Accuracy=0.2095
    throughput/total_tokens=4,515,840
    throughput/device/tokens_per_second=31,847
    throughput/device/batches_per_second=1.728
2025-07-16 15:15:53.460	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:54.086	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:54.626	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:55.225	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:55.753	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:56.041	g3084:0	olmo.train.trainer:817	INFO	[step=250/1000]
    train/CrossEntropyLoss=11.22
    train/ZLoss=0.0141
    train/ImageGenLoss=0.6299
    train/Accuracy=0.2110
    throughput/total_tokens=4,608,000
    throughput/device/tokens_per_second=32,245
    throughput/device/batches_per_second=1.749
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:15:56.312	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:56.871	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:57.395	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:57.929	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:58.487	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:58.780	g3084:0	olmo.train.trainer:817	INFO	[step=255/1000]
    train/CrossEntropyLoss=11.19
    train/ZLoss=0.0141
    train/ImageGenLoss=0.5787
    train/Accuracy=0.2451
    throughput/total_tokens=4,700,160
    throughput/device/tokens_per_second=32,698
    throughput/device/batches_per_second=1.774
2025-07-16 15:15:59.150	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:15:59.735	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:00.352	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:00.919	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:01.523	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:01.819	g3084:0	olmo.train.trainer:817	INFO	[step=260/1000]
    train/CrossEntropyLoss=11.21
    train/ZLoss=0.0141
    train/ImageGenLoss=0.5992
    train/Accuracy=0.2393
    throughput/total_tokens=4,792,320
    throughput/device/tokens_per_second=32,071
    throughput/device/batches_per_second=1.740
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:16:01.821	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 15:16:05.422	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 15:16:05.423	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 15:16:05.423	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 3.6 seconds
2025-07-16 15:16:05.720	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:06.459	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:07.020	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:07.542	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:08.264	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:08.551	g3084:0	olmo.train.trainer:817	INFO	[step=265/1000]
    train/CrossEntropyLoss=11.15
    train/ZLoss=0.0141
    train/ImageGenLoss=0.5289
    train/Accuracy=0.3542
    throughput/total_tokens=4,884,480
    throughput/device/tokens_per_second=32,411
    throughput/device/batches_per_second=1.758
2025-07-16 15:16:08.921	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:09.534	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:10.290	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:10.824	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:11.395	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:11.689	g3084:0	olmo.train.trainer:817	INFO	[step=270/1000]
    train/CrossEntropyLoss=11.16
    train/ZLoss=0.0141
    train/ImageGenLoss=0.5698
    train/Accuracy=0.3084
    throughput/total_tokens=4,976,640
    throughput/device/tokens_per_second=30,819
    throughput/device/batches_per_second=1.672
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:16:11.945	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:12.604	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:13.248	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:13.814	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:14.390	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:14.685	g3084:0	olmo.train.trainer:817	INFO	[step=275/1000]
    train/CrossEntropyLoss=11.14
    train/ZLoss=0.0141
    train/ImageGenLoss=0.6485
    train/Accuracy=0.3229
    throughput/total_tokens=5,068,800
    throughput/device/tokens_per_second=30,799
    throughput/device/batches_per_second=1.671
2025-07-16 15:16:15.043	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:15.588	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:16.128	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:16.817	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:17.428	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:17.723	g3084:0	olmo.train.trainer:817	INFO	[step=280/1000]
    train/CrossEntropyLoss=11.12
    train/ZLoss=0.0141
    train/ImageGenLoss=0.6327
    train/Accuracy=0.3191
    throughput/total_tokens=5,160,960
    throughput/device/tokens_per_second=30,681
    throughput/device/batches_per_second=1.665
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:16:17.725	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 15:16:21.134	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 15:16:21.135	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 15:16:21.135	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 3.4 seconds
2025-07-16 15:16:21.509	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:22.168	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:22.795	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:23.388	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:23.933	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:24.226	g3084:0	olmo.train.trainer:817	INFO	[step=285/1000]
    train/CrossEntropyLoss=11.15
    train/ZLoss=0.0141
    train/ImageGenLoss=0.5674
    train/Accuracy=0.3364
    throughput/total_tokens=5,253,120
    throughput/device/tokens_per_second=33,762
    throughput/device/batches_per_second=1.832
2025-07-16 15:16:24.449	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:24.996	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:25.496	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:26.054	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:26.591	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:26.882	g3084:0	olmo.train.trainer:817	INFO	[step=290/1000]
    train/CrossEntropyLoss=11.12
    train/ZLoss=0.0141
    train/ImageGenLoss=0.5684
    train/Accuracy=0.3451
    throughput/total_tokens=5,345,280
    throughput/device/tokens_per_second=34,223
    throughput/device/batches_per_second=1.857
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:16:27.223	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:27.736	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:28.263	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:29.048	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:29.588	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:29.880	g3084:0	olmo.train.trainer:817	INFO	[step=295/1000]
    train/CrossEntropyLoss=11.12
    train/ZLoss=0.0141
    train/ImageGenLoss=0.6431
    train/Accuracy=0.3947
    throughput/total_tokens=5,437,440
    throughput/device/tokens_per_second=32,978
    throughput/device/batches_per_second=1.789
2025-07-16 15:16:30.129	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:30.784	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:31.331	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:31.869	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:32.488	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:32.781	g3084:0	olmo.train.trainer:817	INFO	[step=300/1000]
    train/CrossEntropyLoss=11.05
    train/ZLoss=0.0141
    train/ImageGenLoss=0.6219
    train/Accuracy=0.4286
    throughput/total_tokens=5,529,600
    throughput/device/tokens_per_second=32,669
    throughput/device/batches_per_second=1.772
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:16:32.782	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 15:16:36.161	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 15:16:36.162	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 15:16:36.162	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 3.4 seconds
2025-07-16 15:16:36.579	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:37.169	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:37.707	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:38.255	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:38.756	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:39.047	g3084:0	olmo.train.trainer:817	INFO	[step=305/1000]
    train/CrossEntropyLoss=11.10
    train/ZLoss=0.0141
    train/ImageGenLoss=0.6104
    train/Accuracy=0.3585
    throughput/total_tokens=5,621,760
    throughput/device/tokens_per_second=37,132
    throughput/device/batches_per_second=2.015
2025-07-16 15:16:39.312	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:39.873	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:40.371	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:40.895	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:41.407	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:41.698	g3084:0	olmo.train.trainer:817	INFO	[step=310/1000]
    train/CrossEntropyLoss=11.08
    train/ZLoss=0.0141
    train/ImageGenLoss=0.5851
    train/Accuracy=0.3750
    throughput/total_tokens=5,713,920
    throughput/device/tokens_per_second=35,916
    throughput/device/batches_per_second=1.949
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:16:42.151	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:42.766	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:43.362	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:43.903	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:44.475	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:44.765	g3084:0	olmo.train.trainer:817	INFO	[step=315/1000]
    train/CrossEntropyLoss=11.01
    train/ZLoss=0.0141
    train/ImageGenLoss=0.6346
    train/Accuracy=0.4624
    throughput/total_tokens=5,806,080
    throughput/device/tokens_per_second=33,720
    throughput/device/batches_per_second=1.829
2025-07-16 15:16:45.008	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:45.547	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:46.090	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:46.624	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:47.210	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:47.502	g3084:0	olmo.train.trainer:817	INFO	[step=320/1000]
    train/CrossEntropyLoss=11.02
    train/ZLoss=0.0141
    train/ImageGenLoss=0.5539
    train/Accuracy=0.4200
    throughput/total_tokens=5,898,240
    throughput/device/tokens_per_second=33,708
    throughput/device/batches_per_second=1.829
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:16:47.504	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 15:16:50.881	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 15:16:50.881	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 15:16:50.882	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 3.4 seconds
2025-07-16 15:16:51.139	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:51.853	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:52.469	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:53.079	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:53.658	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:53.950	g3084:0	olmo.train.trainer:817	INFO	[step=325/1000]
    train/CrossEntropyLoss=11.05
    train/ZLoss=0.0141
    train/ImageGenLoss=0.6658
    train/Accuracy=0.4324
    throughput/total_tokens=5,990,400
    throughput/device/tokens_per_second=32,638
    throughput/device/batches_per_second=1.771
2025-07-16 15:16:54.217	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:54.846	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:55.413	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:55.983	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:56.539	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:56.832	g3084:0	olmo.train.trainer:817	INFO	[step=330/1000]
    train/CrossEntropyLoss=11.06
    train/ZLoss=0.0140
    train/ImageGenLoss=0.6360
    train/Accuracy=0.3906
    throughput/total_tokens=6,082,560
    throughput/device/tokens_per_second=32,306
    throughput/device/batches_per_second=1.753
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:16:57.109	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:57.662	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:58.432	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:58.961	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:59.532	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:16:59.827	g3084:0	olmo.train.trainer:817	INFO	[step=335/1000]
    train/CrossEntropyLoss=10.99
    train/ZLoss=0.0140
    train/ImageGenLoss=0.6157
    train/Accuracy=0.4528
    throughput/total_tokens=6,174,720
    throughput/device/tokens_per_second=31,778
    throughput/device/batches_per_second=1.724
2025-07-16 15:17:00.064	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:00.600	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:01.095	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:01.645	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:02.184	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:02.481	g3084:0	olmo.train.trainer:817	INFO	[step=340/1000]
    train/CrossEntropyLoss=10.97
    train/ZLoss=0.0140
    train/ImageGenLoss=0.6124
    train/Accuracy=0.4766
    throughput/total_tokens=6,266,880
    throughput/device/tokens_per_second=32,466
    throughput/device/batches_per_second=1.761
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:17:02.483	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 15:17:06.023	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 15:17:06.024	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 15:17:06.024	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 3.5 seconds
2025-07-16 15:17:06.302	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:06.931	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:07.507	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:08.042	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:08.553	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:08.845	g3084:0	olmo.train.trainer:817	INFO	[step=345/1000]
    train/CrossEntropyLoss=10.97
    train/ZLoss=0.0140
    train/ImageGenLoss=0.6541
    train/Accuracy=0.4727
    throughput/total_tokens=6,359,040
    throughput/device/tokens_per_second=36,045
    throughput/device/batches_per_second=1.956
2025-07-16 15:17:09.073	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:09.631	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:10.212	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:10.743	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:11.271	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:11.568	g3084:0	olmo.train.trainer:817	INFO	[step=350/1000]
    train/CrossEntropyLoss=10.93
    train/ZLoss=0.0140
    train/ImageGenLoss=0.5925
    train/Accuracy=0.4600
    throughput/total_tokens=6,451,200
    throughput/device/tokens_per_second=34,920
    throughput/device/batches_per_second=1.895
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:17:11.843	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:12.417	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:13.026	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:13.550	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:14.169	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:14.462	g3084:0	olmo.train.trainer:817	INFO	[step=355/1000]
    train/CrossEntropyLoss=10.98
    train/ZLoss=0.0140
    train/ImageGenLoss=0.5366
    train/Accuracy=0.4737
    throughput/total_tokens=6,543,360
    throughput/device/tokens_per_second=33,826
    throughput/device/batches_per_second=1.835
2025-07-16 15:17:14.773	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:15.303	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:15.825	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:16.423	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:16.951	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:17.246	g3084:0	olmo.train.trainer:817	INFO	[step=360/1000]
    train/CrossEntropyLoss=10.88
    train/ZLoss=0.0140
    train/ImageGenLoss=0.6135
    train/Accuracy=0.5248
    throughput/total_tokens=6,635,520
    throughput/device/tokens_per_second=33,643
    throughput/device/batches_per_second=1.825
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:17:17.248	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 15:17:20.680	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 15:17:20.681	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 15:17:20.681	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 3.4 seconds
2025-07-16 15:17:21.011	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:21.553	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:22.079	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:22.595	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:23.132	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:23.421	g3084:0	olmo.train.trainer:817	INFO	[step=365/1000]
    train/CrossEntropyLoss=10.91
    train/ZLoss=0.0140
    train/ImageGenLoss=0.6424
    train/Accuracy=0.4571
    throughput/total_tokens=6,727,680
    throughput/device/tokens_per_second=38,022
    throughput/device/batches_per_second=2.063
2025-07-16 15:17:23.661	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:24.283	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:24.873	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:25.506	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:26.057	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:26.351	g3084:0	olmo.train.trainer:817	INFO	[step=370/1000]
    train/CrossEntropyLoss=10.94
    train/ZLoss=0.0140
    train/ImageGenLoss=0.5873
    train/Accuracy=0.4569
    throughput/total_tokens=6,819,840
    throughput/device/tokens_per_second=34,431
    throughput/device/batches_per_second=1.868
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:17:26.771	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:27.328	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:28.051	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:28.613	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:29.213	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:29.505	g3084:0	olmo.train.trainer:817	INFO	[step=375/1000]
    train/CrossEntropyLoss=10.87
    train/ZLoss=0.0140
    train/ImageGenLoss=0.6292
    train/Accuracy=0.5238
    throughput/total_tokens=6,912,000
    throughput/device/tokens_per_second=32,498
    throughput/device/batches_per_second=1.763
2025-07-16 15:17:29.740	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:30.280	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:30.881	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:31.617	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:32.129	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:32.421	g3084:0	olmo.train.trainer:817	INFO	[step=380/1000]
    train/CrossEntropyLoss=10.86
    train/ZLoss=0.0140
    train/ImageGenLoss=0.5310
    train/Accuracy=0.4685
    throughput/total_tokens=7,004,160
    throughput/device/tokens_per_second=32,273
    throughput/device/batches_per_second=1.751
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:17:32.422	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 15:17:35.827	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 15:17:35.828	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 15:17:35.828	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 3.4 seconds
2025-07-16 15:17:36.134	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:36.811	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:37.418	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:37.997	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:38.527	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:38.819	g3084:0	olmo.train.trainer:817	INFO	[step=385/1000]
    train/CrossEntropyLoss=10.84
    train/ZLoss=0.0140
    train/ImageGenLoss=0.5975
    train/Accuracy=0.5143
    throughput/total_tokens=7,096,320
    throughput/device/tokens_per_second=34,143
    throughput/device/batches_per_second=1.852
2025-07-16 15:17:39.066	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:39.600	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:40.162	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:40.745	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:41.291	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:41.586	g3084:0	olmo.train.trainer:817	INFO	[step=390/1000]
    train/CrossEntropyLoss=10.83
    train/ZLoss=0.0140
    train/ImageGenLoss=0.5621
    train/Accuracy=0.5288
    throughput/total_tokens=7,188,480
    throughput/device/tokens_per_second=33,722
    throughput/device/batches_per_second=1.830
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:17:41.830	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:42.380	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:42.886	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:43.468	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:44.004	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:44.299	g3084:0	olmo.train.trainer:817	INFO	[step=395/1000]
    train/CrossEntropyLoss=10.80
    train/ZLoss=0.0140
    train/ImageGenLoss=0.6641
    train/Accuracy=0.5253
    throughput/total_tokens=7,280,640
    throughput/device/tokens_per_second=33,806
    throughput/device/batches_per_second=1.834
2025-07-16 15:17:44.536	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:45.168	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:45.687	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:46.213	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:46.847	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:47.140	g3084:0	olmo.train.trainer:817	INFO	[step=400/1000]
    train/CrossEntropyLoss=10.78
    train/ZLoss=0.0140
    train/ImageGenLoss=0.6794
    train/Accuracy=0.5686
    throughput/total_tokens=7,372,800
    throughput/device/tokens_per_second=33,453
    throughput/device/batches_per_second=1.815
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:17:47.142	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 15:17:50.507	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 15:17:50.508	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 15:17:50.508	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 3.4 seconds
2025-07-16 15:17:50.788	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:51.306	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:51.892	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:52.411	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:53.039	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:53.333	g3084:0	olmo.train.trainer:817	INFO	[step=405/1000]
    train/CrossEntropyLoss=10.84
    train/ZLoss=0.0140
    train/ImageGenLoss=0.6990
    train/Accuracy=0.5130
    throughput/total_tokens=7,464,960
    throughput/device/tokens_per_second=36,023
    throughput/device/batches_per_second=1.954
2025-07-16 15:17:53.563	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:54.103	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:54.694	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:55.287	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:55.851	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:56.137	g3084:0	olmo.train.trainer:817	INFO	[step=410/1000]
    train/CrossEntropyLoss=10.84
    train/ZLoss=0.0140
    train/ImageGenLoss=0.6285
    train/Accuracy=0.5207
    throughput/total_tokens=7,557,120
    throughput/device/tokens_per_second=34,373
    throughput/device/batches_per_second=1.865
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:17:56.459	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:57.158	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:57.869	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:58.593	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:59.156	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:17:59.444	g3084:0	olmo.train.trainer:817	INFO	[step=415/1000]
    train/CrossEntropyLoss=10.76
    train/ZLoss=0.0140
    train/ImageGenLoss=0.6449
    train/Accuracy=0.5556
    throughput/total_tokens=7,649,280
    throughput/device/tokens_per_second=31,890
    throughput/device/batches_per_second=1.730
2025-07-16 15:17:59.657	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:00.162	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:00.741	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:01.316	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:02.176	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:02.474	g3084:0	olmo.train.trainer:817	INFO	[step=420/1000]
    train/CrossEntropyLoss=10.77
    train/ZLoss=0.0140
    train/ImageGenLoss=0.6439
    train/Accuracy=0.5327
    throughput/total_tokens=7,741,440
    throughput/device/tokens_per_second=31,511
    throughput/device/batches_per_second=1.710
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:18:02.476	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 15:18:05.921	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 15:18:05.922	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 15:18:05.922	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 3.4 seconds
2025-07-16 15:18:06.330	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:07.107	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:07.718	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:08.553	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:09.273	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:09.561	g3084:0	olmo.train.trainer:817	INFO	[step=425/1000]
    train/CrossEntropyLoss=10.75
    train/ZLoss=0.0140
    train/ImageGenLoss=0.6240
    train/Accuracy=0.5849
    throughput/total_tokens=7,833,600
    throughput/device/tokens_per_second=28,407
    throughput/device/batches_per_second=1.541
2025-07-16 15:18:09.871	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:10.436	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:11.186	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:11.787	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:12.375	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:12.664	g3084:0	olmo.train.trainer:817	INFO	[step=430/1000]
    train/CrossEntropyLoss=10.74
    train/ZLoss=0.0140
    train/ImageGenLoss=0.6029
    train/Accuracy=0.5619
    throughput/total_tokens=7,925,760
    throughput/device/tokens_per_second=29,041
    throughput/device/batches_per_second=1.576
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:18:12.934	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:13.598	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:14.378	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:15.149	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:15.746	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:16.040	g3084:0	olmo.train.trainer:817	INFO	[step=435/1000]
    train/CrossEntropyLoss=10.78
    train/ZLoss=0.0140
    train/ImageGenLoss=0.5418
    train/Accuracy=0.5246
    throughput/total_tokens=8,017,920
    throughput/device/tokens_per_second=28,436
    throughput/device/batches_per_second=1.543
2025-07-16 15:18:16.439	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:16.997	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:17.642	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:18.335	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:19.085	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:19.379	g3084:0	olmo.train.trainer:817	INFO	[step=440/1000]
    train/CrossEntropyLoss=10.71
    train/ZLoss=0.0140
    train/ImageGenLoss=0.5917
    train/Accuracy=0.5758
    throughput/total_tokens=8,110,080
    throughput/device/tokens_per_second=28,224
    throughput/device/batches_per_second=1.531
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:18:19.380	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 15:18:22.752	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 15:18:22.753	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 15:18:22.753	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 3.4 seconds
2025-07-16 15:18:23.267	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:24.135	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:24.747	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:25.308	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:25.920	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:26.212	g3084:0	olmo.train.trainer:817	INFO	[step=445/1000]
    train/CrossEntropyLoss=10.70
    train/ZLoss=0.0140
    train/ImageGenLoss=0.5990
    train/Accuracy=0.5701
    throughput/total_tokens=8,202,240
    throughput/device/tokens_per_second=31,164
    throughput/device/batches_per_second=1.691
2025-07-16 15:18:26.545	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:27.154	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:27.695	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:28.242	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:28.796	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:29.088	g3084:0	olmo.train.trainer:817	INFO	[step=450/1000]
    train/CrossEntropyLoss=10.68
    train/ZLoss=0.0140
    train/ImageGenLoss=0.5511
    train/Accuracy=0.5727
    throughput/total_tokens=8,294,400
    throughput/device/tokens_per_second=31,602
    throughput/device/batches_per_second=1.715
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:18:29.340	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:29.878	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:30.489	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:31.181	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:31.730	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:32.022	g3084:0	olmo.train.trainer:817	INFO	[step=455/1000]
    train/CrossEntropyLoss=10.71
    train/ZLoss=0.0140
    train/ImageGenLoss=0.5946
    train/Accuracy=0.5487
    throughput/total_tokens=8,386,560
    throughput/device/tokens_per_second=31,538
    throughput/device/batches_per_second=1.711
2025-07-16 15:18:32.361	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:33.006	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:33.554	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:34.120	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:34.660	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:34.952	g3084:0	olmo.train.trainer:817	INFO	[step=460/1000]
    train/CrossEntropyLoss=10.69
    train/ZLoss=0.0139
    train/ImageGenLoss=0.5555
    train/Accuracy=0.5826
    throughput/total_tokens=8,478,720
    throughput/device/tokens_per_second=31,516
    throughput/device/batches_per_second=1.710
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:18:34.954	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 15:18:38.340	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 15:18:38.341	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 15:18:38.341	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 3.4 seconds
2025-07-16 15:18:38.674	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:39.527	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:40.062	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:40.608	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:41.307	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:41.594	g3084:0	olmo.train.trainer:817	INFO	[step=465/1000]
    train/CrossEntropyLoss=10.69
    train/ZLoss=0.0139
    train/ImageGenLoss=0.6403
    train/Accuracy=0.5656
    throughput/total_tokens=8,570,880
    throughput/device/tokens_per_second=31,415
    throughput/device/batches_per_second=1.704
2025-07-16 15:18:41.954	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:42.586	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:43.198	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:43.815	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:44.389	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:44.682	g3084:0	olmo.train.trainer:817	INFO	[step=470/1000]
    train/CrossEntropyLoss=10.71
    train/ZLoss=0.0139
    train/ImageGenLoss=0.5533
    train/Accuracy=0.5470
    throughput/total_tokens=8,663,040
    throughput/device/tokens_per_second=30,614
    throughput/device/batches_per_second=1.661
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:18:44.885	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:45.437	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:46.041	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:46.546	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:47.251	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:47.543	g3084:0	olmo.train.trainer:817	INFO	[step=475/1000]
    train/CrossEntropyLoss=10.60
    train/ZLoss=0.0139
    train/ImageGenLoss=0.5677
    train/Accuracy=0.5644
    throughput/total_tokens=8,755,200
    throughput/device/tokens_per_second=31,126
    throughput/device/batches_per_second=1.689
2025-07-16 15:18:48.146	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:48.765	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:49.327	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:50.009	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:50.541	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:50.834	g3084:0	olmo.train.trainer:817	INFO	[step=480/1000]
    train/CrossEntropyLoss=10.65
    train/ZLoss=0.0139
    train/ImageGenLoss=0.6467
    train/Accuracy=0.5556
    throughput/total_tokens=8,847,360
    throughput/device/tokens_per_second=30,284
    throughput/device/batches_per_second=1.643
    System/Peak GPU Memory (MB)=29,225
2025-07-16 15:18:50.835	g3084:0	olmo.train.trainer:864	INFO	Running evaluation for 'depth'...
2025-07-16 15:18:54.101	g3084:0	olmo.eval.inf_evaluator:241	INFO	[eval_step=4/4]
2025-07-16 15:18:54.102	g3084:0	olmo.train.trainer:817	INFO	depth

2025-07-16 15:18:54.102	g3084:0	olmo.train.trainer:874	INFO	Eval for 'depth' done in 3.3 seconds
2025-07-16 15:18:54.388	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:55.010	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:55.642	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:56.266	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:56.900	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:57.189	g3084:0	olmo.train.trainer:817	INFO	[step=485/1000]
    train/CrossEntropyLoss=10.64
    train/ZLoss=0.0139
    train/ImageGenLoss=0.6200
    train/Accuracy=0.5526
    throughput/total_tokens=8,939,520
    throughput/device/tokens_per_second=32,746
    throughput/device/batches_per_second=1.777
2025-07-16 15:18:57.662	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:58.316	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:58.852	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:59.425	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 15:18:59.945	g3084:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:462: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 16:22:31.234	g3087:1	olmo.util:269	INFO	Set up torchrun environment
2025-07-16 16:22:31.234	g3087:2	olmo.util:269	INFO	Set up torchrun environment
2025-07-16 16:22:31.235	g3087:3	olmo.util:269	INFO	Set up torchrun environment
2025-07-16 16:22:31.255	g3087:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-16 16:22:31.444	g3087:2	root:266	INFO	Setting eval subset batches to 128
2025-07-16 16:22:31.444	g3087:3	root:266	INFO	Setting eval subset batches to 128
2025-07-16 16:22:31.445	g3087:1	root:266	INFO	Setting eval subset batches to 128
2025-07-16 16:22:31.444	g3087:0	root:266	INFO	Setting eval subset batches to 128
2025-07-16 16:22:32.124	g3087:1	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-16 16:22:32.124	g3087:3	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-16 16:22:32.124	g3087:2	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-16 16:22:32.124	g3087:0	train:54	INFO	Configuration:
2025-07-16 16:22:32.125	g3087:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=3584, n_heads=28, n_kv_heads=4, head_dim=None, qkv_bias=True, clip_qkv=None, n_layers=28, mlp_ratio=4, mlp_hidden_size=37888, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=1000000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='rms', layer_norm_with_affine=True, layer_norm_eps=1e-06, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=False, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.0, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=152064, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2.5-7B', tokenizer_dir=None), init_path='gs://mm-olmo/pretrained_llms/qwen2.5-7b.pt', init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='siglip', image_default_input_size=(378, 378), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1152, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=27, image_head_dim=72, image_mlp_dim=4304, image_mlp_activations='gelu_pytorch_tanh', image_dropout_rate=0.0, image_num_pos=729, image_norm_eps=1e-06, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path='gs://mm-olmo/pretrained_image_encoders/siglip2-so400m-14-384.pt', resize_mode='siglip', pad_value=0.0, normalize='siglip'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-3, -9), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='overlap-and-resize-c2', max_crops=8, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear', per_image_output_tokens=64), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'depth': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=2000, inf_evaluators=[InfDatasetEvaluatorConfig(label='depth', data=DataLoaderConfig(dataset='depth', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=2048, console_log_interval=20, include_image=False)], inf_eval_interval=2000, eval_on_last_step=True, eval_on_load=False, save_folder='/mmfs1/gscratch/krishna/mahtab/Umolmo/checkpoints/molmo-7b-qwen2-siglip2-finetune', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint='/mmfs1/gscratch/krishna/mahtab/Umolmo/pretrained/step22347-unsharded', allow_resume=True, max_duration=30000, global_train_batch_size=256, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=WandbConfig(project='mmseek', entity='allenai-team1', group=None, name='molmo-7b-qwen2-siglip2-finetune', tags=['watching'], log_artifacts=False, rank_zero_only=True, log_interval=20, allow_resume=False), beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=20, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=30000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-16 16:22:32.458	g3087:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-16 16:22:34.817	g3087:3	root:123	INFO	Padding tokenizer with 397 tokens
2025-07-16 16:22:34.819	g3087:1	root:123	INFO	Padding tokenizer with 397 tokens
2025-07-16 16:22:34.819	g3087:2	root:123	INFO	Padding tokenizer with 397 tokens
2025-07-16 16:22:34.844	g3087:0	root:123	INFO	Padding tokenizer with 397 tokens
2025-07-16 16:22:40.558	g3087:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-16 16:22:40.559	g3087:1	train:180	INFO	Wrapping model with FSDP2...
2025-07-16 16:22:40.571	g3087:3	train:180	INFO	Wrapping model with FSDP2...
2025-07-16 16:22:40.572	g3087:2	train:180	INFO	Wrapping model with FSDP2...
2025-07-16 16:22:41.575	g3087:0	train:191	INFO	Total number of parameters: 8,127,216,592
2025-07-16 16:22:41.577	g3087:1	train:191	INFO	Total number of parameters: 8,127,216,592
2025-07-16 16:22:41.578	g3087:0	train:192	INFO	Number of non-embedding parameters: 7,581,760,464
2025-07-16 16:22:41.579	g3087:1	train:192	INFO	Number of non-embedding parameters: 7,581,760,464
2025-07-16 16:22:41.580	g3087:1	train:195	INFO	Peak GPU Memory (MB) after FSDP: 8178
2025-07-16 16:22:41.580	g3087:1	train:196	INFO	Model:
2025-07-16 16:22:41.580	g3087:1	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0-27): 28 x FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=3584, out_features=3584, bias=False)
          (ff_out): Linear(in_features=18944, out_features=3584, bias=False)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): RMSLayerNorm()
          (ff_norm): RMSLayerNorm()
          (att_proj): Linear(in_features=3584, out_features=4608, bias=True)
          (ff_proj): Linear(in_features=3584, out_features=37888, bias=False)
        )
      )
    )
    (ln_f): FSDPRMSLayerNorm()
    (emb_drop): Dropout(p=0.0, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=3584, out_features=152192, bias=False)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=2304, out_features=1152, bias=True)
        (wk): Linear(in_features=2304, out_features=1152, bias=True)
        (wv): Linear(in_features=2304, out_features=1152, bias=True)
        (wo): Linear(in_features=1152, out_features=1152, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1152, out_features=18944, bias=False)
        (w2): Linear(in_features=18944, out_features=3584, bias=False)
        (w3): Linear(in_features=1152, out_features=18944, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPSiglipVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1152, bias=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0-24): 25 x FSDPCheckpointWrapper(
            (_checkpoint_wrapped_module): ResidualAttentionBlock(
              (attention): ViTMultiHeadDotProductAttention(
                (wq): Linear(in_features=1152, out_features=1152, bias=True)
                (wk): Linear(in_features=1152, out_features=1152, bias=True)
                (wv): Linear(in_features=1152, out_features=1152, bias=True)
                (wo): Linear(in_features=1152, out_features=1152, bias=True)
                (residual_dropout): Dropout(p=0.0, inplace=False)
              )
              (feed_forward): ViTMLP(
                (w1): Linear(in_features=1152, out_features=4304, bias=True)
                (act): PytorchGELUTanh()
                (w2): Linear(in_features=4304, out_features=1152, bias=True)
              )
              (attention_norm): LayerNorm((1152,), eps=1e-06, elementwise_affine=True)
              (ffn_norm): LayerNorm((1152,), eps=1e-06, elementwise_affine=True)
            )
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=1024, out_features=3584, bias=False)
  (vision_decoder_head): Linear(in_features=3584, out_features=1024, bias=False)
)
2025-07-16 16:22:41.607	g3087:1	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-16 16:22:41.607	g3087:1	olmo.data.data_loader:197	INFO	Loading train dataset depth/train
2025-07-16 16:22:41.608	g3087:1	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/train/train.json
2025-07-16 16:22:41.640	g3087:2	train:191	INFO	Total number of parameters: 8,127,216,592
2025-07-16 16:22:41.640	g3087:3	train:191	INFO	Total number of parameters: 8,127,216,592
2025-07-16 16:22:41.642	g3087:2	train:192	INFO	Number of non-embedding parameters: 7,581,760,464
2025-07-16 16:22:41.642	g3087:3	train:192	INFO	Number of non-embedding parameters: 7,581,760,464
2025-07-16 16:22:41.643	g3087:2	train:195	INFO	Peak GPU Memory (MB) after FSDP: 8178
2025-07-16 16:22:41.643	g3087:2	train:196	INFO	Model:
2025-07-16 16:22:41.643	g3087:3	train:195	INFO	Peak GPU Memory (MB) after FSDP: 8178
2025-07-16 16:22:41.643	g3087:3	train:196	INFO	Model:
2025-07-16 16:22:41.643	g3087:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 8178
2025-07-16 16:22:41.644	g3087:0	train:196	INFO	Model:
2025-07-16 16:22:41.643	g3087:2	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0-27): 28 x FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=3584, out_features=3584, bias=False)
          (ff_out): Linear(in_features=18944, out_features=3584, bias=False)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): RMSLayerNorm()
          (ff_norm): RMSLayerNorm()
          (att_proj): Linear(in_features=3584, out_features=4608, bias=True)
          (ff_proj): Linear(in_features=3584, out_features=37888, bias=False)
        )
      )
    )
    (ln_f): FSDPRMSLayerNorm()
    (emb_drop): Dropout(p=0.0, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=3584, out_features=152192, bias=False)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=2304, out_features=1152, bias=True)
        (wk): Linear(in_features=2304, out_features=1152, bias=True)
        (wv): Linear(in_features=2304, out_features=1152, bias=True)
        (wo): Linear(in_features=1152, out_features=1152, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1152, out_features=18944, bias=False)
        (w2): Linear(in_features=18944, out_features=3584, bias=False)
        (w3): Linear(in_features=1152, out_features=18944, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPSiglipVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1152, bias=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0-24): 25 x FSDPCheckpointWrapper(
            (_checkpoint_wrapped_module): ResidualAttentionBlock(
              (attention): ViTMultiHeadDotProductAttention(
                (wq): Linear(in_features=1152, out_features=1152, bias=True)
                (wk): Linear(in_features=1152, out_features=1152, bias=True)
                (wv): Linear(in_features=1152, out_features=1152, bias=True)
                (wo): Linear(in_features=1152, out_features=1152, bias=True)
                (residual_dropout): Dropout(p=0.0, inplace=False)
              )
              (feed_forward): ViTMLP(
                (w1): Linear(in_features=1152, out_features=4304, bias=True)
                (act): PytorchGELUTanh()
                (w2): Linear(in_features=4304, out_features=1152, bias=True)
              )
              (attention_norm): LayerNorm((1152,), eps=1e-06, elementwise_affine=True)
              (ffn_norm): LayerNorm((1152,), eps=1e-06, elementwise_affine=True)
            )
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=1024, out_features=3584, bias=False)
  (vision_decoder_head): Linear(in_features=3584, out_features=1024, bias=False)
)
2025-07-16 16:22:41.643	g3087:3	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0-27): 28 x FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=3584, out_features=3584, bias=False)
          (ff_out): Linear(in_features=18944, out_features=3584, bias=False)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): RMSLayerNorm()
          (ff_norm): RMSLayerNorm()
          (att_proj): Linear(in_features=3584, out_features=4608, bias=True)
          (ff_proj): Linear(in_features=3584, out_features=37888, bias=False)
        )
      )
    )
    (ln_f): FSDPRMSLayerNorm()
    (emb_drop): Dropout(p=0.0, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=3584, out_features=152192, bias=False)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=2304, out_features=1152, bias=True)
        (wk): Linear(in_features=2304, out_features=1152, bias=True)
        (wv): Linear(in_features=2304, out_features=1152, bias=True)
        (wo): Linear(in_features=1152, out_features=1152, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1152, out_features=18944, bias=False)
        (w2): Linear(in_features=18944, out_features=3584, bias=False)
        (w3): Linear(in_features=1152, out_features=18944, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPSiglipVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1152, bias=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0-24): 25 x FSDPCheckpointWrapper(
            (_checkpoint_wrapped_module): ResidualAttentionBlock(
              (attention): ViTMultiHeadDotProductAttention(
                (wq): Linear(in_features=1152, out_features=1152, bias=True)
                (wk): Linear(in_features=1152, out_features=1152, bias=True)
                (wv): Linear(in_features=1152, out_features=1152, bias=True)
                (wo): Linear(in_features=1152, out_features=1152, bias=True)
                (residual_dropout): Dropout(p=0.0, inplace=False)
              )
              (feed_forward): ViTMLP(
                (w1): Linear(in_features=1152, out_features=4304, bias=True)
                (act): PytorchGELUTanh()
                (w2): Linear(in_features=4304, out_features=1152, bias=True)
              )
              (attention_norm): LayerNorm((1152,), eps=1e-06, elementwise_affine=True)
              (ffn_norm): LayerNorm((1152,), eps=1e-06, elementwise_affine=True)
            )
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=1024, out_features=3584, bias=False)
  (vision_decoder_head): Linear(in_features=3584, out_features=1024, bias=False)
)
2025-07-16 16:22:41.655	g3087:2	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-16 16:22:41.656	g3087:3	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-16 16:22:41.644	g3087:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0-27): 28 x FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=3584, out_features=3584, bias=False)
          (ff_out): Linear(in_features=18944, out_features=3584, bias=False)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): RMSLayerNorm()
          (ff_norm): RMSLayerNorm()
          (att_proj): Linear(in_features=3584, out_features=4608, bias=True)
          (ff_proj): Linear(in_features=3584, out_features=37888, bias=False)
        )
      )
    )
    (ln_f): FSDPRMSLayerNorm()
    (emb_drop): Dropout(p=0.0, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=3584, out_features=152192, bias=False)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=2304, out_features=1152, bias=True)
        (wk): Linear(in_features=2304, out_features=1152, bias=True)
        (wv): Linear(in_features=2304, out_features=1152, bias=True)
        (wo): Linear(in_features=1152, out_features=1152, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1152, out_features=18944, bias=False)
        (w2): Linear(in_features=18944, out_features=3584, bias=False)
        (w3): Linear(in_features=1152, out_features=18944, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPSiglipVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1152, bias=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0-24): 25 x FSDPCheckpointWrapper(
            (_checkpoint_wrapped_module): ResidualAttentionBlock(
              (attention): ViTMultiHeadDotProductAttention(
                (wq): Linear(in_features=1152, out_features=1152, bias=True)
                (wk): Linear(in_features=1152, out_features=1152, bias=True)
                (wv): Linear(in_features=1152, out_features=1152, bias=True)
                (wo): Linear(in_features=1152, out_features=1152, bias=True)
                (residual_dropout): Dropout(p=0.0, inplace=False)
              )
              (feed_forward): ViTMLP(
                (w1): Linear(in_features=1152, out_features=4304, bias=True)
                (act): PytorchGELUTanh()
                (w2): Linear(in_features=4304, out_features=1152, bias=True)
              )
              (attention_norm): LayerNorm((1152,), eps=1e-06, elementwise_affine=True)
              (ffn_norm): LayerNorm((1152,), eps=1e-06, elementwise_affine=True)
            )
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=1024, out_features=3584, bias=False)
  (vision_decoder_head): Linear(in_features=3584, out_features=1024, bias=False)
)
2025-07-16 16:22:41.657	g3087:2	olmo.data.data_loader:197	INFO	Loading train dataset depth/train
2025-07-16 16:22:41.657	g3087:2	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/train/train.json
2025-07-16 16:22:41.657	g3087:3	olmo.data.data_loader:197	INFO	Loading train dataset depth/train
2025-07-16 16:22:41.657	g3087:3	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/train/train.json
2025-07-16 16:22:41.664	g3087:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-16 16:22:41.665	g3087:0	olmo.data.data_loader:197	INFO	Loading train dataset depth/train
2025-07-16 16:22:41.666	g3087:0	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/train/train.json
2025-07-16 16:22:41.683	g3087:1	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-16 16:22:41.683	g3087:1	olmo.data.data_loader:219	INFO	depth: 100.00
2025-07-16 16:22:41.699	g3087:2	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-16 16:22:41.700	g3087:2	olmo.data.data_loader:219	INFO	depth: 100.00
2025-07-16 16:22:41.700	g3087:3	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-16 16:22:41.700	g3087:3	olmo.data.data_loader:219	INFO	depth: 100.00
2025-07-16 16:22:41.701	g3087:0	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-16 16:22:41.701	g3087:0	olmo.data.data_loader:219	INFO	depth: 100.00
2025-07-16 16:22:41.844	g3087:1	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=2304 images=9 pooled_patches_idx=1414
2025-07-16 16:22:41.844	g3087:2	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=2304 images=9 pooled_patches_idx=1414
2025-07-16 16:22:41.844	g3087:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=2304 images=9 pooled_patches_idx=1414
2025-07-16 16:22:41.844	g3087:3	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=2304 images=9 pooled_patches_idx=1414
2025-07-16 16:22:41.844	g3087:1	olmo.data.data_loader:100	INFO	Loading eval dataset: depth/validation
2025-07-16 16:22:41.845	g3087:1	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/val/val.json
2025-07-16 16:22:41.845	g3087:2	olmo.data.data_loader:100	INFO	Loading eval dataset: depth/validation
2025-07-16 16:22:41.845	g3087:3	olmo.data.data_loader:100	INFO	Loading eval dataset: depth/validation
2025-07-16 16:22:41.845	g3087:2	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/val/val.json
2025-07-16 16:22:41.845	g3087:3	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/val/val.json
2025-07-16 16:22:41.845	g3087:0	olmo.data.data_loader:100	INFO	Loading eval dataset: depth/validation
2025-07-16 16:22:41.845	g3087:0	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/val/val.json
2025-07-16 16:22:41.889	g3087:1	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=1792 images=9 pooled_patches_idx=1414
2025-07-16 16:22:41.889	g3087:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=1792 images=9 pooled_patches_idx=1414
2025-07-16 16:22:41.890	g3087:2	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=1792 images=9 pooled_patches_idx=1414
2025-07-16 16:22:41.890	g3087:3	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=1792 images=9 pooled_patches_idx=1414
2025-07-16 16:22:46.534	g3087:0	olmo.util:177	CRITICAL	Uncaught CommError: Error uploading run: returned error 403: {"data":{"upsertBucket":null},"errors":[{"message":"permission denied","path":["upsertBucket"],"extensions":{"code":"PERMISSION_ERROR"}}]}
Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/Umolmo/launch_scripts/train_multitask_model.py", line 396, in <module>
    run_trainer(cfg)
  File "/gscratch/krishna/mahtab/Umolmo/scripts/train.py", line 252, in run_trainer
    wandb.init(
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/wandb/sdk/wandb_init.py", line 1623, in init
    wandb._sentry.reraise(e)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/wandb/analytics/sentry.py", line 156, in reraise
    raise exc.with_traceback(sys.exc_info()[2])
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/wandb/sdk/wandb_init.py", line 1609, in init
    return wi.init(run_settings, run_config, run_printer)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/wandb/sdk/wandb_init.py", line 1021, in init
    raise error
wandb.errors.errors.CommError: Error uploading run: returned error 403: {"data":{"upsertBucket":null},"errors":[{"message":"permission denied","path":["upsertBucket"],"extensions":{"code":"PERMISSION_ERROR"}}]}
2025-07-16 16:29:44.790	g3087:3	olmo.util:269	INFO	Set up torchrun environment
2025-07-16 16:29:44.791	g3087:2	olmo.util:269	INFO	Set up torchrun environment
2025-07-16 16:29:44.790	g3087:1	olmo.util:269	INFO	Set up torchrun environment
2025-07-16 16:29:44.818	g3087:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-16 16:29:44.900	g3087:3	root:266	INFO	Setting eval subset batches to 128
2025-07-16 16:29:44.900	g3087:1	root:266	INFO	Setting eval subset batches to 128
2025-07-16 16:29:44.901	g3087:2	root:266	INFO	Setting eval subset batches to 128
2025-07-16 16:29:44.902	g3087:0	root:266	INFO	Setting eval subset batches to 128
2025-07-16 16:29:45.064	g3087:2	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-16 16:29:45.064	g3087:1	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-16 16:29:45.064	g3087:3	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-16 16:29:45.064	g3087:0	train:54	INFO	Configuration:
2025-07-16 16:29:45.064	g3087:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=3584, n_heads=28, n_kv_heads=4, head_dim=None, qkv_bias=True, clip_qkv=None, n_layers=28, mlp_ratio=4, mlp_hidden_size=37888, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=1000000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='rms', layer_norm_with_affine=True, layer_norm_eps=1e-06, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=False, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.0, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=152064, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2.5-7B', tokenizer_dir=None), init_path='gs://mm-olmo/pretrained_llms/qwen2.5-7b.pt', init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='siglip', image_default_input_size=(378, 378), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1152, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=27, image_head_dim=72, image_mlp_dim=4304, image_mlp_activations='gelu_pytorch_tanh', image_dropout_rate=0.0, image_num_pos=729, image_norm_eps=1e-06, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path='gs://mm-olmo/pretrained_image_encoders/siglip2-so400m-14-384.pt', resize_mode='siglip', pad_value=0.0, normalize='siglip'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-3, -9), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='overlap-and-resize-c2', max_crops=8, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear', per_image_output_tokens=64), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'depth': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=2000, inf_evaluators=[InfDatasetEvaluatorConfig(label='depth', data=DataLoaderConfig(dataset='depth', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=2048, console_log_interval=20, include_image=False)], inf_eval_interval=2000, eval_on_last_step=True, eval_on_load=False, save_folder='/mmfs1/gscratch/krishna/mahtab/Umolmo/checkpoints/molmo-7b-qwen2-siglip2-finetune', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint='/mmfs1/gscratch/krishna/mahtab/Umolmo/pretrained/step22347-unsharded', allow_resume=True, max_duration=30000, global_train_batch_size=256, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=WandbConfig(project='mmseek', entity='allenai-team1', group=None, name='molmo-7b-qwen2-siglip2-finetune', tags=['watching'], log_artifacts=False, rank_zero_only=True, log_interval=20, allow_resume=False), beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=20, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=30000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-16 16:29:45.386	g3087:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-16 16:29:47.502	g3087:1	root:123	INFO	Padding tokenizer with 397 tokens
2025-07-16 16:29:47.502	g3087:3	root:123	INFO	Padding tokenizer with 397 tokens
2025-07-16 16:29:47.512	g3087:2	root:123	INFO	Padding tokenizer with 397 tokens
2025-07-16 16:29:47.534	g3087:0	root:123	INFO	Padding tokenizer with 397 tokens
2025-07-16 16:29:49.346	g3087:1	train:180	INFO	Wrapping model with FSDP2...
2025-07-16 16:29:49.347	g3087:2	train:180	INFO	Wrapping model with FSDP2...
2025-07-16 16:29:49.347	g3087:3	train:180	INFO	Wrapping model with FSDP2...
2025-07-16 16:29:49.348	g3087:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-16 16:29:49.732	g3087:1	train:191	INFO	Total number of parameters: 8,127,216,592
2025-07-16 16:29:49.733	g3087:3	train:191	INFO	Total number of parameters: 8,127,216,592
2025-07-16 16:29:49.734	g3087:1	train:192	INFO	Number of non-embedding parameters: 7,581,760,464
2025-07-16 16:29:49.735	g3087:1	train:195	INFO	Peak GPU Memory (MB) after FSDP: 8178
2025-07-16 16:29:49.735	g3087:1	train:196	INFO	Model:
2025-07-16 16:29:49.735	g3087:3	train:192	INFO	Number of non-embedding parameters: 7,581,760,464
2025-07-16 16:29:49.735	g3087:1	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0-27): 28 x FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=3584, out_features=3584, bias=False)
          (ff_out): Linear(in_features=18944, out_features=3584, bias=False)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): RMSLayerNorm()
          (ff_norm): RMSLayerNorm()
          (att_proj): Linear(in_features=3584, out_features=4608, bias=True)
          (ff_proj): Linear(in_features=3584, out_features=37888, bias=False)
        )
      )
    )
    (ln_f): FSDPRMSLayerNorm()
    (emb_drop): Dropout(p=0.0, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=3584, out_features=152192, bias=False)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=2304, out_features=1152, bias=True)
        (wk): Linear(in_features=2304, out_features=1152, bias=True)
        (wv): Linear(in_features=2304, out_features=1152, bias=True)
        (wo): Linear(in_features=1152, out_features=1152, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1152, out_features=18944, bias=False)
        (w2): Linear(in_features=18944, out_features=3584, bias=False)
        (w3): Linear(in_features=1152, out_features=18944, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPSiglipVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1152, bias=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0-24): 25 x FSDPCheckpointWrapper(
            (_checkpoint_wrapped_module): ResidualAttentionBlock(
              (attention): ViTMultiHeadDotProductAttention(
                (wq): Linear(in_features=1152, out_features=1152, bias=True)
                (wk): Linear(in_features=1152, out_features=1152, bias=True)
                (wv): Linear(in_features=1152, out_features=1152, bias=True)
                (wo): Linear(in_features=1152, out_features=1152, bias=True)
                (residual_dropout): Dropout(p=0.0, inplace=False)
              )
              (feed_forward): ViTMLP(
                (w1): Linear(in_features=1152, out_features=4304, bias=True)
                (act): PytorchGELUTanh()
                (w2): Linear(in_features=4304, out_features=1152, bias=True)
              )
              (attention_norm): LayerNorm((1152,), eps=1e-06, elementwise_affine=True)
              (ffn_norm): LayerNorm((1152,), eps=1e-06, elementwise_affine=True)
            )
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=1024, out_features=3584, bias=False)
  (vision_decoder_head): Linear(in_features=3584, out_features=1024, bias=False)
)
2025-07-16 16:29:49.738	g3087:2	train:191	INFO	Total number of parameters: 8,127,216,592
2025-07-16 16:29:49.737	g3087:0	train:191	INFO	Total number of parameters: 8,127,216,592
2025-07-16 16:29:49.770	g3087:2	train:192	INFO	Number of non-embedding parameters: 7,581,760,464
2025-07-16 16:29:49.770	g3087:0	train:192	INFO	Number of non-embedding parameters: 7,581,760,464
2025-07-16 16:29:49.770	g3087:3	train:195	INFO	Peak GPU Memory (MB) after FSDP: 8178
2025-07-16 16:29:49.770	g3087:3	train:196	INFO	Model:
2025-07-16 16:29:49.770	g3087:2	train:195	INFO	Peak GPU Memory (MB) after FSDP: 8178
2025-07-16 16:29:49.770	g3087:2	train:196	INFO	Model:
2025-07-16 16:29:49.771	g3087:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 8178
2025-07-16 16:29:49.771	g3087:0	train:196	INFO	Model:
2025-07-16 16:29:49.770	g3087:3	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0-27): 28 x FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=3584, out_features=3584, bias=False)
          (ff_out): Linear(in_features=18944, out_features=3584, bias=False)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): RMSLayerNorm()
          (ff_norm): RMSLayerNorm()
          (att_proj): Linear(in_features=3584, out_features=4608, bias=True)
          (ff_proj): Linear(in_features=3584, out_features=37888, bias=False)
        )
      )
    )
    (ln_f): FSDPRMSLayerNorm()
    (emb_drop): Dropout(p=0.0, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=3584, out_features=152192, bias=False)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=2304, out_features=1152, bias=True)
        (wk): Linear(in_features=2304, out_features=1152, bias=True)
        (wv): Linear(in_features=2304, out_features=1152, bias=True)
        (wo): Linear(in_features=1152, out_features=1152, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1152, out_features=18944, bias=False)
        (w2): Linear(in_features=18944, out_features=3584, bias=False)
        (w3): Linear(in_features=1152, out_features=18944, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPSiglipVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1152, bias=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0-24): 25 x FSDPCheckpointWrapper(
            (_checkpoint_wrapped_module): ResidualAttentionBlock(
              (attention): ViTMultiHeadDotProductAttention(
                (wq): Linear(in_features=1152, out_features=1152, bias=True)
                (wk): Linear(in_features=1152, out_features=1152, bias=True)
                (wv): Linear(in_features=1152, out_features=1152, bias=True)
                (wo): Linear(in_features=1152, out_features=1152, bias=True)
                (residual_dropout): Dropout(p=0.0, inplace=False)
              )
              (feed_forward): ViTMLP(
                (w1): Linear(in_features=1152, out_features=4304, bias=True)
                (act): PytorchGELUTanh()
                (w2): Linear(in_features=4304, out_features=1152, bias=True)
              )
              (attention_norm): LayerNorm((1152,), eps=1e-06, elementwise_affine=True)
              (ffn_norm): LayerNorm((1152,), eps=1e-06, elementwise_affine=True)
            )
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=1024, out_features=3584, bias=False)
  (vision_decoder_head): Linear(in_features=3584, out_features=1024, bias=False)
)
2025-07-16 16:29:49.775	g3087:1	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-16 16:29:49.771	g3087:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0-27): 28 x FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=3584, out_features=3584, bias=False)
          (ff_out): Linear(in_features=18944, out_features=3584, bias=False)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): RMSLayerNorm()
          (ff_norm): RMSLayerNorm()
          (att_proj): Linear(in_features=3584, out_features=4608, bias=True)
          (ff_proj): Linear(in_features=3584, out_features=37888, bias=False)
        )
      )
    )
    (ln_f): FSDPRMSLayerNorm()
    (emb_drop): Dropout(p=0.0, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=3584, out_features=152192, bias=False)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=2304, out_features=1152, bias=True)
        (wk): Linear(in_features=2304, out_features=1152, bias=True)
        (wv): Linear(in_features=2304, out_features=1152, bias=True)
        (wo): Linear(in_features=1152, out_features=1152, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1152, out_features=18944, bias=False)
        (w2): Linear(in_features=18944, out_features=3584, bias=False)
        (w3): Linear(in_features=1152, out_features=18944, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPSiglipVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1152, bias=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0-24): 25 x FSDPCheckpointWrapper(
            (_checkpoint_wrapped_module): ResidualAttentionBlock(
              (attention): ViTMultiHeadDotProductAttention(
                (wq): Linear(in_features=1152, out_features=1152, bias=True)
                (wk): Linear(in_features=1152, out_features=1152, bias=True)
                (wv): Linear(in_features=1152, out_features=1152, bias=True)
                (wo): Linear(in_features=1152, out_features=1152, bias=True)
                (residual_dropout): Dropout(p=0.0, inplace=False)
              )
              (feed_forward): ViTMLP(
                (w1): Linear(in_features=1152, out_features=4304, bias=True)
                (act): PytorchGELUTanh()
                (w2): Linear(in_features=4304, out_features=1152, bias=True)
              )
              (attention_norm): LayerNorm((1152,), eps=1e-06, elementwise_affine=True)
              (ffn_norm): LayerNorm((1152,), eps=1e-06, elementwise_affine=True)
            )
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=1024, out_features=3584, bias=False)
  (vision_decoder_head): Linear(in_features=3584, out_features=1024, bias=False)
)
2025-07-16 16:29:49.770	g3087:2	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0-27): 28 x FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=3584, out_features=3584, bias=False)
          (ff_out): Linear(in_features=18944, out_features=3584, bias=False)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): RMSLayerNorm()
          (ff_norm): RMSLayerNorm()
          (att_proj): Linear(in_features=3584, out_features=4608, bias=True)
          (ff_proj): Linear(in_features=3584, out_features=37888, bias=False)
        )
      )
    )
    (ln_f): FSDPRMSLayerNorm()
    (emb_drop): Dropout(p=0.0, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=3584, out_features=152192, bias=False)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=2304, out_features=1152, bias=True)
        (wk): Linear(in_features=2304, out_features=1152, bias=True)
        (wv): Linear(in_features=2304, out_features=1152, bias=True)
        (wo): Linear(in_features=1152, out_features=1152, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1152, out_features=18944, bias=False)
        (w2): Linear(in_features=18944, out_features=3584, bias=False)
        (w3): Linear(in_features=1152, out_features=18944, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPSiglipVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1152, bias=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0-24): 25 x FSDPCheckpointWrapper(
            (_checkpoint_wrapped_module): ResidualAttentionBlock(
              (attention): ViTMultiHeadDotProductAttention(
                (wq): Linear(in_features=1152, out_features=1152, bias=True)
                (wk): Linear(in_features=1152, out_features=1152, bias=True)
                (wv): Linear(in_features=1152, out_features=1152, bias=True)
                (wo): Linear(in_features=1152, out_features=1152, bias=True)
                (residual_dropout): Dropout(p=0.0, inplace=False)
              )
              (feed_forward): ViTMLP(
                (w1): Linear(in_features=1152, out_features=4304, bias=True)
                (act): PytorchGELUTanh()
                (w2): Linear(in_features=4304, out_features=1152, bias=True)
              )
              (attention_norm): LayerNorm((1152,), eps=1e-06, elementwise_affine=True)
              (ffn_norm): LayerNorm((1152,), eps=1e-06, elementwise_affine=True)
            )
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=1024, out_features=3584, bias=False)
  (vision_decoder_head): Linear(in_features=3584, out_features=1024, bias=False)
)
2025-07-16 16:29:49.822	g3087:1	olmo.data.data_loader:197	INFO	Loading train dataset depth/train
2025-07-16 16:29:49.825	g3087:1	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/train/train.json
2025-07-16 16:29:49.828	g3087:3	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-16 16:29:49.829	g3087:3	olmo.data.data_loader:197	INFO	Loading train dataset depth/train
2025-07-16 16:29:49.829	g3087:3	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/train/train.json
2025-07-16 16:29:49.831	g3087:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-16 16:29:49.832	g3087:2	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-16 16:29:49.833	g3087:0	olmo.data.data_loader:197	INFO	Loading train dataset depth/train
2025-07-16 16:29:49.833	g3087:0	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/train/train.json
2025-07-16 16:29:49.833	g3087:2	olmo.data.data_loader:197	INFO	Loading train dataset depth/train
2025-07-16 16:29:49.833	g3087:2	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/train/train.json
2025-07-16 16:29:49.906	g3087:0	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-16 16:29:49.907	g3087:3	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-16 16:29:49.907	g3087:3	olmo.data.data_loader:219	INFO	depth: 100.00
2025-07-16 16:29:49.907	g3087:0	olmo.data.data_loader:219	INFO	depth: 100.00
2025-07-16 16:29:49.907	g3087:1	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-16 16:29:49.907	g3087:1	olmo.data.data_loader:219	INFO	depth: 100.00
2025-07-16 16:29:49.907	g3087:2	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-16 16:29:49.907	g3087:2	olmo.data.data_loader:219	INFO	depth: 100.00
2025-07-16 16:29:49.909	g3087:3	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=2304 images=9 pooled_patches_idx=1414
2025-07-16 16:29:49.909	g3087:1	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=2304 images=9 pooled_patches_idx=1414
2025-07-16 16:29:49.909	g3087:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=2304 images=9 pooled_patches_idx=1414
2025-07-16 16:29:49.909	g3087:2	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=2304 images=9 pooled_patches_idx=1414
2025-07-16 16:29:49.910	g3087:3	olmo.data.data_loader:100	INFO	Loading eval dataset: depth/validation
2025-07-16 16:29:49.910	g3087:3	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/val/val.json
2025-07-16 16:29:49.910	g3087:1	olmo.data.data_loader:100	INFO	Loading eval dataset: depth/validation
2025-07-16 16:29:49.910	g3087:1	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/val/val.json
2025-07-16 16:29:49.910	g3087:2	olmo.data.data_loader:100	INFO	Loading eval dataset: depth/validation
2025-07-16 16:29:49.910	g3087:2	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/val/val.json
2025-07-16 16:29:49.910	g3087:0	olmo.data.data_loader:100	INFO	Loading eval dataset: depth/validation
2025-07-16 16:29:49.910	g3087:0	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/val/val.json
2025-07-16 16:29:49.911	g3087:3	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=1792 images=9 pooled_patches_idx=1414
2025-07-16 16:29:49.911	g3087:1	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=1792 images=9 pooled_patches_idx=1414
2025-07-16 16:29:49.912	g3087:2	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=1792 images=9 pooled_patches_idx=1414
2025-07-16 16:29:49.912	g3087:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=1792 images=9 pooled_patches_idx=1414
2025-07-16 16:30:05.064	g3087:2	train:308	INFO	Loading unshared model from /mmfs1/gscratch/krishna/mahtab/Umolmo/pretrained/step22347-unsharded
2025-07-16 16:30:05.064	g3087:3	train:308	INFO	Loading unshared model from /mmfs1/gscratch/krishna/mahtab/Umolmo/pretrained/step22347-unsharded
2025-07-16 16:30:05.064	g3087:0	train:308	INFO	Loading unshared model from /mmfs1/gscratch/krishna/mahtab/Umolmo/pretrained/step22347-unsharded
2025-07-16 16:30:05.064	g3087:1	train:308	INFO	Loading unshared model from /mmfs1/gscratch/krishna/mahtab/Umolmo/pretrained/step22347-unsharded
2025-07-16 16:30:55.875	g3087:1	olmo.util:177	CRITICAL	Uncaught RuntimeError: The size of tensor a (38048) must match the size of tensor b (38016) at non-singleton dimension 0
Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/Umolmo/launch_scripts/train_multitask_model.py", line 396, in <module>
    run_trainer(cfg)
  File "/gscratch/krishna/mahtab/Umolmo/scripts/train.py", line 309, in run_trainer
    load_model_state_unsharded(start_from, fsdp_model)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/checkpointer.py", line 52, in load_model_state_unsharded
    dist_cp_sd.set_model_state_dict(
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/distributed/checkpoint/state_dict.py", line 1277, in set_model_state_dict
    return _load_model_state_dict(model, model_state_dict, info)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/distributed/checkpoint/state_dict.py", line 590, in _load_model_state_dict
    _broadcast_state_dict(
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/distributed/_state_dict_utils.py", line 633, in _broadcast_state_dict
    _broadcast_tensors(ret, local_state_dict, keys, device, pg)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/distributed/_state_dict_utils.py", line 547, in _broadcast_tensors
    _distribute_tensors(local_state_dict, keys, device, pg)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/distributed/_state_dict_utils.py", line 588, in _distribute_tensors
    ret.to_local().copy_(full_tensor[slices])
RuntimeError: The size of tensor a (38048) must match the size of tensor b (38016) at non-singleton dimension 0
2025-07-16 16:30:55.876	g3087:2	olmo.util:177	CRITICAL	Uncaught RuntimeError: The size of tensor a (38048) must match the size of tensor b (38016) at non-singleton dimension 0
Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/Umolmo/launch_scripts/train_multitask_model.py", line 396, in <module>
    run_trainer(cfg)
  File "/gscratch/krishna/mahtab/Umolmo/scripts/train.py", line 309, in run_trainer
    load_model_state_unsharded(start_from, fsdp_model)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/checkpointer.py", line 52, in load_model_state_unsharded
    dist_cp_sd.set_model_state_dict(
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/distributed/checkpoint/state_dict.py", line 1277, in set_model_state_dict
    return _load_model_state_dict(model, model_state_dict, info)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/distributed/checkpoint/state_dict.py", line 590, in _load_model_state_dict
    _broadcast_state_dict(
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/distributed/_state_dict_utils.py", line 633, in _broadcast_state_dict
    _broadcast_tensors(ret, local_state_dict, keys, device, pg)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/distributed/_state_dict_utils.py", line 547, in _broadcast_tensors
    _distribute_tensors(local_state_dict, keys, device, pg)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/distributed/_state_dict_utils.py", line 588, in _distribute_tensors
    ret.to_local().copy_(full_tensor[slices])
RuntimeError: The size of tensor a (38048) must match the size of tensor b (38016) at non-singleton dimension 0
2025-07-16 16:30:55.876	g3087:3	olmo.util:177	CRITICAL	Uncaught RuntimeError: The size of tensor a (38048) must match the size of tensor b (38016) at non-singleton dimension 0
Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/Umolmo/launch_scripts/train_multitask_model.py", line 396, in <module>
    run_trainer(cfg)
  File "/gscratch/krishna/mahtab/Umolmo/scripts/train.py", line 309, in run_trainer
    load_model_state_unsharded(start_from, fsdp_model)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/checkpointer.py", line 52, in load_model_state_unsharded
    dist_cp_sd.set_model_state_dict(
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/distributed/checkpoint/state_dict.py", line 1277, in set_model_state_dict
    return _load_model_state_dict(model, model_state_dict, info)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/distributed/checkpoint/state_dict.py", line 590, in _load_model_state_dict
    _broadcast_state_dict(
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/distributed/_state_dict_utils.py", line 633, in _broadcast_state_dict
    _broadcast_tensors(ret, local_state_dict, keys, device, pg)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/distributed/_state_dict_utils.py", line 547, in _broadcast_tensors
    _distribute_tensors(local_state_dict, keys, device, pg)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/distributed/_state_dict_utils.py", line 588, in _distribute_tensors
    ret.to_local().copy_(full_tensor[slices])
RuntimeError: The size of tensor a (38048) must match the size of tensor b (38016) at non-singleton dimension 0
2025-07-16 16:30:57.097	g3087:0	olmo.util:177	CRITICAL	Uncaught RuntimeError: The size of tensor a (38048) must match the size of tensor b (38016) at non-singleton dimension 0
Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/Umolmo/launch_scripts/train_multitask_model.py", line 396, in <module>
    run_trainer(cfg)
  File "/gscratch/krishna/mahtab/Umolmo/scripts/train.py", line 309, in run_trainer
    load_model_state_unsharded(start_from, fsdp_model)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/checkpointer.py", line 52, in load_model_state_unsharded
    dist_cp_sd.set_model_state_dict(
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/distributed/checkpoint/state_dict.py", line 1277, in set_model_state_dict
    return _load_model_state_dict(model, model_state_dict, info)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/distributed/checkpoint/state_dict.py", line 590, in _load_model_state_dict
    _broadcast_state_dict(
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/distributed/_state_dict_utils.py", line 633, in _broadcast_state_dict
    _broadcast_tensors(ret, local_state_dict, keys, device, pg)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/distributed/_state_dict_utils.py", line 547, in _broadcast_tensors
    _distribute_tensors(local_state_dict, keys, device, pg)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/distributed/_state_dict_utils.py", line 588, in _distribute_tensors
    ret.to_local().copy_(full_tensor[slices])
RuntimeError: The size of tensor a (38048) must match the size of tensor b (38016) at non-singleton dimension 0
2025-07-16 16:58:22.425	g3087:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-16 16:58:22.588	g3087:0	root:266	INFO	Setting eval subset batches to 512
2025-07-16 16:58:22.659	g3087:0	train:54	INFO	Configuration:
2025-07-16 16:58:22.659	g3087:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=3584, n_heads=28, n_kv_heads=4, head_dim=None, qkv_bias=True, clip_qkv=None, n_layers=28, mlp_ratio=4, mlp_hidden_size=37888, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=1000000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='rms', layer_norm_with_affine=True, layer_norm_eps=1e-06, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=False, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.0, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=152064, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2.5-7B', tokenizer_dir=None), init_path='gs://mm-olmo/pretrained_llms/qwen2.5-7b.pt', init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='siglip', image_default_input_size=(378, 378), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1152, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=27, image_head_dim=72, image_mlp_dim=4304, image_mlp_activations='gelu_pytorch_tanh', image_dropout_rate=0.0, image_num_pos=729, image_norm_eps=1e-06, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path='gs://mm-olmo/pretrained_image_encoders/siglip2-so400m-14-384.pt', resize_mode='siglip', pad_value=0.0, normalize='siglip'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-3, -9), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='overlap-and-resize-c2', max_crops=8, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear', per_image_output_tokens=64), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'depth': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=2000, inf_evaluators=[InfDatasetEvaluatorConfig(label='depth', data=DataLoaderConfig(dataset='depth', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=2048, console_log_interval=20, include_image=False)], inf_eval_interval=2000, eval_on_last_step=True, eval_on_load=False, save_folder='/mmfs1/gscratch/krishna/mahtab/Umolmo/checkpoints/molmo-7b-qwen2-siglip2-finetune', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint='/mmfs1/gscratch/krishna/mahtab/Umolmo/pretrained/step22347-unsharded', allow_resume=True, max_duration=30000, global_train_batch_size=256, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=WandbConfig(project='mmseek', entity='allenai-team1', group=None, name='molmo-7b-qwen2-siglip2-finetune', tags=['watching'], log_artifacts=False, rank_zero_only=True, log_interval=20, allow_resume=False), beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=20, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=30000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-16 16:58:23.017	g3087:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-16 16:58:25.157	g3087:0	root:123	INFO	Padding tokenizer with 397 tokens
2025-07-16 16:58:26.981	g3087:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-16 16:58:27.364	g3087:0	train:191	INFO	Total number of parameters: 8,127,216,592
2025-07-16 16:58:27.366	g3087:0	train:192	INFO	Number of non-embedding parameters: 7,581,760,464
2025-07-16 16:58:27.367	g3087:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 32605
2025-07-16 16:58:27.368	g3087:0	train:196	INFO	Model:
2025-07-16 16:58:27.368	g3087:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0-27): 28 x FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=3584, out_features=3584, bias=False)
          (ff_out): Linear(in_features=18944, out_features=3584, bias=False)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): RMSLayerNorm()
          (ff_norm): RMSLayerNorm()
          (att_proj): Linear(in_features=3584, out_features=4608, bias=True)
          (ff_proj): Linear(in_features=3584, out_features=37888, bias=False)
        )
      )
    )
    (ln_f): FSDPRMSLayerNorm()
    (emb_drop): Dropout(p=0.0, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=3584, out_features=152192, bias=False)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=2304, out_features=1152, bias=True)
        (wk): Linear(in_features=2304, out_features=1152, bias=True)
        (wv): Linear(in_features=2304, out_features=1152, bias=True)
        (wo): Linear(in_features=1152, out_features=1152, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1152, out_features=18944, bias=False)
        (w2): Linear(in_features=18944, out_features=3584, bias=False)
        (w3): Linear(in_features=1152, out_features=18944, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPSiglipVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1152, bias=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0-24): 25 x FSDPCheckpointWrapper(
            (_checkpoint_wrapped_module): ResidualAttentionBlock(
              (attention): ViTMultiHeadDotProductAttention(
                (wq): Linear(in_features=1152, out_features=1152, bias=True)
                (wk): Linear(in_features=1152, out_features=1152, bias=True)
                (wv): Linear(in_features=1152, out_features=1152, bias=True)
                (wo): Linear(in_features=1152, out_features=1152, bias=True)
                (residual_dropout): Dropout(p=0.0, inplace=False)
              )
              (feed_forward): ViTMLP(
                (w1): Linear(in_features=1152, out_features=4304, bias=True)
                (act): PytorchGELUTanh()
                (w2): Linear(in_features=4304, out_features=1152, bias=True)
              )
              (attention_norm): LayerNorm((1152,), eps=1e-06, elementwise_affine=True)
              (ffn_norm): LayerNorm((1152,), eps=1e-06, elementwise_affine=True)
            )
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=1024, out_features=3584, bias=False)
  (vision_decoder_head): Linear(in_features=3584, out_features=1024, bias=False)
)
2025-07-16 16:58:27.421	g3087:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-16 16:58:27.422	g3087:0	olmo.data.data_loader:197	INFO	Loading train dataset depth/train
2025-07-16 16:58:27.422	g3087:0	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/train/train.json
2025-07-16 16:58:27.499	g3087:0	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-16 16:58:27.500	g3087:0	olmo.data.data_loader:219	INFO	depth: 100.00
2025-07-16 16:58:27.502	g3087:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=2304 images=9 pooled_patches_idx=1414
2025-07-16 16:58:27.503	g3087:0	olmo.data.data_loader:100	INFO	Loading eval dataset: depth/validation
2025-07-16 16:58:27.503	g3087:0	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/val/val.json
2025-07-16 16:58:27.505	g3087:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=1792 images=9 pooled_patches_idx=1414
2025-07-16 16:58:32.135	g3087:0	train:308	INFO	Loading unshared model from /mmfs1/gscratch/krishna/mahtab/Umolmo/pretrained/step22347-unsharded
2025-07-16 16:59:15.092	g3087:0	olmo.util:177	CRITICAL	Uncaught RuntimeError: The size of tensor a (152192) must match the size of tensor b (152064) at non-singleton dimension 0
Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/Umolmo/launch_scripts/train_multitask_model.py", line 396, in <module>
    run_trainer(cfg)
  File "/gscratch/krishna/mahtab/Umolmo/scripts/train.py", line 309, in run_trainer
    load_model_state_unsharded(start_from, fsdp_model)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/checkpointer.py", line 52, in load_model_state_unsharded
    dist_cp_sd.set_model_state_dict(
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/distributed/checkpoint/state_dict.py", line 1277, in set_model_state_dict
    return _load_model_state_dict(model, model_state_dict, info)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/distributed/checkpoint/state_dict.py", line 590, in _load_model_state_dict
    _broadcast_state_dict(
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/distributed/_state_dict_utils.py", line 633, in _broadcast_state_dict
    _broadcast_tensors(ret, local_state_dict, keys, device, pg)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/distributed/_state_dict_utils.py", line 547, in _broadcast_tensors
    _distribute_tensors(local_state_dict, keys, device, pg)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/distributed/_state_dict_utils.py", line 588, in _distribute_tensors
    ret.to_local().copy_(full_tensor[slices])
RuntimeError: The size of tensor a (152192) must match the size of tensor b (152064) at non-singleton dimension 0
2025-07-16 17:00:38.062	g3087:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-16 17:00:38.148	g3087:0	root:266	INFO	Setting eval subset batches to 512
2025-07-16 17:00:38.218	g3087:0	train:54	INFO	Configuration:
2025-07-16 17:00:38.218	g3087:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=3584, n_heads=28, n_kv_heads=4, head_dim=None, qkv_bias=True, clip_qkv=None, n_layers=28, mlp_ratio=4, mlp_hidden_size=37888, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=1000000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='rms', layer_norm_with_affine=True, layer_norm_eps=1e-06, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=False, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.0, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=152064, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2.5-7B', tokenizer_dir=None), init_path='gs://mm-olmo/pretrained_llms/qwen2.5-7b.pt', init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='siglip', image_default_input_size=(378, 378), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1152, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=27, image_head_dim=72, image_mlp_dim=4304, image_mlp_activations='gelu_pytorch_tanh', image_dropout_rate=0.0, image_num_pos=729, image_norm_eps=1e-06, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path='gs://mm-olmo/pretrained_image_encoders/siglip2-so400m-14-384.pt', resize_mode='siglip', pad_value=0.0, normalize='siglip'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-3, -9), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='overlap-and-resize-c2', max_crops=8, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear', per_image_output_tokens=64), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'depth': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=2000, inf_evaluators=[InfDatasetEvaluatorConfig(label='depth', data=DataLoaderConfig(dataset='depth', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=2048, console_log_interval=20, include_image=False)], inf_eval_interval=2000, eval_on_last_step=True, eval_on_load=False, save_folder='/mmfs1/gscratch/krishna/mahtab/Umolmo/checkpoints/molmo-7b-qwen2-siglip2-finetune', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint='/mmfs1/gscratch/krishna/mahtab/Umolmo/pretrained/step22347-unsharded', allow_resume=True, max_duration=30000, global_train_batch_size=256, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=WandbConfig(project='mmseek', entity='allenai-team1', group=None, name='molmo-7b-qwen2-siglip2-finetune', tags=['watching'], log_artifacts=False, rank_zero_only=True, log_interval=20, allow_resume=False), beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=20, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=30000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-16 17:00:38.592	g3087:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-16 17:04:07.036	g3087:0	olmo.util:177	CRITICAL	Uncaught BdbQuit: 
Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/Umolmo/launch_scripts/train_multitask_model.py", line 396, in <module>
    run_trainer(cfg)
  File "/gscratch/krishna/mahtab/Umolmo/scripts/train.py", line 104, in run_trainer
    olmo_model = model_cfg.build_model()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py", line 133, in build_model
    return Molmo(self, device)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py", line 151, in __init__
    self.special_ids = tokenizer.get_special_token_ids(self.config.build_tokenizer())
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py", line 96, in build_tokenizer
    return self.llm.build_tokenizer()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/nn/llm.py", line 579, in build_tokenizer
    return self.tokenizer.build(pad_tokenizer_to=pad_tokenizer_to)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/tokenizer.py", line 175, in build
    def build(self, pad_tokenizer_to):
  File "/gscratch/krishna/mahtab/Umolmo/olmo/tokenizer.py", line 123, in build_tokenizer
    # the special token embedding matrix, so we pad the vocab with additional special tokens
  File "/gscratch/krishna/mahtab/Umolmo/olmo/tokenizer.py", line 123, in build_tokenizer
    # the special token embedding matrix, so we pad the vocab with additional special tokens
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/bdb.py", line 90, in trace_dispatch
    return self.dispatch_line(frame)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/bdb.py", line 115, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit
2025-07-16 17:05:48.091	g3087:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-16 17:05:48.170	g3087:0	root:266	INFO	Setting eval subset batches to 512
2025-07-16 17:05:48.239	g3087:0	train:54	INFO	Configuration:
2025-07-16 17:05:48.239	g3087:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=3584, n_heads=28, n_kv_heads=4, head_dim=None, qkv_bias=True, clip_qkv=None, n_layers=28, mlp_ratio=4, mlp_hidden_size=37888, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=1000000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='rms', layer_norm_with_affine=True, layer_norm_eps=1e-06, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=False, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.0, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=152064, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2.5-7B', tokenizer_dir=None), init_path='gs://mm-olmo/pretrained_llms/qwen2.5-7b.pt', init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='siglip', image_default_input_size=(378, 378), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1152, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=27, image_head_dim=72, image_mlp_dim=4304, image_mlp_activations='gelu_pytorch_tanh', image_dropout_rate=0.0, image_num_pos=729, image_norm_eps=1e-06, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path='gs://mm-olmo/pretrained_image_encoders/siglip2-so400m-14-384.pt', resize_mode='siglip', pad_value=0.0, normalize='siglip'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-3, -9), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='overlap-and-resize-c2', max_crops=8, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear', per_image_output_tokens=64), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'depth': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=2000, inf_evaluators=[InfDatasetEvaluatorConfig(label='depth', data=DataLoaderConfig(dataset='depth', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=2048, console_log_interval=20, include_image=False)], inf_eval_interval=2000, eval_on_last_step=True, eval_on_load=False, save_folder='/mmfs1/gscratch/krishna/mahtab/Umolmo/checkpoints/molmo-7b-qwen2-siglip2-finetune', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint='/mmfs1/gscratch/krishna/mahtab/Umolmo/pretrained/step22347-unsharded', allow_resume=True, max_duration=30000, global_train_batch_size=256, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=WandbConfig(project='mmseek', entity='allenai-team1', group=None, name='molmo-7b-qwen2-siglip2-finetune', tags=['watching'], log_artifacts=False, rank_zero_only=True, log_interval=20, allow_resume=False), beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=20, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=30000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-16 17:05:48.569	g3087:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-16 17:06:08.108	g3087:0	root:126	INFO	Padding tokenizer with 390 tokens
2025-07-16 17:07:32.759	g3087:0	olmo.util:177	CRITICAL	Uncaught AssertionError: 
Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/Umolmo/launch_scripts/train_multitask_model.py", line 396, in <module>
    run_trainer(cfg)
  File "/gscratch/krishna/mahtab/Umolmo/scripts/train.py", line 104, in run_trainer
    olmo_model = model_cfg.build_model()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py", line 133, in build_model
    return Molmo(self, device)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py", line 151, in __init__
    self.special_ids = tokenizer.get_special_token_ids(self.config.build_tokenizer())
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py", line 96, in build_tokenizer
    return self.llm.build_tokenizer()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/nn/llm.py", line 579, in build_tokenizer
    return self.tokenizer.build(pad_tokenizer_to=pad_tokenizer_to)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/tokenizer.py", line 179, in build
    self.identifier,
  File "/gscratch/krishna/mahtab/Umolmo/olmo/tokenizer.py", line 154, in build_tokenizer
AssertionError
2025-07-16 17:08:16.058	g3087:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-16 17:08:16.138	g3087:0	root:266	INFO	Setting eval subset batches to 512
2025-07-16 17:08:16.207	g3087:0	train:54	INFO	Configuration:
2025-07-16 17:08:16.208	g3087:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=3584, n_heads=28, n_kv_heads=4, head_dim=None, qkv_bias=True, clip_qkv=None, n_layers=28, mlp_ratio=4, mlp_hidden_size=37888, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=1000000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='rms', layer_norm_with_affine=True, layer_norm_eps=1e-06, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=False, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.0, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=152064, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2.5-7B', tokenizer_dir=None), init_path='gs://mm-olmo/pretrained_llms/qwen2.5-7b.pt', init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='siglip', image_default_input_size=(378, 378), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1152, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=27, image_head_dim=72, image_mlp_dim=4304, image_mlp_activations='gelu_pytorch_tanh', image_dropout_rate=0.0, image_num_pos=729, image_norm_eps=1e-06, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path='gs://mm-olmo/pretrained_image_encoders/siglip2-so400m-14-384.pt', resize_mode='siglip', pad_value=0.0, normalize='siglip'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-3, -9), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='overlap-and-resize-c2', max_crops=8, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear', per_image_output_tokens=64), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'depth': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=2000, inf_evaluators=[InfDatasetEvaluatorConfig(label='depth', data=DataLoaderConfig(dataset='depth', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=2048, console_log_interval=20, include_image=False)], inf_eval_interval=2000, eval_on_last_step=True, eval_on_load=False, save_folder='/mmfs1/gscratch/krishna/mahtab/Umolmo/checkpoints/molmo-7b-qwen2-siglip2-finetune', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint='/mmfs1/gscratch/krishna/mahtab/Umolmo/pretrained/step22347-unsharded', allow_resume=True, max_duration=30000, global_train_batch_size=256, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=WandbConfig(project='mmseek', entity='allenai-team1', group=None, name='molmo-7b-qwen2-siglip2-finetune', tags=['watching'], log_artifacts=False, rank_zero_only=True, log_interval=20, allow_resume=False), beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=20, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=30000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-16 17:08:16.532	g3087:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-16 17:08:18.572	g3087:0	root:125	INFO	Padding tokenizer with 390 tokens
2025-07-16 17:08:19.096	g3087:0	olmo.util:177	CRITICAL	Uncaught AssertionError: 
Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/Umolmo/launch_scripts/train_multitask_model.py", line 396, in <module>
    run_trainer(cfg)
  File "/gscratch/krishna/mahtab/Umolmo/scripts/train.py", line 104, in run_trainer
    olmo_model = model_cfg.build_model()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py", line 133, in build_model
    return Molmo(self, device)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py", line 151, in __init__
    self.special_ids = tokenizer.get_special_token_ids(self.config.build_tokenizer())
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py", line 96, in build_tokenizer
    return self.llm.build_tokenizer()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/nn/llm.py", line 579, in build_tokenizer
    return self.tokenizer.build(pad_tokenizer_to=pad_tokenizer_to)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/tokenizer.py", line 178, in build
    return build_tokenizer(
  File "/gscratch/krishna/mahtab/Umolmo/olmo/tokenizer.py", line 153, in build_tokenizer
    assert ids == [pad_tokenizer_to + ix]
AssertionError
2025-07-16 17:13:53.496	g3087:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-16 17:13:53.600	g3087:0	root:266	INFO	Setting eval subset batches to 512
2025-07-16 17:13:53.666	g3087:0	train:54	INFO	Configuration:
2025-07-16 17:13:53.667	g3087:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=3584, n_heads=28, n_kv_heads=4, head_dim=None, qkv_bias=True, clip_qkv=None, n_layers=28, mlp_ratio=4, mlp_hidden_size=37888, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=1000000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='rms', layer_norm_with_affine=True, layer_norm_eps=1e-06, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=False, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.0, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=152064, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2.5-7B', tokenizer_dir=None), init_path='gs://mm-olmo/pretrained_llms/qwen2.5-7b.pt', init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='siglip', image_default_input_size=(378, 378), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1152, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=27, image_head_dim=72, image_mlp_dim=4304, image_mlp_activations='gelu_pytorch_tanh', image_dropout_rate=0.0, image_num_pos=729, image_norm_eps=1e-06, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path='gs://mm-olmo/pretrained_image_encoders/siglip2-so400m-14-384.pt', resize_mode='siglip', pad_value=0.0, normalize='siglip'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-3, -9), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='overlap-and-resize-c2', max_crops=8, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear', per_image_output_tokens=64), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'depth': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=2000, inf_evaluators=[InfDatasetEvaluatorConfig(label='depth', data=DataLoaderConfig(dataset='depth', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=2048, console_log_interval=20, include_image=False)], inf_eval_interval=2000, eval_on_last_step=True, eval_on_load=False, save_folder='/mmfs1/gscratch/krishna/mahtab/Umolmo/checkpoints/molmo-7b-qwen2-siglip2-finetune', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint='/mmfs1/gscratch/krishna/mahtab/Umolmo/pretrained/step22347-unsharded', allow_resume=True, max_duration=30000, global_train_batch_size=256, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=WandbConfig(project='mmseek', entity='allenai-team1', group=None, name='molmo-7b-qwen2-siglip2-finetune', tags=['watching'], log_artifacts=False, rank_zero_only=True, log_interval=20, allow_resume=False), beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=20, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=30000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-16 17:13:53.997	g3087:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-16 17:13:55.973	g3087:0	root:125	INFO	Padding tokenizer with 390 tokens
2025-07-16 17:17:06.223	g3087:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-16 17:17:06.324	g3087:0	root:266	INFO	Setting eval subset batches to 512
2025-07-16 17:17:06.390	g3087:0	train:54	INFO	Configuration:
2025-07-16 17:17:06.391	g3087:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=3584, n_heads=28, n_kv_heads=4, head_dim=None, qkv_bias=True, clip_qkv=None, n_layers=28, mlp_ratio=4, mlp_hidden_size=37888, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=1000000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='rms', layer_norm_with_affine=True, layer_norm_eps=1e-06, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=False, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.0, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=152064, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2.5-7B', tokenizer_dir=None), init_path='gs://mm-olmo/pretrained_llms/qwen2.5-7b.pt', init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='siglip', image_default_input_size=(378, 378), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1152, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=27, image_head_dim=72, image_mlp_dim=4304, image_mlp_activations='gelu_pytorch_tanh', image_dropout_rate=0.0, image_num_pos=729, image_norm_eps=1e-06, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path='gs://mm-olmo/pretrained_image_encoders/siglip2-so400m-14-384.pt', resize_mode='siglip', pad_value=0.0, normalize='siglip'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-3, -9), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='overlap-and-resize-c2', max_crops=8, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear', per_image_output_tokens=64), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'depth': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=2000, inf_evaluators=[InfDatasetEvaluatorConfig(label='depth', data=DataLoaderConfig(dataset='depth', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=2048, console_log_interval=20, include_image=False)], inf_eval_interval=2000, eval_on_last_step=True, eval_on_load=False, save_folder='/mmfs1/gscratch/krishna/mahtab/Umolmo/checkpoints/molmo-7b-qwen2-siglip2-finetune', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint='/mmfs1/gscratch/krishna/mahtab/Umolmo/pretrained/step22347-unsharded', allow_resume=True, max_duration=30000, global_train_batch_size=256, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=WandbConfig(project='mmseek', entity='allenai-team1', group=None, name='molmo-7b-qwen2-siglip2-finetune', tags=['watching'], log_artifacts=False, rank_zero_only=True, log_interval=20, allow_resume=False), beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=20, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=30000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-16 17:17:06.719	g3087:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-16 17:17:08.755	g3087:0	root:125	INFO	Padding tokenizer with 399 tokens
2025-07-16 17:17:09.286	g3087:0	olmo.util:177	CRITICAL	Uncaught AssertionError: 
Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/Umolmo/launch_scripts/train_multitask_model.py", line 396, in <module>
    run_trainer(cfg)
  File "/gscratch/krishna/mahtab/Umolmo/scripts/train.py", line 104, in run_trainer
    olmo_model = model_cfg.build_model()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py", line 133, in build_model
    return Molmo(self, device)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py", line 151, in __init__
    self.special_ids = tokenizer.get_special_token_ids(self.config.build_tokenizer())
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py", line 96, in build_tokenizer
    return self.llm.build_tokenizer()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/nn/llm.py", line 579, in build_tokenizer
    return self.tokenizer.build(pad_tokenizer_to=pad_tokenizer_to)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/tokenizer.py", line 178, in build
    return build_tokenizer(
  File "/gscratch/krishna/mahtab/Umolmo/olmo/tokenizer.py", line 140, in build_tokenizer
    assert len(tokenizer) == pad_tokenizer_to
AssertionError
2025-07-16 17:27:06.783	g3087:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-16 17:27:06.891	g3087:0	root:266	INFO	Setting eval subset batches to 512
2025-07-16 17:27:06.961	g3087:0	train:54	INFO	Configuration:
2025-07-16 17:27:06.961	g3087:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=3584, n_heads=28, n_kv_heads=4, head_dim=None, qkv_bias=True, clip_qkv=None, n_layers=28, mlp_ratio=4, mlp_hidden_size=37888, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=1000000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='rms', layer_norm_with_affine=True, layer_norm_eps=1e-06, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=False, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.0, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=152064, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2.5-7B', tokenizer_dir=None), init_path='gs://mm-olmo/pretrained_llms/qwen2.5-7b.pt', init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='siglip', image_default_input_size=(378, 378), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1152, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=27, image_head_dim=72, image_mlp_dim=4304, image_mlp_activations='gelu_pytorch_tanh', image_dropout_rate=0.0, image_num_pos=729, image_norm_eps=1e-06, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path='gs://mm-olmo/pretrained_image_encoders/siglip2-so400m-14-384.pt', resize_mode='siglip', pad_value=0.0, normalize='siglip'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-3, -9), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='overlap-and-resize-c2', max_crops=8, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear', per_image_output_tokens=64), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'depth': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=2000, inf_evaluators=[InfDatasetEvaluatorConfig(label='depth', data=DataLoaderConfig(dataset='depth', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=2048, console_log_interval=20, include_image=False)], inf_eval_interval=2000, eval_on_last_step=True, eval_on_load=False, save_folder='/mmfs1/gscratch/krishna/mahtab/Umolmo/checkpoints/molmo-7b-qwen2-siglip2-finetune', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint='/mmfs1/gscratch/krishna/mahtab/Umolmo/pretrained/step22347-unsharded', allow_resume=True, max_duration=30000, global_train_batch_size=256, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=WandbConfig(project='mmseek', entity='allenai-team1', group=None, name='molmo-7b-qwen2-siglip2-finetune', tags=['watching'], log_artifacts=False, rank_zero_only=True, log_interval=20, allow_resume=False), beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=20, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=30000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-16 17:27:07.309	g3087:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-16 17:27:09.577	g3087:0	root:124	INFO	Padding tokenizer with 397 tokens
2025-07-16 17:29:17.480	g3087:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-16 17:29:17.612	g3087:0	root:266	INFO	Setting eval subset batches to 512
2025-07-16 17:29:17.679	g3087:0	train:54	INFO	Configuration:
2025-07-16 17:29:17.679	g3087:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=3584, n_heads=28, n_kv_heads=4, head_dim=None, qkv_bias=True, clip_qkv=None, n_layers=28, mlp_ratio=4, mlp_hidden_size=37888, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=1000000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='rms', layer_norm_with_affine=True, layer_norm_eps=1e-06, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=False, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.0, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=152064, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2.5-7B', tokenizer_dir=None), init_path='gs://mm-olmo/pretrained_llms/qwen2.5-7b.pt', init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='siglip', image_default_input_size=(378, 378), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1152, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=27, image_head_dim=72, image_mlp_dim=4304, image_mlp_activations='gelu_pytorch_tanh', image_dropout_rate=0.0, image_num_pos=729, image_norm_eps=1e-06, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path='gs://mm-olmo/pretrained_image_encoders/siglip2-so400m-14-384.pt', resize_mode='siglip', pad_value=0.0, normalize='siglip'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-3, -9), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='overlap-and-resize-c2', max_crops=8, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear', per_image_output_tokens=64), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'depth': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=2000, inf_evaluators=[InfDatasetEvaluatorConfig(label='depth', data=DataLoaderConfig(dataset='depth', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=2048, console_log_interval=20, include_image=False)], inf_eval_interval=2000, eval_on_last_step=True, eval_on_load=False, save_folder='/mmfs1/gscratch/krishna/mahtab/Umolmo/checkpoints/molmo-7b-qwen2-siglip2-finetune', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint='/mmfs1/gscratch/krishna/mahtab/Umolmo/pretrained/step22347-unsharded', allow_resume=True, max_duration=30000, global_train_batch_size=256, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=WandbConfig(project='mmseek', entity='allenai-team1', group=None, name='molmo-7b-qwen2-siglip2-finetune', tags=['watching'], log_artifacts=False, rank_zero_only=True, log_interval=20, allow_resume=False), beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=20, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=30000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-16 17:29:18.005	g3087:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-16 17:29:19.987	g3087:0	root:124	INFO	Padding tokenizer with 397 tokens
2025-07-16 17:30:03.902	g3087:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-16 17:30:03.969	g3087:0	train:54	INFO	Configuration:
2025-07-16 17:30:03.969	g3087:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=128, n_heads=2, n_kv_heads=None, head_dim=None, qkv_bias=False, clip_qkv=None, n_layers=1, mlp_ratio=4, mlp_hidden_size=None, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=10000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='default', layer_norm_with_affine=True, layer_norm_eps=None, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=True, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.1, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=None, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2-7B', tokenizer_dir=None), init_path=None, init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='openai', image_default_input_size=(336, 336), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1024, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=1, image_head_dim=64, image_mlp_dim=4096, image_mlp_activations='gelu', image_dropout_rate=0.0, image_num_pos=577, image_norm_eps=1e-05, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path=None, resize_mode='default', pad_value=0.0, normalize='openai'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-1,), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='resize', max_crops=1, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear', per_image_output_tokens=64), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'depth': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=20, inf_evaluators=[InfDatasetEvaluatorConfig(label='depth', data=DataLoaderConfig(dataset='depth', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=16, console_log_interval=5, include_image=False)], inf_eval_interval=20, eval_on_last_step=True, eval_on_load=False, save_folder='debug_run', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint=None, allow_resume=True, max_duration=1000, global_train_batch_size=8, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=None, beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=5, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=1000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-16 17:30:04.331	g3087:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-16 17:30:06.567	g3087:0	root:124	INFO	Padding tokenizer with 416 tokens
2025-07-16 17:31:00.459	g3087:0	olmo.util:177	CRITICAL	Uncaught BdbQuit: 
Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/Umolmo/launch_scripts/train_multitask_model.py", line 396, in <module>
    run_trainer(cfg)
  File "/gscratch/krishna/mahtab/Umolmo/scripts/train.py", line 104, in run_trainer
    olmo_model = model_cfg.build_model()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py", line 133, in build_model
    return Molmo(self, device)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py", line 151, in __init__
    self.special_ids = tokenizer.get_special_token_ids(self.config.build_tokenizer())
  File "/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py", line 96, in build_tokenizer
    return self.llm.build_tokenizer()
  File "/gscratch/krishna/mahtab/Umolmo/olmo/nn/llm.py", line 579, in build_tokenizer
    return self.tokenizer.build(pad_tokenizer_to=pad_tokenizer_to)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/tokenizer.py", line 176, in build
    return build_tokenizer(
  File "/gscratch/krishna/mahtab/Umolmo/olmo/tokenizer.py", line 136, in build_tokenizer
    num_added_tokens = tokenizer.add_tokens(GEN_TOKENS)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/tokenizer.py", line 136, in build_tokenizer
    num_added_tokens = tokenizer.add_tokens(GEN_TOKENS)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/bdb.py", line 90, in trace_dispatch
    return self.dispatch_line(frame)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/bdb.py", line 115, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit
2025-07-16 17:31:45.873	g3087:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-16 17:31:45.941	g3087:0	train:54	INFO	Configuration:
2025-07-16 17:31:45.942	g3087:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=128, n_heads=2, n_kv_heads=None, head_dim=None, qkv_bias=False, clip_qkv=None, n_layers=1, mlp_ratio=4, mlp_hidden_size=None, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=10000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='default', layer_norm_with_affine=True, layer_norm_eps=None, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=True, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.1, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=None, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2-7B', tokenizer_dir=None), init_path=None, init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='openai', image_default_input_size=(336, 336), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1024, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=1, image_head_dim=64, image_mlp_dim=4096, image_mlp_activations='gelu', image_dropout_rate=0.0, image_num_pos=577, image_norm_eps=1e-05, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path=None, resize_mode='default', pad_value=0.0, normalize='openai'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-1,), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='resize', max_crops=1, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear', per_image_output_tokens=64), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'depth': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=20, inf_evaluators=[InfDatasetEvaluatorConfig(label='depth', data=DataLoaderConfig(dataset='depth', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=16, console_log_interval=5, include_image=False)], inf_eval_interval=20, eval_on_last_step=True, eval_on_load=False, save_folder='debug_run', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint=None, allow_resume=True, max_duration=1000, global_train_batch_size=8, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=None, beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=5, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=1000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-16 17:31:46.290	g3087:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-16 17:31:48.246	g3087:0	root:123	INFO	Padding tokenizer with 416 tokens
2025-07-16 17:31:49.941	g3087:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-16 17:31:51.194	g3087:0	train:191	INFO	Total number of parameters: 58,088,960
2025-07-16 17:31:51.195	g3087:0	train:192	INFO	Number of non-embedding parameters: 38,608,384
2025-07-16 17:31:51.196	g3087:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 234
2025-07-16 17:31:51.196	g3087:0	train:196	INFO	Model:
2025-07-16 17:31:51.197	g3087:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0): FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=128, out_features=128, bias=True)
          (ff_out): Linear(in_features=256, out_features=128, bias=True)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): LayerNorm()
          (ff_norm): LayerNorm()
          (att_proj): Linear(in_features=128, out_features=384, bias=True)
          (ff_proj): Linear(in_features=128, out_features=512, bias=True)
        )
      )
    )
    (ln_f): FSDPLayerNorm()
    (emb_drop): Dropout(p=0.1, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=128, out_features=152192, bias=True)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=1024, out_features=1024, bias=True)
        (wk): Linear(in_features=1024, out_features=1024, bias=True)
        (wv): Linear(in_features=1024, out_features=1024, bias=True)
        (wo): Linear(in_features=1024, out_features=1024, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1024, out_features=256, bias=False)
        (w2): Linear(in_features=256, out_features=128, bias=False)
        (w3): Linear(in_features=1024, out_features=256, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1024, bias=False)
      (pre_ln): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0): FSDPResidualAttentionBlock(
            (attention): ViTMultiHeadDotProductAttention(
              (wq): Linear(in_features=1024, out_features=1024, bias=True)
              (wk): Linear(in_features=1024, out_features=1024, bias=True)
              (wv): Linear(in_features=1024, out_features=1024, bias=True)
              (wo): Linear(in_features=1024, out_features=1024, bias=True)
              (residual_dropout): Dropout(p=0.0, inplace=False)
            )
            (feed_forward): ViTMLP(
              (w1): Linear(in_features=1024, out_features=4096, bias=True)
              (act): GELUActivation()
              (w2): Linear(in_features=4096, out_features=1024, bias=True)
            )
            (attention_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
            (ffn_norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=1024, out_features=128, bias=False)
  (vision_decoder_head): Linear(in_features=128, out_features=1024, bias=False)
)
2025-07-16 17:31:51.235	g3087:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-16 17:31:51.236	g3087:0	olmo.data.data_loader:197	INFO	Loading train dataset depth/train
2025-07-16 17:31:51.236	g3087:0	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/train/train.json
2025-07-16 17:31:51.307	g3087:0	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-16 17:31:51.307	g3087:0	olmo.data.data_loader:219	INFO	depth: 100.00
2025-07-16 17:31:51.309	g3087:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=2304 images=1 pooled_patches_idx=158
2025-07-16 17:31:51.310	g3087:0	olmo.data.data_loader:100	INFO	Loading eval dataset: depth/validation
2025-07-16 17:31:51.310	g3087:0	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/val/val.json
2025-07-16 17:31:51.312	g3087:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=1792 images=1 pooled_patches_idx=158
2025-07-16 17:31:52.653	g3087:0	train:332	INFO	Starting training...
2025-07-16 17:31:52.654	g3087:0	olmo.train.trainer:817	INFO	Pre-train system metrics
    System/Peak GPU Memory (MB)=370.8
2025-07-16 17:48:23.597	g3086:3	olmo.util:269	INFO	Set up torchrun environment
2025-07-16 17:48:23.597	g3086:1	olmo.util:269	INFO	Set up torchrun environment
2025-07-16 17:48:23.597	g3086:2	olmo.util:269	INFO	Set up torchrun environment
2025-07-16 17:48:23.626	g3086:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-16 17:48:23.803	g3086:2	root:266	INFO	Setting eval subset batches to 128
2025-07-16 17:48:23.803	g3086:3	root:266	INFO	Setting eval subset batches to 128
2025-07-16 17:48:23.804	g3086:1	root:266	INFO	Setting eval subset batches to 128
2025-07-16 17:48:23.803	g3086:0	root:266	INFO	Setting eval subset batches to 128
2025-07-16 17:48:24.168	g3086:0	train:54	INFO	Configuration:
2025-07-16 17:48:24.169	g3086:3	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-16 17:48:24.169	g3086:2	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-16 17:48:24.169	g3086:1	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-16 17:48:24.169	g3086:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=3584, n_heads=28, n_kv_heads=4, head_dim=None, qkv_bias=True, clip_qkv=None, n_layers=28, mlp_ratio=4, mlp_hidden_size=37888, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=1000000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='rms', layer_norm_with_affine=True, layer_norm_eps=1e-06, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=False, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.0, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=152064, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2.5-7B', tokenizer_dir=None), init_path='gs://mm-olmo/pretrained_llms/qwen2.5-7b.pt', init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='siglip', image_default_input_size=(378, 378), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1152, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=27, image_head_dim=72, image_mlp_dim=4304, image_mlp_activations='gelu_pytorch_tanh', image_dropout_rate=0.0, image_num_pos=729, image_norm_eps=1e-06, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path='gs://mm-olmo/pretrained_image_encoders/siglip2-so400m-14-384.pt', resize_mode='siglip', pad_value=0.0, normalize='siglip'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-3, -9), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='overlap-and-resize-c2', max_crops=8, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear', per_image_output_tokens=64), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'depth': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=2000, inf_evaluators=[InfDatasetEvaluatorConfig(label='depth', data=DataLoaderConfig(dataset='depth', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=2048, console_log_interval=20, include_image=False)], inf_eval_interval=2000, eval_on_last_step=True, eval_on_load=False, save_folder='/mmfs1/gscratch/krishna/mahtab/Umolmo/checkpoints/molmo-7b-qwen2-siglip2-finetune', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint='/mmfs1/gscratch/krishna/mahtab/Umolmo/pretrained/step22347-unsharded', allow_resume=True, max_duration=30000, global_train_batch_size=256, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=WandbConfig(project='mmseek', entity='allenai-team1', group=None, name='molmo-7b-qwen2-siglip2-finetune', tags=['watching'], log_artifacts=False, rank_zero_only=True, log_interval=20, allow_resume=False), beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=20, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=30000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-16 17:48:24.523	g3086:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-16 17:48:27.325	g3086:1	root:123	INFO	Padding tokenizer with 397 tokens
2025-07-16 17:48:27.327	g3086:3	root:123	INFO	Padding tokenizer with 397 tokens
2025-07-16 17:48:27.341	g3086:2	root:123	INFO	Padding tokenizer with 397 tokens
2025-07-16 17:48:27.357	g3086:0	root:123	INFO	Padding tokenizer with 397 tokens
2025-07-16 17:48:33.722	g3086:2	train:180	INFO	Wrapping model with FSDP2...
2025-07-16 17:48:33.722	g3086:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-16 17:48:33.722	g3086:3	train:180	INFO	Wrapping model with FSDP2...
2025-07-16 17:48:33.723	g3086:1	train:180	INFO	Wrapping model with FSDP2...
2025-07-16 17:48:34.402	g3086:3	train:191	INFO	Total number of parameters: 8,126,757,840
2025-07-16 17:48:34.403	g3086:2	train:191	INFO	Total number of parameters: 8,126,757,840
2025-07-16 17:48:34.403	g3086:1	train:191	INFO	Total number of parameters: 8,126,757,840
2025-07-16 17:48:34.403	g3086:0	train:191	INFO	Total number of parameters: 8,126,757,840
2025-07-16 17:48:34.404	g3086:3	train:192	INFO	Number of non-embedding parameters: 7,581,301,712
2025-07-16 17:48:34.405	g3086:2	train:192	INFO	Number of non-embedding parameters: 7,581,301,712
2025-07-16 17:48:34.405	g3086:1	train:192	INFO	Number of non-embedding parameters: 7,581,301,712
2025-07-16 17:48:34.406	g3086:2	train:195	INFO	Peak GPU Memory (MB) after FSDP: 8177
2025-07-16 17:48:34.406	g3086:3	train:195	INFO	Peak GPU Memory (MB) after FSDP: 8177
2025-07-16 17:48:34.406	g3086:2	train:196	INFO	Model:
2025-07-16 17:48:34.406	g3086:3	train:196	INFO	Model:
2025-07-16 17:48:34.406	g3086:1	train:195	INFO	Peak GPU Memory (MB) after FSDP: 8177
2025-07-16 17:48:34.406	g3086:1	train:196	INFO	Model:
2025-07-16 17:48:34.406	g3086:0	train:192	INFO	Number of non-embedding parameters: 7,581,301,712
2025-07-16 17:48:34.407	g3086:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 8177
2025-07-16 17:48:34.407	g3086:0	train:196	INFO	Model:
2025-07-16 17:48:34.406	g3086:2	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0-27): 28 x FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=3584, out_features=3584, bias=False)
          (ff_out): Linear(in_features=18944, out_features=3584, bias=False)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): RMSLayerNorm()
          (ff_norm): RMSLayerNorm()
          (att_proj): Linear(in_features=3584, out_features=4608, bias=True)
          (ff_proj): Linear(in_features=3584, out_features=37888, bias=False)
        )
      )
    )
    (ln_f): FSDPRMSLayerNorm()
    (emb_drop): Dropout(p=0.0, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=3584, out_features=152064, bias=False)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=2304, out_features=1152, bias=True)
        (wk): Linear(in_features=2304, out_features=1152, bias=True)
        (wv): Linear(in_features=2304, out_features=1152, bias=True)
        (wo): Linear(in_features=1152, out_features=1152, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1152, out_features=18944, bias=False)
        (w2): Linear(in_features=18944, out_features=3584, bias=False)
        (w3): Linear(in_features=1152, out_features=18944, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPSiglipVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1152, bias=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0-24): 25 x FSDPCheckpointWrapper(
            (_checkpoint_wrapped_module): ResidualAttentionBlock(
              (attention): ViTMultiHeadDotProductAttention(
                (wq): Linear(in_features=1152, out_features=1152, bias=True)
                (wk): Linear(in_features=1152, out_features=1152, bias=True)
                (wv): Linear(in_features=1152, out_features=1152, bias=True)
                (wo): Linear(in_features=1152, out_features=1152, bias=True)
                (residual_dropout): Dropout(p=0.0, inplace=False)
              )
              (feed_forward): ViTMLP(
                (w1): Linear(in_features=1152, out_features=4304, bias=True)
                (act): PytorchGELUTanh()
                (w2): Linear(in_features=4304, out_features=1152, bias=True)
              )
              (attention_norm): LayerNorm((1152,), eps=1e-06, elementwise_affine=True)
              (ffn_norm): LayerNorm((1152,), eps=1e-06, elementwise_affine=True)
            )
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=1024, out_features=3584, bias=False)
  (vision_decoder_head): Linear(in_features=3584, out_features=1024, bias=False)
)
2025-07-16 17:48:34.406	g3086:3	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0-27): 28 x FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=3584, out_features=3584, bias=False)
          (ff_out): Linear(in_features=18944, out_features=3584, bias=False)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): RMSLayerNorm()
          (ff_norm): RMSLayerNorm()
          (att_proj): Linear(in_features=3584, out_features=4608, bias=True)
          (ff_proj): Linear(in_features=3584, out_features=37888, bias=False)
        )
      )
    )
    (ln_f): FSDPRMSLayerNorm()
    (emb_drop): Dropout(p=0.0, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=3584, out_features=152064, bias=False)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=2304, out_features=1152, bias=True)
        (wk): Linear(in_features=2304, out_features=1152, bias=True)
        (wv): Linear(in_features=2304, out_features=1152, bias=True)
        (wo): Linear(in_features=1152, out_features=1152, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1152, out_features=18944, bias=False)
        (w2): Linear(in_features=18944, out_features=3584, bias=False)
        (w3): Linear(in_features=1152, out_features=18944, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPSiglipVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1152, bias=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0-24): 25 x FSDPCheckpointWrapper(
            (_checkpoint_wrapped_module): ResidualAttentionBlock(
              (attention): ViTMultiHeadDotProductAttention(
                (wq): Linear(in_features=1152, out_features=1152, bias=True)
                (wk): Linear(in_features=1152, out_features=1152, bias=True)
                (wv): Linear(in_features=1152, out_features=1152, bias=True)
                (wo): Linear(in_features=1152, out_features=1152, bias=True)
                (residual_dropout): Dropout(p=0.0, inplace=False)
              )
              (feed_forward): ViTMLP(
                (w1): Linear(in_features=1152, out_features=4304, bias=True)
                (act): PytorchGELUTanh()
                (w2): Linear(in_features=4304, out_features=1152, bias=True)
              )
              (attention_norm): LayerNorm((1152,), eps=1e-06, elementwise_affine=True)
              (ffn_norm): LayerNorm((1152,), eps=1e-06, elementwise_affine=True)
            )
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=1024, out_features=3584, bias=False)
  (vision_decoder_head): Linear(in_features=3584, out_features=1024, bias=False)
)
2025-07-16 17:48:34.406	g3086:1	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0-27): 28 x FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=3584, out_features=3584, bias=False)
          (ff_out): Linear(in_features=18944, out_features=3584, bias=False)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): RMSLayerNorm()
          (ff_norm): RMSLayerNorm()
          (att_proj): Linear(in_features=3584, out_features=4608, bias=True)
          (ff_proj): Linear(in_features=3584, out_features=37888, bias=False)
        )
      )
    )
    (ln_f): FSDPRMSLayerNorm()
    (emb_drop): Dropout(p=0.0, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=3584, out_features=152064, bias=False)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=2304, out_features=1152, bias=True)
        (wk): Linear(in_features=2304, out_features=1152, bias=True)
        (wv): Linear(in_features=2304, out_features=1152, bias=True)
        (wo): Linear(in_features=1152, out_features=1152, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1152, out_features=18944, bias=False)
        (w2): Linear(in_features=18944, out_features=3584, bias=False)
        (w3): Linear(in_features=1152, out_features=18944, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPSiglipVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1152, bias=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0-24): 25 x FSDPCheckpointWrapper(
            (_checkpoint_wrapped_module): ResidualAttentionBlock(
              (attention): ViTMultiHeadDotProductAttention(
                (wq): Linear(in_features=1152, out_features=1152, bias=True)
                (wk): Linear(in_features=1152, out_features=1152, bias=True)
                (wv): Linear(in_features=1152, out_features=1152, bias=True)
                (wo): Linear(in_features=1152, out_features=1152, bias=True)
                (residual_dropout): Dropout(p=0.0, inplace=False)
              )
              (feed_forward): ViTMLP(
                (w1): Linear(in_features=1152, out_features=4304, bias=True)
                (act): PytorchGELUTanh()
                (w2): Linear(in_features=4304, out_features=1152, bias=True)
              )
              (attention_norm): LayerNorm((1152,), eps=1e-06, elementwise_affine=True)
              (ffn_norm): LayerNorm((1152,), eps=1e-06, elementwise_affine=True)
            )
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=1024, out_features=3584, bias=False)
  (vision_decoder_head): Linear(in_features=3584, out_features=1024, bias=False)
)
2025-07-16 17:48:34.428	g3086:2	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-16 17:48:34.429	g3086:3	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-16 17:48:34.429	g3086:2	olmo.data.data_loader:197	INFO	Loading train dataset depth/train
2025-07-16 17:48:34.429	g3086:2	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/train/train.json
2025-07-16 17:48:34.429	g3086:1	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-16 17:48:34.430	g3086:3	olmo.data.data_loader:197	INFO	Loading train dataset depth/train
2025-07-16 17:48:34.430	g3086:3	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/train/train.json
2025-07-16 17:48:34.430	g3086:1	olmo.data.data_loader:197	INFO	Loading train dataset depth/train
2025-07-16 17:48:34.431	g3086:1	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/train/train.json
2025-07-16 17:48:34.421	g3086:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0-27): 28 x FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=3584, out_features=3584, bias=False)
          (ff_out): Linear(in_features=18944, out_features=3584, bias=False)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): RMSLayerNorm()
          (ff_norm): RMSLayerNorm()
          (att_proj): Linear(in_features=3584, out_features=4608, bias=True)
          (ff_proj): Linear(in_features=3584, out_features=37888, bias=False)
        )
      )
    )
    (ln_f): FSDPRMSLayerNorm()
    (emb_drop): Dropout(p=0.0, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=3584, out_features=152064, bias=False)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=2304, out_features=1152, bias=True)
        (wk): Linear(in_features=2304, out_features=1152, bias=True)
        (wv): Linear(in_features=2304, out_features=1152, bias=True)
        (wo): Linear(in_features=1152, out_features=1152, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1152, out_features=18944, bias=False)
        (w2): Linear(in_features=18944, out_features=3584, bias=False)
        (w3): Linear(in_features=1152, out_features=18944, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPSiglipVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1152, bias=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0-24): 25 x FSDPCheckpointWrapper(
            (_checkpoint_wrapped_module): ResidualAttentionBlock(
              (attention): ViTMultiHeadDotProductAttention(
                (wq): Linear(in_features=1152, out_features=1152, bias=True)
                (wk): Linear(in_features=1152, out_features=1152, bias=True)
                (wv): Linear(in_features=1152, out_features=1152, bias=True)
                (wo): Linear(in_features=1152, out_features=1152, bias=True)
                (residual_dropout): Dropout(p=0.0, inplace=False)
              )
              (feed_forward): ViTMLP(
                (w1): Linear(in_features=1152, out_features=4304, bias=True)
                (act): PytorchGELUTanh()
                (w2): Linear(in_features=4304, out_features=1152, bias=True)
              )
              (attention_norm): LayerNorm((1152,), eps=1e-06, elementwise_affine=True)
              (ffn_norm): LayerNorm((1152,), eps=1e-06, elementwise_affine=True)
            )
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=1024, out_features=3584, bias=False)
  (vision_decoder_head): Linear(in_features=3584, out_features=1024, bias=False)
)
2025-07-16 17:48:34.443	g3086:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-16 17:48:34.444	g3086:0	olmo.data.data_loader:197	INFO	Loading train dataset depth/train
2025-07-16 17:48:34.444	g3086:0	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/train/train.json
2025-07-16 17:48:34.517	g3086:0	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-16 17:48:34.518	g3086:0	olmo.data.data_loader:219	INFO	depth: 100.00
2025-07-16 17:48:34.519	g3086:3	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-16 17:48:34.519	g3086:3	olmo.data.data_loader:219	INFO	depth: 100.00
2025-07-16 17:48:34.519	g3086:2	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-16 17:48:34.520	g3086:2	olmo.data.data_loader:219	INFO	depth: 100.00
2025-07-16 17:48:34.520	g3086:1	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-16 17:48:34.520	g3086:1	olmo.data.data_loader:219	INFO	depth: 100.00
2025-07-16 17:48:34.543	g3086:3	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=2304 images=9 pooled_patches_idx=1414
2025-07-16 17:48:34.543	g3086:2	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=2304 images=9 pooled_patches_idx=1414
2025-07-16 17:48:34.543	g3086:1	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=2304 images=9 pooled_patches_idx=1414
2025-07-16 17:48:34.543	g3086:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=2304 images=9 pooled_patches_idx=1414
2025-07-16 17:48:34.543	g3086:2	olmo.data.data_loader:100	INFO	Loading eval dataset: depth/validation
2025-07-16 17:48:34.543	g3086:3	olmo.data.data_loader:100	INFO	Loading eval dataset: depth/validation
2025-07-16 17:48:34.543	g3086:1	olmo.data.data_loader:100	INFO	Loading eval dataset: depth/validation
2025-07-16 17:48:34.543	g3086:2	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/val/val.json
2025-07-16 17:48:34.543	g3086:3	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/val/val.json
2025-07-16 17:48:34.543	g3086:1	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/val/val.json
2025-07-16 17:48:34.544	g3086:0	olmo.data.data_loader:100	INFO	Loading eval dataset: depth/validation
2025-07-16 17:48:34.544	g3086:0	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/val/val.json
2025-07-16 17:48:34.561	g3086:1	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=1792 images=9 pooled_patches_idx=1414
2025-07-16 17:48:34.561	g3086:3	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=1792 images=9 pooled_patches_idx=1414
2025-07-16 17:48:34.561	g3086:2	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=1792 images=9 pooled_patches_idx=1414
2025-07-16 17:48:34.561	g3086:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=1792 images=9 pooled_patches_idx=1414
2025-07-16 17:48:45.294	g3086:2	train:308	INFO	Loading unshared model from /mmfs1/gscratch/krishna/mahtab/Umolmo/pretrained/step22347-unsharded
2025-07-16 17:48:45.294	g3086:3	train:308	INFO	Loading unshared model from /mmfs1/gscratch/krishna/mahtab/Umolmo/pretrained/step22347-unsharded
2025-07-16 17:48:45.294	g3086:1	train:308	INFO	Loading unshared model from /mmfs1/gscratch/krishna/mahtab/Umolmo/pretrained/step22347-unsharded
2025-07-16 17:48:45.294	g3086:0	train:308	INFO	Loading unshared model from /mmfs1/gscratch/krishna/mahtab/Umolmo/pretrained/step22347-unsharded
2025-07-16 17:49:21.565	g3086:1	olmo.util:177	CRITICAL	Uncaught RuntimeError: Error(s) in loading state_dict for FSDPMolmo:
	Missing key(s) in state_dict: "vision_encoder_head.weight", "vision_decoder_head.weight". 
Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/Umolmo/launch_scripts/train_multitask_model.py", line 396, in <module>
    run_trainer(cfg)
  File "/gscratch/krishna/mahtab/Umolmo/scripts/train.py", line 309, in run_trainer
    load_model_state_unsharded(start_from, fsdp_model)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/checkpointer.py", line 52, in load_model_state_unsharded
    dist_cp_sd.set_model_state_dict(
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/distributed/checkpoint/state_dict.py", line 1277, in set_model_state_dict
    return _load_model_state_dict(model, model_state_dict, info)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/distributed/checkpoint/state_dict.py", line 605, in _load_model_state_dict
    _state_dict_fn(model, "load_state_dict")(
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2593, in load_state_dict
    raise RuntimeError(
RuntimeError: Error(s) in loading state_dict for FSDPMolmo:
	Missing key(s) in state_dict: "vision_encoder_head.weight", "vision_decoder_head.weight". 
2025-07-16 17:49:21.565	g3086:2	olmo.util:177	CRITICAL	Uncaught RuntimeError: Error(s) in loading state_dict for FSDPMolmo:
	Missing key(s) in state_dict: "vision_encoder_head.weight", "vision_decoder_head.weight". 
Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/Umolmo/launch_scripts/train_multitask_model.py", line 396, in <module>
    run_trainer(cfg)
  File "/gscratch/krishna/mahtab/Umolmo/scripts/train.py", line 309, in run_trainer
    load_model_state_unsharded(start_from, fsdp_model)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/checkpointer.py", line 52, in load_model_state_unsharded
    dist_cp_sd.set_model_state_dict(
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/distributed/checkpoint/state_dict.py", line 1277, in set_model_state_dict
    return _load_model_state_dict(model, model_state_dict, info)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/distributed/checkpoint/state_dict.py", line 605, in _load_model_state_dict
    _state_dict_fn(model, "load_state_dict")(
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2593, in load_state_dict
    raise RuntimeError(
RuntimeError: Error(s) in loading state_dict for FSDPMolmo:
	Missing key(s) in state_dict: "vision_encoder_head.weight", "vision_decoder_head.weight". 
2025-07-16 17:49:21.565	g3086:3	olmo.util:177	CRITICAL	Uncaught RuntimeError: Error(s) in loading state_dict for FSDPMolmo:
	Missing key(s) in state_dict: "vision_encoder_head.weight", "vision_decoder_head.weight". 
Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/Umolmo/launch_scripts/train_multitask_model.py", line 396, in <module>
    run_trainer(cfg)
  File "/gscratch/krishna/mahtab/Umolmo/scripts/train.py", line 309, in run_trainer
    load_model_state_unsharded(start_from, fsdp_model)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/checkpointer.py", line 52, in load_model_state_unsharded
    dist_cp_sd.set_model_state_dict(
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/distributed/checkpoint/state_dict.py", line 1277, in set_model_state_dict
    return _load_model_state_dict(model, model_state_dict, info)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/distributed/checkpoint/state_dict.py", line 605, in _load_model_state_dict
    _state_dict_fn(model, "load_state_dict")(
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2593, in load_state_dict
    raise RuntimeError(
RuntimeError: Error(s) in loading state_dict for FSDPMolmo:
	Missing key(s) in state_dict: "vision_encoder_head.weight", "vision_decoder_head.weight". 
2025-07-16 17:49:24.598	g3086:0	olmo.util:177	CRITICAL	Uncaught RuntimeError: Error(s) in loading state_dict for FSDPMolmo:
	Missing key(s) in state_dict: "vision_encoder_head.weight", "vision_decoder_head.weight". 
Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/Umolmo/launch_scripts/train_multitask_model.py", line 396, in <module>
    run_trainer(cfg)
  File "/gscratch/krishna/mahtab/Umolmo/scripts/train.py", line 309, in run_trainer
    load_model_state_unsharded(start_from, fsdp_model)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/checkpointer.py", line 52, in load_model_state_unsharded
    dist_cp_sd.set_model_state_dict(
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/distributed/checkpoint/state_dict.py", line 1277, in set_model_state_dict
    return _load_model_state_dict(model, model_state_dict, info)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/distributed/checkpoint/state_dict.py", line 605, in _load_model_state_dict
    _state_dict_fn(model, "load_state_dict")(
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2593, in load_state_dict
    raise RuntimeError(
RuntimeError: Error(s) in loading state_dict for FSDPMolmo:
	Missing key(s) in state_dict: "vision_encoder_head.weight", "vision_decoder_head.weight". 
2025-07-16 18:00:06.955	g3086:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-16 18:00:07.128	g3086:0	root:266	INFO	Setting eval subset batches to 512
2025-07-16 18:00:07.407	g3086:0	train:54	INFO	Configuration:
2025-07-16 18:00:07.408	g3086:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=3584, n_heads=28, n_kv_heads=4, head_dim=None, qkv_bias=True, clip_qkv=None, n_layers=28, mlp_ratio=4, mlp_hidden_size=37888, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=1000000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='rms', layer_norm_with_affine=True, layer_norm_eps=1e-06, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=False, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.0, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=152064, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2.5-7B', tokenizer_dir=None), init_path='gs://mm-olmo/pretrained_llms/qwen2.5-7b.pt', init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='siglip', image_default_input_size=(378, 378), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1152, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=27, image_head_dim=72, image_mlp_dim=4304, image_mlp_activations='gelu_pytorch_tanh', image_dropout_rate=0.0, image_num_pos=729, image_norm_eps=1e-06, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path='gs://mm-olmo/pretrained_image_encoders/siglip2-so400m-14-384.pt', resize_mode='siglip', pad_value=0.0, normalize='siglip'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-3, -9), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='overlap-and-resize-c2', max_crops=8, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear', per_image_output_tokens=64), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'depth': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=2000, inf_evaluators=[InfDatasetEvaluatorConfig(label='depth', data=DataLoaderConfig(dataset='depth', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=2048, console_log_interval=20, include_image=False)], inf_eval_interval=2000, eval_on_last_step=True, eval_on_load=False, save_folder='/mmfs1/gscratch/krishna/mahtab/Umolmo/checkpoints/molmo-7b-qwen2-siglip2-finetune', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint='/mmfs1/gscratch/krishna/mahtab/Umolmo/pretrained/step22347-unsharded', allow_resume=True, max_duration=30000, global_train_batch_size=256, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=WandbConfig(project='mmseek', entity='allenai-team1', group=None, name='molmo-7b-qwen2-siglip2-finetune', tags=['watching'], log_artifacts=False, rank_zero_only=True, log_interval=20, allow_resume=False), beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=20, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=30000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-16 18:00:07.767	g3086:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-16 18:00:10.755	g3086:0	root:123	INFO	Padding tokenizer with 397 tokens
2025-07-16 18:00:16.235	g3086:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-16 18:00:16.925	g3086:0	train:191	INFO	Total number of parameters: 8,126,757,840
2025-07-16 18:00:16.927	g3086:0	train:192	INFO	Number of non-embedding parameters: 7,581,301,712
2025-07-16 18:00:16.928	g3086:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 32604
2025-07-16 18:00:16.928	g3086:0	train:196	INFO	Model:
2025-07-16 18:00:16.929	g3086:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0-27): 28 x FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=3584, out_features=3584, bias=False)
          (ff_out): Linear(in_features=18944, out_features=3584, bias=False)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): RMSLayerNorm()
          (ff_norm): RMSLayerNorm()
          (att_proj): Linear(in_features=3584, out_features=4608, bias=True)
          (ff_proj): Linear(in_features=3584, out_features=37888, bias=False)
        )
      )
    )
    (ln_f): FSDPRMSLayerNorm()
    (emb_drop): Dropout(p=0.0, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=3584, out_features=152064, bias=False)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=2304, out_features=1152, bias=True)
        (wk): Linear(in_features=2304, out_features=1152, bias=True)
        (wv): Linear(in_features=2304, out_features=1152, bias=True)
        (wo): Linear(in_features=1152, out_features=1152, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1152, out_features=18944, bias=False)
        (w2): Linear(in_features=18944, out_features=3584, bias=False)
        (w3): Linear(in_features=1152, out_features=18944, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPSiglipVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1152, bias=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0-24): 25 x FSDPCheckpointWrapper(
            (_checkpoint_wrapped_module): ResidualAttentionBlock(
              (attention): ViTMultiHeadDotProductAttention(
                (wq): Linear(in_features=1152, out_features=1152, bias=True)
                (wk): Linear(in_features=1152, out_features=1152, bias=True)
                (wv): Linear(in_features=1152, out_features=1152, bias=True)
                (wo): Linear(in_features=1152, out_features=1152, bias=True)
                (residual_dropout): Dropout(p=0.0, inplace=False)
              )
              (feed_forward): ViTMLP(
                (w1): Linear(in_features=1152, out_features=4304, bias=True)
                (act): PytorchGELUTanh()
                (w2): Linear(in_features=4304, out_features=1152, bias=True)
              )
              (attention_norm): LayerNorm((1152,), eps=1e-06, elementwise_affine=True)
              (ffn_norm): LayerNorm((1152,), eps=1e-06, elementwise_affine=True)
            )
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=1024, out_features=3584, bias=False)
  (vision_decoder_head): Linear(in_features=3584, out_features=1024, bias=False)
)
2025-07-16 18:00:16.950	g3086:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-16 18:00:16.951	g3086:0	olmo.data.data_loader:197	INFO	Loading train dataset depth/train
2025-07-16 18:00:16.951	g3086:0	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/train/train.json
2025-07-16 18:00:17.038	g3086:0	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-16 18:00:17.038	g3086:0	olmo.data.data_loader:219	INFO	depth: 100.00
2025-07-16 18:00:17.057	g3086:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=2304 images=9 pooled_patches_idx=1414
2025-07-16 18:00:17.058	g3086:0	olmo.data.data_loader:100	INFO	Loading eval dataset: depth/validation
2025-07-16 18:00:17.058	g3086:0	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/val/val.json
2025-07-16 18:00:17.073	g3086:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=1792 images=9 pooled_patches_idx=1414
2025-07-16 18:00:25.105	g3086:0	train:308	INFO	Loading unshared model from /mmfs1/gscratch/krishna/mahtab/Umolmo/pretrained/step22347-unsharded
2025-07-16 18:02:41.168	g3086:0	olmo.util:177	CRITICAL	Uncaught BdbQuit: 
Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/Umolmo/launch_scripts/train_multitask_model.py", line 396, in <module>
    run_trainer(cfg)
  File "/gscratch/krishna/mahtab/Umolmo/scripts/train.py", line 309, in run_trainer
    load_model_state_unsharded(start_from, fsdp_model)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/checkpointer.py", line 53, in load_model_state_unsharded
    dist_cp_sd.set_model_state_dict(
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/checkpointer.py", line 53, in load_model_state_unsharded
    dist_cp_sd.set_model_state_dict(
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/bdb.py", line 90, in trace_dispatch
    return self.dispatch_line(frame)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/bdb.py", line 115, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit
2025-07-16 18:06:41.685	g3086:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-16 18:06:41.896	g3086:0	root:266	INFO	Setting eval subset batches to 512
2025-07-16 18:06:42.114	g3086:0	train:54	INFO	Configuration:
2025-07-16 18:06:42.115	g3086:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=3584, n_heads=28, n_kv_heads=4, head_dim=None, qkv_bias=True, clip_qkv=None, n_layers=28, mlp_ratio=4, mlp_hidden_size=37888, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=1000000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='rms', layer_norm_with_affine=True, layer_norm_eps=1e-06, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=False, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.0, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=152064, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2.5-7B', tokenizer_dir=None), init_path='gs://mm-olmo/pretrained_llms/qwen2.5-7b.pt', init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='siglip', image_default_input_size=(378, 378), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1152, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=27, image_head_dim=72, image_mlp_dim=4304, image_mlp_activations='gelu_pytorch_tanh', image_dropout_rate=0.0, image_num_pos=729, image_norm_eps=1e-06, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path='gs://mm-olmo/pretrained_image_encoders/siglip2-so400m-14-384.pt', resize_mode='siglip', pad_value=0.0, normalize='siglip'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-3, -9), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='overlap-and-resize-c2', max_crops=8, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear', per_image_output_tokens=64), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'depth': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=2000, inf_evaluators=[InfDatasetEvaluatorConfig(label='depth', data=DataLoaderConfig(dataset='depth', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=2048, console_log_interval=20, include_image=False)], inf_eval_interval=2000, eval_on_last_step=True, eval_on_load=False, save_folder='/mmfs1/gscratch/krishna/mahtab/Umolmo/checkpoints/molmo-7b-qwen2-siglip2-finetune', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint='/mmfs1/gscratch/krishna/mahtab/Umolmo/pretrained/step22347-unsharded', allow_resume=True, max_duration=30000, global_train_batch_size=256, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=WandbConfig(project='mmseek', entity='allenai-team1', group=None, name='molmo-7b-qwen2-siglip2-finetune', tags=['watching'], log_artifacts=False, rank_zero_only=True, log_interval=20, allow_resume=False), beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=20, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=30000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-16 18:06:42.479	g3086:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-16 18:06:45.087	g3086:0	root:123	INFO	Padding tokenizer with 397 tokens
2025-07-16 18:06:49.600	g3086:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-16 18:06:50.330	g3086:0	train:191	INFO	Total number of parameters: 8,126,757,840
2025-07-16 18:06:50.333	g3086:0	train:192	INFO	Number of non-embedding parameters: 7,581,301,712
2025-07-16 18:06:50.334	g3086:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 32604
2025-07-16 18:06:50.335	g3086:0	train:196	INFO	Model:
2025-07-16 18:06:50.335	g3086:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0-27): 28 x FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=3584, out_features=3584, bias=False)
          (ff_out): Linear(in_features=18944, out_features=3584, bias=False)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): RMSLayerNorm()
          (ff_norm): RMSLayerNorm()
          (att_proj): Linear(in_features=3584, out_features=4608, bias=True)
          (ff_proj): Linear(in_features=3584, out_features=37888, bias=False)
        )
      )
    )
    (ln_f): FSDPRMSLayerNorm()
    (emb_drop): Dropout(p=0.0, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=3584, out_features=152064, bias=False)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=2304, out_features=1152, bias=True)
        (wk): Linear(in_features=2304, out_features=1152, bias=True)
        (wv): Linear(in_features=2304, out_features=1152, bias=True)
        (wo): Linear(in_features=1152, out_features=1152, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1152, out_features=18944, bias=False)
        (w2): Linear(in_features=18944, out_features=3584, bias=False)
        (w3): Linear(in_features=1152, out_features=18944, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPSiglipVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1152, bias=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0-24): 25 x FSDPCheckpointWrapper(
            (_checkpoint_wrapped_module): ResidualAttentionBlock(
              (attention): ViTMultiHeadDotProductAttention(
                (wq): Linear(in_features=1152, out_features=1152, bias=True)
                (wk): Linear(in_features=1152, out_features=1152, bias=True)
                (wv): Linear(in_features=1152, out_features=1152, bias=True)
                (wo): Linear(in_features=1152, out_features=1152, bias=True)
                (residual_dropout): Dropout(p=0.0, inplace=False)
              )
              (feed_forward): ViTMLP(
                (w1): Linear(in_features=1152, out_features=4304, bias=True)
                (act): PytorchGELUTanh()
                (w2): Linear(in_features=4304, out_features=1152, bias=True)
              )
              (attention_norm): LayerNorm((1152,), eps=1e-06, elementwise_affine=True)
              (ffn_norm): LayerNorm((1152,), eps=1e-06, elementwise_affine=True)
            )
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=1024, out_features=3584, bias=False)
  (vision_decoder_head): Linear(in_features=3584, out_features=1024, bias=False)
)
2025-07-16 18:06:50.375	g3086:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-16 18:06:50.376	g3086:0	olmo.data.data_loader:197	INFO	Loading train dataset depth/train
2025-07-16 18:06:50.377	g3086:0	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/train/train.json
2025-07-16 18:06:50.451	g3086:0	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-16 18:06:50.452	g3086:0	olmo.data.data_loader:219	INFO	depth: 100.00
2025-07-16 18:06:50.473	g3086:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=2304 images=9 pooled_patches_idx=1414
2025-07-16 18:06:50.474	g3086:0	olmo.data.data_loader:100	INFO	Loading eval dataset: depth/validation
2025-07-16 18:06:50.475	g3086:0	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/val/val.json
2025-07-16 18:06:50.488	g3086:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=1792 images=9 pooled_patches_idx=1414
2025-07-16 18:06:58.636	g3086:0	train:308	INFO	Loading unshared model from /mmfs1/gscratch/krishna/mahtab/Umolmo/pretrained/step22347-unsharded
2025-07-16 18:09:17.633	g3086:0	olmo.util:177	CRITICAL	Uncaught BdbQuit: 
Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/Umolmo/launch_scripts/train_multitask_model.py", line 396, in <module>
    run_trainer(cfg)
  File "/gscratch/krishna/mahtab/Umolmo/scripts/train.py", line 309, in run_trainer
    load_model_state_unsharded(start_from, fsdp_model)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/checkpointer.py", line 53, in load_model_state_unsharded
    import pdb; pdb.set_trace()
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/bdb.py", line 96, in trace_dispatch
    return self.dispatch_exception(frame, arg)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/bdb.py", line 176, in dispatch_exception
    if self.quitting: raise BdbQuit
bdb.BdbQuit
2025-07-16 18:17:24.490	g3086:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-16 18:17:24.777	g3086:0	root:266	INFO	Setting eval subset batches to 512
2025-07-16 18:17:24.966	g3086:0	train:54	INFO	Configuration:
2025-07-16 18:17:24.966	g3086:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=3584, n_heads=28, n_kv_heads=4, head_dim=None, qkv_bias=True, clip_qkv=None, n_layers=28, mlp_ratio=4, mlp_hidden_size=37888, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=1000000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='rms', layer_norm_with_affine=True, layer_norm_eps=1e-06, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=False, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.0, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=152064, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2.5-7B', tokenizer_dir=None), init_path='gs://mm-olmo/pretrained_llms/qwen2.5-7b.pt', init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='siglip', image_default_input_size=(378, 378), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1152, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=27, image_head_dim=72, image_mlp_dim=4304, image_mlp_activations='gelu_pytorch_tanh', image_dropout_rate=0.0, image_num_pos=729, image_norm_eps=1e-06, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path='gs://mm-olmo/pretrained_image_encoders/siglip2-so400m-14-384.pt', resize_mode='siglip', pad_value=0.0, normalize='siglip'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-3, -9), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='overlap-and-resize-c2', max_crops=8, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear', per_image_output_tokens=64), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'depth': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=2000, inf_evaluators=[InfDatasetEvaluatorConfig(label='depth', data=DataLoaderConfig(dataset='depth', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=2048, console_log_interval=20, include_image=False)], inf_eval_interval=2000, eval_on_last_step=True, eval_on_load=False, save_folder='/mmfs1/gscratch/krishna/mahtab/Umolmo/checkpoints/molmo-7b-qwen2-siglip2-finetune', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint='/mmfs1/gscratch/krishna/mahtab/Umolmo/pretrained/step22347-unsharded', allow_resume=True, max_duration=30000, global_train_batch_size=256, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=WandbConfig(project='mmseek', entity='allenai-team1', group=None, name='molmo-7b-qwen2-siglip2-finetune', tags=['watching'], log_artifacts=False, rank_zero_only=True, log_interval=20, allow_resume=False), beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=20, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=30000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-16 18:17:25.340	g3086:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-16 18:17:28.210	g3086:0	root:123	INFO	Padding tokenizer with 397 tokens
2025-07-16 18:17:32.774	g3086:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-16 18:17:33.483	g3086:0	train:191	INFO	Total number of parameters: 8,126,757,840
2025-07-16 18:17:33.486	g3086:0	train:192	INFO	Number of non-embedding parameters: 7,581,301,712
2025-07-16 18:17:33.487	g3086:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 32604
2025-07-16 18:17:33.487	g3086:0	train:196	INFO	Model:
2025-07-16 18:17:33.488	g3086:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0-27): 28 x FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=3584, out_features=3584, bias=False)
          (ff_out): Linear(in_features=18944, out_features=3584, bias=False)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): RMSLayerNorm()
          (ff_norm): RMSLayerNorm()
          (att_proj): Linear(in_features=3584, out_features=4608, bias=True)
          (ff_proj): Linear(in_features=3584, out_features=37888, bias=False)
        )
      )
    )
    (ln_f): FSDPRMSLayerNorm()
    (emb_drop): Dropout(p=0.0, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=3584, out_features=152064, bias=False)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=2304, out_features=1152, bias=True)
        (wk): Linear(in_features=2304, out_features=1152, bias=True)
        (wv): Linear(in_features=2304, out_features=1152, bias=True)
        (wo): Linear(in_features=1152, out_features=1152, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1152, out_features=18944, bias=False)
        (w2): Linear(in_features=18944, out_features=3584, bias=False)
        (w3): Linear(in_features=1152, out_features=18944, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPSiglipVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1152, bias=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0-24): 25 x FSDPCheckpointWrapper(
            (_checkpoint_wrapped_module): ResidualAttentionBlock(
              (attention): ViTMultiHeadDotProductAttention(
                (wq): Linear(in_features=1152, out_features=1152, bias=True)
                (wk): Linear(in_features=1152, out_features=1152, bias=True)
                (wv): Linear(in_features=1152, out_features=1152, bias=True)
                (wo): Linear(in_features=1152, out_features=1152, bias=True)
                (residual_dropout): Dropout(p=0.0, inplace=False)
              )
              (feed_forward): ViTMLP(
                (w1): Linear(in_features=1152, out_features=4304, bias=True)
                (act): PytorchGELUTanh()
                (w2): Linear(in_features=4304, out_features=1152, bias=True)
              )
              (attention_norm): LayerNorm((1152,), eps=1e-06, elementwise_affine=True)
              (ffn_norm): LayerNorm((1152,), eps=1e-06, elementwise_affine=True)
            )
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=1024, out_features=3584, bias=False)
  (vision_decoder_head): Linear(in_features=3584, out_features=1024, bias=False)
)
2025-07-16 18:17:33.551	g3086:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-16 18:17:33.553	g3086:0	olmo.data.data_loader:197	INFO	Loading train dataset depth/train
2025-07-16 18:17:33.553	g3086:0	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/train/train.json
2025-07-16 18:17:33.629	g3086:0	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-16 18:17:33.630	g3086:0	olmo.data.data_loader:219	INFO	depth: 100.00
2025-07-16 18:17:33.647	g3086:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=2304 images=9 pooled_patches_idx=1414
2025-07-16 18:17:33.648	g3086:0	olmo.data.data_loader:100	INFO	Loading eval dataset: depth/validation
2025-07-16 18:17:33.649	g3086:0	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/val/val.json
2025-07-16 18:17:33.668	g3086:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=1792 images=9 pooled_patches_idx=1414
2025-07-16 18:17:41.217	g3086:0	train:308	INFO	Loading unshared model from /mmfs1/gscratch/krishna/mahtab/Umolmo/pretrained/step22347-unsharded
2025-07-16 18:29:57.590	g3086:1	olmo.util:269	INFO	Set up torchrun environment
2025-07-16 18:29:57.590	g3086:3	olmo.util:269	INFO	Set up torchrun environment
2025-07-16 18:29:57.590	g3086:2	olmo.util:269	INFO	Set up torchrun environment
2025-07-16 18:29:57.606	g3086:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-16 18:29:57.763	g3086:0	root:266	INFO	Setting eval subset batches to 128
2025-07-16 18:29:57.763	g3086:1	root:266	INFO	Setting eval subset batches to 128
2025-07-16 18:29:57.763	g3086:2	root:266	INFO	Setting eval subset batches to 128
2025-07-16 18:29:57.763	g3086:3	root:266	INFO	Setting eval subset batches to 128
2025-07-16 18:29:58.128	g3086:0	train:54	INFO	Configuration:
2025-07-16 18:29:58.129	g3086:2	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-16 18:29:58.129	g3086:3	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-16 18:29:58.129	g3086:1	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-16 18:29:58.129	g3086:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=3584, n_heads=28, n_kv_heads=4, head_dim=None, qkv_bias=True, clip_qkv=None, n_layers=28, mlp_ratio=4, mlp_hidden_size=37888, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=1000000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='rms', layer_norm_with_affine=True, layer_norm_eps=1e-06, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=False, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.0, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=152064, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2.5-7B', tokenizer_dir=None), init_path='gs://mm-olmo/pretrained_llms/qwen2.5-7b.pt', init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='siglip', image_default_input_size=(378, 378), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1152, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=27, image_head_dim=72, image_mlp_dim=4304, image_mlp_activations='gelu_pytorch_tanh', image_dropout_rate=0.0, image_num_pos=729, image_norm_eps=1e-06, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path='gs://mm-olmo/pretrained_image_encoders/siglip2-so400m-14-384.pt', resize_mode='siglip', pad_value=0.0, normalize='siglip'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-3, -9), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='overlap-and-resize-c2', max_crops=8, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear', per_image_output_tokens=64), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'depth': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=2000, inf_evaluators=[InfDatasetEvaluatorConfig(label='depth', data=DataLoaderConfig(dataset='depth', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=2048, console_log_interval=20, include_image=False)], inf_eval_interval=2000, eval_on_last_step=True, eval_on_load=False, save_folder='/mmfs1/gscratch/krishna/mahtab/Umolmo/checkpoints/molmo-7b-qwen2-siglip2-finetune', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint='/mmfs1/gscratch/krishna/mahtab/Umolmo/pretrained/step22347-unsharded', allow_resume=True, max_duration=30000, global_train_batch_size=256, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=WandbConfig(project='mmseek', entity='allenai-team1', group=None, name='molmo-7b-qwen2-siglip2-finetune', tags=['watching'], log_artifacts=False, rank_zero_only=True, log_interval=20, allow_resume=False), beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=20, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=30000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-16 18:29:58.497	g3086:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-16 18:30:01.300	g3086:1	root:123	INFO	Padding tokenizer with 397 tokens
2025-07-16 18:30:01.305	g3086:2	root:123	INFO	Padding tokenizer with 397 tokens
2025-07-16 18:30:01.305	g3086:3	root:123	INFO	Padding tokenizer with 397 tokens
2025-07-16 18:30:01.335	g3086:0	root:123	INFO	Padding tokenizer with 397 tokens
2025-07-16 18:30:06.071	g3086:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-16 18:30:06.073	g3086:2	train:180	INFO	Wrapping model with FSDP2...
2025-07-16 18:30:06.074	g3086:3	train:180	INFO	Wrapping model with FSDP2...
2025-07-16 18:30:06.074	g3086:1	train:180	INFO	Wrapping model with FSDP2...
2025-07-16 18:30:06.693	g3086:1	train:191	INFO	Total number of parameters: 8,126,757,840
2025-07-16 18:30:06.693	g3086:2	train:191	INFO	Total number of parameters: 8,126,757,840
2025-07-16 18:30:06.694	g3086:1	train:192	INFO	Number of non-embedding parameters: 7,581,301,712
2025-07-16 18:30:06.694	g3086:0	train:191	INFO	Total number of parameters: 8,126,757,840
2025-07-16 18:30:06.695	g3086:2	train:192	INFO	Number of non-embedding parameters: 7,581,301,712
2025-07-16 18:30:06.695	g3086:1	train:195	INFO	Peak GPU Memory (MB) after FSDP: 8177
2025-07-16 18:30:06.695	g3086:1	train:196	INFO	Model:
2025-07-16 18:30:06.696	g3086:2	train:195	INFO	Peak GPU Memory (MB) after FSDP: 8177
2025-07-16 18:30:06.696	g3086:2	train:196	INFO	Model:
2025-07-16 18:30:06.697	g3086:0	train:192	INFO	Number of non-embedding parameters: 7,581,301,712
2025-07-16 18:30:06.695	g3086:1	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0-27): 28 x FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=3584, out_features=3584, bias=False)
          (ff_out): Linear(in_features=18944, out_features=3584, bias=False)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): RMSLayerNorm()
          (ff_norm): RMSLayerNorm()
          (att_proj): Linear(in_features=3584, out_features=4608, bias=True)
          (ff_proj): Linear(in_features=3584, out_features=37888, bias=False)
        )
      )
    )
    (ln_f): FSDPRMSLayerNorm()
    (emb_drop): Dropout(p=0.0, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=3584, out_features=152064, bias=False)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=2304, out_features=1152, bias=True)
        (wk): Linear(in_features=2304, out_features=1152, bias=True)
        (wv): Linear(in_features=2304, out_features=1152, bias=True)
        (wo): Linear(in_features=1152, out_features=1152, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1152, out_features=18944, bias=False)
        (w2): Linear(in_features=18944, out_features=3584, bias=False)
        (w3): Linear(in_features=1152, out_features=18944, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPSiglipVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1152, bias=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0-24): 25 x FSDPCheckpointWrapper(
            (_checkpoint_wrapped_module): ResidualAttentionBlock(
              (attention): ViTMultiHeadDotProductAttention(
                (wq): Linear(in_features=1152, out_features=1152, bias=True)
                (wk): Linear(in_features=1152, out_features=1152, bias=True)
                (wv): Linear(in_features=1152, out_features=1152, bias=True)
                (wo): Linear(in_features=1152, out_features=1152, bias=True)
                (residual_dropout): Dropout(p=0.0, inplace=False)
              )
              (feed_forward): ViTMLP(
                (w1): Linear(in_features=1152, out_features=4304, bias=True)
                (act): PytorchGELUTanh()
                (w2): Linear(in_features=4304, out_features=1152, bias=True)
              )
              (attention_norm): LayerNorm((1152,), eps=1e-06, elementwise_affine=True)
              (ffn_norm): LayerNorm((1152,), eps=1e-06, elementwise_affine=True)
            )
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=1024, out_features=3584, bias=False)
  (vision_decoder_head): Linear(in_features=3584, out_features=1024, bias=False)
)
2025-07-16 18:30:06.698	g3086:3	train:191	INFO	Total number of parameters: 8,126,757,840
2025-07-16 18:30:06.696	g3086:2	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0-27): 28 x FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=3584, out_features=3584, bias=False)
          (ff_out): Linear(in_features=18944, out_features=3584, bias=False)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): RMSLayerNorm()
          (ff_norm): RMSLayerNorm()
          (att_proj): Linear(in_features=3584, out_features=4608, bias=True)
          (ff_proj): Linear(in_features=3584, out_features=37888, bias=False)
        )
      )
    )
    (ln_f): FSDPRMSLayerNorm()
    (emb_drop): Dropout(p=0.0, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=3584, out_features=152064, bias=False)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=2304, out_features=1152, bias=True)
        (wk): Linear(in_features=2304, out_features=1152, bias=True)
        (wv): Linear(in_features=2304, out_features=1152, bias=True)
        (wo): Linear(in_features=1152, out_features=1152, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1152, out_features=18944, bias=False)
        (w2): Linear(in_features=18944, out_features=3584, bias=False)
        (w3): Linear(in_features=1152, out_features=18944, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPSiglipVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1152, bias=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0-24): 25 x FSDPCheckpointWrapper(
            (_checkpoint_wrapped_module): ResidualAttentionBlock(
              (attention): ViTMultiHeadDotProductAttention(
                (wq): Linear(in_features=1152, out_features=1152, bias=True)
                (wk): Linear(in_features=1152, out_features=1152, bias=True)
                (wv): Linear(in_features=1152, out_features=1152, bias=True)
                (wo): Linear(in_features=1152, out_features=1152, bias=True)
                (residual_dropout): Dropout(p=0.0, inplace=False)
              )
              (feed_forward): ViTMLP(
                (w1): Linear(in_features=1152, out_features=4304, bias=True)
                (act): PytorchGELUTanh()
                (w2): Linear(in_features=4304, out_features=1152, bias=True)
              )
              (attention_norm): LayerNorm((1152,), eps=1e-06, elementwise_affine=True)
              (ffn_norm): LayerNorm((1152,), eps=1e-06, elementwise_affine=True)
            )
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=1024, out_features=3584, bias=False)
  (vision_decoder_head): Linear(in_features=3584, out_features=1024, bias=False)
)
2025-07-16 18:30:06.718	g3086:3	train:192	INFO	Number of non-embedding parameters: 7,581,301,712
2025-07-16 18:30:06.719	g3086:3	train:195	INFO	Peak GPU Memory (MB) after FSDP: 8177
2025-07-16 18:30:06.719	g3086:3	train:196	INFO	Model:
2025-07-16 18:30:06.719	g3086:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 8177
2025-07-16 18:30:06.719	g3086:0	train:196	INFO	Model:
2025-07-16 18:30:06.719	g3086:3	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0-27): 28 x FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=3584, out_features=3584, bias=False)
          (ff_out): Linear(in_features=18944, out_features=3584, bias=False)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): RMSLayerNorm()
          (ff_norm): RMSLayerNorm()
          (att_proj): Linear(in_features=3584, out_features=4608, bias=True)
          (ff_proj): Linear(in_features=3584, out_features=37888, bias=False)
        )
      )
    )
    (ln_f): FSDPRMSLayerNorm()
    (emb_drop): Dropout(p=0.0, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=3584, out_features=152064, bias=False)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=2304, out_features=1152, bias=True)
        (wk): Linear(in_features=2304, out_features=1152, bias=True)
        (wv): Linear(in_features=2304, out_features=1152, bias=True)
        (wo): Linear(in_features=1152, out_features=1152, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1152, out_features=18944, bias=False)
        (w2): Linear(in_features=18944, out_features=3584, bias=False)
        (w3): Linear(in_features=1152, out_features=18944, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPSiglipVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1152, bias=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0-24): 25 x FSDPCheckpointWrapper(
            (_checkpoint_wrapped_module): ResidualAttentionBlock(
              (attention): ViTMultiHeadDotProductAttention(
                (wq): Linear(in_features=1152, out_features=1152, bias=True)
                (wk): Linear(in_features=1152, out_features=1152, bias=True)
                (wv): Linear(in_features=1152, out_features=1152, bias=True)
                (wo): Linear(in_features=1152, out_features=1152, bias=True)
                (residual_dropout): Dropout(p=0.0, inplace=False)
              )
              (feed_forward): ViTMLP(
                (w1): Linear(in_features=1152, out_features=4304, bias=True)
                (act): PytorchGELUTanh()
                (w2): Linear(in_features=4304, out_features=1152, bias=True)
              )
              (attention_norm): LayerNorm((1152,), eps=1e-06, elementwise_affine=True)
              (ffn_norm): LayerNorm((1152,), eps=1e-06, elementwise_affine=True)
            )
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=1024, out_features=3584, bias=False)
  (vision_decoder_head): Linear(in_features=3584, out_features=1024, bias=False)
)
2025-07-16 18:30:06.720	g3086:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0-27): 28 x FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=3584, out_features=3584, bias=False)
          (ff_out): Linear(in_features=18944, out_features=3584, bias=False)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): RMSLayerNorm()
          (ff_norm): RMSLayerNorm()
          (att_proj): Linear(in_features=3584, out_features=4608, bias=True)
          (ff_proj): Linear(in_features=3584, out_features=37888, bias=False)
        )
      )
    )
    (ln_f): FSDPRMSLayerNorm()
    (emb_drop): Dropout(p=0.0, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=3584, out_features=152064, bias=False)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=2304, out_features=1152, bias=True)
        (wk): Linear(in_features=2304, out_features=1152, bias=True)
        (wv): Linear(in_features=2304, out_features=1152, bias=True)
        (wo): Linear(in_features=1152, out_features=1152, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1152, out_features=18944, bias=False)
        (w2): Linear(in_features=18944, out_features=3584, bias=False)
        (w3): Linear(in_features=1152, out_features=18944, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPSiglipVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1152, bias=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0-24): 25 x FSDPCheckpointWrapper(
            (_checkpoint_wrapped_module): ResidualAttentionBlock(
              (attention): ViTMultiHeadDotProductAttention(
                (wq): Linear(in_features=1152, out_features=1152, bias=True)
                (wk): Linear(in_features=1152, out_features=1152, bias=True)
                (wv): Linear(in_features=1152, out_features=1152, bias=True)
                (wo): Linear(in_features=1152, out_features=1152, bias=True)
                (residual_dropout): Dropout(p=0.0, inplace=False)
              )
              (feed_forward): ViTMLP(
                (w1): Linear(in_features=1152, out_features=4304, bias=True)
                (act): PytorchGELUTanh()
                (w2): Linear(in_features=4304, out_features=1152, bias=True)
              )
              (attention_norm): LayerNorm((1152,), eps=1e-06, elementwise_affine=True)
              (ffn_norm): LayerNorm((1152,), eps=1e-06, elementwise_affine=True)
            )
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=1024, out_features=3584, bias=False)
  (vision_decoder_head): Linear(in_features=3584, out_features=1024, bias=False)
)
2025-07-16 18:30:06.724	g3086:2	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-16 18:30:06.724	g3086:1	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-16 18:30:06.745	g3086:2	olmo.data.data_loader:197	INFO	Loading train dataset depth/train
2025-07-16 18:30:06.745	g3086:1	olmo.data.data_loader:197	INFO	Loading train dataset depth/train
2025-07-16 18:30:06.745	g3086:2	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/train/train.json
2025-07-16 18:30:06.745	g3086:1	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/train/train.json
2025-07-16 18:30:06.749	g3086:3	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-16 18:30:06.750	g3086:3	olmo.data.data_loader:197	INFO	Loading train dataset depth/train
2025-07-16 18:30:06.750	g3086:3	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/train/train.json
2025-07-16 18:30:06.751	g3086:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-16 18:30:06.752	g3086:0	olmo.data.data_loader:197	INFO	Loading train dataset depth/train
2025-07-16 18:30:06.752	g3086:0	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/train/train.json
2025-07-16 18:30:06.812	g3086:0	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-16 18:30:06.813	g3086:0	olmo.data.data_loader:219	INFO	depth: 100.00
2025-07-16 18:30:06.813	g3086:2	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-16 18:30:06.813	g3086:2	olmo.data.data_loader:219	INFO	depth: 100.00
2025-07-16 18:30:06.813	g3086:1	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-16 18:30:06.813	g3086:3	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-16 18:30:06.815	g3086:1	olmo.data.data_loader:219	INFO	depth: 100.00
2025-07-16 18:30:06.815	g3086:3	olmo.data.data_loader:219	INFO	depth: 100.00
2025-07-16 18:30:06.830	g3086:3	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=2304 images=9 pooled_patches_idx=1414
2025-07-16 18:30:06.830	g3086:2	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=2304 images=9 pooled_patches_idx=1414
2025-07-16 18:30:06.830	g3086:1	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=2304 images=9 pooled_patches_idx=1414
2025-07-16 18:30:06.830	g3086:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=2304 images=9 pooled_patches_idx=1414
2025-07-16 18:30:06.831	g3086:2	olmo.data.data_loader:100	INFO	Loading eval dataset: depth/validation
2025-07-16 18:30:06.831	g3086:3	olmo.data.data_loader:100	INFO	Loading eval dataset: depth/validation
2025-07-16 18:30:06.831	g3086:1	olmo.data.data_loader:100	INFO	Loading eval dataset: depth/validation
2025-07-16 18:30:06.831	g3086:2	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/val/val.json
2025-07-16 18:30:06.831	g3086:3	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/val/val.json
2025-07-16 18:30:06.831	g3086:1	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/val/val.json
2025-07-16 18:30:06.831	g3086:0	olmo.data.data_loader:100	INFO	Loading eval dataset: depth/validation
2025-07-16 18:30:06.831	g3086:0	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/val/val.json
2025-07-16 18:30:06.847	g3086:1	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=1792 images=9 pooled_patches_idx=1414
2025-07-16 18:30:06.847	g3086:2	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=1792 images=9 pooled_patches_idx=1414
2025-07-16 18:30:06.847	g3086:3	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=1792 images=9 pooled_patches_idx=1414
2025-07-16 18:30:06.847	g3086:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=1792 images=9 pooled_patches_idx=1414
2025-07-16 18:30:14.647	g3086:2	train:308	INFO	Loading unshared model from /mmfs1/gscratch/krishna/mahtab/Umolmo/pretrained/step22347-unsharded
2025-07-16 18:30:14.647	g3086:1	train:308	INFO	Loading unshared model from /mmfs1/gscratch/krishna/mahtab/Umolmo/pretrained/step22347-unsharded
2025-07-16 18:30:14.647	g3086:3	train:308	INFO	Loading unshared model from /mmfs1/gscratch/krishna/mahtab/Umolmo/pretrained/step22347-unsharded
2025-07-16 18:30:14.647	g3086:0	train:308	INFO	Loading unshared model from /mmfs1/gscratch/krishna/mahtab/Umolmo/pretrained/step22347-unsharded
2025-07-16 18:30:56.405	g3086:0	olmo.util:177	CRITICAL	Uncaught AssertionError: found no DeviceMesh from dtensor args for c10d.broadcast_.default!
Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/Umolmo/launch_scripts/train_multitask_model.py", line 396, in <module>
    run_trainer(cfg)
  File "/gscratch/krishna/mahtab/Umolmo/scripts/train.py", line 309, in run_trainer
    load_model_state_unsharded(start_from, fsdp_model)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/checkpointer.py", line 58, in load_model_state_unsharded
    dist_cp_sd.set_model_state_dict(
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/distributed/checkpoint/state_dict.py", line 1277, in set_model_state_dict
    return _load_model_state_dict(model, model_state_dict, info)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/distributed/checkpoint/state_dict.py", line 590, in _load_model_state_dict
    _broadcast_state_dict(
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/distributed/_state_dict_utils.py", line 633, in _broadcast_state_dict
    _broadcast_tensors(ret, local_state_dict, keys, device, pg)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/distributed/_state_dict_utils.py", line 545, in _broadcast_tensors
    dist.broadcast(tensors[0], src=0, group=pg)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/distributed/c10d_logger.py", line 81, in wrapper
    return func(*args, **kwargs)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/distributed/distributed_c10d.py", line 2714, in broadcast
    work = group.broadcast([tensor], opts)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/_compile.py", line 51, in inner
    return disable_fn(*args, **kwargs)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py", line 838, in _fn
    return fn(*args, **kwargs)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/distributed/tensor/_api.py", line 344, in __torch_dispatch__
    return DTensor._op_dispatcher.dispatch(
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/distributed/tensor/_dispatch.py", line 167, in dispatch
    op_info = self.unwrap_to_op_info(op_call, args, kwargs)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/distributed/tensor/_dispatch.py", line 393, in unwrap_to_op_info
    assert compute_mesh is not None, (
AssertionError: found no DeviceMesh from dtensor args for c10d.broadcast_.default!
2025-07-16 18:36:30.460	g3086:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-16 18:36:30.675	g3086:0	root:266	INFO	Setting eval subset batches to 512
2025-07-16 18:36:30.951	g3086:0	train:54	INFO	Configuration:
2025-07-16 18:36:30.952	g3086:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=3584, n_heads=28, n_kv_heads=4, head_dim=None, qkv_bias=True, clip_qkv=None, n_layers=28, mlp_ratio=4, mlp_hidden_size=37888, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=1000000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='rms', layer_norm_with_affine=True, layer_norm_eps=1e-06, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=False, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.0, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=152064, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2.5-7B', tokenizer_dir=None), init_path='gs://mm-olmo/pretrained_llms/qwen2.5-7b.pt', init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='siglip', image_default_input_size=(378, 378), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1152, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=27, image_head_dim=72, image_mlp_dim=4304, image_mlp_activations='gelu_pytorch_tanh', image_dropout_rate=0.0, image_num_pos=729, image_norm_eps=1e-06, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path='gs://mm-olmo/pretrained_image_encoders/siglip2-so400m-14-384.pt', resize_mode='siglip', pad_value=0.0, normalize='siglip'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-3, -9), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='overlap-and-resize-c2', max_crops=8, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear', per_image_output_tokens=64), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'depth': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=2000, inf_evaluators=[InfDatasetEvaluatorConfig(label='depth', data=DataLoaderConfig(dataset='depth', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=2048, console_log_interval=20, include_image=False)], inf_eval_interval=2000, eval_on_last_step=True, eval_on_load=False, save_folder='/mmfs1/gscratch/krishna/mahtab/Umolmo/checkpoints/molmo-7b-qwen2-siglip2-finetune', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint='/mmfs1/gscratch/krishna/mahtab/Umolmo/pretrained/step22347-unsharded', allow_resume=True, max_duration=30000, global_train_batch_size=256, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=WandbConfig(project='mmseek', entity='allenai-team1', group=None, name='molmo-7b-qwen2-siglip2-finetune', tags=['watching'], log_artifacts=False, rank_zero_only=True, log_interval=20, allow_resume=False), beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=20, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=30000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-16 18:36:31.345	g3086:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-16 18:36:34.185	g3086:0	root:123	INFO	Padding tokenizer with 397 tokens
2025-07-16 18:36:39.166	g3086:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-16 18:36:39.864	g3086:0	train:191	INFO	Total number of parameters: 8,126,757,840
2025-07-16 18:36:39.867	g3086:0	train:192	INFO	Number of non-embedding parameters: 7,581,301,712
2025-07-16 18:36:39.869	g3086:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 32604
2025-07-16 18:36:39.869	g3086:0	train:196	INFO	Model:
2025-07-16 18:36:39.869	g3086:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0-27): 28 x FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=3584, out_features=3584, bias=False)
          (ff_out): Linear(in_features=18944, out_features=3584, bias=False)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): RMSLayerNorm()
          (ff_norm): RMSLayerNorm()
          (att_proj): Linear(in_features=3584, out_features=4608, bias=True)
          (ff_proj): Linear(in_features=3584, out_features=37888, bias=False)
        )
      )
    )
    (ln_f): FSDPRMSLayerNorm()
    (emb_drop): Dropout(p=0.0, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=3584, out_features=152064, bias=False)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=2304, out_features=1152, bias=True)
        (wk): Linear(in_features=2304, out_features=1152, bias=True)
        (wv): Linear(in_features=2304, out_features=1152, bias=True)
        (wo): Linear(in_features=1152, out_features=1152, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1152, out_features=18944, bias=False)
        (w2): Linear(in_features=18944, out_features=3584, bias=False)
        (w3): Linear(in_features=1152, out_features=18944, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPSiglipVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1152, bias=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0-24): 25 x FSDPCheckpointWrapper(
            (_checkpoint_wrapped_module): ResidualAttentionBlock(
              (attention): ViTMultiHeadDotProductAttention(
                (wq): Linear(in_features=1152, out_features=1152, bias=True)
                (wk): Linear(in_features=1152, out_features=1152, bias=True)
                (wv): Linear(in_features=1152, out_features=1152, bias=True)
                (wo): Linear(in_features=1152, out_features=1152, bias=True)
                (residual_dropout): Dropout(p=0.0, inplace=False)
              )
              (feed_forward): ViTMLP(
                (w1): Linear(in_features=1152, out_features=4304, bias=True)
                (act): PytorchGELUTanh()
                (w2): Linear(in_features=4304, out_features=1152, bias=True)
              )
              (attention_norm): LayerNorm((1152,), eps=1e-06, elementwise_affine=True)
              (ffn_norm): LayerNorm((1152,), eps=1e-06, elementwise_affine=True)
            )
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=1024, out_features=3584, bias=False)
  (vision_decoder_head): Linear(in_features=3584, out_features=1024, bias=False)
)
2025-07-16 18:36:39.937	g3086:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-16 18:36:39.939	g3086:0	olmo.data.data_loader:197	INFO	Loading train dataset depth/train
2025-07-16 18:36:39.939	g3086:0	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/train/train.json
2025-07-16 18:36:40.002	g3086:0	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-16 18:36:40.003	g3086:0	olmo.data.data_loader:219	INFO	depth: 100.00
2025-07-16 18:36:40.029	g3086:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=2304 images=9 pooled_patches_idx=1414
2025-07-16 18:36:40.029	g3086:0	olmo.data.data_loader:100	INFO	Loading eval dataset: depth/validation
2025-07-16 18:36:40.030	g3086:0	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/val/val.json
2025-07-16 18:36:40.061	g3086:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=1792 images=9 pooled_patches_idx=1414
2025-07-16 18:36:46.553	g3086:0	train:308	INFO	Loading unshared model from /mmfs1/gscratch/krishna/mahtab/Umolmo/pretrained/step22347-unsharded
2025-07-16 18:39:17.999	g3086:0	olmo.util:177	CRITICAL	Uncaught BdbQuit: 
Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/Umolmo/launch_scripts/train_multitask_model.py", line 396, in <module>
    run_trainer(cfg)
  File "/gscratch/krishna/mahtab/Umolmo/scripts/train.py", line 309, in run_trainer
    load_model_state_unsharded(start_from, fsdp_model)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/checkpointer.py", line 54, in load_model_state_unsharded
    if hasattr(model, "vision_decoder_head") and "vision_decoder_head" not in state_dict:
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/checkpointer.py", line 54, in load_model_state_unsharded
    if hasattr(model, "vision_decoder_head") and "vision_decoder_head" not in state_dict:
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/bdb.py", line 90, in trace_dispatch
    return self.dispatch_line(frame)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/bdb.py", line 115, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit
2025-07-16 18:42:13.396	g3086:1	olmo.util:269	INFO	Set up torchrun environment
2025-07-16 18:42:13.419	g3086:3	olmo.util:269	INFO	Set up torchrun environment
2025-07-16 18:42:13.420	g3086:2	olmo.util:269	INFO	Set up torchrun environment
2025-07-16 18:42:13.420	g3086:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-16 18:42:13.580	g3086:3	root:266	INFO	Setting eval subset batches to 128
2025-07-16 18:42:13.580	g3086:1	root:266	INFO	Setting eval subset batches to 128
2025-07-16 18:42:13.580	g3086:2	root:266	INFO	Setting eval subset batches to 128
2025-07-16 18:42:13.580	g3086:0	root:266	INFO	Setting eval subset batches to 128
2025-07-16 18:42:13.901	g3086:0	train:54	INFO	Configuration:
2025-07-16 18:42:13.902	g3086:3	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-16 18:42:13.902	g3086:1	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-16 18:42:13.902	g3086:2	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-16 18:42:13.901	g3086:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=3584, n_heads=28, n_kv_heads=4, head_dim=None, qkv_bias=True, clip_qkv=None, n_layers=28, mlp_ratio=4, mlp_hidden_size=37888, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=1000000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='rms', layer_norm_with_affine=True, layer_norm_eps=1e-06, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=False, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.0, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=152064, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2.5-7B', tokenizer_dir=None), init_path='gs://mm-olmo/pretrained_llms/qwen2.5-7b.pt', init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='siglip', image_default_input_size=(378, 378), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1152, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=27, image_head_dim=72, image_mlp_dim=4304, image_mlp_activations='gelu_pytorch_tanh', image_dropout_rate=0.0, image_num_pos=729, image_norm_eps=1e-06, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path='gs://mm-olmo/pretrained_image_encoders/siglip2-so400m-14-384.pt', resize_mode='siglip', pad_value=0.0, normalize='siglip'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-3, -9), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='overlap-and-resize-c2', max_crops=8, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear', per_image_output_tokens=64), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'depth': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=2000, inf_evaluators=[InfDatasetEvaluatorConfig(label='depth', data=DataLoaderConfig(dataset='depth', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=2048, console_log_interval=20, include_image=False)], inf_eval_interval=2000, eval_on_last_step=True, eval_on_load=False, save_folder='/mmfs1/gscratch/krishna/mahtab/Umolmo/checkpoints/molmo-7b-qwen2-siglip2-finetune', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint='/mmfs1/gscratch/krishna/mahtab/Umolmo/pretrained/step22347-unsharded', allow_resume=True, max_duration=30000, global_train_batch_size=256, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=WandbConfig(project='mmseek', entity='allenai-team1', group=None, name='molmo-7b-qwen2-siglip2-finetune', tags=['watching'], log_artifacts=False, rank_zero_only=True, log_interval=20, allow_resume=False), beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=20, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=30000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-16 18:42:14.259	g3086:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-16 18:42:17.195	g3086:1	root:123	INFO	Padding tokenizer with 397 tokens
2025-07-16 18:42:17.203	g3086:3	root:123	INFO	Padding tokenizer with 397 tokens
2025-07-16 18:42:17.206	g3086:2	root:123	INFO	Padding tokenizer with 397 tokens
2025-07-16 18:42:17.232	g3086:0	root:123	INFO	Padding tokenizer with 397 tokens
2025-07-16 18:42:21.688	g3086:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-16 18:42:21.689	g3086:2	train:180	INFO	Wrapping model with FSDP2...
2025-07-16 18:42:21.689	g3086:1	train:180	INFO	Wrapping model with FSDP2...
2025-07-16 18:42:21.690	g3086:3	train:180	INFO	Wrapping model with FSDP2...
2025-07-16 18:42:22.426	g3086:0	train:191	INFO	Total number of parameters: 8,126,757,840
2025-07-16 18:42:22.428	g3086:2	train:191	INFO	Total number of parameters: 8,126,757,840
2025-07-16 18:42:22.429	g3086:1	train:191	INFO	Total number of parameters: 8,126,757,840
2025-07-16 18:42:22.429	g3086:0	train:192	INFO	Number of non-embedding parameters: 7,581,301,712
2025-07-16 18:42:22.430	g3086:2	train:192	INFO	Number of non-embedding parameters: 7,581,301,712
2025-07-16 18:42:22.431	g3086:1	train:192	INFO	Number of non-embedding parameters: 7,581,301,712
2025-07-16 18:42:22.431	g3086:2	train:195	INFO	Peak GPU Memory (MB) after FSDP: 8177
2025-07-16 18:42:22.432	g3086:2	train:196	INFO	Model:
2025-07-16 18:42:22.432	g3086:1	train:195	INFO	Peak GPU Memory (MB) after FSDP: 8177
2025-07-16 18:42:22.432	g3086:1	train:196	INFO	Model:
2025-07-16 18:42:22.432	g3086:2	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0-27): 28 x FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=3584, out_features=3584, bias=False)
          (ff_out): Linear(in_features=18944, out_features=3584, bias=False)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): RMSLayerNorm()
          (ff_norm): RMSLayerNorm()
          (att_proj): Linear(in_features=3584, out_features=4608, bias=True)
          (ff_proj): Linear(in_features=3584, out_features=37888, bias=False)
        )
      )
    )
    (ln_f): FSDPRMSLayerNorm()
    (emb_drop): Dropout(p=0.0, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=3584, out_features=152064, bias=False)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=2304, out_features=1152, bias=True)
        (wk): Linear(in_features=2304, out_features=1152, bias=True)
        (wv): Linear(in_features=2304, out_features=1152, bias=True)
        (wo): Linear(in_features=1152, out_features=1152, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1152, out_features=18944, bias=False)
        (w2): Linear(in_features=18944, out_features=3584, bias=False)
        (w3): Linear(in_features=1152, out_features=18944, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPSiglipVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1152, bias=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0-24): 25 x FSDPCheckpointWrapper(
            (_checkpoint_wrapped_module): ResidualAttentionBlock(
              (attention): ViTMultiHeadDotProductAttention(
                (wq): Linear(in_features=1152, out_features=1152, bias=True)
                (wk): Linear(in_features=1152, out_features=1152, bias=True)
                (wv): Linear(in_features=1152, out_features=1152, bias=True)
                (wo): Linear(in_features=1152, out_features=1152, bias=True)
                (residual_dropout): Dropout(p=0.0, inplace=False)
              )
              (feed_forward): ViTMLP(
                (w1): Linear(in_features=1152, out_features=4304, bias=True)
                (act): PytorchGELUTanh()
                (w2): Linear(in_features=4304, out_features=1152, bias=True)
              )
              (attention_norm): LayerNorm((1152,), eps=1e-06, elementwise_affine=True)
              (ffn_norm): LayerNorm((1152,), eps=1e-06, elementwise_affine=True)
            )
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=1024, out_features=3584, bias=False)
  (vision_decoder_head): Linear(in_features=3584, out_features=1024, bias=False)
)
2025-07-16 18:42:22.432	g3086:1	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0-27): 28 x FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=3584, out_features=3584, bias=False)
          (ff_out): Linear(in_features=18944, out_features=3584, bias=False)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): RMSLayerNorm()
          (ff_norm): RMSLayerNorm()
          (att_proj): Linear(in_features=3584, out_features=4608, bias=True)
          (ff_proj): Linear(in_features=3584, out_features=37888, bias=False)
        )
      )
    )
    (ln_f): FSDPRMSLayerNorm()
    (emb_drop): Dropout(p=0.0, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=3584, out_features=152064, bias=False)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=2304, out_features=1152, bias=True)
        (wk): Linear(in_features=2304, out_features=1152, bias=True)
        (wv): Linear(in_features=2304, out_features=1152, bias=True)
        (wo): Linear(in_features=1152, out_features=1152, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1152, out_features=18944, bias=False)
        (w2): Linear(in_features=18944, out_features=3584, bias=False)
        (w3): Linear(in_features=1152, out_features=18944, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPSiglipVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1152, bias=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0-24): 25 x FSDPCheckpointWrapper(
            (_checkpoint_wrapped_module): ResidualAttentionBlock(
              (attention): ViTMultiHeadDotProductAttention(
                (wq): Linear(in_features=1152, out_features=1152, bias=True)
                (wk): Linear(in_features=1152, out_features=1152, bias=True)
                (wv): Linear(in_features=1152, out_features=1152, bias=True)
                (wo): Linear(in_features=1152, out_features=1152, bias=True)
                (residual_dropout): Dropout(p=0.0, inplace=False)
              )
              (feed_forward): ViTMLP(
                (w1): Linear(in_features=1152, out_features=4304, bias=True)
                (act): PytorchGELUTanh()
                (w2): Linear(in_features=4304, out_features=1152, bias=True)
              )
              (attention_norm): LayerNorm((1152,), eps=1e-06, elementwise_affine=True)
              (ffn_norm): LayerNorm((1152,), eps=1e-06, elementwise_affine=True)
            )
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=1024, out_features=3584, bias=False)
  (vision_decoder_head): Linear(in_features=3584, out_features=1024, bias=False)
)
2025-07-16 18:42:22.443	g3086:1	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-16 18:42:22.443	g3086:2	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-16 18:42:22.444	g3086:1	olmo.data.data_loader:197	INFO	Loading train dataset depth/train
2025-07-16 18:42:22.444	g3086:1	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/train/train.json
2025-07-16 18:42:22.444	g3086:2	olmo.data.data_loader:197	INFO	Loading train dataset depth/train
2025-07-16 18:42:22.444	g3086:2	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/train/train.json
2025-07-16 18:42:22.444	g3086:3	train:191	INFO	Total number of parameters: 8,126,757,840
2025-07-16 18:42:22.447	g3086:3	train:192	INFO	Number of non-embedding parameters: 7,581,301,712
2025-07-16 18:42:22.448	g3086:3	train:195	INFO	Peak GPU Memory (MB) after FSDP: 8177
2025-07-16 18:42:22.448	g3086:3	train:196	INFO	Model:
2025-07-16 18:42:22.447	g3086:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 8177
2025-07-16 18:42:22.448	g3086:0	train:196	INFO	Model:
2025-07-16 18:42:22.448	g3086:3	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0-27): 28 x FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=3584, out_features=3584, bias=False)
          (ff_out): Linear(in_features=18944, out_features=3584, bias=False)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): RMSLayerNorm()
          (ff_norm): RMSLayerNorm()
          (att_proj): Linear(in_features=3584, out_features=4608, bias=True)
          (ff_proj): Linear(in_features=3584, out_features=37888, bias=False)
        )
      )
    )
    (ln_f): FSDPRMSLayerNorm()
    (emb_drop): Dropout(p=0.0, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=3584, out_features=152064, bias=False)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=2304, out_features=1152, bias=True)
        (wk): Linear(in_features=2304, out_features=1152, bias=True)
        (wv): Linear(in_features=2304, out_features=1152, bias=True)
        (wo): Linear(in_features=1152, out_features=1152, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1152, out_features=18944, bias=False)
        (w2): Linear(in_features=18944, out_features=3584, bias=False)
        (w3): Linear(in_features=1152, out_features=18944, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPSiglipVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1152, bias=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0-24): 25 x FSDPCheckpointWrapper(
            (_checkpoint_wrapped_module): ResidualAttentionBlock(
              (attention): ViTMultiHeadDotProductAttention(
                (wq): Linear(in_features=1152, out_features=1152, bias=True)
                (wk): Linear(in_features=1152, out_features=1152, bias=True)
                (wv): Linear(in_features=1152, out_features=1152, bias=True)
                (wo): Linear(in_features=1152, out_features=1152, bias=True)
                (residual_dropout): Dropout(p=0.0, inplace=False)
              )
              (feed_forward): ViTMLP(
                (w1): Linear(in_features=1152, out_features=4304, bias=True)
                (act): PytorchGELUTanh()
                (w2): Linear(in_features=4304, out_features=1152, bias=True)
              )
              (attention_norm): LayerNorm((1152,), eps=1e-06, elementwise_affine=True)
              (ffn_norm): LayerNorm((1152,), eps=1e-06, elementwise_affine=True)
            )
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=1024, out_features=3584, bias=False)
  (vision_decoder_head): Linear(in_features=3584, out_features=1024, bias=False)
)
2025-07-16 18:42:22.459	g3086:3	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-16 18:42:22.460	g3086:3	olmo.data.data_loader:197	INFO	Loading train dataset depth/train
2025-07-16 18:42:22.460	g3086:3	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/train/train.json
2025-07-16 18:42:22.448	g3086:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0-27): 28 x FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=3584, out_features=3584, bias=False)
          (ff_out): Linear(in_features=18944, out_features=3584, bias=False)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): RMSLayerNorm()
          (ff_norm): RMSLayerNorm()
          (att_proj): Linear(in_features=3584, out_features=4608, bias=True)
          (ff_proj): Linear(in_features=3584, out_features=37888, bias=False)
        )
      )
    )
    (ln_f): FSDPRMSLayerNorm()
    (emb_drop): Dropout(p=0.0, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=3584, out_features=152064, bias=False)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=2304, out_features=1152, bias=True)
        (wk): Linear(in_features=2304, out_features=1152, bias=True)
        (wv): Linear(in_features=2304, out_features=1152, bias=True)
        (wo): Linear(in_features=1152, out_features=1152, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1152, out_features=18944, bias=False)
        (w2): Linear(in_features=18944, out_features=3584, bias=False)
        (w3): Linear(in_features=1152, out_features=18944, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPSiglipVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1152, bias=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0-24): 25 x FSDPCheckpointWrapper(
            (_checkpoint_wrapped_module): ResidualAttentionBlock(
              (attention): ViTMultiHeadDotProductAttention(
                (wq): Linear(in_features=1152, out_features=1152, bias=True)
                (wk): Linear(in_features=1152, out_features=1152, bias=True)
                (wv): Linear(in_features=1152, out_features=1152, bias=True)
                (wo): Linear(in_features=1152, out_features=1152, bias=True)
                (residual_dropout): Dropout(p=0.0, inplace=False)
              )
              (feed_forward): ViTMLP(
                (w1): Linear(in_features=1152, out_features=4304, bias=True)
                (act): PytorchGELUTanh()
                (w2): Linear(in_features=4304, out_features=1152, bias=True)
              )
              (attention_norm): LayerNorm((1152,), eps=1e-06, elementwise_affine=True)
              (ffn_norm): LayerNorm((1152,), eps=1e-06, elementwise_affine=True)
            )
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=1024, out_features=3584, bias=False)
  (vision_decoder_head): Linear(in_features=3584, out_features=1024, bias=False)
)
2025-07-16 18:42:22.473	g3086:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-16 18:42:22.475	g3086:0	olmo.data.data_loader:197	INFO	Loading train dataset depth/train
2025-07-16 18:42:22.475	g3086:0	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/train/train.json
2025-07-16 18:42:22.517	g3086:0	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-16 18:42:22.518	g3086:0	olmo.data.data_loader:219	INFO	depth: 100.00
2025-07-16 18:42:22.520	g3086:2	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-16 18:42:22.520	g3086:3	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-16 18:42:22.520	g3086:1	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-16 18:42:22.520	g3086:2	olmo.data.data_loader:219	INFO	depth: 100.00
2025-07-16 18:42:22.520	g3086:3	olmo.data.data_loader:219	INFO	depth: 100.00
2025-07-16 18:42:22.520	g3086:1	olmo.data.data_loader:219	INFO	depth: 100.00
2025-07-16 18:42:22.537	g3086:1	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=2304 images=9 pooled_patches_idx=1414
2025-07-16 18:42:22.537	g3086:2	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=2304 images=9 pooled_patches_idx=1414
2025-07-16 18:42:22.537	g3086:3	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=2304 images=9 pooled_patches_idx=1414
2025-07-16 18:42:22.537	g3086:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=2304 images=9 pooled_patches_idx=1414
2025-07-16 18:42:22.538	g3086:1	olmo.data.data_loader:100	INFO	Loading eval dataset: depth/validation
2025-07-16 18:42:22.538	g3086:2	olmo.data.data_loader:100	INFO	Loading eval dataset: depth/validation
2025-07-16 18:42:22.538	g3086:3	olmo.data.data_loader:100	INFO	Loading eval dataset: depth/validation
2025-07-16 18:42:22.538	g3086:1	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/val/val.json
2025-07-16 18:42:22.538	g3086:2	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/val/val.json
2025-07-16 18:42:22.538	g3086:3	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/val/val.json
2025-07-16 18:42:22.538	g3086:0	olmo.data.data_loader:100	INFO	Loading eval dataset: depth/validation
2025-07-16 18:42:22.538	g3086:0	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/val/val.json
2025-07-16 18:42:22.551	g3086:1	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=1792 images=9 pooled_patches_idx=1414
2025-07-16 18:42:22.551	g3086:2	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=1792 images=9 pooled_patches_idx=1414
2025-07-16 18:42:22.551	g3086:3	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=1792 images=9 pooled_patches_idx=1414
2025-07-16 18:42:22.551	g3086:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=1792 images=9 pooled_patches_idx=1414
2025-07-16 18:42:29.154	g3086:2	train:308	INFO	Loading unshared model from /mmfs1/gscratch/krishna/mahtab/Umolmo/pretrained/step22347-unsharded
2025-07-16 18:42:29.154	g3086:1	train:308	INFO	Loading unshared model from /mmfs1/gscratch/krishna/mahtab/Umolmo/pretrained/step22347-unsharded
2025-07-16 18:42:29.155	g3086:3	train:308	INFO	Loading unshared model from /mmfs1/gscratch/krishna/mahtab/Umolmo/pretrained/step22347-unsharded
2025-07-16 18:42:29.154	g3086:0	train:308	INFO	Loading unshared model from /mmfs1/gscratch/krishna/mahtab/Umolmo/pretrained/step22347-unsharded
2025-07-16 18:43:06.991	g3086:1	olmo.util:177	CRITICAL	Uncaught RuntimeError: Error(s) in loading state_dict for FSDPMolmo:
	Missing key(s) in state_dict: "vision_encoder_head.weight", "vision_decoder_head.weight". 
Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/Umolmo/launch_scripts/train_multitask_model.py", line 396, in <module>
    run_trainer(cfg)
  File "/gscratch/krishna/mahtab/Umolmo/scripts/train.py", line 309, in run_trainer
    load_model_state_unsharded(start_from, fsdp_model)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/checkpointer.py", line 58, in load_model_state_unsharded
    dist_cp_sd.set_model_state_dict(
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/distributed/checkpoint/state_dict.py", line 1277, in set_model_state_dict
    return _load_model_state_dict(model, model_state_dict, info)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/distributed/checkpoint/state_dict.py", line 605, in _load_model_state_dict
    _state_dict_fn(model, "load_state_dict")(
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2593, in load_state_dict
    raise RuntimeError(
RuntimeError: Error(s) in loading state_dict for FSDPMolmo:
	Missing key(s) in state_dict: "vision_encoder_head.weight", "vision_decoder_head.weight". 
2025-07-16 18:43:06.992	g3086:2	olmo.util:177	CRITICAL	Uncaught RuntimeError: Error(s) in loading state_dict for FSDPMolmo:
	Missing key(s) in state_dict: "vision_encoder_head.weight", "vision_decoder_head.weight". 
Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/Umolmo/launch_scripts/train_multitask_model.py", line 396, in <module>
    run_trainer(cfg)
  File "/gscratch/krishna/mahtab/Umolmo/scripts/train.py", line 309, in run_trainer
    load_model_state_unsharded(start_from, fsdp_model)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/checkpointer.py", line 58, in load_model_state_unsharded
    dist_cp_sd.set_model_state_dict(
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/distributed/checkpoint/state_dict.py", line 1277, in set_model_state_dict
    return _load_model_state_dict(model, model_state_dict, info)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/distributed/checkpoint/state_dict.py", line 605, in _load_model_state_dict
    _state_dict_fn(model, "load_state_dict")(
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2593, in load_state_dict
    raise RuntimeError(
RuntimeError: Error(s) in loading state_dict for FSDPMolmo:
	Missing key(s) in state_dict: "vision_encoder_head.weight", "vision_decoder_head.weight". 
2025-07-16 18:43:06.993	g3086:3	olmo.util:177	CRITICAL	Uncaught RuntimeError: Error(s) in loading state_dict for FSDPMolmo:
	Missing key(s) in state_dict: "vision_encoder_head.weight", "vision_decoder_head.weight". 
Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/Umolmo/launch_scripts/train_multitask_model.py", line 396, in <module>
    run_trainer(cfg)
  File "/gscratch/krishna/mahtab/Umolmo/scripts/train.py", line 309, in run_trainer
    load_model_state_unsharded(start_from, fsdp_model)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/checkpointer.py", line 58, in load_model_state_unsharded
    dist_cp_sd.set_model_state_dict(
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/distributed/checkpoint/state_dict.py", line 1277, in set_model_state_dict
    return _load_model_state_dict(model, model_state_dict, info)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/distributed/checkpoint/state_dict.py", line 605, in _load_model_state_dict
    _state_dict_fn(model, "load_state_dict")(
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2593, in load_state_dict
    raise RuntimeError(
RuntimeError: Error(s) in loading state_dict for FSDPMolmo:
	Missing key(s) in state_dict: "vision_encoder_head.weight", "vision_decoder_head.weight". 
2025-07-16 18:43:08.727	g3086:0	olmo.util:177	CRITICAL	Uncaught RuntimeError: Error(s) in loading state_dict for FSDPMolmo:
	Missing key(s) in state_dict: "vision_encoder_head.weight", "vision_decoder_head.weight". 
	Unexpected key(s) in state_dict: "vision_encoder_head", "vision_decoder_head". 
Traceback (most recent call last):
  File "/mmfs1/gscratch/krishna/mahtab/Umolmo/launch_scripts/train_multitask_model.py", line 396, in <module>
    run_trainer(cfg)
  File "/gscratch/krishna/mahtab/Umolmo/scripts/train.py", line 309, in run_trainer
    load_model_state_unsharded(start_from, fsdp_model)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/gscratch/krishna/mahtab/Umolmo/olmo/train/checkpointer.py", line 58, in load_model_state_unsharded
    dist_cp_sd.set_model_state_dict(
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/distributed/checkpoint/state_dict.py", line 1277, in set_model_state_dict
    return _load_model_state_dict(model, model_state_dict, info)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 116, in decorate_context
    return func(*args, **kwargs)
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/distributed/checkpoint/state_dict.py", line 605, in _load_model_state_dict
    _state_dict_fn(model, "load_state_dict")(
  File "/gscratch/krishna/mahtab/miniconda3/envs/molmo/lib/python3.10/site-packages/torch/nn/modules/module.py", line 2593, in load_state_dict
    raise RuntimeError(
RuntimeError: Error(s) in loading state_dict for FSDPMolmo:
	Missing key(s) in state_dict: "vision_encoder_head.weight", "vision_decoder_head.weight". 
	Unexpected key(s) in state_dict: "vision_encoder_head", "vision_decoder_head". 
2025-07-16 18:58:55.885	g3086:2	olmo.util:269	INFO	Set up torchrun environment
2025-07-16 18:58:55.885	g3086:3	olmo.util:269	INFO	Set up torchrun environment
2025-07-16 18:58:55.885	g3086:1	olmo.util:269	INFO	Set up torchrun environment
2025-07-16 18:58:55.902	g3086:0	olmo.util:269	INFO	Set up torchrun environment
2025-07-16 18:58:56.046	g3086:1	root:266	INFO	Setting eval subset batches to 128
2025-07-16 18:58:56.046	g3086:2	root:266	INFO	Setting eval subset batches to 128
2025-07-16 18:58:56.046	g3086:3	root:266	INFO	Setting eval subset batches to 128
2025-07-16 18:58:56.047	g3086:0	root:266	INFO	Setting eval subset batches to 128
2025-07-16 18:58:56.375	g3086:3	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-16 18:58:56.375	g3086:1	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-16 18:58:56.375	g3086:2	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-16 18:58:56.375	g3086:0	train:54	INFO	Configuration:
2025-07-16 18:58:56.375	g3086:0	train:55	INFO	TrainConfig(run_name='multitask_train', model=MolmoConfig(model_name='molmo', llm=LlmConfig(d_model=3584, n_heads=28, n_kv_heads=4, head_dim=None, qkv_bias=True, clip_qkv=None, n_layers=28, mlp_ratio=4, mlp_hidden_size=37888, activation_type='swiglu', block_type='sequential', rope=True, rope_full_precision=True, rope_theta=1000000.0, rope_type='default', rope_factor=None, rope_high_freq_factor=None, rope_low_freq_factor=None, rope_original_max_position_embeddings=None, attention_type='sdpa', float32_attention=True, attention_dropout=0.0, attention_layer_norm=False, attention_layer_norm_type='olmo', residual_dropout=0.1, response_residual_dropout=0.0, layer_norm_type='rms', layer_norm_with_affine=True, layer_norm_eps=1e-06, attention_layer_norm_with_affine=True, max_sequence_length=4096, max_position_embeddings=None, include_bias=False, bias_for_layer_norm=None, norm_after=False, moe_num_experts=8, moe_top_k=2, moe_mlp_impl='sparse', moe_log_expert_assignment=False, moe_shared_expert=False, moe_lbl_in_fp32=False, moe_interleave=False, moe_loss_weight=0.1, moe_zloss_weight=None, moe_dropless=True, moe_capacity_factor=1.25, embedding_dropout=0.0, scale_logits=False, vocab_size=152064, additional_vocab_size=128, weight_tying=False, embedding_size=152064, use_position_ids=True, tokenizer=TokenizerConfig(identifier='Qwen/Qwen2.5-7B', tokenizer_dir=None), init_path='gs://mm-olmo/pretrained_llms/qwen2.5-7b.pt', init_incremental=None, new_embedding_init_range=0.02, initializer_range=0.02, normalize_input_embeds=False, activation_checkpoint='whole_layer', compile='blocks', fix_pad_tokenizer=False, init_std=0.02, init_fn='normal', init_cutoff_factor=None), vision_backbone=MolmoVisionBackboneConfig(vit=VitConfig(image_model_type='siglip', image_default_input_size=(378, 378), image_patch_size=14, image_pos_patch_size=14, image_emb_dim=1152, image_num_heads=16, image_num_key_value_heads=16, image_num_layers=27, image_head_dim=72, image_mlp_dim=4304, image_mlp_activations='gelu_pytorch_tanh', image_dropout_rate=0.0, image_num_pos=729, image_norm_eps=1e-06, attention_dropout=0.0, residual_dropout=0.0, initializer_range=0.02, float32_attention=True, attention_type='sdpa', activation_checkpointing=True, init_path='gs://mm-olmo/pretrained_image_encoders/siglip2-so400m-14-384.pt', resize_mode='siglip', pad_value=0.0, normalize='siglip'), image_pooling_2d='attention_meanq', pooling_attention_mask=False, image_projector='mlp', image_padding_embed=None, vit_layers=(-3, -9), skip_unused_layers=True, image_feature_dropout=0.0, connector_activation_checkpointing=True, compile_vit='blocks'), data_formatter=DataFormatter(prompt_templates='uber_model', message_format='role', system_prompt='demo_or_style', always_start_with_space=False, default_inference_len=65, select_answer='best', debug=False, image_last=False, format_message_list=None, p_one_message=0.0), mm_preprocessor=MolmoPreprocessorConfig(crop_mode='overlap-and-resize-c2', max_crops=8, max_images=None, pooling_w=2, pooling_h=2, overlap_margins=[4, 4], use_col_tokens=True, loss_token_weighting='root_subsegments', legacy_image_mask=False), bi_directional_attn=None, image_encoder='SigLip2', vision_head_type='Linear', per_image_output_tokens=64), seed=6198, epoch=None, dry_run=False, ft_llm=True, ft_gen=True, ft_vit=True, ft_connector=True, ft_embedding='all', optimizer=OptimizerConfig(name='adamw', learning_rate=0.0001, weight_decay=0.01, betas=(0.9, 0.95), eps=1e-05, gen_learning_rate=1e-05, connector_learning_rate=5e-06, vit_learning_rate=5e-06, llm_learning_rate=1e-05, gen_weight_decay=0.0, connector_weight_decay=0.0, vit_weight_decay=0.0, llm_weight_decay=0.0, gen_betas=(0.9, 0.95), connector_betas=(0.9, 0.95), vit_betas=(0.9, 0.95), llm_betas=(0.9, 0.95), gen_eps=1e-06, connector_eps=1e-06, vit_eps=1e-06, llm_eps=1e-06, metrics_log_interval=-1), scheduler=SchedulerConfig(name='multimodal', units='steps', t_warmup=100, t_max=None, alpha_f=0.1, connector_t_warmup=200, vit_t_warmup=200, llm_t_warmup=200, gen_t_warmup=200, grad_clip_warmup_steps=None, grad_clip_warmup_factor=None, warmup_min_lr=0.0), data=DataLoaderConfig(dataset=None, mixture=None, root_size_mixture=[RootSizeMixture(rate=1.0, mixture={'depth': None})], kwargs_mixture=None, split='train', seed=50189, pad='to_max', sequence_length=2304, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=False, timeout=0), restore_dataloader=True, fast_forward_batches=None, evaluators=[], eval_interval=2000, inf_evaluators=[InfDatasetEvaluatorConfig(label='depth', data=DataLoaderConfig(dataset='depth', mixture=None, root_size_mixture=None, kwargs_mixture=None, split='validation', seed=691203, pad='to_max', sequence_length=1792, max_text_seq_len=None, shuffle=True, start_index=0, num_workers=0, drop_last=True, pin_memory=True, prefetch_factor=None, persistent_workers=True, timeout=0), evaluator=EvaluatorConfig(n_to_log=0, num_wandb_examples=32, save_predictions=None, save_tokens=False, vqa_eval='', pointing_eval=False, count_eval=False, point_count_eval=False, android_eval=False, clock_eval=False, clock_bench_eval=False, math_vista_eval=False, temp_compass_eval='', temp_compass_disable_api=False, video_mme_eval='', mlvu_gen_eval=False, long_video_bench_eval=False, plm_fgqa_eval=False), max_new_tokens=12, device_batch_size=4, subset_num_batches=None, max_examples=2048, console_log_interval=20, include_image=False)], inf_eval_interval=2000, eval_on_last_step=True, eval_on_load=False, save_folder='/mmfs1/gscratch/krishna/mahtab/Umolmo/checkpoints/molmo-7b-qwen2-siglip2-finetune', checkpointer_config=CheckpointerConfig(save_thread_count=None, load_thread_count=None, pre_download=False, work_dir=None, throttle_uploads=False), canceled_check_interval=50, save_interval=2000, save_num_checkpoints_to_keep=1, save_final_unsharded_checkpoint=False, save_interval_ephemeral=None, save_overwrite=True, load_path=None, reset_optimizer_state=False, reset_trainer_state=False, initial_model_checkpoint='/mmfs1/gscratch/krishna/mahtab/Umolmo/pretrained/step22347-unsharded', allow_resume=True, max_duration=30000, global_train_batch_size=256, device_train_microbatch_size=4, max_grad_norm=1.0, multi_component_grad_norm=True, batch_divisor='global_batch', max_grad_norm_ratio=None, precision='amp_bf16', wandb=WandbConfig(project='mmseek', entity='allenai-team1', group=None, name='molmo-7b-qwen2-siglip2-finetune', tags=['watching'], log_artifacts=False, rank_zero_only=True, log_interval=20, allow_resume=False), beaker_log_interval=50, speed_monitor=SpeedMonitorConfig(window_size=20, gpu_flops_available=None), console_log_interval=20, gen1_gc_interval=1, compile=CompilerConfig(mode='default', fullgraph=False, dynamic=False, backend='inductor'), activation_checkpointing=True, fsdp=FSDPConfig(fsdp2=True, precision='float', use_orig_params=True, wrapping_strategy='by_block_and_size', sharding_strategy=<ShardingStrategy.FULL_SHARD: 1>, hybrid_sharding_num_model_replicas=None), softmax_auxiliary_loss=True, softmax_auxiliary_loss_scale=0.0001, time_limit=None, extra_steps_after_cancel=10, python_profiling=False, torch_profiling=False, stop_at=30000, stop_after=None, fused_loss=False, compile_loss=True, runtime_data=None, image_generation_loss_type='cosine')
2025-07-16 18:58:56.733	g3086:0	train:82	INFO	Not resuming since no latest checkpoint found
2025-07-16 18:58:59.028	g3086:3	root:123	INFO	Padding tokenizer with 397 tokens
2025-07-16 18:58:59.028	g3086:1	root:123	INFO	Padding tokenizer with 397 tokens
2025-07-16 18:58:59.032	g3086:2	root:123	INFO	Padding tokenizer with 397 tokens
2025-07-16 18:58:59.217	g3086:0	root:123	INFO	Padding tokenizer with 397 tokens
2025-07-16 18:59:04.420	g3086:0	train:180	INFO	Wrapping model with FSDP2...
2025-07-16 18:59:04.424	g3086:3	train:180	INFO	Wrapping model with FSDP2...
2025-07-16 18:59:04.424	g3086:1	train:180	INFO	Wrapping model with FSDP2...
2025-07-16 18:59:04.424	g3086:2	train:180	INFO	Wrapping model with FSDP2...
2025-07-16 18:59:05.095	g3086:1	train:191	INFO	Total number of parameters: 8,126,757,840
2025-07-16 18:59:05.096	g3086:2	train:191	INFO	Total number of parameters: 8,126,757,840
2025-07-16 18:59:05.096	g3086:3	train:191	INFO	Total number of parameters: 8,126,757,840
2025-07-16 18:59:05.097	g3086:1	train:192	INFO	Number of non-embedding parameters: 7,581,301,712
2025-07-16 18:59:05.097	g3086:2	train:192	INFO	Number of non-embedding parameters: 7,581,301,712
2025-07-16 18:59:05.098	g3086:3	train:192	INFO	Number of non-embedding parameters: 7,581,301,712
2025-07-16 18:59:05.098	g3086:1	train:195	INFO	Peak GPU Memory (MB) after FSDP: 8177
2025-07-16 18:59:05.098	g3086:2	train:195	INFO	Peak GPU Memory (MB) after FSDP: 8177
2025-07-16 18:59:05.098	g3086:1	train:196	INFO	Model:
2025-07-16 18:59:05.098	g3086:2	train:196	INFO	Model:
2025-07-16 18:59:05.098	g3086:3	train:195	INFO	Peak GPU Memory (MB) after FSDP: 8177
2025-07-16 18:59:05.098	g3086:3	train:196	INFO	Model:
2025-07-16 18:59:05.098	g3086:2	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0-27): 28 x FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=3584, out_features=3584, bias=False)
          (ff_out): Linear(in_features=18944, out_features=3584, bias=False)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): RMSLayerNorm()
          (ff_norm): RMSLayerNorm()
          (att_proj): Linear(in_features=3584, out_features=4608, bias=True)
          (ff_proj): Linear(in_features=3584, out_features=37888, bias=False)
        )
      )
    )
    (ln_f): FSDPRMSLayerNorm()
    (emb_drop): Dropout(p=0.0, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=3584, out_features=152064, bias=False)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=2304, out_features=1152, bias=True)
        (wk): Linear(in_features=2304, out_features=1152, bias=True)
        (wv): Linear(in_features=2304, out_features=1152, bias=True)
        (wo): Linear(in_features=1152, out_features=1152, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1152, out_features=18944, bias=False)
        (w2): Linear(in_features=18944, out_features=3584, bias=False)
        (w3): Linear(in_features=1152, out_features=18944, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPSiglipVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1152, bias=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0-24): 25 x FSDPCheckpointWrapper(
            (_checkpoint_wrapped_module): ResidualAttentionBlock(
              (attention): ViTMultiHeadDotProductAttention(
                (wq): Linear(in_features=1152, out_features=1152, bias=True)
                (wk): Linear(in_features=1152, out_features=1152, bias=True)
                (wv): Linear(in_features=1152, out_features=1152, bias=True)
                (wo): Linear(in_features=1152, out_features=1152, bias=True)
                (residual_dropout): Dropout(p=0.0, inplace=False)
              )
              (feed_forward): ViTMLP(
                (w1): Linear(in_features=1152, out_features=4304, bias=True)
                (act): PytorchGELUTanh()
                (w2): Linear(in_features=4304, out_features=1152, bias=True)
              )
              (attention_norm): LayerNorm((1152,), eps=1e-06, elementwise_affine=True)
              (ffn_norm): LayerNorm((1152,), eps=1e-06, elementwise_affine=True)
            )
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=1024, out_features=3584, bias=False)
  (vision_decoder_head): Linear(in_features=3584, out_features=1024, bias=False)
)
2025-07-16 18:59:05.098	g3086:1	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0-27): 28 x FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=3584, out_features=3584, bias=False)
          (ff_out): Linear(in_features=18944, out_features=3584, bias=False)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): RMSLayerNorm()
          (ff_norm): RMSLayerNorm()
          (att_proj): Linear(in_features=3584, out_features=4608, bias=True)
          (ff_proj): Linear(in_features=3584, out_features=37888, bias=False)
        )
      )
    )
    (ln_f): FSDPRMSLayerNorm()
    (emb_drop): Dropout(p=0.0, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=3584, out_features=152064, bias=False)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=2304, out_features=1152, bias=True)
        (wk): Linear(in_features=2304, out_features=1152, bias=True)
        (wv): Linear(in_features=2304, out_features=1152, bias=True)
        (wo): Linear(in_features=1152, out_features=1152, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1152, out_features=18944, bias=False)
        (w2): Linear(in_features=18944, out_features=3584, bias=False)
        (w3): Linear(in_features=1152, out_features=18944, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPSiglipVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1152, bias=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0-24): 25 x FSDPCheckpointWrapper(
            (_checkpoint_wrapped_module): ResidualAttentionBlock(
              (attention): ViTMultiHeadDotProductAttention(
                (wq): Linear(in_features=1152, out_features=1152, bias=True)
                (wk): Linear(in_features=1152, out_features=1152, bias=True)
                (wv): Linear(in_features=1152, out_features=1152, bias=True)
                (wo): Linear(in_features=1152, out_features=1152, bias=True)
                (residual_dropout): Dropout(p=0.0, inplace=False)
              )
              (feed_forward): ViTMLP(
                (w1): Linear(in_features=1152, out_features=4304, bias=True)
                (act): PytorchGELUTanh()
                (w2): Linear(in_features=4304, out_features=1152, bias=True)
              )
              (attention_norm): LayerNorm((1152,), eps=1e-06, elementwise_affine=True)
              (ffn_norm): LayerNorm((1152,), eps=1e-06, elementwise_affine=True)
            )
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=1024, out_features=3584, bias=False)
  (vision_decoder_head): Linear(in_features=3584, out_features=1024, bias=False)
)
2025-07-16 18:59:05.121	g3086:2	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-16 18:59:05.114	g3086:3	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0-27): 28 x FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=3584, out_features=3584, bias=False)
          (ff_out): Linear(in_features=18944, out_features=3584, bias=False)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): RMSLayerNorm()
          (ff_norm): RMSLayerNorm()
          (att_proj): Linear(in_features=3584, out_features=4608, bias=True)
          (ff_proj): Linear(in_features=3584, out_features=37888, bias=False)
        )
      )
    )
    (ln_f): FSDPRMSLayerNorm()
    (emb_drop): Dropout(p=0.0, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=3584, out_features=152064, bias=False)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=2304, out_features=1152, bias=True)
        (wk): Linear(in_features=2304, out_features=1152, bias=True)
        (wv): Linear(in_features=2304, out_features=1152, bias=True)
        (wo): Linear(in_features=1152, out_features=1152, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1152, out_features=18944, bias=False)
        (w2): Linear(in_features=18944, out_features=3584, bias=False)
        (w3): Linear(in_features=1152, out_features=18944, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPSiglipVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1152, bias=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0-24): 25 x FSDPCheckpointWrapper(
            (_checkpoint_wrapped_module): ResidualAttentionBlock(
              (attention): ViTMultiHeadDotProductAttention(
                (wq): Linear(in_features=1152, out_features=1152, bias=True)
                (wk): Linear(in_features=1152, out_features=1152, bias=True)
                (wv): Linear(in_features=1152, out_features=1152, bias=True)
                (wo): Linear(in_features=1152, out_features=1152, bias=True)
                (residual_dropout): Dropout(p=0.0, inplace=False)
              )
              (feed_forward): ViTMLP(
                (w1): Linear(in_features=1152, out_features=4304, bias=True)
                (act): PytorchGELUTanh()
                (w2): Linear(in_features=4304, out_features=1152, bias=True)
              )
              (attention_norm): LayerNorm((1152,), eps=1e-06, elementwise_affine=True)
              (ffn_norm): LayerNorm((1152,), eps=1e-06, elementwise_affine=True)
            )
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=1024, out_features=3584, bias=False)
  (vision_decoder_head): Linear(in_features=3584, out_features=1024, bias=False)
)
2025-07-16 18:59:05.149	g3086:2	olmo.data.data_loader:197	INFO	Loading train dataset depth/train
2025-07-16 18:59:05.102	g3086:0	train:191	INFO	Total number of parameters: 8,126,757,840
2025-07-16 18:59:05.149	g3086:2	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/train/train.json
2025-07-16 18:59:05.152	g3086:0	train:192	INFO	Number of non-embedding parameters: 7,581,301,712
2025-07-16 18:59:05.153	g3086:0	train:195	INFO	Peak GPU Memory (MB) after FSDP: 8177
2025-07-16 18:59:05.153	g3086:0	train:196	INFO	Model:
2025-07-16 18:59:05.155	g3086:1	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-16 18:59:05.156	g3086:1	olmo.data.data_loader:197	INFO	Loading train dataset depth/train
2025-07-16 18:59:05.156	g3086:1	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/train/train.json
2025-07-16 18:59:05.156	g3086:3	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-16 18:59:05.157	g3086:3	olmo.data.data_loader:197	INFO	Loading train dataset depth/train
2025-07-16 18:59:05.157	g3086:3	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/train/train.json
2025-07-16 18:59:05.154	g3086:0	train:197	INFO	FSDPMolmo(
  (transformer): Llm(
    (blocks): ModuleList(
      (0-27): 28 x FSDPCheckpointWrapper(
        (_checkpoint_wrapped_module): OLMoSequentialBlock(
          (dropout): Dropout(p=0.1, inplace=False)
          (act): SwiGLU()
          (attn_out): Linear(in_features=3584, out_features=3584, bias=False)
          (ff_out): Linear(in_features=18944, out_features=3584, bias=False)
          (rotary_emb): RotaryEmbedding()
          (attn_norm): RMSLayerNorm()
          (ff_norm): RMSLayerNorm()
          (att_proj): Linear(in_features=3584, out_features=4608, bias=True)
          (ff_proj): Linear(in_features=3584, out_features=37888, bias=False)
        )
      )
    )
    (ln_f): FSDPRMSLayerNorm()
    (emb_drop): Dropout(p=0.0, inplace=False)
    (wte): FSDPEmbedding()
    (ff_out): FSDPLinear(in_features=3584, out_features=152064, bias=False)
  )
  (vision_backbone): FSDPMolmoVisionBackbone(
    (image_pooling_2d): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ViTMultiHeadDotProductAttention(
        (wq): Linear(in_features=2304, out_features=1152, bias=True)
        (wk): Linear(in_features=2304, out_features=1152, bias=True)
        (wv): Linear(in_features=2304, out_features=1152, bias=True)
        (wo): Linear(in_features=1152, out_features=1152, bias=True)
        (residual_dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_projector): FSDPCheckpointWrapper(
      (_checkpoint_wrapped_module): ImageProjectorMLP(
        (w1): Linear(in_features=1152, out_features=18944, bias=False)
        (w2): Linear(in_features=18944, out_features=3584, bias=False)
        (w3): Linear(in_features=1152, out_features=18944, bias=False)
        (act): LlamaSwiGLU()
        (dropout): Dropout(p=0.0, inplace=False)
      )
    )
    (image_feature_dropout): Dropout(p=0.0, inplace=False)
    (image_vit): FSDPSiglipVisionTransformer(
      (patch_embedding): Linear(in_features=588, out_features=1152, bias=True)
      (transformer): BlockCollection(
        (resblocks): ModuleList(
          (0-24): 25 x FSDPCheckpointWrapper(
            (_checkpoint_wrapped_module): ResidualAttentionBlock(
              (attention): ViTMultiHeadDotProductAttention(
                (wq): Linear(in_features=1152, out_features=1152, bias=True)
                (wk): Linear(in_features=1152, out_features=1152, bias=True)
                (wv): Linear(in_features=1152, out_features=1152, bias=True)
                (wo): Linear(in_features=1152, out_features=1152, bias=True)
                (residual_dropout): Dropout(p=0.0, inplace=False)
              )
              (feed_forward): ViTMLP(
                (w1): Linear(in_features=1152, out_features=4304, bias=True)
                (act): PytorchGELUTanh()
                (w2): Linear(in_features=4304, out_features=1152, bias=True)
              )
              (attention_norm): LayerNorm((1152,), eps=1e-06, elementwise_affine=True)
              (ffn_norm): LayerNorm((1152,), eps=1e-06, elementwise_affine=True)
            )
          )
        )
      )
    )
  )
  (vision_encoder_head): Linear(in_features=1024, out_features=3584, bias=False)
  (vision_decoder_head): Linear(in_features=3584, out_features=1024, bias=False)
)
2025-07-16 18:59:05.177	g3086:0	olmo.train.optim:178	INFO	Constructing optimizer with 4 param groups
2025-07-16 18:59:05.178	g3086:0	olmo.data.data_loader:197	INFO	Loading train dataset depth/train
2025-07-16 18:59:05.179	g3086:0	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/train/train.json
2025-07-16 18:59:05.230	g3086:3	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-16 18:59:05.230	g3086:2	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-16 18:59:05.230	g3086:1	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-16 18:59:05.230	g3086:3	olmo.data.data_loader:219	INFO	depth: 100.00
2025-07-16 18:59:05.230	g3086:2	olmo.data.data_loader:219	INFO	depth: 100.00
2025-07-16 18:59:05.230	g3086:1	olmo.data.data_loader:219	INFO	depth: 100.00
2025-07-16 18:59:05.230	g3086:0	olmo.data.data_loader:216	INFO	Sampling rates:
2025-07-16 18:59:05.231	g3086:0	olmo.data.data_loader:219	INFO	depth: 100.00
2025-07-16 18:59:05.252	g3086:2	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=2304 images=9 pooled_patches_idx=1414
2025-07-16 18:59:05.252	g3086:3	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=2304 images=9 pooled_patches_idx=1414
2025-07-16 18:59:05.252	g3086:1	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=2304 images=9 pooled_patches_idx=1414
2025-07-16 18:59:05.252	g3086:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=2304 images=9 pooled_patches_idx=1414
2025-07-16 18:59:05.253	g3086:3	olmo.data.data_loader:100	INFO	Loading eval dataset: depth/validation
2025-07-16 18:59:05.253	g3086:2	olmo.data.data_loader:100	INFO	Loading eval dataset: depth/validation
2025-07-16 18:59:05.253	g3086:1	olmo.data.data_loader:100	INFO	Loading eval dataset: depth/validation
2025-07-16 18:59:05.253	g3086:3	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/val/val.json
2025-07-16 18:59:05.253	g3086:2	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/val/val.json
2025-07-16 18:59:05.253	g3086:1	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/val/val.json
2025-07-16 18:59:05.253	g3086:0	olmo.data.data_loader:100	INFO	Loading eval dataset: depth/validation
2025-07-16 18:59:05.254	g3086:0	root:34	INFO	Loading depth data from /gscratch/krishna/mahtab/Umolmo/Data/torch_datasets/depth/val/val.json
2025-07-16 18:59:05.270	g3086:3	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=1792 images=9 pooled_patches_idx=1414
2025-07-16 18:59:05.270	g3086:2	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=1792 images=9 pooled_patches_idx=1414
2025-07-16 18:59:05.270	g3086:1	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=1792 images=9 pooled_patches_idx=1414
2025-07-16 18:59:05.270	g3086:0	olmo.models.molmo.molmo:122	INFO	Building collator, pad=to_max seq_len=1792 images=9 pooled_patches_idx=1414
2025-07-16 18:59:11.454	g3086:1	train:308	INFO	Loading unshared model from /mmfs1/gscratch/krishna/mahtab/Umolmo/pretrained/step22347-unsharded
2025-07-16 18:59:11.454	g3086:3	train:308	INFO	Loading unshared model from /mmfs1/gscratch/krishna/mahtab/Umolmo/pretrained/step22347-unsharded
2025-07-16 18:59:11.454	g3086:2	train:308	INFO	Loading unshared model from /mmfs1/gscratch/krishna/mahtab/Umolmo/pretrained/step22347-unsharded
2025-07-16 18:59:11.454	g3086:0	train:308	INFO	Loading unshared model from /mmfs1/gscratch/krishna/mahtab/Umolmo/pretrained/step22347-unsharded
2025-07-16 18:59:37.039	g3086:1	train:323	INFO	Checkpoint successfully loaded in 25.6 seconds
2025-07-16 18:59:37.040	g3086:3	train:323	INFO	Checkpoint successfully loaded in 25.6 seconds
2025-07-16 18:59:37.039	g3086:2	train:323	INFO	Checkpoint successfully loaded in 25.6 seconds
2025-07-16 18:59:47.957	g3086:0	train:323	INFO	Checkpoint successfully loaded in 36.5 seconds
2025-07-16 18:59:48.949	g3086:0	train:332	INFO	Starting training...
2025-07-16 18:59:48.952	g3086:1	train:332	INFO	Starting training...
2025-07-16 18:59:48.954	g3086:3	train:332	INFO	Starting training...
2025-07-16 18:59:48.955	g3086:1	olmo.train.trainer:817	INFO	Pre-train system metrics
    System/Peak GPU Memory (MB)=10,358
2025-07-16 18:59:48.956	g3086:2	train:332	INFO	Starting training...
2025-07-16 18:59:48.959	g3086:3	olmo.train.trainer:817	INFO	Pre-train system metrics
    System/Peak GPU Memory (MB)=10,358
2025-07-16 18:59:48.959	g3086:2	olmo.train.trainer:817	INFO	Pre-train system metrics
    System/Peak GPU Memory (MB)=10,358
2025-07-16 18:59:48.959	g3086:0	olmo.train.trainer:817	INFO	Pre-train system metrics
    System/Peak GPU Memory (MB)=10,358
2025-07-16 19:00:28.237	g3086:1	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:461: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 19:00:28.237	g3086:3	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:461: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 19:00:28.237	g3086:2	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:461: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 19:00:28.310	g3086:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:461: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 19:00:58.830	g3086:3	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:461: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 19:00:58.830	g3086:1	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:461: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 19:00:58.830	g3086:2	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:461: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 19:00:58.830	g3086:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:461: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 19:05:11.903	g3086:2	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:461: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 19:05:11.903	g3086:3	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:461: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 19:05:11.903	g3086:0	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:461: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

2025-07-16 19:05:11.903	g3086:1	py.warnings:109	WARNING	/gscratch/krishna/mahtab/Umolmo/olmo/models/molmo/molmo.py:461: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(enabled=False):

